Loading data
Loading data
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Epoch 0
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Epoch 0
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Epoch 0
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 7.856414
Validation band_gap mae = 7.856414
Epoch 1
Validation mae = 7.535098
Validation band_gap mae = 7.535098
Epoch 2
Validation mae = 5.438952
Validation band_gap mae = 5.438952
Epoch 3
Validation mae = 7.730510
Validation band_gap mae = 7.730510
Epoch 4
Validation mae = 6.269136
Validation band_gap mae = 6.269136
Epoch 5
Validation mae = 7.985044
Validation band_gap mae = 7.985044
Epoch 6
Validation mae = 4.760769
Validation band_gap mae = 4.760769
Epoch 7
Validation mae = 4.591734
Validation band_gap mae = 4.591734
Epoch 8
Validation mae = 4.037439
Validation band_gap mae = 4.037439
Epoch 9
Validation mae = 3.651691
Validation band_gap mae = 3.651691
Epoch 10
Validation mae = 3.944384
Validation band_gap mae = 3.944384
Epoch 11
Validation mae = 3.699607
Validation band_gap mae = 3.699607
Epoch 12
Validation mae = 3.706796
Validation band_gap mae = 3.706796
Epoch 13
Validation mae = 3.391762
Validation band_gap mae = 3.391762
Epoch 14
Validation mae = 3.511865
Validation band_gap mae = 3.511865
Epoch 15
Validation mae = 3.232284
Validation band_gap mae = 3.232284
Epoch 16
Validation mae = 3.265400
Validation band_gap mae = 3.265400
Epoch 17
Validation mae = 4.225385
Validation band_gap mae = 4.225385
Epoch 18
Validation mae = 3.367210
Validation band_gap mae = 3.367210
Epoch 19
Validation mae = 3.310203
Validation band_gap mae = 3.310203
Epoch 20
Validation mae = 3.523369
Validation band_gap mae = 3.523369
Epoch 21
Validation mae = 3.573224
Validation band_gap mae = 3.573224
Epoch 22
Validation mae = 3.686463
Validation band_gap mae = 3.686463
Epoch 23
Validation mae = 3.977868
Validation band_gap mae = 3.977868
Epoch 24
Validation mae = 3.669419
Validation band_gap mae = 3.669419
Epoch 25
Validation mae = 3.410511
Validation band_gap mae = 3.410511
Epoch 26
Validation mae = 3.249637
Validation band_gap mae = 3.249637
Epoch 27
Validation mae = 3.164633
Validation band_gap mae = 3.164633
Epoch 28
Validation mae = 3.321883
Validation band_gap mae = 3.321883
Epoch 29
Validation mae = 3.181909
Validation band_gap mae = 3.181909
Epoch 30
Validation mae = 3.305985
Validation band_gap mae = 3.305985
Epoch 31
Validation mae = 3.742715
Validation band_gap mae = 3.742715
Epoch 32
Validation mae = 3.329932
Validation band_gap mae = 3.329932
Epoch 33
Validation mae = 3.151515
Validation band_gap mae = 3.151515
Epoch 34
Validation mae = 3.245481
Validation band_gap mae = 3.245481
Epoch 35
Validation mae = 3.231340
Validation band_gap mae = 3.231340
Epoch 36
Validation mae = 3.372264
Validation band_gap mae = 3.372264
Epoch 37
Validation mae = 3.229072
Validation band_gap mae = 3.229072
Epoch 38
Validation mae = 3.222913
Validation band_gap mae = 3.222913
Epoch 39
Validation mae = 3.181737
Validation band_gap mae = 3.181737
Epoch 40
Validation mae = 3.247459
Validation band_gap mae = 3.247459
Epoch 41
Validation mae = 3.245842
Validation band_gap mae = 3.245842
Epoch 42
Validation mae = 3.377779
Validation band_gap mae = 3.377779
Epoch 43
Validation mae = 3.348464
Validation band_gap mae = 3.348464
Epoch 44
Validation mae = 3.277580
Validation band_gap mae = 3.277580
Epoch 45
Validation mae = 3.244642
Validation band_gap mae = 3.244642
Epoch 46
Validation mae = 3.306138
Validation band_gap mae = 3.306138
Epoch 47
Validation mae = 3.342666
Validation band_gap mae = 3.342666
Epoch 48
Validation mae = 3.463772
Validation band_gap mae = 3.463772
Epoch 49
Validation mae = 3.460536
Validation band_gap mae = 3.460536
Epoch 50
Validation mae = 3.425808
Validation band_gap mae = 3.425808
Epoch 51
Validation mae = 3.582804
Validation band_gap mae = 3.582804
Epoch 52
Validation mae = 3.495851
Validation band_gap mae = 3.495851
Epoch 53
Validation mae = 3.769444
Validation band_gap mae = 3.769444
Epoch 54
Validation mae = 3.542195
Validation band_gap mae = 3.542195
Epoch 55
Validation mae = 3.428035
Validation band_gap mae = 3.428035
Epoch 56
Validation mae = 3.278577
Validation band_gap mae = 3.278577
Epoch 57
Validation mae = 3.268491
Validation band_gap mae = 3.268491
Epoch 58
Validation mae = 3.349948
Validation band_gap mae = 3.349948
Epoch 59
Validation mae = 3.413072
Validation band_gap mae = 3.413072
Epoch 60
Validation mae = 3.807248
Validation band_gap mae = 3.807248
Epoch 61
Validation mae = 3.898452
Validation band_gap mae = 3.898452
Epoch 62
Validation mae = 3.474910
Validation band_gap mae = 3.474910
Epoch 63
Validation mae = 3.405928
Validation band_gap mae = 3.405928
Epoch 64
Validation mae = 3.321102
Validation band_gap mae = 3.321102
Epoch 65
Validation mae = 3.307209
Validation band_gap mae = 3.307209
Epoch 66
Validation mae = 3.411610
Validation band_gap mae = 3.411610
Epoch 67
Validation mae = 3.229439
Validation band_gap mae = 3.229439
Epoch 68
Validation mae = 3.340490
Validation band_gap mae = 3.340490
Epoch 69
Validation mae = 3.302177
Validation band_gap mae = 3.302177
Epoch 70
Validation mae = 3.345793
Validation band_gap mae = 3.345793
Epoch 71
Validation mae = 3.456411
Validation band_gap mae = 3.456411
Epoch 72
Validation mae = 3.347261
Validation band_gap mae = 3.347261
Epoch 73
Validation mae = 3.370729
Validation band_gap mae = 3.370729
Epoch 74
Validation mae = 3.262135
Validation band_gap mae = 3.262135
Epoch 75
Validation mae = 3.294967
Validation band_gap mae = 3.294967
Epoch 76
Validation mae = 3.298646
Validation band_gap mae = 3.298646
Epoch 77
Validation mae = 3.450399
Validation band_gap mae = 3.450399
Epoch 78
Validation mae = 3.318709
Validation band_gap mae = 3.318709
Epoch 79
Validation mae = 3.353615
Validation band_gap mae = 3.353615
Epoch 80
Validation mae = 3.272893
Validation band_gap mae = 3.272893
Epoch 81
Validation mae = 3.334704
Validation band_gap mae = 3.334704
Epoch 82
Validation mae = 3.533030
Validation band_gap mae = 3.533030
Epoch 83
Validation mae = 3.438094
Validation band_gap mae = 3.438094
Epoch 84
Validation mae = 3.341521
Validation band_gap mae = 3.341521
Epoch 85
Validation mae = 3.222132
Validation band_gap mae = 3.222132
Epoch 86
Validation mae = 3.203535
Validation band_gap mae = 3.203535
Epoch 87
Validation mae = 3.284304
Validation band_gap mae = 3.284304
Epoch 88
Validation mae = 3.243987
Validation band_gap mae = 3.243987
Epoch 89
Validation mae = 3.223766
Validation band_gap mae = 3.223766
Epoch 90
Validation mae = 3.209641
Validation band_gap mae = 3.209641
Epoch 91
Validation mae = 3.292721
Validation band_gap mae = 3.292721
Epoch 92
Validation mae = 3.330360
Validation band_gap mae = 3.330360
Epoch 93
Validation mae = 3.277752
Validation band_gap mae = 3.277752
Epoch 94
Validation mae = 3.255311
Validation band_gap mae = 3.255311
Epoch 95
Validation mae = 3.280041
Validation band_gap mae = 3.280041
Epoch 96
Validation mae = 3.314715
Validation band_gap mae = 3.314715
Epoch 97
Validation mae = 3.195976
Validation band_gap mae = 3.195976
Epoch 98
Validation mae = 3.366152
Validation band_gap mae = 3.366152
Epoch 99
Validation mae = 3.307517
Validation band_gap mae = 3.307517
Model 0 best validation mae = 7.985044 on epoch 5
Moving model to cuda
Model 0 test mae = 6.086070
Model 0 test band_gap mae = 6.086070
Ensemble test mae = 6.086070
Ensemble test band_gap mae = 6.086070
==================== fold 1 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 1.636513
Validation band_gap mae = 1.636513
Epoch 1
Validation mae = 2.169725
Validation band_gap mae = 2.169725
Epoch 2
Validation mae = 1.310940
Validation band_gap mae = 1.310940
Epoch 3
Validation mae = 3.102220
Validation band_gap mae = 3.102220
Epoch 4
Validation mae = 1.613407
Validation band_gap mae = 1.613407
Epoch 5
Validation mae = 2.169659
Validation band_gap mae = 2.169659
Epoch 6
Validation mae = 1.896994
Validation band_gap mae = 1.896994
Epoch 7
Validation mae = 3.495403
Validation band_gap mae = 3.495403
Epoch 8
Validation mae = 1.737340
Validation band_gap mae = 1.737340
Epoch 9
Validation mae = 3.293082
Validation band_gap mae = 3.293082
Epoch 10
Validation mae = 1.736595
Validation band_gap mae = 1.736595
Epoch 11
Validation mae = 1.428682
Validation band_gap mae = 1.428682
Epoch 12
Validation mae = 2.277738
Validation band_gap mae = 2.277738
Epoch 13
Validation mae = 2.462537
Validation band_gap mae = 2.462537
Epoch 14
Validation mae = 2.106565
Validation band_gap mae = 2.106565
Epoch 15
Validation mae = 2.337081
Validation band_gap mae = 2.337081
Epoch 16
Validation mae = 1.398886
Validation band_gap mae = 1.398886
Epoch 17
Validation mae = 1.593418
Validation band_gap mae = 1.593418
Epoch 18
Validation mae = 3.362804
Validation band_gap mae = 3.362804
Epoch 19
Validation mae = 1.775078
Validation band_gap mae = 1.775078
Epoch 20
Validation mae = 2.303439
Validation band_gap mae = 2.303439
Epoch 21
Validation mae = 3.608905
Validation band_gap mae = 3.608905
Epoch 22
Validation mae = 2.290817
Validation band_gap mae = 2.290817
Epoch 23
Validation mae = 2.076107
Validation band_gap mae = 2.076107
Epoch 24
Validation mae = 2.031162
Validation band_gap mae = 2.031162
Epoch 25
Validation mae = 1.544106
Validation band_gap mae = 1.544106
Epoch 26
Validation mae = 2.262792
Validation band_gap mae = 2.262792
Epoch 27
Validation mae = 1.401104
Validation band_gap mae = 1.401104
Epoch 28
Validation mae = 1.954387
Validation band_gap mae = 1.954387
Epoch 29
Validation mae = 2.146337
Validation band_gap mae = 2.146337
Epoch 30
Validation mae = 2.263306
Validation band_gap mae = 2.263306
Epoch 31
Validation mae = 2.227368
Validation band_gap mae = 2.227368
Epoch 32
Validation mae = 1.805675
Validation band_gap mae = 1.805675
Epoch 33
Validation mae = 2.409737
Validation band_gap mae = 2.409737
Epoch 34
Validation mae = 1.457334
Validation band_gap mae = 1.457334
Epoch 35
Validation mae = 2.538791
Validation band_gap mae = 2.538791
Epoch 36
Validation mae = 1.749533
Validation band_gap mae = 1.749533
Epoch 37
Validation mae = 2.329667
Validation band_gap mae = 2.329667
Epoch 38
Validation mae = 1.738184
Validation band_gap mae = 1.738184
Epoch 39
Validation mae = 2.261283
Validation band_gap mae = 2.261283
Epoch 40
Validation mae = 1.705893
Validation band_gap mae = 1.705893
Epoch 41
Validation mae = 2.195355
Validation band_gap mae = 2.195355
Epoch 42
Validation mae = 1.940417
Validation band_gap mae = 1.940417
Epoch 43
Validation mae = 2.328892
Validation band_gap mae = 2.328892
Epoch 44
Validation mae = 1.966824
Validation band_gap mae = 1.966824
Epoch 45
Validation mae = 2.934385
Validation band_gap mae = 2.934385
Epoch 46
Validation mae = 1.369068
Validation band_gap mae = 1.369068
Epoch 47
Validation mae = 1.453930
Validation band_gap mae = 1.453930
Epoch 48
Validation mae = 2.084998
Validation band_gap mae = 2.084998
Epoch 49
Validation mae = 2.291792
Validation band_gap mae = 2.291792
Epoch 50
Validation mae = 2.160517
Validation band_gap mae = 2.160517
Epoch 51
Validation mae = 1.820769
Validation band_gap mae = 1.820769
Epoch 52
Validation mae = 2.307397
Validation band_gap mae = 2.307397
Epoch 53
Validation mae = 2.215638
Validation band_gap mae = 2.215638
Epoch 54
Validation mae = 1.807687
Validation band_gap mae = 1.807687
Epoch 55
Validation mae = 2.475007
Validation band_gap mae = 2.475007
Epoch 56
Validation mae = 1.863531
Validation band_gap mae = 1.863531
Epoch 57
Validation mae = 1.641995
Validation band_gap mae = 1.641995
Epoch 58
Validation mae = 1.835914
Validation band_gap mae = 1.835914
Epoch 59
Validation mae = 1.937540
Validation band_gap mae = 1.937540
Epoch 60
Validation mae = 2.182445
Validation band_gap mae = 2.182445
Epoch 61
Validation mae = 1.693251
Validation band_gap mae = 1.693251
Epoch 62
Validation mae = 1.795219
Validation band_gap mae = 1.795219
Epoch 63
Validation mae = 1.758691
Validation band_gap mae = 1.758691
Epoch 64
Validation mae = 1.457450
Validation band_gap mae = 1.457450
Epoch 65
Validation mae = 1.842028
Validation band_gap mae = 1.842028
Epoch 66
Validation mae = 2.077798
Validation band_gap mae = 2.077798
Epoch 67
Validation mae = 2.011667
Validation band_gap mae = 2.011667
Epoch 68
Validation mae = 2.466086
Validation band_gap mae = 2.466086
Epoch 69
Validation mae = 1.909787
Validation band_gap mae = 1.909787
Epoch 70
Validation mae = 2.290473
Validation band_gap mae = 2.290473
Epoch 71
Validation mae = 1.967472
Validation band_gap mae = 1.967472
Epoch 72
Validation mae = 1.906818
Validation band_gap mae = 1.906818
Epoch 73
Validation mae = 2.266469
Validation band_gap mae = 2.266469
Epoch 74
Validation mae = 1.867855
Validation band_gap mae = 1.867855
Epoch 75
Validation mae = 2.600597
Validation band_gap mae = 2.600597
Epoch 76
Validation mae = 1.563099
Validation band_gap mae = 1.563099
Epoch 77
Validation mae = 2.193190
Validation band_gap mae = 2.193190
Epoch 78
Validation mae = 2.075516
Validation band_gap mae = 2.075516
Epoch 79
Validation mae = 2.219846
Validation band_gap mae = 2.219846
Epoch 80
Validation mae = 2.058300
Validation band_gap mae = 2.058300
Epoch 81
Validation mae = 2.197177
Validation band_gap mae = 2.197177
Epoch 82
Validation mae = 2.147446
Validation band_gap mae = 2.147446
Epoch 83
Validation mae = 2.381744
Validation band_gap mae = 2.381744
Epoch 84
Validation mae = 2.066561
Validation band_gap mae = 2.066561
Epoch 85
Validation mae = 1.970979
Validation band_gap mae = 1.970979
Epoch 86
Validation mae = 2.358459
Validation band_gap mae = 2.358459
Epoch 87
Validation mae = 1.990184
Validation band_gap mae = 1.990184
Epoch 88
Validation mae = 2.330864
Validation band_gap mae = 2.330864
Epoch 89
Validation mae = 2.163557
Validation band_gap mae = 2.163557
Epoch 90
Validation mae = 1.986534
Validation band_gap mae = 1.986534
Epoch 91
Validation mae = 2.193080
Validation band_gap mae = 2.193080
Epoch 92
Validation mae = 2.181212
Validation band_gap mae = 2.181212
Epoch 93
Validation mae = 2.224440
Validation band_gap mae = 2.224440
Epoch 94
Validation mae = 2.213078
Validation band_gap mae = 2.213078
Epoch 95
Validation mae = 2.009972
Validation band_gap mae = 2.009972
Epoch 96
Validation mae = 2.164492
Validation band_gap mae = 2.164492
Epoch 97
Validation mae = 2.152085
Validation band_gap mae = 2.152085
Epoch 98
Validation mae = 2.058997
Validation band_gap mae = 2.058997
Epoch 99
Validation mae = 2.057248
Validation band_gap mae = 2.057248
Model 0 best validation mae = 3.608905 on epoch 21
Moving model to cuda
Model 0 test mae = 3.642490
Model 0 test band_gap mae = 3.642490
Ensemble test mae = 3.642490
Ensemble test band_gap mae = 3.642490
==================== fold 2 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 1.612272
Validation band_gap mae = 1.612272
Epoch 1
Validation mae = 1.782169
Validation band_gap mae = 1.782169
Epoch 2
Validation mae = 1.568976
Validation band_gap mae = 1.568976
Epoch 3
Validation mae = 1.365178
Validation band_gap mae = 1.365178
Epoch 4
Validation mae = 1.863712
Validation band_gap mae = 1.863712
Epoch 5
Validation mae = 1.341548
Validation band_gap mae = 1.341548
Epoch 6
Validation mae = 1.451258
Validation band_gap mae = 1.451258
Epoch 7
Validation mae = 1.576367
Validation band_gap mae = 1.576367
Epoch 8
Validation mae = 1.354494
Validation band_gap mae = 1.354494
Epoch 9
Validation mae = 1.592237
Validation band_gap mae = 1.592237
Epoch 10
Validation mae = 1.588554
Validation band_gap mae = 1.588554
Epoch 11
Validation mae = 1.536132
Validation band_gap mae = 1.536132
Epoch 12
Validation mae = 1.496140
Validation band_gap mae = 1.496140
Epoch 13
Validation mae = 1.500889
Validation band_gap mae = 1.500889
Epoch 14
Validation mae = 1.511115
Validation band_gap mae = 1.511115
Epoch 15
Validation mae = 1.373225
Validation band_gap mae = 1.373225
Epoch 16
Validation mae = 1.594260
Validation band_gap mae = 1.594260
Epoch 17
Validation mae = 1.455523
Validation band_gap mae = 1.455523
Epoch 18
Validation mae = 1.525301
Validation band_gap mae = 1.525301
Epoch 19
Validation mae = 1.366275
Validation band_gap mae = 1.366275
Epoch 20
Validation mae = 1.530380
Validation band_gap mae = 1.530380
Epoch 21
Validation mae = 1.329411
Validation band_gap mae = 1.329411
Epoch 22
Validation mae = 1.470912
Validation band_gap mae = 1.470912
Epoch 23
Validation mae = 1.306443
Validation band_gap mae = 1.306443
Epoch 24
Validation mae = 1.389196
Validation band_gap mae = 1.389196
Epoch 25
Validation mae = 1.552223
Validation band_gap mae = 1.552223
Epoch 26
Validation mae = 1.537978
Validation band_gap mae = 1.537978
Epoch 27
Validation mae = 1.349245
Validation band_gap mae = 1.349245
Epoch 28
Validation mae = 1.386106
Validation band_gap mae = 1.386106
Epoch 29
Validation mae = 1.382773
Validation band_gap mae = 1.382773
Epoch 30
Validation mae = 1.360984
Validation band_gap mae = 1.360984
Epoch 31
Validation mae = 1.652511
Validation band_gap mae = 1.652511
Epoch 32
Validation mae = 1.406963
Validation band_gap mae = 1.406963
Epoch 33
Validation mae = 1.354120
Validation band_gap mae = 1.354120
Epoch 34
Validation mae = 1.344963
Validation band_gap mae = 1.344963
Epoch 35
Validation mae = 1.379146
Validation band_gap mae = 1.379146
Epoch 36
Validation mae = 1.345515
Validation band_gap mae = 1.345515
Epoch 37
Validation mae = 1.360849
Validation band_gap mae = 1.360849
Epoch 38
Validation mae = 1.404705
Validation band_gap mae = 1.404705
Epoch 39
Validation mae = 1.316543
Validation band_gap mae = 1.316543
Epoch 40
Validation mae = 1.364539
Validation band_gap mae = 1.364539
Epoch 41
Validation mae = 1.387480
Validation band_gap mae = 1.387480
Epoch 42
Validation mae = 1.433085
Validation band_gap mae = 1.433085
Epoch 43
Validation mae = 1.479340
Validation band_gap mae = 1.479340
Epoch 44
Validation mae = 1.418472
Validation band_gap mae = 1.418472
Epoch 45
Validation mae = 1.359418
Validation band_gap mae = 1.359418
Epoch 46
Validation mae = 1.321140
Validation band_gap mae = 1.321140
Epoch 47
Validation mae = 1.385115
Validation band_gap mae = 1.385115
Epoch 48
Validation mae = 1.374034
Validation band_gap mae = 1.374034
Epoch 49
Validation mae = 1.352412
Validation band_gap mae = 1.352412
Epoch 50
Validation mae = 1.480036
Validation band_gap mae = 1.480036
Epoch 51
Validation mae = 1.351949
Validation band_gap mae = 1.351949
Epoch 52
Validation mae = 1.425260
Validation band_gap mae = 1.425260
Epoch 53
Validation mae = 1.343037
Validation band_gap mae = 1.343037
Epoch 54
Validation mae = 1.358620
Validation band_gap mae = 1.358620
Epoch 55
Validation mae = 1.347410
Validation band_gap mae = 1.347410
Epoch 56
Validation mae = 1.406528
Validation band_gap mae = 1.406528
Epoch 57
Validation mae = 1.337586
Validation band_gap mae = 1.337586
Epoch 58
Validation mae = 1.337606
Validation band_gap mae = 1.337606
Epoch 59
Validation mae = 1.376661
Validation band_gap mae = 1.376661
Epoch 60
Validation mae = 1.301998
Validation band_gap mae = 1.301998
Epoch 61
Validation mae = 1.336965
Validation band_gap mae = 1.336965
Epoch 62
Validation mae = 1.414933
Validation band_gap mae = 1.414933
Epoch 63
Validation mae = 1.288067
Validation band_gap mae = 1.288067
Epoch 64
Validation mae = 1.345272
Validation band_gap mae = 1.345272
Epoch 65
Validation mae = 1.396629
Validation band_gap mae = 1.396629
Epoch 66
Validation mae = 1.439863
Validation band_gap mae = 1.439863
Epoch 67
Validation mae = 1.270957
Validation band_gap mae = 1.270957
Epoch 68
Validation mae = 1.255503
Validation band_gap mae = 1.255503
Epoch 69
Validation mae = 1.361849
Validation band_gap mae = 1.361849
Epoch 70
Validation mae = 1.329605
Validation band_gap mae = 1.329605
Epoch 71
Validation mae = 1.297689
Validation band_gap mae = 1.297689
Epoch 72
Validation mae = 1.395190
Validation band_gap mae = 1.395190
Epoch 73
Validation mae = 1.304795
Validation band_gap mae = 1.304795
Epoch 74
Validation mae = 1.432182
Validation band_gap mae = 1.432182
Epoch 75
Validation mae = 1.293361
Validation band_gap mae = 1.293361
Epoch 76
Validation mae = 1.459026
Validation band_gap mae = 1.459026
Epoch 77
Validation mae = 1.281818
Validation band_gap mae = 1.281818
Epoch 78
Validation mae = 1.291635
Validation band_gap mae = 1.291635
Epoch 79
Validation mae = 1.325830
Validation band_gap mae = 1.325830
Epoch 80
Validation mae = 1.301359
Validation band_gap mae = 1.301359
Epoch 81
Validation mae = 1.287923
Validation band_gap mae = 1.287923
Epoch 82
Validation mae = 1.290518
Validation band_gap mae = 1.290518
Epoch 83
Validation mae = 1.295309
Validation band_gap mae = 1.295309
Epoch 84
Validation mae = 1.317017
Validation band_gap mae = 1.317017
Epoch 85
Validation mae = 1.279735
Validation band_gap mae = 1.279735
Epoch 86
Validation mae = 1.319877
Validation band_gap mae = 1.319877
Epoch 87
Validation mae = 1.242998
Validation band_gap mae = 1.242998
Epoch 88
Validation mae = 1.340686
Validation band_gap mae = 1.340686
Epoch 89
Validation mae = 1.239025
Validation band_gap mae = 1.239025
Epoch 90
Validation mae = 1.314694
Validation band_gap mae = 1.314694
Epoch 91
Validation mae = 1.290235
Validation band_gap mae = 1.290235
Epoch 92
Validation mae = 1.261274
Validation band_gap mae = 1.261274
Epoch 93
Validation mae = 1.270784
Validation band_gap mae = 1.270784
Epoch 94
Validation mae = 1.304207
Validation band_gap mae = 1.304207
Epoch 95
Validation mae = 1.251238
Validation band_gap mae = 1.251238
Epoch 96
Validation mae = 1.291297
Validation band_gap mae = 1.291297
Epoch 97
Validation mae = 1.255079
Validation band_gap mae = 1.255079
Epoch 98
Validation mae = 1.285504
Validation band_gap mae = 1.285504
Epoch 99
Validation mae = 1.274865
Validation band_gap mae = 1.274865
Model 0 best validation mae = 1.863712 on epoch 4
Moving model to cuda
Model 0 test mae = 1.005071
Model 0 test band_gap mae = 1.005071
Ensemble test mae = 1.005071
Ensemble test band_gap mae = 1.005071
==================== fold 3 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 1.396579
Validation band_gap mae = 1.396579
Epoch 1
Validation mae = 1.553656
Validation band_gap mae = 1.553656
Epoch 2
Validation mae = 1.435574
Validation band_gap mae = 1.435574
Epoch 3
Validation mae = 1.607328
Validation band_gap mae = 1.607328
Epoch 4
Validation mae = 1.432300
Validation band_gap mae = 1.432300
Epoch 5
Validation mae = 1.414075
Validation band_gap mae = 1.414075
Epoch 6
Validation mae = 1.419087
Validation band_gap mae = 1.419087
Epoch 7
Validation mae = 1.444216
Validation band_gap mae = 1.444216
Epoch 8
Validation mae = 1.426678
Validation band_gap mae = 1.426678
Epoch 9
Validation mae = 1.404517
Validation band_gap mae = 1.404517
Epoch 10
Validation mae = 1.403944
Validation band_gap mae = 1.403944
Epoch 11
Validation mae = 1.551566
Validation band_gap mae = 1.551566
Epoch 12
Validation mae = 1.439372
Validation band_gap mae = 1.439372
Epoch 13
Validation mae = 1.593781
Validation band_gap mae = 1.593781
Epoch 14
Validation mae = 1.411822
Validation band_gap mae = 1.411822
Epoch 15
Validation mae = 1.411699
Validation band_gap mae = 1.411699
Epoch 16
Validation mae = 1.409567
Validation band_gap mae = 1.409567
Epoch 17
Validation mae = 1.429971
Validation band_gap mae = 1.429971
Epoch 18
Validation mae = 1.437115
Validation band_gap mae = 1.437115
Epoch 19
Validation mae = 1.430798
Validation band_gap mae = 1.430798
Epoch 20
Validation mae = 1.452801
Validation band_gap mae = 1.452801
Epoch 21
Validation mae = 1.389474
Validation band_gap mae = 1.389474
Epoch 22
Validation mae = 1.397628
Validation band_gap mae = 1.397628
Epoch 23
Validation mae = 1.399094
Validation band_gap mae = 1.399094
Epoch 24
Validation mae = 1.485229
Validation band_gap mae = 1.485229
Epoch 25
Validation mae = 1.383710
Validation band_gap mae = 1.383710
Epoch 26
Validation mae = 1.381221
Validation band_gap mae = 1.381221
Epoch 27
Validation mae = 1.359692
Validation band_gap mae = 1.359692
Epoch 28
Validation mae = 1.424918
Validation band_gap mae = 1.424918
Epoch 29
Validation mae = 1.391061
Validation band_gap mae = 1.391061
Epoch 30
Validation mae = 1.389751
Validation band_gap mae = 1.389751
Epoch 31
Validation mae = 1.417385
Validation band_gap mae = 1.417385
Epoch 32
Validation mae = 1.416954
Validation band_gap mae = 1.416954
Epoch 33
Validation mae = 1.435141
Validation band_gap mae = 1.435141
Epoch 34
Validation mae = 1.383916
Validation band_gap mae = 1.383916
Epoch 35
Validation mae = 1.451389
Validation band_gap mae = 1.451389
Epoch 36
Validation mae = 1.457786
Validation band_gap mae = 1.457786
Epoch 37
Validation mae = 1.402234
Validation band_gap mae = 1.402234
Epoch 38
Validation mae = 1.443664
Validation band_gap mae = 1.443664
Epoch 39
Validation mae = 1.397767
Validation band_gap mae = 1.397767
Epoch 40
Validation mae = 1.440012
Validation band_gap mae = 1.440012
Epoch 41
Validation mae = 1.477099
Validation band_gap mae = 1.477099
Epoch 42
Validation mae = 1.406978
Validation band_gap mae = 1.406978
Epoch 43
Validation mae = 1.429527
Validation band_gap mae = 1.429527
Epoch 44
Validation mae = 1.411832
Validation band_gap mae = 1.411832
Epoch 45
Validation mae = 1.399517
Validation band_gap mae = 1.399517
Epoch 46
Validation mae = 1.429145
Validation band_gap mae = 1.429145
Epoch 47
Validation mae = 1.422548
Validation band_gap mae = 1.422548
Epoch 48
Validation mae = 1.429364
Validation band_gap mae = 1.429364
Epoch 49
Validation mae = 1.444433
Validation band_gap mae = 1.444433
Epoch 50
Validation mae = 1.426638
Validation band_gap mae = 1.426638
Epoch 51
Validation mae = 1.409472
Validation band_gap mae = 1.409472
Epoch 52
Validation mae = 1.444466
Validation band_gap mae = 1.444466
Epoch 53
Validation mae = 1.445147
Validation band_gap mae = 1.445147
Epoch 54
Validation mae = 1.420651
Validation band_gap mae = 1.420651
Epoch 55
Validation mae = 1.419709
Validation band_gap mae = 1.419709
Epoch 56
Validation mae = 1.458632
Validation band_gap mae = 1.458632
Epoch 57
Validation mae = 1.428006
Validation band_gap mae = 1.428006
Epoch 58
Validation mae = 1.427117
Validation band_gap mae = 1.427117
Epoch 59
Validation mae = 1.442409
Validation band_gap mae = 1.442409
Epoch 60
Validation mae = 1.434580
Validation band_gap mae = 1.434580
Epoch 61
Validation mae = 1.397821
Validation band_gap mae = 1.397821
Epoch 62
Validation mae = 1.434962
Validation band_gap mae = 1.434962
Epoch 63
Validation mae = 1.451044
Validation band_gap mae = 1.451044
Epoch 64
Validation mae = 1.447392
Validation band_gap mae = 1.447392
Epoch 65
Validation mae = 1.427589
Validation band_gap mae = 1.427589
Epoch 66
Validation mae = 1.440421
Validation band_gap mae = 1.440421
Epoch 67
Validation mae = 1.428296
Validation band_gap mae = 1.428296
Epoch 68
Validation mae = 1.459081
Validation band_gap mae = 1.459081
Epoch 69
Validation mae = 1.408565
Validation band_gap mae = 1.408565
Epoch 70
Validation mae = 1.429849
Validation band_gap mae = 1.429849
Epoch 71
Validation mae = 1.460729
Validation band_gap mae = 1.460729
Epoch 72
Validation mae = 1.449595
Validation band_gap mae = 1.449595
Epoch 73
Validation mae = 1.433915
Validation band_gap mae = 1.433915
Epoch 74
Validation mae = 1.445355
Validation band_gap mae = 1.445355
Epoch 75
Validation mae = 1.443579
Validation band_gap mae = 1.443579
Epoch 76
Validation mae = 1.447845
Validation band_gap mae = 1.447845
Epoch 77
Validation mae = 1.457054
Validation band_gap mae = 1.457054
Epoch 78
Validation mae = 1.438358
Validation band_gap mae = 1.438358
Epoch 79
Validation mae = 1.446280
Validation band_gap mae = 1.446280
Epoch 80
Validation mae = 1.444506
Validation band_gap mae = 1.444506
Epoch 81
Validation mae = 1.443888
Validation band_gap mae = 1.443888
Epoch 82
Validation mae = 1.439170
Validation band_gap mae = 1.439170
Epoch 83
Validation mae = 1.463250
Validation band_gap mae = 1.463250
Epoch 84
Validation mae = 1.455979
Validation band_gap mae = 1.455979
Epoch 85
Validation mae = 1.428039
Validation band_gap mae = 1.428039
Epoch 86
Validation mae = 1.444403
Validation band_gap mae = 1.444403
Epoch 87
Validation mae = 1.447590
Validation band_gap mae = 1.447590
Epoch 88
Validation mae = 1.458105
Validation band_gap mae = 1.458105
Epoch 89
Validation mae = 1.441210
Validation band_gap mae = 1.441210
Epoch 90
Validation mae = 1.447052
Validation band_gap mae = 1.447052
Epoch 91
Validation mae = 1.436300
Validation band_gap mae = 1.436300
Epoch 92
Validation mae = 1.445381
Validation band_gap mae = 1.445381
Epoch 93
Validation mae = 1.441748
Validation band_gap mae = 1.441748
Epoch 94
Validation mae = 1.453267
Validation band_gap mae = 1.453267
Epoch 95
Validation mae = 1.448245
Validation band_gap mae = 1.448245
Epoch 96
Validation mae = 1.456870
Validation band_gap mae = 1.456870
Epoch 97
Validation mae = 1.447641
Validation band_gap mae = 1.447641
Epoch 98
Validation mae = 1.452381
Validation band_gap mae = 1.452381
Epoch 99
Validation mae = 1.448245
Validation band_gap mae = 1.448245
Model 0 best validation mae = 1.607328 on epoch 3
Moving model to cuda
Model 0 test mae = 0.774039
Model 0 test band_gap mae = 0.774039
Ensemble test mae = 0.774039
Ensemble test band_gap mae = 0.774039
==================== fold 4 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.868436
Validation band_gap mae = 0.868436
Epoch 1
Validation mae = 0.613770
Validation band_gap mae = 0.613770
Epoch 2
Validation mae = 0.503660
Validation band_gap mae = 0.503660
Epoch 3
Validation mae = 1.373377
Validation band_gap mae = 1.373377
Epoch 4
Validation mae = 0.444756
Validation band_gap mae = 0.444756
Epoch 5
Validation mae = 0.607982
Validation band_gap mae = 0.607982
Epoch 6
Validation mae = 0.504163
Validation band_gap mae = 0.504163
Epoch 7
Validation mae = 0.744152
Validation band_gap mae = 0.744152
Epoch 8
Validation mae = 0.838380
Validation band_gap mae = 0.838380
Epoch 9
Validation mae = 0.409929
Validation band_gap mae = 0.409929
Epoch 10
Validation mae = 0.490739
Validation band_gap mae = 0.490739
Epoch 11
Validation mae = 0.663352
Validation band_gap mae = 0.663352
Epoch 12
Validation mae = 0.656972
Validation band_gap mae = 0.656972
Epoch 13
Validation mae = 0.409531
Validation band_gap mae = 0.409531
Epoch 14
Validation mae = 0.719266
Validation band_gap mae = 0.719266
Epoch 15
Validation mae = 0.563275
Validation band_gap mae = 0.563275
Epoch 16
Validation mae = 0.630892
Validation band_gap mae = 0.630892
Epoch 17
Validation mae = 0.388338
Validation band_gap mae = 0.388338
Epoch 18
Validation mae = 0.671576
Validation band_gap mae = 0.671576
Epoch 19
Validation mae = 0.399406
Validation band_gap mae = 0.399406
Epoch 20
Validation mae = 0.670703
Validation band_gap mae = 0.670703
Epoch 21
Validation mae = 0.373115
Validation band_gap mae = 0.373115
Epoch 22
Validation mae = 0.481059
Validation band_gap mae = 0.481059
Epoch 23
Validation mae = 0.456974
Validation band_gap mae = 0.456974
Epoch 24
Validation mae = 0.501608
Validation band_gap mae = 0.501608
Epoch 25
Validation mae = 0.389095
Validation band_gap mae = 0.389095
Epoch 26
Validation mae = 0.572346
Validation band_gap mae = 0.572346
Epoch 27
Validation mae = 0.592542
Validation band_gap mae = 0.592542
Epoch 28
Validation mae = 0.373677
Validation band_gap mae = 0.373677
Epoch 29
Validation mae = 0.542756
Validation band_gap mae = 0.542756
Epoch 30
Validation mae = 0.620949
Validation band_gap mae = 0.620949
Epoch 31
Validation mae = 0.397212
Validation band_gap mae = 0.397212
Epoch 32
Validation mae = 0.446196
Validation band_gap mae = 0.446196
Epoch 33
Validation mae = 0.422744
Validation band_gap mae = 0.422744
Epoch 34
Validation mae = 0.571838
Validation band_gap mae = 0.571838
Epoch 35
Validation mae = 0.551839
Validation band_gap mae = 0.551839
Epoch 36
Validation mae = 0.469342
Validation band_gap mae = 0.469342
Epoch 37
Validation mae = 0.501817
Validation band_gap mae = 0.501817
Epoch 38
Validation mae = 0.376795
Validation band_gap mae = 0.376795
Epoch 39
Validation mae = 0.805018
Validation band_gap mae = 0.805018
Epoch 40
Validation mae = 0.569449
Validation band_gap mae = 0.569449
Epoch 41
Validation mae = 0.324106
Validation band_gap mae = 0.324106
Epoch 42
Validation mae = 1.038150
Validation band_gap mae = 1.038150
Epoch 43
Validation mae = 0.421896
Validation band_gap mae = 0.421896
Epoch 44
Validation mae = 0.635067
Validation band_gap mae = 0.635067
Epoch 45
Validation mae = 0.643482
Validation band_gap mae = 0.643482
Epoch 46
Validation mae = 0.539993
Validation band_gap mae = 0.539993
Epoch 47
Validation mae = 0.471571
Validation band_gap mae = 0.471571
Epoch 48
Validation mae = 0.413395
Validation band_gap mae = 0.413395
Epoch 49
Validation mae = 0.442601
Validation band_gap mae = 0.442601
Epoch 50
Validation mae = 0.426806
Validation band_gap mae = 0.426806
Epoch 51
Validation mae = 0.467149
Validation band_gap mae = 0.467149
Epoch 52
Validation mae = 0.509100
Validation band_gap mae = 0.509100
Epoch 53
Validation mae = 0.441628
Validation band_gap mae = 0.441628
Epoch 54
Validation mae = 0.380451
Validation band_gap mae = 0.380451
Epoch 55
Validation mae = 0.362569
Validation band_gap mae = 0.362569
Epoch 56
Validation mae = 0.413331
Validation band_gap mae = 0.413331
Epoch 57
Validation mae = 0.374633
Validation band_gap mae = 0.374633
Epoch 58
Validation mae = 0.424479
Validation band_gap mae = 0.424479
Epoch 59
Validation mae = 0.492589
Validation band_gap mae = 0.492589
Epoch 60
Validation mae = 0.509770
Validation band_gap mae = 0.509770
Epoch 61
Validation mae = 0.361213
Validation band_gap mae = 0.361213
Epoch 62
Validation mae = 0.404638
Validation band_gap mae = 0.404638
Epoch 63
Validation mae = 0.382756
Validation band_gap mae = 0.382756
Epoch 64
Validation mae = 0.454356
Validation band_gap mae = 0.454356
Epoch 65
Validation mae = 0.364788
Validation band_gap mae = 0.364788
Epoch 66
Validation mae = 0.376774
Validation band_gap mae = 0.376774
Epoch 67
Validation mae = 0.467659
Validation band_gap mae = 0.467659
Epoch 68
Validation mae = 0.525330
Validation band_gap mae = 0.525330
Epoch 69
Validation mae = 0.322327
Validation band_gap mae = 0.322327
Epoch 70
Validation mae = 0.366106
Validation band_gap mae = 0.366106
Epoch 71
Validation mae = 0.391088
Validation band_gap mae = 0.391088
Epoch 72
Validation mae = 0.467448
Validation band_gap mae = 0.467448
Epoch 73
Validation mae = 0.445066
Validation band_gap mae = 0.445066
Epoch 74
Validation mae = 0.427067
Validation band_gap mae = 0.427067
Epoch 75
Validation mae = 0.445673
Validation band_gap mae = 0.445673
Epoch 76
Validation mae = 0.402720
Validation band_gap mae = 0.402720
Epoch 77
Validation mae = 0.374423
Validation band_gap mae = 0.374423
Epoch 78
Validation mae = 0.422793
Validation band_gap mae = 0.422793
Epoch 79
Validation mae = 0.452305
Validation band_gap mae = 0.452305
Epoch 80
Validation mae = 0.418016
Validation band_gap mae = 0.418016
Epoch 81
Validation mae = 0.467154
Validation band_gap mae = 0.467154
Epoch 82
Validation mae = 0.399949
Validation band_gap mae = 0.399949
Epoch 83
Validation mae = 0.439973
Validation band_gap mae = 0.439973
Epoch 84
Validation mae = 0.402637
Validation band_gap mae = 0.402637
Epoch 85
Validation mae = 0.442025
Validation band_gap mae = 0.442025
Epoch 86
Validation mae = 0.494466
Validation band_gap mae = 0.494466
Epoch 87
Validation mae = 0.438662
Validation band_gap mae = 0.438662
Epoch 88
Validation mae = 0.504609
Validation band_gap mae = 0.504609
Epoch 89
Validation mae = 0.455655
Validation band_gap mae = 0.455655
Epoch 90
Validation mae = 0.424622
Validation band_gap mae = 0.424622
Epoch 91
Validation mae = 0.459213
Validation band_gap mae = 0.459213
Epoch 92
Validation mae = 0.476434
Validation band_gap mae = 0.476434
Epoch 93
Validation mae = 0.465103
Validation band_gap mae = 0.465103
Epoch 94
Validation mae = 0.447856
Validation band_gap mae = 0.447856
Epoch 95
Validation mae = 0.560571
Validation band_gap mae = 0.560571
Epoch 96
Validation mae = 0.438569
Validation band_gap mae = 0.438569
Epoch 97
Validation mae = 0.497268
Validation band_gap mae = 0.497268
Epoch 98
Validation mae = 0.448736
Validation band_gap mae = 0.448736
Epoch 99
Validation mae = 0.457023
Validation band_gap mae = 0.457023
Model 0 best validation mae = 1.373377 on epoch 3
Moving model to cuda
Model 0 test mae = 1.236446
Model 0 test band_gap mae = 1.236446
Ensemble test mae = 1.236446
Ensemble test band_gap mae = 1.236446
==================== fold 5 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.428268
Validation band_gap mae = 0.428268
Epoch 1
Validation mae = 0.427729
Validation band_gap mae = 0.427729
Epoch 2
Validation mae = 0.431866
Validation band_gap mae = 0.431866
Epoch 3
Validation mae = 0.483228
Validation band_gap mae = 0.483228
Epoch 4
Validation mae = 0.476425
Validation band_gap mae = 0.476425
Epoch 5
Validation mae = 0.464262
Validation band_gap mae = 0.464262
Epoch 6
Validation mae = 0.443021
Validation band_gap mae = 0.443021
Epoch 7
Validation mae = 0.470569
Validation band_gap mae = 0.470569
Epoch 8
Validation mae = 0.485814
Validation band_gap mae = 0.485814
Epoch 9
Validation mae = 0.422925
Validation band_gap mae = 0.422925
Epoch 10
Validation mae = 0.427070
Validation band_gap mae = 0.427070
Epoch 11
Validation mae = 0.422438
Validation band_gap mae = 0.422438
Epoch 12
Validation mae = 0.440258
Validation band_gap mae = 0.440258
Epoch 13
Validation mae = 0.434892
Validation band_gap mae = 0.434892
Epoch 14
Validation mae = 0.443670
Validation band_gap mae = 0.443670
Epoch 15
Validation mae = 0.425643
Validation band_gap mae = 0.425643
Epoch 16
Validation mae = 0.451473
Validation band_gap mae = 0.451473
Epoch 17
Validation mae = 0.440137
Validation band_gap mae = 0.440137
Epoch 18
Validation mae = 0.433789
Validation band_gap mae = 0.433789
Epoch 19
Validation mae = 0.476034
Validation band_gap mae = 0.476034
Epoch 20
Validation mae = 0.433579
Validation band_gap mae = 0.433579
Epoch 21
Validation mae = 0.415833
Validation band_gap mae = 0.415833
Epoch 22
Validation mae = 0.437289
Validation band_gap mae = 0.437289
Epoch 23
Validation mae = 0.422270
Validation band_gap mae = 0.422270
Epoch 24
Validation mae = 0.459847
Validation band_gap mae = 0.459847
Epoch 25
Validation mae = 0.436306
Validation band_gap mae = 0.436306
Epoch 26
Validation mae = 0.445686
Validation band_gap mae = 0.445686
Epoch 27
Validation mae = 0.490766
Validation band_gap mae = 0.490766
Epoch 28
Validation mae = 0.460333
Validation band_gap mae = 0.460333
Epoch 29
Validation mae = 0.452960
Validation band_gap mae = 0.452960
Epoch 30
Validation mae = 0.445952
Validation band_gap mae = 0.445952
Epoch 31
Validation mae = 0.439599
Validation band_gap mae = 0.439599
Epoch 32
Validation mae = 0.472001
Validation band_gap mae = 0.472001
Epoch 33
Validation mae = 0.457137
Validation band_gap mae = 0.457137
Epoch 34
Validation mae = 0.424297
Validation band_gap mae = 0.424297
Epoch 35
Validation mae = 0.421653
Validation band_gap mae = 0.421653
Epoch 36
Validation mae = 0.446843
Validation band_gap mae = 0.446843
Epoch 37
Validation mae = 0.419054
Validation band_gap mae = 0.419054
Epoch 38
Validation mae = 0.469281
Validation band_gap mae = 0.469281
Epoch 39
Validation mae = 0.431476
Validation band_gap mae = 0.431476
Epoch 40
Validation mae = 0.415975
Validation band_gap mae = 0.415975
Epoch 41
Validation mae = 0.465281
Validation band_gap mae = 0.465281
Epoch 42
Validation mae = 0.440617
Validation band_gap mae = 0.440617
Epoch 43
Validation mae = 0.450242
Validation band_gap mae = 0.450242
Epoch 44
Validation mae = 0.441333
Validation band_gap mae = 0.441333
Epoch 45
Validation mae = 0.435049
Validation band_gap mae = 0.435049
Epoch 46
Validation mae = 0.429398
Validation band_gap mae = 0.429398
Epoch 47
Validation mae = 0.420824
Validation band_gap mae = 0.420824
Epoch 48
Validation mae = 0.442956
Validation band_gap mae = 0.442956
Epoch 49
Validation mae = 0.426769
Validation band_gap mae = 0.426769
Epoch 50
Validation mae = 0.444186
Validation band_gap mae = 0.444186
Epoch 51
Validation mae = 0.458595
Validation band_gap mae = 0.458595
Epoch 52
Validation mae = 0.458543
Validation band_gap mae = 0.458543
Epoch 53
Validation mae = 0.453455
Validation band_gap mae = 0.453455
Epoch 54
Validation mae = 0.453589
Validation band_gap mae = 0.453589
Epoch 55
Validation mae = 0.433840
Validation band_gap mae = 0.433840
Epoch 56
Validation mae = 0.438745
Validation band_gap mae = 0.438745
Epoch 57
Validation mae = 0.431097
Validation band_gap mae = 0.431097
Epoch 58
Validation mae = 0.441291
Validation band_gap mae = 0.441291
Epoch 59
Validation mae = 0.421553
Validation band_gap mae = 0.421553
Epoch 60
Validation mae = 0.441592
Validation band_gap mae = 0.441592
Epoch 61
Validation mae = 0.435772
Validation band_gap mae = 0.435772
Epoch 62
Validation mae = 0.492771
Validation band_gap mae = 0.492771
Epoch 63
Validation mae = 0.435675
Validation band_gap mae = 0.435675
Epoch 64
Validation mae = 0.439187
Validation band_gap mae = 0.439187
Epoch 65
Validation mae = 0.424210
Validation band_gap mae = 0.424210
Epoch 66
Validation mae = 0.446400
Validation band_gap mae = 0.446400
Epoch 67
Validation mae = 0.432743
Validation band_gap mae = 0.432743
Epoch 68
Validation mae = 0.434556
Validation band_gap mae = 0.434556
Epoch 69
Validation mae = 0.456452
Validation band_gap mae = 0.456452
Epoch 70
Validation mae = 0.456272
Validation band_gap mae = 0.456272
Epoch 71
Validation mae = 0.437996
Validation band_gap mae = 0.437996
Epoch 72
Validation mae = 0.439226
Validation band_gap mae = 0.439226
Epoch 73
Validation mae = 0.442993
Validation band_gap mae = 0.442993
Epoch 74
Validation mae = 0.444692
Validation band_gap mae = 0.444692
Epoch 75
Validation mae = 0.461777
Validation band_gap mae = 0.461777
Epoch 76
Validation mae = 0.438223
Validation band_gap mae = 0.438223
Epoch 77
Validation mae = 0.412407
Validation band_gap mae = 0.412407
Epoch 78
Validation mae = 0.460448
Validation band_gap mae = 0.460448
Epoch 79
Validation mae = 0.434286
Validation band_gap mae = 0.434286
Epoch 80
Validation mae = 0.444186
Validation band_gap mae = 0.444186
Epoch 81
Validation mae = 0.442102
Validation band_gap mae = 0.442102
Epoch 82
Validation mae = 0.442077
Validation band_gap mae = 0.442077
Epoch 83
Validation mae = 0.453896
Validation band_gap mae = 0.453896
Epoch 84
Validation mae = 0.435347
Validation band_gap mae = 0.435347
Epoch 85
Validation mae = 0.422726
Validation band_gap mae = 0.422726
Epoch 86
Validation mae = 0.425430
Validation band_gap mae = 0.425430
Epoch 87
Validation mae = 0.426084
Validation band_gap mae = 0.426084
Epoch 88
Validation mae = 0.416893
Validation band_gap mae = 0.416893
Epoch 89
Validation mae = 0.452557
Validation band_gap mae = 0.452557
Epoch 90
Validation mae = 0.410876
Validation band_gap mae = 0.410876
Epoch 91
Validation mae = 0.427520
Validation band_gap mae = 0.427520
Epoch 92
Validation mae = 0.412971
Validation band_gap mae = 0.412971
Epoch 93
Validation mae = 0.437228
Validation band_gap mae = 0.437228
Epoch 94
Validation mae = 0.449548
Validation band_gap mae = 0.449548
Epoch 95
Validation mae = 0.418903
Validation band_gap mae = 0.418903
Epoch 96
Validation mae = 0.429512
Validation band_gap mae = 0.429512
Epoch 97
Validation mae = 0.427895
Validation band_gap mae = 0.427895
Epoch 98
Validation mae = 0.430589
Validation band_gap mae = 0.430589
Epoch 99
Validation mae = 0.428012
Validation band_gap mae = 0.428012
Model 0 best validation mae = 0.492771 on epoch 62
Moving model to cuda
Model 0 test mae = 0.125988
Model 0 test band_gap mae = 0.125988
Ensemble test mae = 0.125988
Ensemble test band_gap mae = 0.125988
==================== fold 6 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.731358
Validation band_gap mae = 0.731358
Epoch 1
Validation mae = 0.727684
Validation band_gap mae = 0.727684
Epoch 2
Validation mae = 0.750631
Validation band_gap mae = 0.750631
Epoch 3
Validation mae = 0.806177
Validation band_gap mae = 0.806177
Epoch 4
Validation mae = 0.817034
Validation band_gap mae = 0.817034
Epoch 5
Validation mae = 0.755333
Validation band_gap mae = 0.755333
Epoch 6
Validation mae = 0.739556
Validation band_gap mae = 0.739556
Epoch 7
Validation mae = 0.781838
Validation band_gap mae = 0.781838
Epoch 8
Validation mae = 0.799490
Validation band_gap mae = 0.799490
Epoch 9
Validation mae = 0.728214
Validation band_gap mae = 0.728214
Epoch 10
Validation mae = 0.732208
Validation band_gap mae = 0.732208
Epoch 11
Validation mae = 0.741456
Validation band_gap mae = 0.741456
Epoch 12
Validation mae = 0.736794
Validation band_gap mae = 0.736794
Epoch 13
Validation mae = 0.711794
Validation band_gap mae = 0.711794
Epoch 14
Validation mae = 0.711459
Validation band_gap mae = 0.711459
Epoch 15
Validation mae = 0.798333
Validation band_gap mae = 0.798333
Epoch 16
Validation mae = 0.738432
Validation band_gap mae = 0.738432
Epoch 17
Validation mae = 0.713893
Validation band_gap mae = 0.713893
Epoch 18
Validation mae = 0.827860
Validation band_gap mae = 0.827860
Epoch 19
Validation mae = 0.705621
Validation band_gap mae = 0.705621
Epoch 20
Validation mae = 0.740930
Validation band_gap mae = 0.740930
Epoch 21
Validation mae = 0.715360
Validation band_gap mae = 0.715360
Epoch 22
Validation mae = 0.775993
Validation band_gap mae = 0.775993
Epoch 23
Validation mae = 0.715543
Validation band_gap mae = 0.715543
Epoch 24
Validation mae = 0.723951
Validation band_gap mae = 0.723951
Epoch 25
Validation mae = 0.768541
Validation band_gap mae = 0.768541
Epoch 26
Validation mae = 0.841611
Validation band_gap mae = 0.841611
Epoch 27
Validation mae = 0.770070
Validation band_gap mae = 0.770070
Epoch 28
Validation mae = 0.711727
Validation band_gap mae = 0.711727
Epoch 29
Validation mae = 0.856526
Validation band_gap mae = 0.856526
Epoch 30
Validation mae = 0.755794
Validation band_gap mae = 0.755794
Epoch 31
Validation mae = 0.710632
Validation band_gap mae = 0.710632
Epoch 32
Validation mae = 0.710351
Validation band_gap mae = 0.710351
Epoch 33
Validation mae = 0.763373
Validation band_gap mae = 0.763373
Epoch 34
Validation mae = 0.730180
Validation band_gap mae = 0.730180
Epoch 35
Validation mae = 0.738142
Validation band_gap mae = 0.738142
Epoch 36
Validation mae = 0.764203
Validation band_gap mae = 0.764203
Epoch 37
Validation mae = 0.761194
Validation band_gap mae = 0.761194
Epoch 38
Validation mae = 0.760628
Validation band_gap mae = 0.760628
Epoch 39
Validation mae = 0.741880
Validation band_gap mae = 0.741880
Epoch 40
Validation mae = 0.759328
Validation band_gap mae = 0.759328
Epoch 41
Validation mae = 0.788095
Validation band_gap mae = 0.788095
Epoch 42
Validation mae = 0.740793
Validation band_gap mae = 0.740793
Epoch 43
Validation mae = 0.753783
Validation band_gap mae = 0.753783
Epoch 44
Validation mae = 0.808132
Validation band_gap mae = 0.808132
Epoch 45
Validation mae = 0.780813
Validation band_gap mae = 0.780813
Epoch 46
Validation mae = 0.798965
Validation band_gap mae = 0.798965
Epoch 47
Validation mae = 0.794081
Validation band_gap mae = 0.794081
Epoch 48
Validation mae = 0.801118
Validation band_gap mae = 0.801118
Epoch 49
Validation mae = 0.875368
Validation band_gap mae = 0.875368
Epoch 50
Validation mae = 0.745841
Validation band_gap mae = 0.745841
Epoch 51
Validation mae = 0.795070
Validation band_gap mae = 0.795070
Epoch 52
Validation mae = 0.803519
Validation band_gap mae = 0.803519
Epoch 53
Validation mae = 0.764879
Validation band_gap mae = 0.764879
Epoch 54
Validation mae = 0.771700
Validation band_gap mae = 0.771700
Epoch 55
Validation mae = 0.817819
Validation band_gap mae = 0.817819
Epoch 56
Validation mae = 0.754793
Validation band_gap mae = 0.754793
Epoch 57
Validation mae = 0.807684
Validation band_gap mae = 0.807684
Epoch 58
Validation mae = 0.780825
Validation band_gap mae = 0.780825
Epoch 59
Validation mae = 0.773640
Validation band_gap mae = 0.773640
Epoch 60
Validation mae = 0.771097
Validation band_gap mae = 0.771097
Epoch 61
Validation mae = 0.805668
Validation band_gap mae = 0.805668
Epoch 62
Validation mae = 0.801569
Validation band_gap mae = 0.801569
Epoch 63
Validation mae = 0.762490
Validation band_gap mae = 0.762490
Epoch 64
Validation mae = 0.766037
Validation band_gap mae = 0.766037
Epoch 65
Validation mae = 0.762579
Validation band_gap mae = 0.762579
Epoch 66
Validation mae = 0.744454
Validation band_gap mae = 0.744454
Epoch 67
Validation mae = 0.767651
Validation band_gap mae = 0.767651
Epoch 68
Validation mae = 0.773924
Validation band_gap mae = 0.773924
Epoch 69
Validation mae = 0.804748
Validation band_gap mae = 0.804748
Epoch 70
Validation mae = 0.808042
Validation band_gap mae = 0.808042
Epoch 71
Validation mae = 0.795496
Validation band_gap mae = 0.795496
Epoch 72
Validation mae = 0.774569
Validation band_gap mae = 0.774569
Epoch 73
Validation mae = 0.768039
Validation band_gap mae = 0.768039
Epoch 74
Validation mae = 0.815883
Validation band_gap mae = 0.815883
Epoch 75
Validation mae = 0.754185
Validation band_gap mae = 0.754185
Epoch 76
Validation mae = 0.809427
Validation band_gap mae = 0.809427
Epoch 77
Validation mae = 0.787830
Validation band_gap mae = 0.787830
Epoch 78
Validation mae = 0.846592
Validation band_gap mae = 0.846592
Epoch 79
Validation mae = 0.763780
Validation band_gap mae = 0.763780
Epoch 80
Validation mae = 0.807268
Validation band_gap mae = 0.807268
Epoch 81
Validation mae = 0.792996
Validation band_gap mae = 0.792996
Epoch 82
Validation mae = 0.808990
Validation band_gap mae = 0.808990
Epoch 83
Validation mae = 0.785672
Validation band_gap mae = 0.785672
Epoch 84
Validation mae = 0.789660
Validation band_gap mae = 0.789660
Epoch 85
Validation mae = 0.774042
Validation band_gap mae = 0.774042
Epoch 86
Validation mae = 0.849116
Validation band_gap mae = 0.849116
Epoch 87
Validation mae = 0.770584
Validation band_gap mae = 0.770584
Epoch 88
Validation mae = 0.815950
Validation band_gap mae = 0.815950
Epoch 89
Validation mae = 0.812106
Validation band_gap mae = 0.812106
Epoch 90
Validation mae = 0.788903
Validation band_gap mae = 0.788903
Epoch 91
Validation mae = 0.782069
Validation band_gap mae = 0.782069
Epoch 92
Validation mae = 0.780720
Validation band_gap mae = 0.780720
Epoch 93
Validation mae = 0.764595
Validation band_gap mae = 0.764595
Epoch 94
Validation mae = 0.813752
Validation band_gap mae = 0.813752
Epoch 95
Validation mae = 0.782121
Validation band_gap mae = 0.782121
Epoch 96
Validation mae = 0.794219
Validation band_gap mae = 0.794219
Epoch 97
Validation mae = 0.801431
Validation band_gap mae = 0.801431
Epoch 98
Validation mae = 0.794381
Validation band_gap mae = 0.794381
Epoch 99
Validation mae = 0.766837
Validation band_gap mae = 0.766837
Model 0 best validation mae = 0.875368 on epoch 49
Moving model to cuda
Model 0 test mae = 0.261646
Model 0 test band_gap mae = 0.261646
Ensemble test mae = 0.261646
Ensemble test band_gap mae = 0.261646
==================== fold 7 ====================
Total size = 927 | train size = 743 | val size = 92 | test size = 92
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.825143
Validation band_gap mae = 0.825143
Epoch 1
Validation mae = 0.808859
Validation band_gap mae = 0.808859
Epoch 2
Validation mae = 0.816922
Validation band_gap mae = 0.816922
Epoch 3
Validation mae = 0.829210
Validation band_gap mae = 0.829210
Epoch 4
Validation mae = 0.950348
Validation band_gap mae = 0.950348
Epoch 5
Validation mae = 0.825807
Validation band_gap mae = 0.825807
Epoch 6
Validation mae = 0.808431
Validation band_gap mae = 0.808431
Epoch 7
Validation mae = 0.874116
Validation band_gap mae = 0.874116
Epoch 8
Validation mae = 0.879918
Validation band_gap mae = 0.879918
Epoch 9
Validation mae = 0.830711
Validation band_gap mae = 0.830711
Epoch 10
Validation mae = 0.926615
Validation band_gap mae = 0.926615
Epoch 11
Validation mae = 0.826263
Validation band_gap mae = 0.826263
Epoch 12
Validation mae = 0.786109
Validation band_gap mae = 0.786109
Epoch 13
Validation mae = 0.846584
Validation band_gap mae = 0.846584
Epoch 14
Validation mae = 0.829913
Validation band_gap mae = 0.829913
Epoch 15
Validation mae = 0.805400
Validation band_gap mae = 0.805400
Epoch 16
Validation mae = 0.858339
Validation band_gap mae = 0.858339
Epoch 17
Validation mae = 0.860989
Validation band_gap mae = 0.860989
Epoch 18
Validation mae = 0.813620
Validation band_gap mae = 0.813620
Epoch 19
Validation mae = 0.816429
Validation band_gap mae = 0.816429
Epoch 20
Validation mae = 0.795866
Validation band_gap mae = 0.795866
Epoch 21
Validation mae = 0.877678
Validation band_gap mae = 0.877678
Epoch 22
Validation mae = 0.859655
Validation band_gap mae = 0.859655
Epoch 23
Validation mae = 0.882151
Validation band_gap mae = 0.882151
Epoch 24
Validation mae = 0.876687
Validation band_gap mae = 0.876687
Epoch 25
Validation mae = 0.868097
Validation band_gap mae = 0.868097
Epoch 26
Validation mae = 0.884821
Validation band_gap mae = 0.884821
Epoch 27
Validation mae = 0.812141
Validation band_gap mae = 0.812141
Epoch 28
Validation mae = 0.911127
Validation band_gap mae = 0.911127
Epoch 29
Validation mae = 0.843734
Validation band_gap mae = 0.843734
Epoch 30
Validation mae = 0.830315
Validation band_gap mae = 0.830315
Epoch 31
Validation mae = 0.883915
Validation band_gap mae = 0.883915
Epoch 32
Validation mae = 0.884891
Validation band_gap mae = 0.884891
Epoch 33
Validation mae = 0.833829
Validation band_gap mae = 0.833829
Epoch 34
Validation mae = 0.904994
Validation band_gap mae = 0.904994
Epoch 35
Validation mae = 0.823988
Validation band_gap mae = 0.823988
Epoch 36
Validation mae = 0.803219
Validation band_gap mae = 0.803219
Epoch 37
Validation mae = 0.891585
Validation band_gap mae = 0.891585
Epoch 38
Validation mae = 0.838116
Validation band_gap mae = 0.838116
Epoch 39
Validation mae = 0.861071
Validation band_gap mae = 0.861071
Epoch 40
Validation mae = 0.824230
Validation band_gap mae = 0.824230
Epoch 41
Validation mae = 0.888542
Validation band_gap mae = 0.888542
Epoch 42
Validation mae = 0.882561
Validation band_gap mae = 0.882561
Epoch 43
Validation mae = 0.882895
Validation band_gap mae = 0.882895
Epoch 44
Validation mae = 0.867224
Validation band_gap mae = 0.867224
Epoch 45
Validation mae = 0.829963
Validation band_gap mae = 0.829963
Epoch 46
Validation mae = 0.887121
Validation band_gap mae = 0.887121
Epoch 47
Validation mae = 0.854365
Validation band_gap mae = 0.854365
Epoch 48
Validation mae = 0.876778
Validation band_gap mae = 0.876778
Epoch 49
Validation mae = 0.879782
Validation band_gap mae = 0.879782
Epoch 50
Validation mae = 0.860400
Validation band_gap mae = 0.860400
Epoch 51
Validation mae = 0.813759
Validation band_gap mae = 0.813759
Epoch 52
Validation mae = 0.867535
Validation band_gap mae = 0.867535
Epoch 53
Validation mae = 0.794337
Validation band_gap mae = 0.794337
Epoch 54
Validation mae = 0.874041
Validation band_gap mae = 0.874041
Epoch 55
Validation mae = 0.822101
Validation band_gap mae = 0.822101
Epoch 56
Validation mae = 0.841328
Validation band_gap mae = 0.841328
Epoch 57
Validation mae = 0.876334
Validation band_gap mae = 0.876334
Epoch 58
Validation mae = 0.826313
Validation band_gap mae = 0.826313
Epoch 59
Validation mae = 0.803575
Validation band_gap mae = 0.803575
Epoch 60
Validation mae = 0.820006
Validation band_gap mae = 0.820006
Epoch 61
Validation mae = 0.776570
Validation band_gap mae = 0.776570
Epoch 62
Validation mae = 0.803628
Validation band_gap mae = 0.803628
Epoch 63
Validation mae = 0.781893
Validation band_gap mae = 0.781893
Epoch 64
Validation mae = 0.811659
Validation band_gap mae = 0.811659
Epoch 65
Validation mae = 0.760539
Validation band_gap mae = 0.760539
Epoch 66
Validation mae = 0.788343
Validation band_gap mae = 0.788343
Epoch 67
Validation mae = 0.814383
Validation band_gap mae = 0.814383
Epoch 68
Validation mae = 0.798686
Validation band_gap mae = 0.798686
Epoch 69
Validation mae = 0.811517
Validation band_gap mae = 0.811517
Epoch 70
Validation mae = 0.781112
Validation band_gap mae = 0.781112
Epoch 71
Validation mae = 0.796760
Validation band_gap mae = 0.796760
Epoch 72
Validation mae = 0.772560
Validation band_gap mae = 0.772560
Epoch 73
Validation mae = 0.790728
Validation band_gap mae = 0.790728
Epoch 74
Validation mae = 0.793447
Validation band_gap mae = 0.793447
Epoch 75
Validation mae = 0.771846
Validation band_gap mae = 0.771846
Epoch 76
Validation mae = 0.778300
Validation band_gap mae = 0.778300
Epoch 77
Validation mae = 0.804286
Validation band_gap mae = 0.804286
Epoch 78
Validation mae = 0.786354
Validation band_gap mae = 0.786354
Epoch 79
Validation mae = 0.773117
Validation band_gap mae = 0.773117
Epoch 80
Validation mae = 0.781574
Validation band_gap mae = 0.781574
Epoch 81
Validation mae = 0.781204
Validation band_gap mae = 0.781204
Epoch 82
Validation mae = 0.771324
Validation band_gap mae = 0.771324
Epoch 83
Validation mae = 0.780254
Validation band_gap mae = 0.780254
Epoch 84
Validation mae = 0.763088
Validation band_gap mae = 0.763088
Epoch 85
Validation mae = 0.788345
Validation band_gap mae = 0.788345
Epoch 86
Validation mae = 0.753656
Validation band_gap mae = 0.753656
Epoch 87
Validation mae = 0.762799
Validation band_gap mae = 0.762799
Epoch 88
Validation mae = 0.804357
Validation band_gap mae = 0.804357
Epoch 89
Validation mae = 0.781283
Validation band_gap mae = 0.781283
Epoch 90
Validation mae = 0.747781
Validation band_gap mae = 0.747781
Epoch 91
Validation mae = 0.796479
Validation band_gap mae = 0.796479
Epoch 92
Validation mae = 0.765274
Validation band_gap mae = 0.765274
Epoch 93
Validation mae = 0.794922
Validation band_gap mae = 0.794922
Epoch 94
Validation mae = 0.828127
Validation band_gap mae = 0.828127
Epoch 95
Validation mae = 0.775388
Validation band_gap mae = 0.775388
Epoch 96
Validation mae = 0.810512
Validation band_gap mae = 0.810512
Epoch 97
Validation mae = 0.845745
Validation band_gap mae = 0.845745
Epoch 98
Validation mae = 0.802400
Validation band_gap mae = 0.802400
Epoch 99
Validation mae = 0.795721
Validation band_gap mae = 0.795721
Model 0 best validation mae = 0.950348 on epoch 4
Moving model to cuda
Model 0 test mae = 0.303195
Model 0 test band_gap mae = 0.303195
Ensemble test mae = 0.303195
Ensemble test band_gap mae = 0.303195
==================== fold 8 ====================
Total size = 927 | train size = 743 | val size = 92 | test size = 92
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.700882
Validation band_gap mae = 0.700882
Epoch 1
Validation mae = 0.975068
Validation band_gap mae = 0.975068
Epoch 2
Validation mae = 0.744538
Validation band_gap mae = 0.744538
Epoch 3
Validation mae = 0.748473
Validation band_gap mae = 0.748473
Epoch 4
Validation mae = 0.738724
Validation band_gap mae = 0.738724
Epoch 5
Validation mae = 0.843292
Validation band_gap mae = 0.843292
Epoch 6
Validation mae = 0.822416
Validation band_gap mae = 0.822416
Epoch 7
Validation mae = 0.891330
Validation band_gap mae = 0.891330
Epoch 8
Validation mae = 0.709069
Validation band_gap mae = 0.709069
Epoch 9
Validation mae = 0.735803
Validation band_gap mae = 0.735803
Epoch 10
Validation mae = 0.941225
Validation band_gap mae = 0.941225
Epoch 11
Validation mae = 0.762663
Validation band_gap mae = 0.762663
Epoch 12
Validation mae = 1.049854
Validation band_gap mae = 1.049854
Epoch 13
Validation mae = 0.818173
Validation band_gap mae = 0.818173
Epoch 14
Validation mae = 0.748825
Validation band_gap mae = 0.748825
Epoch 15
Validation mae = 0.678026
Validation band_gap mae = 0.678026
Epoch 16
Validation mae = 0.784063
Validation band_gap mae = 0.784063
Epoch 17
Validation mae = 0.675757
Validation band_gap mae = 0.675757
Epoch 18
Validation mae = 0.718374
Validation band_gap mae = 0.718374
Epoch 19
Validation mae = 0.691535
Validation band_gap mae = 0.691535
Epoch 20
Validation mae = 0.687059
Validation band_gap mae = 0.687059
Epoch 21
Validation mae = 0.663567
Validation band_gap mae = 0.663567
Epoch 22
Validation mae = 0.734515
Validation band_gap mae = 0.734515
Epoch 23
Validation mae = 0.726687
Validation band_gap mae = 0.726687
Epoch 24
Validation mae = 0.699188
Validation band_gap mae = 0.699188
Epoch 25
Validation mae = 0.671383
Validation band_gap mae = 0.671383
Epoch 26
Validation mae = 0.722179
Validation band_gap mae = 0.722179
Epoch 27
Validation mae = 0.712652
Validation band_gap mae = 0.712652
Epoch 28
Validation mae = 0.729852
Validation band_gap mae = 0.729852
Epoch 29
Validation mae = 0.700169
Validation band_gap mae = 0.700169
Epoch 30
Validation mae = 0.738416
Validation band_gap mae = 0.738416
Epoch 31
Validation mae = 0.692891
Validation band_gap mae = 0.692891
Epoch 32
Validation mae = 0.744508
Validation band_gap mae = 0.744508
Epoch 33
Validation mae = 0.719286
Validation band_gap mae = 0.719286
Epoch 34
Validation mae = 0.710726
Validation band_gap mae = 0.710726
Epoch 35
Validation mae = 0.747561
Validation band_gap mae = 0.747561
Epoch 36
Validation mae = 0.721037
Validation band_gap mae = 0.721037
Epoch 37
Validation mae = 0.724010
Validation band_gap mae = 0.724010
Epoch 38
Validation mae = 0.893294
Validation band_gap mae = 0.893294
Epoch 39
Validation mae = 0.733315
Validation band_gap mae = 0.733315
Epoch 40
Validation mae = 0.749133
Validation band_gap mae = 0.749133
Epoch 41
Validation mae = 0.819842
Validation band_gap mae = 0.819842
Epoch 42
Validation mae = 0.757364
Validation band_gap mae = 0.757364
Epoch 43
Validation mae = 0.783571
Validation band_gap mae = 0.783571
Epoch 44
Validation mae = 0.858654
Validation band_gap mae = 0.858654
Epoch 45
Validation mae = 0.669909
Validation band_gap mae = 0.669909
Epoch 46
Validation mae = 0.688414
Validation band_gap mae = 0.688414
Epoch 47
Validation mae = 0.784641
Validation band_gap mae = 0.784641
Epoch 48
Validation mae = 0.728466
Validation band_gap mae = 0.728466
Epoch 49
Validation mae = 0.722533
Validation band_gap mae = 0.722533
Epoch 50
Validation mae = 0.623715
Validation band_gap mae = 0.623715
Epoch 51
Validation mae = 0.804125
Validation band_gap mae = 0.804125
Epoch 52
Validation mae = 0.633389
Validation band_gap mae = 0.633389
Epoch 53
Validation mae = 0.678090
Validation band_gap mae = 0.678090
Epoch 54
Validation mae = 0.687898
Validation band_gap mae = 0.687898
Epoch 55
Validation mae = 0.697687
Validation band_gap mae = 0.697687
Epoch 56
Validation mae = 0.694768
Validation band_gap mae = 0.694768
Epoch 57
Validation mae = 0.752160
Validation band_gap mae = 0.752160
Epoch 58
Validation mae = 0.703867
Validation band_gap mae = 0.703867
Epoch 59
Validation mae = 0.648866
Validation band_gap mae = 0.648866
Epoch 60
Validation mae = 0.654103
Validation band_gap mae = 0.654103
Epoch 61
Validation mae = 0.704590
Validation band_gap mae = 0.704590
Epoch 62
Validation mae = 0.677289
Validation band_gap mae = 0.677289
Epoch 63
Validation mae = 0.720610
Validation band_gap mae = 0.720610
Epoch 64
Validation mae = 0.747925
Validation band_gap mae = 0.747925
Epoch 65
Validation mae = 0.669198
Validation band_gap mae = 0.669198
Epoch 66
Validation mae = 0.715911
Validation band_gap mae = 0.715911
Epoch 67
Validation mae = 0.656966
Validation band_gap mae = 0.656966
Epoch 68
Validation mae = 0.681973
Validation band_gap mae = 0.681973
Epoch 69
Validation mae = 0.687068
Validation band_gap mae = 0.687068
Epoch 70
Validation mae = 0.661886
Validation band_gap mae = 0.661886
Epoch 71
Validation mae = 0.689765
Validation band_gap mae = 0.689765
Epoch 72
Validation mae = 0.673690
Validation band_gap mae = 0.673690
Epoch 73
Validation mae = 0.676388
Validation band_gap mae = 0.676388
Epoch 74
Validation mae = 0.690146
Validation band_gap mae = 0.690146
Epoch 75
Validation mae = 0.676864
Validation band_gap mae = 0.676864
Epoch 76
Validation mae = 0.670946
Validation band_gap mae = 0.670946
Epoch 77
Validation mae = 0.671921
Validation band_gap mae = 0.671921
Epoch 78
Validation mae = 0.694709
Validation band_gap mae = 0.694709
Epoch 79
Validation mae = 0.676293
Validation band_gap mae = 0.676293
Epoch 80
Validation mae = 0.679954
Validation band_gap mae = 0.679954
Epoch 81
Validation mae = 0.677173
Validation band_gap mae = 0.677173
Epoch 82
Validation mae = 0.665762
Validation band_gap mae = 0.665762
Epoch 83
Validation mae = 0.704397
Validation band_gap mae = 0.704397
Epoch 84
Validation mae = 0.686030
Validation band_gap mae = 0.686030
Epoch 85
Validation mae = 0.685640
Validation band_gap mae = 0.685640
Epoch 86
Validation mae = 0.709686
Validation band_gap mae = 0.709686
Epoch 87
Validation mae = 0.696109
Validation band_gap mae = 0.696109
Epoch 88
Validation mae = 0.698587
Validation band_gap mae = 0.698587
Epoch 89
Validation mae = 0.717866
Validation band_gap mae = 0.717866
Epoch 90
Validation mae = 0.688898
Validation band_gap mae = 0.688898
Epoch 91
Validation mae = 0.693633
Validation band_gap mae = 0.693633
Epoch 92
Validation mae = 0.696764
Validation band_gap mae = 0.696764
Epoch 93
Validation mae = 0.684582
Validation band_gap mae = 0.684582
Epoch 94
Validation mae = 0.719412
Validation band_gap mae = 0.719412
Epoch 95
Validation mae = 0.710658
Validation band_gap mae = 0.710658
Epoch 96
Validation mae = 0.707943
Validation band_gap mae = 0.707943
Epoch 97
Validation mae = 0.699341
Validation band_gap mae = 0.699341
Epoch 98
Validation mae = 0.723354
Validation band_gap mae = 0.723354
Epoch 99
Validation mae = 0.689385
Validation band_gap mae = 0.689385
Model 0 best validation mae = 1.049854 on epoch 12
Moving model to cuda
Model 0 test mae = 0.611575
Model 0 test band_gap mae = 0.611575
Ensemble test mae = 0.611575
Ensemble test band_gap mae = 0.611575
==================== fold 9 ====================
Total size = 927 | train size = 743 | val size = 92 | test size = 92
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.547903
Validation band_gap mae = 0.547903
Epoch 1
Validation mae = 0.658372
Validation band_gap mae = 0.658372
Epoch 2
Validation mae = 0.488872
Validation band_gap mae = 0.488872
Epoch 3
Validation mae = 0.469257
Validation band_gap mae = 0.469257
Epoch 4
Validation mae = 0.597407
Validation band_gap mae = 0.597407
Epoch 5
Validation mae = 0.565149
Validation band_gap mae = 0.565149
Epoch 6
Validation mae = 0.447505
Validation band_gap mae = 0.447505
Epoch 7
Validation mae = 0.455234
Validation band_gap mae = 0.455234
Epoch 8
Validation mae = 0.462565
Validation band_gap mae = 0.462565
Epoch 9
Validation mae = 0.489857
Validation band_gap mae = 0.489857
Epoch 10
Validation mae = 0.451007
Validation band_gap mae = 0.451007
Epoch 11
Validation mae = 0.456253
Validation band_gap mae = 0.456253
Epoch 12
Validation mae = 0.442208
Validation band_gap mae = 0.442208
Epoch 13
Validation mae = 0.444093
Validation band_gap mae = 0.444093
Epoch 14
Validation mae = 0.526392
Validation band_gap mae = 0.526392
Epoch 15
Validation mae = 0.557168
Validation band_gap mae = 0.557168
Epoch 16
Validation mae = 0.441084
Validation band_gap mae = 0.441084
Epoch 17
Validation mae = 0.472512
Validation band_gap mae = 0.472512
Epoch 18
Validation mae = 0.474700
Validation band_gap mae = 0.474700
Epoch 19
Validation mae = 0.462729
Validation band_gap mae = 0.462729
Epoch 20
Validation mae = 0.505030
Validation band_gap mae = 0.505030
Epoch 21
Validation mae = 0.490155
Validation band_gap mae = 0.490155
Epoch 22
Validation mae = 0.465868
Validation band_gap mae = 0.465868
Epoch 23
Validation mae = 0.516466
Validation band_gap mae = 0.516466
Epoch 24
Validation mae = 0.482376
Validation band_gap mae = 0.482376
Epoch 25
Validation mae = 0.644690
Validation band_gap mae = 0.644690
Epoch 26
Validation mae = 0.477189
Validation band_gap mae = 0.477189
Epoch 27
Validation mae = 0.482475
Validation band_gap mae = 0.482475
Epoch 28
Validation mae = 0.526276
Validation band_gap mae = 0.526276
Epoch 29
Validation mae = 0.525151
Validation band_gap mae = 0.525151
Epoch 30
Validation mae = 0.478359
Validation band_gap mae = 0.478359
Epoch 31
Validation mae = 0.457098
Validation band_gap mae = 0.457098
Epoch 32
Validation mae = 0.490557
Validation band_gap mae = 0.490557
Epoch 33
Validation mae = 0.510240
Validation band_gap mae = 0.510240
Epoch 34
Validation mae = 0.494829
Validation band_gap mae = 0.494829
Epoch 35
Validation mae = 0.523717
Validation band_gap mae = 0.523717
Epoch 36
Validation mae = 0.461871
Validation band_gap mae = 0.461871
Epoch 37
Validation mae = 0.453001
Validation band_gap mae = 0.453001
Epoch 38
Validation mae = 0.453768
Validation band_gap mae = 0.453768
Epoch 39
Validation mae = 0.493881
Validation band_gap mae = 0.493881
Epoch 40
Validation mae = 0.505881
Validation band_gap mae = 0.505881
Epoch 41
Validation mae = 0.468969
Validation band_gap mae = 0.468969
Epoch 42
Validation mae = 0.452779
Validation band_gap mae = 0.452779
Epoch 43
Validation mae = 0.466918
Validation band_gap mae = 0.466918
Epoch 44
Validation mae = 0.560563
Validation band_gap mae = 0.560563
Epoch 45
Validation mae = 0.492474
Validation band_gap mae = 0.492474
Epoch 46
Validation mae = 0.453384
Validation band_gap mae = 0.453384
Epoch 47
Validation mae = 0.459390
Validation band_gap mae = 0.459390
Epoch 48
Validation mae = 0.491648
Validation band_gap mae = 0.491648
Epoch 49
Validation mae = 0.548178
Validation band_gap mae = 0.548178
Epoch 50
Validation mae = 0.610136
Validation band_gap mae = 0.610136
Epoch 51
Validation mae = 0.452524
Validation band_gap mae = 0.452524
Epoch 52
Validation mae = 0.460116
Validation band_gap mae = 0.460116
Epoch 53
Validation mae = 0.450201
Validation band_gap mae = 0.450201
Epoch 54
Validation mae = 0.434615
Validation band_gap mae = 0.434615
Epoch 55
Validation mae = 0.545759
Validation band_gap mae = 0.545759
Epoch 56
Validation mae = 0.498414
Validation band_gap mae = 0.498414
Epoch 57
Validation mae = 0.592884
Validation band_gap mae = 0.592884
Epoch 58
Validation mae = 0.512222
Validation band_gap mae = 0.512222
Epoch 59
Validation mae = 0.480265
Validation band_gap mae = 0.480265
Epoch 60
Validation mae = 0.457560
Validation band_gap mae = 0.457560
Epoch 61
Validation mae = 0.480205
Validation band_gap mae = 0.480205
Epoch 62
Validation mae = 0.589474
Validation band_gap mae = 0.589474
Epoch 63
Validation mae = 0.471164
Validation band_gap mae = 0.471164
Epoch 64
Validation mae = 0.474801
Validation band_gap mae = 0.474801
Epoch 65
Validation mae = 0.450460
Validation band_gap mae = 0.450460
Epoch 66
Validation mae = 0.539778
Validation band_gap mae = 0.539778
Epoch 67
Validation mae = 0.426731
Validation band_gap mae = 0.426731
Epoch 68
Validation mae = 0.502140
Validation band_gap mae = 0.502140
Epoch 69
Validation mae = 0.501593
Validation band_gap mae = 0.501593
Epoch 70
Validation mae = 0.486658
Validation band_gap mae = 0.486658
Epoch 71
Validation mae = 0.452531
Validation band_gap mae = 0.452531
Epoch 72
Validation mae = 0.461432
Validation band_gap mae = 0.461432
Epoch 73
Validation mae = 0.491773
Validation band_gap mae = 0.491773
Epoch 74
Validation mae = 0.465188
Validation band_gap mae = 0.465188
Epoch 75
Validation mae = 0.504127
Validation band_gap mae = 0.504127
Epoch 76
Validation mae = 0.514127
Validation band_gap mae = 0.514127
Epoch 77
Validation mae = 0.453444
Validation band_gap mae = 0.453444
Epoch 78
Validation mae = 0.472461
Validation band_gap mae = 0.472461
Epoch 79
Validation mae = 0.525818
Validation band_gap mae = 0.525818
Epoch 80
Validation mae = 0.444782
Validation band_gap mae = 0.444782
Epoch 81
Validation mae = 0.506467
Validation band_gap mae = 0.506467
Epoch 82
Validation mae = 0.463489
Validation band_gap mae = 0.463489
Epoch 83
Validation mae = 0.482329
Validation band_gap mae = 0.482329
Epoch 84
Validation mae = 0.461831
Validation band_gap mae = 0.461831
Epoch 85
Validation mae = 0.464509
Validation band_gap mae = 0.464509
Epoch 86
Validation mae = 0.463815
Validation band_gap mae = 0.463815
Epoch 87
Validation mae = 0.467813
Validation band_gap mae = 0.467813
Epoch 88
Validation mae = 0.461320
Validation band_gap mae = 0.461320
Epoch 89
Validation mae = 0.458415
Validation band_gap mae = 0.458415
Epoch 90
Validation mae = 0.471708
Validation band_gap mae = 0.471708
Epoch 91
Validation mae = 0.456105
Validation band_gap mae = 0.456105
Epoch 92
Validation mae = 0.475547
Validation band_gap mae = 0.475547
Epoch 93
Validation mae = 0.454994
Validation band_gap mae = 0.454994
Epoch 94
Validation mae = 0.460543
Validation band_gap mae = 0.460543
Epoch 95
Validation mae = 0.472153
Validation band_gap mae = 0.472153
Epoch 96
Validation mae = 0.460107
Validation band_gap mae = 0.460107
Epoch 97
Validation mae = 0.466274
Validation band_gap mae = 0.466274
Epoch 98
Validation mae = 0.476025
Validation band_gap mae = 0.476025
Epoch 99
Validation mae = 0.467325
Validation band_gap mae = 0.467325
Model 0 best validation mae = 0.658372 on epoch 1
Moving model to cuda
Model 0 test mae = 0.509787
Model 0 test band_gap mae = 0.509787
Ensemble test mae = 0.509787
Ensemble test band_gap mae = 0.509787
10-fold cross validation
Seed 0
Fold 0 ==> valid mae = 7.985044 test mae = 6.086070
Fold 0 ==> valid band_gap mae = 7.985044test band_gap mae = 6.086070
Fold 1 ==> valid mae = 3.608905 test mae = 3.642490
Fold 1 ==> valid band_gap mae = 3.608905test band_gap mae = 3.642490
Fold 2 ==> valid mae = 1.863712 test mae = 1.005071
Fold 2 ==> valid band_gap mae = 1.863712test band_gap mae = 1.005071
Fold 3 ==> valid mae = 1.607328 test mae = 0.774039
Fold 3 ==> valid band_gap mae = 1.607328test band_gap mae = 0.774039
Fold 4 ==> valid mae = 1.373377 test mae = 1.236446
Fold 4 ==> valid band_gap mae = 1.373377test band_gap mae = 1.236446
Fold 5 ==> valid mae = 0.492771 test mae = 0.125988
Fold 5 ==> valid band_gap mae = 0.492771test band_gap mae = 0.125988
Fold 6 ==> valid mae = 0.875368 test mae = 0.261646
Fold 6 ==> valid band_gap mae = 0.875368test band_gap mae = 0.261646
Fold 7 ==> valid mae = 0.950348 test mae = 0.303195
Fold 7 ==> valid band_gap mae = 0.950348test band_gap mae = 0.303195
Fold 8 ==> valid mae = 1.049854 test mae = 0.611575
Fold 8 ==> valid band_gap mae = 1.049854test band_gap mae = 0.611575
Fold 9 ==> valid mae = 0.658372 test mae = 0.509787
Fold 9 ==> valid band_gap mae = 0.658372test band_gap mae = 0.509787
Overall valid mae = 2.046508 +/- 2.151608
Overall test mae = 1.455631 +/- 1.818451
Overall test band_gap mae = 1.455631 +/- 1.818451
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 7.406875
Validation band_gap mae = 7.406875
Epoch 1
Validation mae = 5.406267
Validation band_gap mae = 5.406267
Epoch 2
Validation mae = 5.867034
Validation band_gap mae = 5.867034
Epoch 3
Validation mae = 5.139550
Validation band_gap mae = 5.139550
Epoch 4
Validation mae = 4.834212
Validation band_gap mae = 4.834212
Epoch 5
Validation mae = 4.417457
Validation band_gap mae = 4.417457
Epoch 6
Validation mae = 4.852668
Validation band_gap mae = 4.852668
Epoch 7
Validation mae = 3.124061
Validation band_gap mae = 3.124061
Epoch 8
Validation mae = 3.320268
Validation band_gap mae = 3.320268
Epoch 9
Validation mae = 3.062068
Validation band_gap mae = 3.062068
Epoch 10
Validation mae = 4.726479
Validation band_gap mae = 4.726479
Epoch 11
Validation mae = 3.890319
Validation band_gap mae = 3.890319
Epoch 12
Validation mae = 3.282366
Validation band_gap mae = 3.282366
Epoch 13
Validation mae = 3.058344
Validation band_gap mae = 3.058344
Epoch 14
Validation mae = 3.375855
Validation band_gap mae = 3.375855
Epoch 15
Validation mae = 2.928921
Validation band_gap mae = 2.928921
Epoch 16
Validation mae = 3.238135
Validation band_gap mae = 3.238135
Epoch 17
Validation mae = 2.988853
Validation band_gap mae = 2.988853
Epoch 18
Validation mae = 3.179784
Validation band_gap mae = 3.179784
Epoch 19
Validation mae = 3.378213
Validation band_gap mae = 3.378213
Epoch 20
Validation mae = 2.804614
Validation band_gap mae = 2.804614
Epoch 21
Validation mae = 2.897352
Validation band_gap mae = 2.897352
Epoch 22
Validation mae = 2.833517
Validation band_gap mae = 2.833517
Epoch 23
Validation mae = 3.018431
Validation band_gap mae = 3.018431
Epoch 24
Validation mae = 3.148412
Validation band_gap mae = 3.148412
Epoch 25
Validation mae = 2.763380
Validation band_gap mae = 2.763380
Epoch 26
Validation mae = 2.823997
Validation band_gap mae = 2.823997
Epoch 27
Validation mae = 3.194936
Validation band_gap mae = 3.194936
Epoch 28
Validation mae = 3.242736
Validation band_gap mae = 3.242736
Epoch 29
Validation mae = 3.062506
Validation band_gap mae = 3.062506
Epoch 30
Validation mae = 3.147869
Validation band_gap mae = 3.147869
Epoch 31
Validation mae = 2.838380
Validation band_gap mae = 2.838380
Epoch 32
Validation mae = 2.939843
Validation band_gap mae = 2.939843
Epoch 33
Validation mae = 2.957819
Validation band_gap mae = 2.957819
Epoch 34
Validation mae = 3.027165
Validation band_gap mae = 3.027165
Epoch 35
Validation mae = 3.129054
Validation band_gap mae = 3.129054
Epoch 36
Validation mae = 2.805214
Validation band_gap mae = 2.805214
Epoch 37
Validation mae = 2.816509
Validation band_gap mae = 2.816509
Epoch 38
Validation mae = 2.791369
Validation band_gap mae = 2.791369
Epoch 39
Validation mae = 2.862577
Validation band_gap mae = 2.862577
Epoch 40
Validation mae = 2.863416
Validation band_gap mae = 2.863416
Epoch 41
Validation mae = 2.918523
Validation band_gap mae = 2.918523
Epoch 42
Validation mae = 2.864693
Validation band_gap mae = 2.864693
Epoch 43
Validation mae = 2.955691
Validation band_gap mae = 2.955691
Epoch 44
Validation mae = 2.764875
Validation band_gap mae = 2.764875
Epoch 45
Validation mae = 2.813669
Validation band_gap mae = 2.813669
Epoch 46
Validation mae = 2.880671
Validation band_gap mae = 2.880671
Epoch 47
Validation mae = 2.903129
Validation band_gap mae = 2.903129
Epoch 48
Validation mae = 2.816949
Validation band_gap mae = 2.816949
Epoch 49
Validation mae = 2.770455
Validation band_gap mae = 2.770455
Epoch 50
Validation mae = 2.897295
Validation band_gap mae = 2.897295
Epoch 51
Validation mae = 2.802205
Validation band_gap mae = 2.802205
Epoch 52
Validation mae = 2.813349
Validation band_gap mae = 2.813349
Epoch 53
Validation mae = 2.890775
Validation band_gap mae = 2.890775
Epoch 54
Validation mae = 2.799137
Validation band_gap mae = 2.799137
Epoch 55
Validation mae = 2.886762
Validation band_gap mae = 2.886762
Epoch 56
Validation mae = 2.923865
Validation band_gap mae = 2.923865
Epoch 57
Validation mae = 2.858227
Validation band_gap mae = 2.858227
Epoch 58
Validation mae = 2.874262
Validation band_gap mae = 2.874262
Epoch 59
Validation mae = 2.870597
Validation band_gap mae = 2.870597
Epoch 60
Validation mae = 2.763933
Validation band_gap mae = 2.763933
Epoch 61
Validation mae = 2.877834
Validation band_gap mae = 2.877834
Epoch 62
Validation mae = 2.836881
Validation band_gap mae = 2.836881
Epoch 63
Validation mae = 2.866093
Validation band_gap mae = 2.866093
Epoch 64
Validation mae = 2.890173
Validation band_gap mae = 2.890173
Epoch 65
Validation mae = 2.890649
Validation band_gap mae = 2.890649
Epoch 66
Validation mae = 2.709101
Validation band_gap mae = 2.709101
Epoch 67
Validation mae = 3.021066
Validation band_gap mae = 3.021066
Epoch 68
Validation mae = 2.814287
Validation band_gap mae = 2.814287
Epoch 69
Validation mae = 2.875831
Validation band_gap mae = 2.875831
Epoch 70
Validation mae = 3.098395
Validation band_gap mae = 3.098395
Epoch 71
Validation mae = 3.006205
Validation band_gap mae = 3.006205
Epoch 72
Validation mae = 2.846887
Validation band_gap mae = 2.846887
Epoch 73
Validation mae = 2.911602
Validation band_gap mae = 2.911602
Epoch 74
Validation mae = 2.929239
Validation band_gap mae = 2.929239
Epoch 75
Validation mae = 2.815893
Validation band_gap mae = 2.815893
Epoch 76
Validation mae = 2.811566
Validation band_gap mae = 2.811566
Epoch 77
Validation mae = 2.789800
Validation band_gap mae = 2.789800
Epoch 78
Validation mae = 2.805668
Validation band_gap mae = 2.805668
Epoch 79
Validation mae = 2.910198
Validation band_gap mae = 2.910198
Epoch 80
Validation mae = 2.991512
Validation band_gap mae = 2.991512
Epoch 81
Validation mae = 2.883608
Validation band_gap mae = 2.883608
Epoch 82
Validation mae = 3.138946
Validation band_gap mae = 3.138946
Epoch 83
Validation mae = 3.104522
Validation band_gap mae = 3.104522
Epoch 84
Validation mae = 3.034611
Validation band_gap mae = 3.034611
Epoch 85
Validation mae = 2.850531
Validation band_gap mae = 2.850531
Epoch 86
Validation mae = 2.800435
Validation band_gap mae = 2.800435
Epoch 87
Validation mae = 2.858591
Validation band_gap mae = 2.858591
Epoch 88
Validation mae = 2.984077
Validation band_gap mae = 2.984077
Epoch 89
Validation mae = 2.785448
Validation band_gap mae = 2.785448
Epoch 90
Validation mae = 2.796602
Validation band_gap mae = 2.796602
Epoch 91
Validation mae = 2.934245
Validation band_gap mae = 2.934245
Epoch 92
Validation mae = 2.778045
Validation band_gap mae = 2.778045
Epoch 93
Validation mae = 2.900332
Validation band_gap mae = 2.900332
Epoch 94
Validation mae = 2.854907
Validation band_gap mae = 2.854907
Epoch 95
Validation mae = 2.908972
Validation band_gap mae = 2.908972
Epoch 96
Validation mae = 2.954904
Validation band_gap mae = 2.954904
Epoch 97
Validation mae = 2.901570
Validation band_gap mae = 2.901570
Epoch 98
Validation mae = 2.783967
Validation band_gap mae = 2.783967
Epoch 99
Validation mae = 2.735769
Validation band_gap mae = 2.735769
Model 0 best validation mae = 7.406875 on epoch 0
Moving model to cuda
Model 0 test mae = 4.701292
Model 0 test band_gap mae = 4.701292
Ensemble test mae = 4.701292
Ensemble test band_gap mae = 4.701292
==================== fold 1 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 2.533944
Validation band_gap mae = 2.533944
Epoch 1
Validation mae = 1.492849
Validation band_gap mae = 1.492849
Epoch 2
Validation mae = 2.134538
Validation band_gap mae = 2.134538
Epoch 3
Validation mae = 2.312195
Validation band_gap mae = 2.312195
Epoch 4
Validation mae = 2.322543
Validation band_gap mae = 2.322543
Epoch 5
Validation mae = 1.437408
Validation band_gap mae = 1.437408
Epoch 6
Validation mae = 2.039309
Validation band_gap mae = 2.039309
Epoch 7
Validation mae = 1.465710
Validation band_gap mae = 1.465710
Epoch 8
Validation mae = 2.308197
Validation band_gap mae = 2.308197
Epoch 9
Validation mae = 1.623035
Validation band_gap mae = 1.623035
Epoch 10
Validation mae = 1.633877
Validation band_gap mae = 1.633877
Epoch 11
Validation mae = 1.310385
Validation band_gap mae = 1.310385
Epoch 12
Validation mae = 1.775955
Validation band_gap mae = 1.775955
Epoch 13
Validation mae = 2.027780
Validation band_gap mae = 2.027780
Epoch 14
Validation mae = 2.539503
Validation band_gap mae = 2.539503
Epoch 15
Validation mae = 1.507493
Validation band_gap mae = 1.507493
Epoch 16
Validation mae = 2.110572
Validation band_gap mae = 2.110572
Epoch 17
Validation mae = 2.232783
Validation band_gap mae = 2.232783
Epoch 18
Validation mae = 1.903237
Validation band_gap mae = 1.903237
Epoch 19
Validation mae = 1.891544
Validation band_gap mae = 1.891544
Epoch 20
Validation mae = 1.943986
Validation band_gap mae = 1.943986
Epoch 21
Validation mae = 1.422473
Validation band_gap mae = 1.422473
Epoch 22
Validation mae = 2.142456
Validation band_gap mae = 2.142456
Epoch 23
Validation mae = 3.072839
Validation band_gap mae = 3.072839
Epoch 24
Validation mae = 2.364154
Validation band_gap mae = 2.364154
Epoch 25
Validation mae = 2.338410
Validation band_gap mae = 2.338410
Epoch 26
Validation mae = 2.085584
Validation band_gap mae = 2.085584
Epoch 27
Validation mae = 2.102014
Validation band_gap mae = 2.102014
Epoch 28
Validation mae = 2.264447
Validation band_gap mae = 2.264447
Epoch 29
Validation mae = 1.849123
Validation band_gap mae = 1.849123
Epoch 30
Validation mae = 3.937725
Validation band_gap mae = 3.937725
Epoch 31
Validation mae = 2.340004
Validation band_gap mae = 2.340004
Epoch 32
Validation mae = 1.965097
Validation band_gap mae = 1.965097
Epoch 33
Validation mae = 1.578039
Validation band_gap mae = 1.578039
Epoch 34
Validation mae = 2.623502
Validation band_gap mae = 2.623502
Epoch 35
Validation mae = 1.977391
Validation band_gap mae = 1.977391
Epoch 36
Validation mae = 1.957376
Validation band_gap mae = 1.957376
Epoch 37
Validation mae = 2.404843
Validation band_gap mae = 2.404843
Epoch 38
Validation mae = 2.101811
Validation band_gap mae = 2.101811
Epoch 39
Validation mae = 2.421299
Validation band_gap mae = 2.421299
Epoch 40
Validation mae = 2.634512
Validation band_gap mae = 2.634512
Epoch 41
Validation mae = 1.581147
Validation band_gap mae = 1.581147
Epoch 42
Validation mae = 2.385801
Validation band_gap mae = 2.385801
Epoch 43
Validation mae = 1.626348
Validation band_gap mae = 1.626348
Epoch 44
Validation mae = 2.163523
Validation band_gap mae = 2.163523
Epoch 45
Validation mae = 2.043726
Validation band_gap mae = 2.043726
Epoch 46
Validation mae = 2.411197
Validation band_gap mae = 2.411197
Epoch 47
Validation mae = 1.566644
Validation band_gap mae = 1.566644
Epoch 48
Validation mae = 2.073136
Validation band_gap mae = 2.073136
Epoch 49
Validation mae = 2.073741
Validation band_gap mae = 2.073741
Epoch 50
Validation mae = 2.910332
Validation band_gap mae = 2.910332
Epoch 51
Validation mae = 1.767111
Validation band_gap mae = 1.767111
Epoch 52
Validation mae = 1.865928
Validation band_gap mae = 1.865928
Epoch 53
Validation mae = 2.154808
Validation band_gap mae = 2.154808
Epoch 54
Validation mae = 2.275985
Validation band_gap mae = 2.275985
Epoch 55
Validation mae = 2.119731
Validation band_gap mae = 2.119731
Epoch 56
Validation mae = 1.579199
Validation band_gap mae = 1.579199
Epoch 57
Validation mae = 2.499543
Validation band_gap mae = 2.499543
Epoch 58
Validation mae = 2.106835
Validation band_gap mae = 2.106835
Epoch 59
Validation mae = 2.051682
Validation band_gap mae = 2.051682
Epoch 60
Validation mae = 2.721840
Validation band_gap mae = 2.721840
Epoch 61
Validation mae = 1.981223
Validation band_gap mae = 1.981223
Epoch 62
Validation mae = 2.118721
Validation band_gap mae = 2.118721
Epoch 63
Validation mae = 2.497049
Validation band_gap mae = 2.497049
Epoch 64
Validation mae = 1.462323
Validation band_gap mae = 1.462323
Epoch 65
Validation mae = 2.038450
Validation band_gap mae = 2.038450
Epoch 66
Validation mae = 2.636079
Validation band_gap mae = 2.636079
Epoch 67
Validation mae = 1.893924
Validation band_gap mae = 1.893924
Epoch 68
Validation mae = 2.838993
Validation band_gap mae = 2.838993
Epoch 69
Validation mae = 1.504748
Validation band_gap mae = 1.504748
Epoch 70
Validation mae = 2.037497
Validation band_gap mae = 2.037497
Epoch 71
Validation mae = 2.215471
Validation band_gap mae = 2.215471
Epoch 72
Validation mae = 2.764124
Validation band_gap mae = 2.764124
Epoch 73
Validation mae = 2.385833
Validation band_gap mae = 2.385833
Epoch 74
Validation mae = 1.829416
Validation band_gap mae = 1.829416
Epoch 75
Validation mae = 2.759120
Validation band_gap mae = 2.759120
Epoch 76
Validation mae = 1.993295
Validation band_gap mae = 1.993295
Epoch 77
Validation mae = 1.813445
Validation band_gap mae = 1.813445
Epoch 78
Validation mae = 2.963061
Validation band_gap mae = 2.963061
Epoch 79
Validation mae = 1.613406
Validation band_gap mae = 1.613406
Epoch 80
Validation mae = 3.430446
Validation band_gap mae = 3.430446
Epoch 81
Validation mae = 1.810324
Validation band_gap mae = 1.810324
Epoch 82
Validation mae = 2.272599
Validation band_gap mae = 2.272599
Epoch 83
Validation mae = 3.029639
Validation band_gap mae = 3.029639
Epoch 84
Validation mae = 1.540010
Validation band_gap mae = 1.540010
Epoch 85
Validation mae = 2.078275
Validation band_gap mae = 2.078275
Epoch 86
Validation mae = 2.426705
Validation band_gap mae = 2.426705
Epoch 87
Validation mae = 2.445993
Validation band_gap mae = 2.445993
Epoch 88
Validation mae = 1.991399
Validation band_gap mae = 1.991399
Epoch 89
Validation mae = 2.375365
Validation band_gap mae = 2.375365
Epoch 90
Validation mae = 1.734829
Validation band_gap mae = 1.734829
Epoch 91
Validation mae = 2.249625
Validation band_gap mae = 2.249625
Epoch 92
Validation mae = 2.012029
Validation band_gap mae = 2.012029
Epoch 93
Validation mae = 2.219470
Validation band_gap mae = 2.219470
Epoch 94
Validation mae = 2.412869
Validation band_gap mae = 2.412869
Epoch 95
Validation mae = 1.939662
Validation band_gap mae = 1.939662
Epoch 96
Validation mae = 2.409845
Validation band_gap mae = 2.409845
Epoch 97
Validation mae = 2.409937
Validation band_gap mae = 2.409937
Epoch 98
Validation mae = 1.899406
Validation band_gap mae = 1.899406
Epoch 99
Validation mae = 2.282871
Validation band_gap mae = 2.282871
Model 0 best validation mae = 3.937725 on epoch 30
Moving model to cuda
Model 0 test mae = 4.959343
Model 0 test band_gap mae = 4.959343
Ensemble test mae = 4.959343
Ensemble test band_gap mae = 4.959343
==================== fold 2 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 1.360216
Validation band_gap mae = 1.360216
Epoch 1
Validation mae = 1.568215
Validation band_gap mae = 1.568215
Epoch 2
Validation mae = 1.432164
Validation band_gap mae = 1.432164
Epoch 3
Validation mae = 1.429297
Validation band_gap mae = 1.429297
Epoch 4
Validation mae = 1.695897
Validation band_gap mae = 1.695897
Epoch 5
Validation mae = 1.676504
Validation band_gap mae = 1.676504
Epoch 6
Validation mae = 1.596159
Validation band_gap mae = 1.596159
Epoch 7
Validation mae = 1.628364
Validation band_gap mae = 1.628364
Epoch 8
Validation mae = 1.616195
Validation band_gap mae = 1.616195
Epoch 9
Validation mae = 1.518766
Validation band_gap mae = 1.518766
Epoch 10
Validation mae = 1.658391
Validation band_gap mae = 1.658391
Epoch 11
Validation mae = 1.458134
Validation band_gap mae = 1.458134
Epoch 12
Validation mae = 1.569919
Validation band_gap mae = 1.569919
Epoch 13
Validation mae = 1.369899
Validation band_gap mae = 1.369899
Epoch 14
Validation mae = 1.367435
Validation band_gap mae = 1.367435
Epoch 15
Validation mae = 1.410071
Validation band_gap mae = 1.410071
Epoch 16
Validation mae = 1.430042
Validation band_gap mae = 1.430042
Epoch 17
Validation mae = 1.463394
Validation band_gap mae = 1.463394
Epoch 18
Validation mae = 1.612483
Validation band_gap mae = 1.612483
Epoch 19
Validation mae = 1.373151
Validation band_gap mae = 1.373151
Epoch 20
Validation mae = 1.482518
Validation band_gap mae = 1.482518
Epoch 21
Validation mae = 1.700911
Validation band_gap mae = 1.700911
Epoch 22
Validation mae = 1.531768
Validation band_gap mae = 1.531768
Epoch 23
Validation mae = 1.438919
Validation band_gap mae = 1.438919
Epoch 24
Validation mae = 1.380914
Validation band_gap mae = 1.380914
Epoch 25
Validation mae = 1.372815
Validation band_gap mae = 1.372815
Epoch 26
Validation mae = 1.324955
Validation band_gap mae = 1.324955
Epoch 27
Validation mae = 1.394712
Validation band_gap mae = 1.394712
Epoch 28
Validation mae = 1.389003
Validation band_gap mae = 1.389003
Epoch 29
Validation mae = 1.455131
Validation band_gap mae = 1.455131
Epoch 30
Validation mae = 1.335134
Validation band_gap mae = 1.335134
Epoch 31
Validation mae = 1.436115
Validation band_gap mae = 1.436115
Epoch 32
Validation mae = 1.409115
Validation band_gap mae = 1.409115
Epoch 33
Validation mae = 1.454667
Validation band_gap mae = 1.454667
Epoch 34
Validation mae = 1.462238
Validation band_gap mae = 1.462238
Epoch 35
Validation mae = 1.372110
Validation band_gap mae = 1.372110
Epoch 36
Validation mae = 1.358067
Validation band_gap mae = 1.358067
Epoch 37
Validation mae = 1.382033
Validation band_gap mae = 1.382033
Epoch 38
Validation mae = 1.393482
Validation band_gap mae = 1.393482
Epoch 39
Validation mae = 1.422827
Validation band_gap mae = 1.422827
Epoch 40
Validation mae = 1.378947
Validation band_gap mae = 1.378947
Epoch 41
Validation mae = 1.491283
Validation band_gap mae = 1.491283
Epoch 42
Validation mae = 1.459751
Validation band_gap mae = 1.459751
Epoch 43
Validation mae = 1.535358
Validation band_gap mae = 1.535358
Epoch 44
Validation mae = 1.314703
Validation band_gap mae = 1.314703
Epoch 45
Validation mae = 1.360823
Validation band_gap mae = 1.360823
Epoch 46
Validation mae = 1.456939
Validation band_gap mae = 1.456939
Epoch 47
Validation mae = 1.361243
Validation band_gap mae = 1.361243
Epoch 48
Validation mae = 1.474288
Validation band_gap mae = 1.474288
Epoch 49
Validation mae = 1.466669
Validation band_gap mae = 1.466669
Epoch 50
Validation mae = 1.379505
Validation band_gap mae = 1.379505
Epoch 51
Validation mae = 1.402166
Validation band_gap mae = 1.402166
Epoch 52
Validation mae = 1.351041
Validation band_gap mae = 1.351041
Epoch 53
Validation mae = 1.327359
Validation band_gap mae = 1.327359
Epoch 54
Validation mae = 1.455555
Validation band_gap mae = 1.455555
Epoch 55
Validation mae = 1.323919
Validation band_gap mae = 1.323919
Epoch 56
Validation mae = 1.337255
Validation band_gap mae = 1.337255
Epoch 57
Validation mae = 1.406132
Validation band_gap mae = 1.406132
Epoch 58
Validation mae = 1.467392
Validation band_gap mae = 1.467392
Epoch 59
Validation mae = 1.361652
Validation band_gap mae = 1.361652
Epoch 60
Validation mae = 1.317093
Validation band_gap mae = 1.317093
Epoch 61
Validation mae = 1.353882
Validation band_gap mae = 1.353882
Epoch 62
Validation mae = 1.367075
Validation band_gap mae = 1.367075
Epoch 63
Validation mae = 1.366111
Validation band_gap mae = 1.366111
Epoch 64
Validation mae = 1.332866
Validation band_gap mae = 1.332866
Epoch 65
Validation mae = 1.353875
Validation band_gap mae = 1.353875
Epoch 66
Validation mae = 1.333229
Validation band_gap mae = 1.333229
Epoch 67
Validation mae = 1.358748
Validation band_gap mae = 1.358748
Epoch 68
Validation mae = 1.279170
Validation band_gap mae = 1.279170
Epoch 69
Validation mae = 1.466403
Validation band_gap mae = 1.466403
Epoch 70
Validation mae = 1.258694
Validation band_gap mae = 1.258694
Epoch 71
Validation mae = 1.460120
Validation band_gap mae = 1.460120
Epoch 72
Validation mae = 1.294575
Validation band_gap mae = 1.294575
Epoch 73
Validation mae = 1.389141
Validation band_gap mae = 1.389141
Epoch 74
Validation mae = 1.344181
Validation band_gap mae = 1.344181
Epoch 75
Validation mae = 1.328765
Validation band_gap mae = 1.328765
Epoch 76
Validation mae = 1.357598
Validation band_gap mae = 1.357598
Epoch 77
Validation mae = 1.418341
Validation band_gap mae = 1.418341
Epoch 78
Validation mae = 1.332925
Validation band_gap mae = 1.332925
Epoch 79
Validation mae = 1.310070
Validation band_gap mae = 1.310070
Epoch 80
Validation mae = 1.365799
Validation band_gap mae = 1.365799
Epoch 81
Validation mae = 1.370301
Validation band_gap mae = 1.370301
Epoch 82
Validation mae = 1.338209
Validation band_gap mae = 1.338209
Epoch 83
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 7.297821
Validation band_gap mae = 7.297821
Epoch 1
Validation mae = 6.044644
Validation band_gap mae = 6.044644
Epoch 2
Validation mae = 7.163431
Validation band_gap mae = 7.163431
Epoch 3
Validation mae = 6.463635
Validation band_gap mae = 6.463635
Epoch 4
Validation mae = 5.808430
Validation band_gap mae = 5.808430
Epoch 5
Validation mae = 5.649001
Validation band_gap mae = 5.649001
Epoch 6
Validation mae = 5.710361
Validation band_gap mae = 5.710361
Epoch 7
Validation mae = 5.485300
Validation band_gap mae = 5.485300
Epoch 8
Validation mae = 4.899423
Validation band_gap mae = 4.899423
Epoch 9
Validation mae = 3.538078
Validation band_gap mae = 3.538078
Epoch 10
Validation mae = 4.017605
Validation band_gap mae = 4.017605
Epoch 11
Validation mae = 3.696424
Validation band_gap mae = 3.696424
Epoch 12
Validation mae = 3.922154
Validation band_gap mae = 3.922154
Epoch 13
Validation mae = 4.033253
Validation band_gap mae = 4.033253
Epoch 14
Validation mae = 3.249206
Validation band_gap mae = 3.249206
Epoch 15
Validation mae = 4.022804
Validation band_gap mae = 4.022804
Epoch 16
Validation mae = 3.731090
Validation band_gap mae = 3.731090
Epoch 17
Validation mae = 3.525480
Validation band_gap mae = 3.525480
Epoch 18
Validation mae = 3.396700
Validation band_gap mae = 3.396700
Epoch 19
Validation mae = 3.407498
Validation band_gap mae = 3.407498
Epoch 20
Validation mae = 3.549823
Validation band_gap mae = 3.549823
Epoch 21
Validation mae = 3.798525
Validation band_gap mae = 3.798525
Epoch 22
Validation mae = 3.769313
Validation band_gap mae = 3.769313
Epoch 23
Validation mae = 3.575380
Validation band_gap mae = 3.575380
Epoch 24
Validation mae = 3.229434
Validation band_gap mae = 3.229434
Epoch 25
Validation mae = 3.703509
Validation band_gap mae = 3.703509
Epoch 26
Validation mae = 3.610033
Validation band_gap mae = 3.610033
Epoch 27
Validation mae = 3.132928
Validation band_gap mae = 3.132928
Epoch 28
Validation mae = 3.119659
Validation band_gap mae = 3.119659
Epoch 29
Validation mae = 3.141706
Validation band_gap mae = 3.141706
Epoch 30
Validation mae = 3.257021
Validation band_gap mae = 3.257021
Epoch 31
Validation mae = 3.223712
Validation band_gap mae = 3.223712
Epoch 32
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Epoch 0
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Epoch 0
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Epoch 0
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Epoch 0
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Epoch 0
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 6.595015
Validation band_gap mae = 6.595015
Epoch 1
Validation mae = 6.013953
Validation band_gap mae = 6.013953
Epoch 2
Validation mae = 4.475356
Validation band_gap mae = 4.475356
Epoch 3
Validation mae = 9.540726
Validation band_gap mae = 9.540726
Epoch 4
Validation mae = 6.346656
Validation band_gap mae = 6.346656
Epoch 5
Validation mae = 4.948600
Validation band_gap mae = 4.948600
Epoch 6
Validation mae = 4.266847
Validation band_gap mae = 4.266847
Epoch 7
Validation mae = 4.655520
Validation band_gap mae = 4.655520
Epoch 8
Validation mae = 4.155744
Validation band_gap mae = 4.155744
Epoch 9
Validation mae = 3.762876
Validation band_gap mae = 3.762876
Epoch 10
Validation mae = 3.847368
Validation band_gap mae = 3.847368
Epoch 11
Validation mae = 3.443837
Validation band_gap mae = 3.443837
Epoch 12
Validation mae = 3.626364
Validation band_gap mae = 3.626364
Epoch 13
Validation mae = 3.661052
Validation band_gap mae = 3.661052
Epoch 14
Validation mae = 3.313189
Validation band_gap mae = 3.313189
Epoch 15
Validation mae = 3.651276
Validation band_gap mae = 3.651276
Epoch 16
Validation mae = 3.295345
Validation band_gap mae = 3.295345
Epoch 17
Validation mae = 3.825139
Validation band_gap mae = 3.825139
Epoch 18
Validation mae = 3.472521
Validation band_gap mae = 3.472521
Epoch 19
Validation mae = 3.304088
Validation band_gap mae = 3.304088
Epoch 20
Validation mae = 3.192994
Validation band_gap mae = 3.192994
Epoch 21
Validation mae = 3.300116
Validation band_gap mae = 3.300116
Epoch 22
Validation mae = 3.477501
Validation band_gap mae = 3.477501
Epoch 23
Validation mae = 3.178758
Validation band_gap mae = 3.178758
Epoch 24
Validation mae = 3.306412
Validation band_gap mae = 3.306412
Epoch 25
Validation mae = 3.412843
Validation band_gap mae = 3.412843
Epoch 26
Validation mae = 3.254141
Validation band_gap mae = 3.254141
Epoch 27
Validation mae = 3.138211
Validation band_gap mae = 3.138211
Epoch 28
Validation mae = 3.216623
Validation band_gap mae = 3.216623
Epoch 29
Validation mae = 3.297913
Validation band_gap mae = 3.297913
Epoch 30
Validation mae = 3.366294
Validation band_gap mae = 3.366294
Epoch 31
Validation mae = 3.318335
Validation band_gap mae = 3.318335
Epoch 32
Validation mae = 3.242364
Validation band_gap mae = 3.242364
Epoch 33
Validation mae = 3.285773
Validation band_gap mae = 3.285773
Epoch 34
Validation mae = 3.098771
Validation band_gap mae = 3.098771
Epoch 35
Validation mae = 3.211144
Validation band_gap mae = 3.211144
Epoch 36
Validation mae = 3.455501
Validation band_gap mae = 3.455501
Epoch 37
Validation mae = 3.265712
Validation band_gap mae = 3.265712
Epoch 38
Validation mae = 3.340635
Validation band_gap mae = 3.340635
Epoch 39
Validation mae = 3.279619
Validation band_gap mae = 3.279619
Epoch 40
Validation mae = 3.093087
Validation band_gap mae = 3.093087
Epoch 41
Validation mae = 3.463466
Validation band_gap mae = 3.463466
Epoch 42
Validation mae = 3.146917
Validation band_gap mae = 3.146917
Epoch 43
Validation mae = 3.157215
Validation band_gap mae = 3.157215
Epoch 44
Validation mae = 3.221840
Validation band_gap mae = 3.221840
Epoch 45
Validation mae = 3.923673
Validation band_gap mae = 3.923673
Epoch 46
Validation mae = 3.682406
Validation band_gap mae = 3.682406
Epoch 47
Validation mae = 3.380399
Validation band_gap mae = 3.380399
Epoch 48
Validation mae = 3.302788
Validation band_gap mae = 3.302788
Epoch 49
Validation mae = 3.221453
Validation band_gap mae = 3.221453
Epoch 50
Validation mae = 3.319256
Validation band_gap mae = 3.319256
Epoch 51
Validation mae = 3.236487
Validation band_gap mae = 3.236487
Epoch 52
Validation mae = 3.382974
Validation band_gap mae = 3.382974
Epoch 53
Validation mae = 3.244106
Validation band_gap mae = 3.244106
Epoch 54
Validation mae = 3.391035
Validation band_gap mae = 3.391035
Epoch 55
Validation mae = 3.411318
Validation band_gap mae = 3.411318
Epoch 56
Validation mae = 3.352405
Validation band_gap mae = 3.352405
Epoch 57
Validation mae = 3.249256
Validation band_gap mae = 3.249256
Epoch 58
Validation mae = 3.292746
Validation band_gap mae = 3.292746
Epoch 59
Validation mae = 3.347183
Validation band_gap mae = 3.347183
Epoch 60
Validation mae = 3.105320
Validation band_gap mae = 3.105320
Epoch 61
Validation mae = 3.237453
Validation band_gap mae = 3.237453
Epoch 62
Validation mae = 3.312104
Validation band_gap mae = 3.312104
Epoch 63
Validation mae = 3.417391
Validation band_gap mae = 3.417391
Epoch 64
Validation mae = 3.432005
Validation band_gap mae = 3.432005
Epoch 65
Validation mae = 3.435204
Validation band_gap mae = 3.435204
Epoch 66
Validation mae = 3.370858
Validation band_gap mae = 3.370858
Epoch 67
Validation mae = 3.278811
Validation band_gap mae = 3.278811
Epoch 68
Validation mae = 3.306301
Validation band_gap mae = 3.306301
Epoch 69
Validation mae = 3.456467
Validation band_gap mae = 3.456467
Epoch 70
Validation mae = 3.385934
Validation band_gap mae = 3.385934
Epoch 71
Validation mae = 3.555479
Validation band_gap mae = 3.555479
Epoch 72
Validation mae = 3.408207
Validation band_gap mae = 3.408207
Epoch 73
Validation mae = 3.416599
Validation band_gap mae = 3.416599
Epoch 74
Validation mae = 3.379536
Validation band_gap mae = 3.379536
Epoch 75
Validation mae = 3.319000
Validation band_gap mae = 3.319000
Epoch 76
Validation mae = 3.498965
Validation band_gap mae = 3.498965
Epoch 77
Validation mae = 3.379058
Validation band_gap mae = 3.379058
Epoch 78
Validation mae = 3.289721
Validation band_gap mae = 3.289721
Epoch 79
Validation mae = 3.282544
Validation band_gap mae = 3.282544
Epoch 80
Validation mae = 3.439678
Validation band_gap mae = 3.439678
Epoch 81
Validation mae = 3.386925
Validation band_gap mae = 3.386925
Epoch 82
Validation mae = 3.436572
Validation band_gap mae = 3.436572
Epoch 83
Validation mae = 3.359898
Validation band_gap mae = 3.359898
Epoch 84
Validation mae = 3.307903
Validation band_gap mae = 3.307903
Epoch 85
Validation mae = 3.375804
Validation band_gap mae = 3.375804
Epoch 86
Validation mae = 3.373781
Validation band_gap mae = 3.373781
Epoch 87
Validation mae = 3.497394
Validation band_gap mae = 3.497394
Epoch 88
Validation mae = 3.314188
Validation band_gap mae = 3.314188
Epoch 89
Validation mae = 3.433471
Validation band_gap mae = 3.433471
Epoch 90
Validation mae = 3.228830
Validation band_gap mae = 3.228830
Epoch 91
Validation mae = 3.280015
Validation band_gap mae = 3.280015
Epoch 92
Validation mae = 3.254642
Validation band_gap mae = 3.254642
Epoch 93
Validation mae = 3.325485
Validation band_gap mae = 3.325485
Epoch 94
Validation mae = 3.296253
Validation band_gap mae = 3.296253
Epoch 95
Validation mae = 3.295161
Validation band_gap mae = 3.295161
Epoch 96
Validation mae = 3.209106
Validation band_gap mae = 3.209106
Epoch 97
Validation mae = 3.473923
Validation band_gap mae = 3.473923
Epoch 98
Validation mae = 3.366230
Validation band_gap mae = 3.366230
Epoch 99
Validation mae = 3.341217
Validation band_gap mae = 3.341217
Model 0 best validation mae = 9.540726 on epoch 3
Moving model to cuda
Model 0 test mae = 6.978208
Model 0 test band_gap mae = 6.978208
Ensemble test mae = 6.978208
Ensemble test band_gap mae = 6.978208
==================== fold 1 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 1.527618
Validation band_gap mae = 1.527618
Epoch 1
Validation mae = 1.554676
Validation band_gap mae = 1.554676
Epoch 2
Validation mae = 1.410268
Validation band_gap mae = 1.410268
Epoch 3
Validation mae = 2.884015
Validation band_gap mae = 2.884015
Epoch 4
Validation mae = 1.927239
Validation band_gap mae = 1.927239
Epoch 5
Validation mae = 1.700769
Validation band_gap mae = 1.700769
Epoch 6
Validation mae = 1.594541
Validation band_gap mae = 1.594541
Epoch 7
Validation mae = 1.958257
Validation band_gap mae = 1.958257
Epoch 8
Validation mae = 1.985710
Validation band_gap mae = 1.985710
Epoch 9
Validation mae = 2.120433
Validation band_gap mae = 2.120433
Epoch 10
Validation mae = 2.364505
Validation band_gap mae = 2.364505
Epoch 11
Validation mae = 1.855869
Validation band_gap mae = 1.855869
Epoch 12
Validation mae = 1.787664
Validation band_gap mae = 1.787664
Epoch 13
Validation mae = 2.359118
Validation band_gap mae = 2.359118
Epoch 14
Validation mae = 1.877851
Validation band_gap mae = 1.877851
Epoch 15
Validation mae = 1.549653
Validation band_gap mae = 1.549653
Epoch 16
Validation mae = 1.873756
Validation band_gap mae = 1.873756
Epoch 17
Validation mae = 1.812237
Validation band_gap mae = 1.812237
Epoch 18
Validation mae = 1.727753
Validation band_gap mae = 1.727753
Epoch 19
Validation mae = 2.760220
Validation band_gap mae = 2.760220
Epoch 20
Validation mae = 1.516612
Validation band_gap mae = 1.516612
Epoch 21
Validation mae = 1.774928
Validation band_gap mae = 1.774928
Epoch 22
Validation mae = 1.872062
Validation band_gap mae = 1.872062
Epoch 23
Validation mae = 1.614299
Validation band_gap mae = 1.614299
Epoch 24
Validation mae = 2.824083
Validation band_gap mae = 2.824083
Epoch 25
Validation mae = 1.988480
Validation band_gap mae = 1.988480
Epoch 26
Validation mae = 2.704017
Validation band_gap mae = 2.704017
Epoch 27
Validation mae = 2.599251
Validation band_gap mae = 2.599251
Epoch 28
Validation mae = 2.133299
Validation band_gap mae = 2.133299
Epoch 29
Validation mae = 1.651493
Validation band_gap mae = 1.651493
Epoch 30
Validation mae = 2.320262
Validation band_gap mae = 2.320262
Epoch 31
Validation mae = 1.418925
Validation band_gap mae = 1.418925
Epoch 32
Validation mae = 2.234906
Validation band_gap mae = 2.234906
Epoch 33
Validation mae = 1.875785
Validation band_gap mae = 1.875785
Epoch 34
Validation mae = 1.511412
Validation band_gap mae = 1.511412
Epoch 35
Validation mae = 1.623418
Validation band_gap mae = 1.623418
Epoch 36
Validation mae = 2.076173
Validation band_gap mae = 2.076173
Epoch 37
Validation mae = 1.660080
Validation band_gap mae = 1.660080
Epoch 38
Validation mae = 1.867234
Validation band_gap mae = 1.867234
Epoch 39
Validation mae = 1.875314
Validation band_gap mae = 1.875314
Epoch 40
Validation mae = 1.843791
Validation band_gap mae = 1.843791
Epoch 41
Validation mae = 1.951657
Validation band_gap mae = 1.951657
Epoch 42
Validation mae = 2.508393
Validation band_gap mae = 2.508393
Epoch 43
Validation mae = 1.778941
Validation band_gap mae = 1.778941
Epoch 44
Validation mae = 2.331142
Validation band_gap mae = 2.331142
Epoch 45
Validation mae = 1.488517
Validation band_gap mae = 1.488517
Epoch 46
Validation mae = 1.980290
Validation band_gap mae = 1.980290
Epoch 47
Validation mae = 2.163613
Validation band_gap mae = 2.163613
Epoch 48
Validation mae = 1.922193
Validation band_gap mae = 1.922193
Epoch 49
Validation mae = 2.301234
Validation band_gap mae = 2.301234
Epoch 50
Validation mae = 1.828338
Validation band_gap mae = 1.828338
Epoch 51
Validation mae = 2.425535
Validation band_gap mae = 2.425535
Epoch 52
Validation mae = 1.926211
Validation band_gap mae = 1.926211
Epoch 53
Validation mae = 2.635393
Validation band_gap mae = 2.635393
Epoch 54
Validation mae = 2.283635
Validation band_gap mae = 2.283635
Epoch 55
Validation mae = 1.819293
Validation band_gap mae = 1.819293
Epoch 56
Validation mae = 2.222110
Validation band_gap mae = 2.222110
Epoch 57
Validation mae = 2.152122
Validation band_gap mae = 2.152122
Epoch 58
Validation mae = 2.106662
Validation band_gap mae = 2.106662
Epoch 59
Validation mae = 1.745729
Validation band_gap mae = 1.745729
Epoch 60
Validation mae = 2.078088
Validation band_gap mae = 2.078088
Epoch 61
Validation mae = 2.148218
Validation band_gap mae = 2.148218
Epoch 62
Validation mae = 1.966310
Validation band_gap mae = 1.966310
Epoch 63
Validation mae = 3.368571
Validation band_gap mae = 3.368571
Epoch 64
Validation mae = 1.345248
Validation band_gap mae = 1.345248
Epoch 65
Validation mae = 1.846486
Validation band_gap mae = 1.846486
Epoch 66
Validation mae = 2.472744
Validation band_gap mae = 2.472744
Epoch 67
Validation mae = 2.030991
Validation band_gap mae = 2.030991
Epoch 68
Validation mae = 2.153153
Validation band_gap mae = 2.153153
Epoch 69
Validation mae = 2.440017
Validation band_gap mae = 2.440017
Epoch 70
Validation mae = 2.641671
Validation band_gap mae = 2.641671
Epoch 71
Validation mae = 1.645513
Validation band_gap mae = 1.645513
Epoch 72
Validation mae = 1.492104
Validation band_gap mae = 1.492104
Epoch 73
Validation mae = 2.165180
Validation band_gap mae = 2.165180
Epoch 74
Validation mae = 2.728531
Validation band_gap mae = 2.728531
Epoch 75
Validation mae = 2.337095
Validation band_gap mae = 2.337095
Epoch 76
Validation mae = 2.313785
Validation band_gap mae = 2.313785
Epoch 77
Validation mae = 2.166383
Validation band_gap mae = 2.166383
Epoch 78
Validation mae = 2.532519
Validation band_gap mae = 2.532519
Epoch 79
Validation mae = 2.342994
Validation band_gap mae = 2.342994
Epoch 80
Validation mae = 2.598131
Validation band_gap mae = 2.598131
Epoch 81
Validation mae = 2.274159
Validation band_gap mae = 2.274159
Epoch 82
Validation mae = 2.109204
Validation band_gap mae = 2.109204
Epoch 83
Validation mae = 2.559945
Validation band_gap mae = 2.559945
Epoch 84
Validation mae = 2.310920
Validation band_gap mae = 2.310920
Epoch 85
Validation mae = 2.494079
Validation band_gap mae = 2.494079
Epoch 86
Validation mae = 1.787919
Validation band_gap mae = 1.787919
Epoch 87
Validation mae = 2.450360
Validation band_gap mae = 2.450360
Epoch 88
Validation mae = 2.530418
Validation band_gap mae = 2.530418
Epoch 89
Validation mae = 2.269033
Validation band_gap mae = 2.269033
Epoch 90
Validation mae = 2.344700
Validation band_gap mae = 2.344700
Epoch 91
Validation mae = 2.482198
Validation band_gap mae = 2.482198
Epoch 92
Validation mae = 2.308724
Validation band_gap mae = 2.308724
Epoch 93
Validation mae = 2.492435
Validation band_gap mae = 2.492435
Epoch 94
Validation mae = 2.363692
Validation band_gap mae = 2.363692
Epoch 95
Validation mae = 2.457433
Validation band_gap mae = 2.457433
Epoch 96
Validation mae = 2.511759
Validation band_gap mae = 2.511759
Epoch 97
Validation mae = 2.275733
Validation band_gap mae = 2.275733
Epoch 98
Validation mae = 2.519390
Validation band_gap mae = 2.519390
Epoch 99
Validation mae = 2.355710
Validation band_gap mae = 2.355710
Model 0 best validation mae = 3.368571 on epoch 63
Moving model to cuda
Model 0 test mae = 1.662631
Model 0 test band_gap mae = 1.662631
Ensemble test mae = 1.662631
Ensemble test band_gap mae = 1.662631
==================== fold 2 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 1.675213
Validation band_gap mae = 1.675213
Epoch 1
Validation mae = 1.415110
Validation band_gap mae = 1.415110
Epoch 2
Validation mae = 1.571416
Validation band_gap mae = 1.571416
Epoch 3
Validation mae = 1.426069
Validation band_gap mae = 1.426069
Epoch 4
Validation mae = 1.374065
Validation band_gap mae = 1.374065
Epoch 5
Validation mae = 1.724782
Validation band_gap mae = 1.724782
Epoch 6
Validation mae = 1.439814
Validation band_gap mae = 1.439814
Epoch 7
Validation mae = 1.470755
Validation band_gap mae = 1.470755
Epoch 8
Validation mae = 1.523163
Validation band_gap mae = 1.523163
Epoch 9
Validation mae = 1.553864
Validation band_gap mae = 1.553864
Epoch 10
Validation mae = 1.332796
Validation band_gap mae = 1.332796
Epoch 11
Validation mae = 1.431148
Validation band_gap mae = 1.431148
Epoch 12
Validation mae = 1.325675
Validation band_gap mae = 1.325675
Epoch 13
Validation mae = 1.462974
Validation band_gap mae = 1.462974
Epoch 14
Validation mae = 1.481778
Validation band_gap mae = 1.481778
Epoch 15
Validation mae = 1.358769
Validation band_gap mae = 1.358769
Epoch 16
Validation mae = 1.423751
Validation band_gap mae = 1.423751
Epoch 17
Validation mae = 1.406923
Validation band_gap mae = 1.406923
Epoch 18
Validation mae = 1.468147
Validation band_gap mae = 1.468147
Epoch 19
Validation mae = 1.423030
Validation band_gap mae = 1.423030
Epoch 20
Validation mae = 1.390194
Validation band_gap mae = 1.390194
Epoch 21
Validation mae = 1.357632
Validation band_gap mae = 1.357632
Epoch 22
Validation mae = 1.357083
Validation band_gap mae = 1.357083
Epoch 23
Validation mae = 1.476130
Validation band_gap mae = 1.476130
Epoch 24
Validation mae = 1.354754
Validation band_gap mae = 1.354754
Epoch 25
Validation mae = 1.406002
Validation band_gap mae = 1.406002
Epoch 26
Validation mae = 1.359065
Validation band_gap mae = 1.359065
Epoch 27
Validation mae = 1.385021
Validation band_gap mae = 1.385021
Epoch 28
Validation mae = 1.444384
Validation band_gap mae = 1.444384
Epoch 29
Validation mae = 1.348897
Validation band_gap mae = 1.348897
Epoch 30
Validation mae = 1.353104
Validation band_gap mae = 1.353104
Epoch 31
Validation mae = 1.390524
Validation band_gap mae = 1.390524
Epoch 32
Validation mae = 1.427086
Validation band_gap mae = 1.427086
Epoch 33
Validation mae = 1.425797
Validation band_gap mae = 1.425797
Epoch 34
Validation mae = 1.426197
Validation band_gap mae = 1.426197
Epoch 35
Validation mae = 1.340396
Validation band_gap mae = 1.340396
Epoch 36
Validation mae = 1.533873
Validation band_gap mae = 1.533873
Epoch 37
Validation mae = 1.328901
Validation band_gap mae = 1.328901
Epoch 38
Validation mae = 1.347286
Validation band_gap mae = 1.347286
Epoch 39
Validation mae = 1.295786
Validation band_gap mae = 1.295786
Epoch 40
Validation mae = 1.403313
Validation band_gap mae = 1.403313
Epoch 41
Validation mae = 1.491148
Validation band_gap mae = 1.491148
Epoch 42
Validation mae = 1.431949
Validation band_gap mae = 1.431949
Epoch 43
Validation mae = 1.433980
Validation band_gap mae = 1.433980
Epoch 44
Validation mae = 1.325953
Validation band_gap mae = 1.325953
Epoch 45
Validation mae = 1.368884
Validation band_gap mae = 1.368884
Epoch 46
Validation mae = 1.330653
Validation band_gap mae = 1.330653
Epoch 47
Validation mae = 1.427461
Validation band_gap mae = 1.427461
Epoch 48
Validation mae = 1.406251
Validation band_gap mae = 1.406251
Epoch 49
Validation mae = 1.344041
Validation band_gap mae = 1.344041
Epoch 50
Validation mae = 1.362328
Validation band_gap mae = 1.362328
Epoch 51
Validation mae = 1.456585
Validation band_gap mae = 1.456585
Epoch 52
Validation mae = 1.367184
Validation band_gap mae = 1.367184
Epoch 53
Validation mae = 1.422086
Validation band_gap mae = 1.422086
Epoch 54
Validation mae = 1.368058
Validation band_gap mae = 1.368058
Epoch 55
Validation mae = 1.288079
Validation band_gap mae = 1.288079
Epoch 56
Validation mae = 1.295057
Validation band_gap mae = 1.295057
Epoch 57
Validation mae = 1.417463
Validation band_gap mae = 1.417463
Epoch 58
Validation mae = 1.425711
Validation band_gap mae = 1.425711
Epoch 59
Validation mae = 1.336882
Validation band_gap mae = 1.336882
Epoch 60
Validation mae = 1.313313
Validation band_gap mae = 1.313313
Epoch 61
Validation mae = 1.403801
Validation band_gap mae = 1.403801
Epoch 62
Validation mae = 1.288801
Validation band_gap mae = 1.288801
Epoch 63
Validation mae = 1.336518
Validation band_gap mae = 1.336518
Epoch 64
Validation mae = 1.348776
Validation band_gap mae = 1.348776
Epoch 65
Validation mae = 1.345170
Validation band_gap mae = 1.345170
Epoch 66
Validation mae = 1.306300
Validation band_gap mae = 1.306300
Epoch 67
Validation mae = 1.381780
Validation band_gap mae = 1.381780
Epoch 68
Validation mae = 1.402040
Validation band_gap mae = 1.402040
Epoch 69
Validation mae = 1.352132
Validation band_gap mae = 1.352132
Epoch 70
Validation mae = 1.314954
Validation band_gap mae = 1.314954
Epoch 71
Validation mae = 1.340109
Validation band_gap mae = 1.340109
Epoch 72
Validation mae = 1.346285
Validation band_gap mae = 1.346285
Epoch 73
Validation mae = 1.345887
Validation band_gap mae = 1.345887
Epoch 74
Validation mae = 1.385546
Validation band_gap mae = 1.385546
Epoch 75
Validation mae = 1.340513
Validation band_gap mae = 1.340513
Epoch 76
Validation mae = 1.344164
Validation band_gap mae = 1.344164
Epoch 77
Validation mae = 1.358191
Validation band_gap mae = 1.358191
Epoch 78
Validation mae = 1.350114
Validation band_gap mae = 1.350114
Epoch 79
Validation mae = 1.377212
Validation band_gap mae = 1.377212
Epoch 80
Validation mae = 1.351018
Validation band_gap mae = 1.351018
Epoch 81
Validation mae = 1.352068
Validation band_gap mae = 1.352068
Epoch 82
Validation mae = 1.379949
Validation band_gap mae = 1.379949
Epoch 83
Validation mae = 1.335657
Validation band_gap mae = 1.335657
Epoch 84
Validation mae = 1.374635
Validation band_gap mae = 1.374635
Epoch 85
Validation mae = 1.311616
Validation band_gap mae = 1.311616
Epoch 86
Validation mae = 1.391037
Validation band_gap mae = 1.391037
Epoch 87
Validation mae = 1.375961
Validation band_gap mae = 1.375961
Epoch 88
Validation mae = 1.339870
Validation band_gap mae = 1.339870
Epoch 89
Validation mae = 1.348373
Validation band_gap mae = 1.348373
Epoch 90
Validation mae = 1.350779
Validation band_gap mae = 1.350779
Epoch 91
Validation mae = 1.343045
Validation band_gap mae = 1.343045
Epoch 92
Validation mae = 1.385708
Validation band_gap mae = 1.385708
Epoch 93
Validation mae = 1.363943
Validation band_gap mae = 1.363943
Epoch 94
Validation mae = 1.373432
Validation band_gap mae = 1.373432
Epoch 95
Validation mae = 1.377817
Validation band_gap mae = 1.377817
Epoch 96
Validation mae = 1.394179
Validation band_gap mae = 1.394179
Epoch 97
Validation mae = 1.349418
Validation band_gap mae = 1.349418
Epoch 98
Validation mae = 1.374737
Validation band_gap mae = 1.374737
Epoch 99
Validation mae = 1.389527
Validation band_gap mae = 1.389527
Model 0 best validation mae = 1.724782 on epoch 5
Moving model to cuda
Model 0 test mae = 0.857358
Model 0 test band_gap mae = 0.857358
Ensemble test mae = 0.857358
Ensemble test band_gap mae = 0.857358
==================== fold 3 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 1.458222
Validation band_gap mae = 1.458222
Epoch 1
Validation mae = 1.466708
Validation band_gap mae = 1.466708
Epoch 2
Validation mae = 1.391804
Validation band_gap mae = 1.391804
Epoch 3
Validation mae = 1.417351
Validation band_gap mae = 1.417351
Epoch 4
Validation mae = 1.470282
Validation band_gap mae = 1.470282
Epoch 5
Validation mae = 1.396806
Validation band_gap mae = 1.396806
Epoch 6
Validation mae = 1.447785
Validation band_gap mae = 1.447785
Epoch 7
Validation mae = 1.422988
Validation band_gap mae = 1.422988
Epoch 8
Validation mae = 1.377166
Validation band_gap mae = 1.377166
Epoch 9
Validation mae = 1.384111
Validation band_gap mae = 1.384111
Epoch 10
Validation mae = 1.411835
Validation band_gap mae = 1.411835
Epoch 11
Validation mae = 1.555866
Validation band_gap mae = 1.555866
Epoch 12
Validation mae = 1.488127
Validation band_gap mae = 1.488127
Epoch 13
Validation mae = 1.505382
Validation band_gap mae = 1.505382
Epoch 14
Validation mae = 1.412402
Validation band_gap mae = 1.412402
Epoch 15
Validation mae = 1.398057
Validation band_gap mae = 1.398057
Epoch 16
Validation mae = 1.480937
Validation band_gap mae = 1.480937
Epoch 17
Validation mae = 1.434880
Validation band_gap mae = 1.434880
Epoch 18
Validation mae = 1.399346
Validation band_gap mae = 1.399346
Epoch 19
Validation mae = 1.551079
Validation band_gap mae = 1.551079
Epoch 20
Validation mae = 1.418573
Validation band_gap mae = 1.418573
Epoch 21
Validation mae = 1.508732
Validation band_gap mae = 1.508732
Epoch 22
Validation mae = 1.419392
Validation band_gap mae = 1.419392
Epoch 23
Validation mae = 1.419883
Validation band_gap mae = 1.419883
Epoch 24
Validation mae = 1.427089
Validation band_gap mae = 1.427089
Epoch 25
Validation mae = 1.440440
Validation band_gap mae = 1.440440
Epoch 26
Validation mae = 1.410778
Validation band_gap mae = 1.410778
Epoch 27
Validation mae = 1.417230
Validation band_gap mae = 1.417230
Epoch 28
Validation mae = 1.423254
Validation band_gap mae = 1.423254
Epoch 29
Validation mae = 1.436657
Validation band_gap mae = 1.436657
Epoch 30
Validation mae = 1.379874
Validation band_gap mae = 1.379874
Epoch 31
Validation mae = 1.433264
Validation band_gap mae = 1.433264
Epoch 32
Validation mae = 1.414537
Validation band_gap mae = 1.414537
Epoch 33
Validation mae = 1.377760
Validation band_gap mae = 1.377760
Epoch 34
Validation mae = 1.427634
Validation band_gap mae = 1.427634
Epoch 35
Validation mae = 1.402789
Validation band_gap mae = 1.402789
Epoch 36
Validation mae = 1.469412
Validation band_gap mae = 1.469412
Epoch 37
Validation mae = 1.418864
Validation band_gap mae = 1.418864
Epoch 38
Validation mae = 1.386806
Validation band_gap mae = 1.386806
Epoch 39
Validation mae = 1.367622
Validation band_gap mae = 1.367622
Epoch 40
Validation mae = 1.402598
Validation band_gap mae = 1.402598
Epoch 41
Validation mae = 1.421606
Validation band_gap mae = 1.421606
Epoch 42
Validation mae = 1.401724
Validation band_gap mae = 1.401724
Epoch 43
Validation mae = 1.413282
Validation band_gap mae = 1.413282
Epoch 44
Validation mae = 1.446939
Validation band_gap mae = 1.446939
Epoch 45
Validation mae = 1.358477
Validation band_gap mae = 1.358477
Epoch 46
Validation mae = 1.389526
Validation band_gap mae = 1.389526
Epoch 47
Validation mae = 1.416998
Validation band_gap mae = 1.416998
Epoch 48
Validation mae = 1.435379
Validation band_gap mae = 1.435379
Epoch 49
Validation mae = 1.402047
Validation band_gap mae = 1.402047
Epoch 50
Validation mae = 1.437790
Validation band_gap mae = 1.437790
Epoch 51
Validation mae = 1.438518
Validation band_gap mae = 1.438518
Epoch 52
Validation mae = 1.408306
Validation band_gap mae = 1.408306
Epoch 53
Validation mae = 1.406082
Validation band_gap mae = 1.406082
Epoch 54
Validation mae = 1.420257
Validation band_gap mae = 1.420257
Epoch 55
Validation mae = 1.434737
Validation band_gap mae = 1.434737
Epoch 56
Validation mae = 1.428964
Validation band_gap mae = 1.428964
Epoch 57
Validation mae = 1.407931
Validation band_gap mae = 1.407931
Epoch 58
Validation mae = 1.411451
Validation band_gap mae = 1.411451
Epoch 59
Validation mae = 1.439259
Validation band_gap mae = 1.439259
Epoch 60
Validation mae = 1.443068
Validation band_gap mae = 1.443068
Epoch 61
Validation mae = 1.425330
Validation band_gap mae = 1.425330
Epoch 62
Validation mae = 1.429520
Validation band_gap mae = 1.429520
Epoch 63
Validation mae = 1.439340
Validation band_gap mae = 1.439340
Epoch 64
Validation mae = 1.436001
Validation band_gap mae = 1.436001
Epoch 65
Validation mae = 1.426017
Validation band_gap mae = 1.426017
Epoch 66
Validation mae = 1.434711
Validation band_gap mae = 1.434711
Epoch 67
Validation mae = 1.412425
Validation band_gap mae = 1.412425
Epoch 68
Validation mae = 1.446409
Validation band_gap mae = 1.446409
Epoch 69
Validation mae = 1.411937
Validation band_gap mae = 1.411937
Epoch 70
Validation mae = 1.452761
Validation band_gap mae = 1.452761
Epoch 71
Validation mae = 1.442263
Validation band_gap mae = 1.442263
Epoch 72
Validation mae = 1.471934
Validation band_gap mae = 1.471934
Epoch 73
Validation mae = 1.491324
Validation band_gap mae = 1.491324
Epoch 74
Validation mae = 1.547180
Validation band_gap mae = 1.547180
Epoch 75
Validation mae = 1.443886
Validation band_gap mae = 1.443886
Epoch 76
Validation mae = 1.436065
Validation band_gap mae = 1.436065
Epoch 77
Validation mae = 1.445082
Validation band_gap mae = 1.445082
Epoch 78
Validation mae = 1.439768
Validation band_gap mae = 1.439768
Epoch 79
Validation mae = 1.481929
Validation band_gap mae = 1.481929
Epoch 80
Validation mae = 1.434939
Validation band_gap mae = 1.434939
Epoch 81
Validation mae = 1.432638
Validation band_gap mae = 1.432638
Epoch 82
Validation mae = 1.505799
Validation band_gap mae = 1.505799
Epoch 83
Validation mae = 1.426834
Validation band_gap mae = 1.426834
Epoch 84
Validation mae = 1.411656
Validation band_gap mae = 1.411656
Epoch 85
Validation mae = 1.449321
Validation band_gap mae = 1.449321
Epoch 86
Validation mae = 1.438172
Validation band_gap mae = 1.438172
Epoch 87
Validation mae = 1.423224
Validation band_gap mae = 1.423224
Epoch 88
Validation mae = 1.466584
Validation band_gap mae = 1.466584
Epoch 89
Validation mae = 1.425379
Validation band_gap mae = 1.425379
Epoch 90
Validation mae = 1.418575
Validation band_gap mae = 1.418575
Epoch 91
Validation mae = 1.450257
Validation band_gap mae = 1.450257
Epoch 92
Validation mae = 1.449837
Validation band_gap mae = 1.449837
Epoch 93
Validation mae = 1.443351
Validation band_gap mae = 1.443351
Epoch 94
Validation mae = 1.431505
Validation band_gap mae = 1.431505
Epoch 95
Validation mae = 1.471614
Validation band_gap mae = 1.471614
Epoch 96
Validation mae = 1.453600
Validation band_gap mae = 1.453600
Epoch 97
Validation mae = 1.416685
Validation band_gap mae = 1.416685
Epoch 98
Validation mae = 1.442949
Validation band_gap mae = 1.442949
Epoch 99
Validation mae = 1.450033
Validation band_gap mae = 1.450033
Model 0 best validation mae = 1.555866 on epoch 11
Moving model to cuda
Model 0 test mae = 0.680146
Model 0 test band_gap mae = 0.680146
Ensemble test mae = 0.680146
Ensemble test band_gap mae = 0.680146
==================== fold 4 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.734347
Validation band_gap mae = 0.734347
Epoch 1
Validation mae = 0.727193
Validation band_gap mae = 0.727193
Epoch 2
Validation mae = 0.923744
Validation band_gap mae = 0.923744
Epoch 3
Validation mae = 0.939587
Validation band_gap mae = 0.939587
Epoch 4
Validation mae = 0.443939
Validation band_gap mae = 0.443939
Epoch 5
Validation mae = 0.677569
Validation band_gap mae = 0.677569
Epoch 6
Validation mae = 0.800437
Validation band_gap mae = 0.800437
Epoch 7
Validation mae = 0.507183
Validation band_gap mae = 0.507183
Epoch 8
Validation mae = 0.442408
Validation band_gap mae = 0.442408
Epoch 9
Validation mae = 0.857747
Validation band_gap mae = 0.857747
Epoch 10
Validation mae = 0.338281
Validation band_gap mae = 0.338281
Epoch 11
Validation mae = 0.504785
Validation band_gap mae = 0.504785
Epoch 12
Validation mae = 0.691299
Validation band_gap mae = 0.691299
Epoch 13
Validation mae = 0.622788
Validation band_gap mae = 0.622788
Epoch 14
Validation mae = 0.364587
Validation band_gap mae = 0.364587
Epoch 15
Validation mae = 0.488378
Validation band_gap mae = 0.488378
Epoch 16
Validation mae = 0.441729
Validation band_gap mae = 0.441729
Epoch 17
Validation mae = 0.518181
Validation band_gap mae = 0.518181
Epoch 18
Validation mae = 0.606231
Validation band_gap mae = 0.606231
Epoch 19
Validation mae = 0.351528
Validation band_gap mae = 0.351528
Epoch 20
Validation mae = 0.476922
Validation band_gap mae = 0.476922
Epoch 21
Validation mae = 0.536036
Validation band_gap mae = 0.536036
Epoch 22
Validation mae = 0.668800
Validation band_gap mae = 0.668800
Epoch 23
Validation mae = 0.581231
Validation band_gap mae = 0.581231
Epoch 24
Validation mae = 0.459229
Validation band_gap mae = 0.459229
Epoch 25
Validation mae = 0.486330
Validation band_gap mae = 0.486330
Epoch 26
Validation mae = 0.542188
Validation band_gap mae = 0.542188
Epoch 27
Validation mae = 0.468828
Validation band_gap mae = 0.468828
Epoch 28
Validation mae = 0.401188
Validation band_gap mae = 0.401188
Epoch 29
Validation mae = 0.426378
Validation band_gap mae = 0.426378
Epoch 30
Validation mae = 0.359197
Validation band_gap mae = 0.359197
Epoch 31
Validation mae = 0.543765
Validation band_gap mae = 0.543765
Epoch 32
Validation mae = 0.521881
Validation band_gap mae = 0.521881
Epoch 33
Validation mae = 0.380467
Validation band_gap mae = 0.380467
Epoch 34
Validation mae = 0.415451
Validation band_gap mae = 0.415451
Epoch 35
Validation mae = 0.595910
Validation band_gap mae = 0.595910
Epoch 36
Validation mae = 0.495510
Validation band_gap mae = 0.495510
Epoch 37
Validation mae = 0.502337
Validation band_gap mae = 0.502337
Epoch 38
Validation mae = 0.361921
Validation band_gap mae = 0.361921
Epoch 39
Validation mae = 0.378455
Validation band_gap mae = 0.378455
Epoch 40
Validation mae = 0.396426
Validation band_gap mae = 0.396426
Epoch 41
Validation mae = 0.526999
Validation band_gap mae = 0.526999
Epoch 42
Validation mae = 0.389273
Validation band_gap mae = 0.389273
Epoch 43
Validation mae = 0.475043
Validation band_gap mae = 0.475043
Epoch 44
Validation mae = 0.365245
Validation band_gap mae = 0.365245
Epoch 45
Validation mae = 0.539465
Validation band_gap mae = 0.539465
Epoch 46
Validation mae = 0.429572
Validation band_gap mae = 0.429572
Epoch 47
Validation mae = 0.447796
Validation band_gap mae = 0.447796
Epoch 48
Validation mae = 0.468215
Validation band_gap mae = 0.468215
Epoch 49
Validation mae = 0.460686
Validation band_gap mae = 0.460686
Epoch 50
Validation mae = 0.433521
Validation band_gap mae = 0.433521
Epoch 51
Validation mae = 0.477367
Validation band_gap mae = 0.477367
Epoch 52
Validation mae = 0.487225
Validation band_gap mae = 0.487225
Epoch 53
Validation mae = 0.437624
Validation band_gap mae = 0.437624
Epoch 54
Validation mae = 0.387531
Validation band_gap mae = 0.387531
Epoch 55
Validation mae = 0.457002
Validation band_gap mae = 0.457002
Epoch 56
Validation mae = 0.346205
Validation band_gap mae = 0.346205
Epoch 57
Validation mae = 0.470644
Validation band_gap mae = 0.470644
Epoch 58
Validation mae = 0.450232
Validation band_gap mae = 0.450232
Epoch 59
Validation mae = 0.384417
Validation band_gap mae = 0.384417
Epoch 60
Validation mae = 0.362912
Validation band_gap mae = 0.362912
Epoch 61
Validation mae = 0.386507
Validation band_gap mae = 0.386507
Epoch 62
Validation mae = 0.433401
Validation band_gap mae = 0.433401
Epoch 63
Validation mae = 0.418474
Validation band_gap mae = 0.418474
Epoch 64
Validation mae = 0.410074
Validation band_gap mae = 0.410074
Epoch 65
Validation mae = 0.454884
Validation band_gap mae = 0.454884
Epoch 66
Validation mae = 0.387373
Validation band_gap mae = 0.387373
Epoch 67
Validation mae = 0.458352
Validation band_gap mae = 0.458352
Epoch 68
Validation mae = 0.459737
Validation band_gap mae = 0.459737
Epoch 69
Validation mae = 0.515108
Validation band_gap mae = 0.515108
Epoch 70
Validation mae = 0.432174
Validation band_gap mae = 0.432174
Epoch 71
Validation mae = 0.468885
Validation band_gap mae = 0.468885
Epoch 72
Validation mae = 0.508243
Validation band_gap mae = 0.508243
Epoch 73
Validation mae = 0.431170
Validation band_gap mae = 0.431170
Epoch 74
Validation mae = 0.509518
Validation band_gap mae = 0.509518
Epoch 75
Validation mae = 0.547904
Validation band_gap mae = 0.547904
Epoch 76
Validation mae = 0.434528
Validation band_gap mae = 0.434528
Epoch 77
Validation mae = 0.538398
Validation band_gap mae = 0.538398
Epoch 78
Validation mae = 0.439585
Validation band_gap mae = 0.439585
Epoch 79
Validation mae = 0.458728
Validation band_gap mae = 0.458728
Epoch 80
Validation mae = 0.447050
Validation band_gap mae = 0.447050
Epoch 81
Validation mae = 0.481263
Validation band_gap mae = 0.481263
Epoch 82
Validation mae = 0.467751
Validation band_gap mae = 0.467751
Epoch 83
Validation mae = 0.415216
Validation band_gap mae = 0.415216
Epoch 84
Validation mae = 0.463844
Validation band_gap mae = 0.463844
Epoch 85
Validation mae = 0.464171
Validation band_gap mae = 0.464171
Epoch 86
Validation mae = 0.454961
Validation band_gap mae = 0.454961
Epoch 87
Validation mae = 0.428685
Validation band_gap mae = 0.428685
Epoch 88
Validation mae = 0.500551
Validation band_gap mae = 0.500551
Epoch 89
Validation mae = 0.432291
Validation band_gap mae = 0.432291
Epoch 90
Validation mae = 0.452638
Validation band_gap mae = 0.452638
Epoch 91
Validation mae = 0.447921
Validation band_gap mae = 0.447921
Epoch 92
Validation mae = 0.442734
Validation band_gap mae = 0.442734
Epoch 93
Validation mae = 0.443528
Validation band_gap mae = 0.443528
Epoch 94
Validation mae = 0.457197
Validation band_gap mae = 0.457197
Epoch 95
Validation mae = 0.455366
Validation band_gap mae = 0.455366
Epoch 96
Validation mae = 0.415502
Validation band_gap mae = 0.415502
Epoch 97
Validation mae = 0.503282
Validation band_gap mae = 0.503282
Epoch 98
Validation mae = 0.471862
Validation band_gap mae = 0.471862
Epoch 99
Validation mae = 0.461953
Validation band_gap mae = 0.461953
Model 0 best validation mae = 0.939587 on epoch 3
Moving model to cuda
Model 0 test mae = 0.844119
Model 0 test band_gap mae = 0.844119
Ensemble test mae = 0.844119
Ensemble test band_gap mae = 0.844119
==================== fold 5 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.469918
Validation band_gap mae = 0.469918
Epoch 1
Validation mae = 0.480759
Validation band_gap mae = 0.480759
Epoch 2
Validation mae = 0.426482
Validation band_gap mae = 0.426482
Epoch 3
Validation mae = 0.454811
Validation band_gap mae = 0.454811
Epoch 4
Validation mae = 0.470384
Validation band_gap mae = 0.470384
Epoch 5
Validation mae = 0.474739
Validation band_gap mae = 0.474739
Epoch 6
Validation mae = 0.471544
Validation band_gap mae = 0.471544
Epoch 7
Validation mae = 0.428495
Validation band_gap mae = 0.428495
Epoch 8
Validation mae = 0.427252
Validation band_gap mae = 0.427252
Epoch 9
Validation mae = 0.490756
Validation band_gap mae = 0.490756
Epoch 10
Validation mae = 0.445881
Validation band_gap mae = 0.445881
Epoch 11
Validation mae = 0.450367
Validation band_gap mae = 0.450367
Epoch 12
Validation mae = 0.510958
Validation band_gap mae = 0.510958
Epoch 13
Validation mae = 0.432044
Validation band_gap mae = 0.432044
Epoch 14
Validation mae = 0.428267
Validation band_gap mae = 0.428267
Epoch 15
Validation mae = 0.417597
Validation band_gap mae = 0.417597
Epoch 16
Validation mae = 0.430816
Validation band_gap mae = 0.430816
Epoch 17
Validation mae = 0.421014
Validation band_gap mae = 0.421014
Epoch 18
Validation mae = 0.443146
Validation band_gap mae = 0.443146
Epoch 19
Validation mae = 0.419021
Validation band_gap mae = 0.419021
Epoch 20
Validation mae = 0.414328
Validation band_gap mae = 0.414328
Epoch 21
Validation mae = 0.446617
Validation band_gap mae = 0.446617
Epoch 22
Validation mae = 0.443311
Validation band_gap mae = 0.443311
Epoch 23
Validation mae = 0.472833
Validation band_gap mae = 0.472833
Epoch 24
Validation mae = 0.443040
Validation band_gap mae = 0.443040
Epoch 25
Validation mae = 0.422357
Validation band_gap mae = 0.422357
Epoch 26
Validation mae = 0.448061
Validation band_gap mae = 0.448061
Epoch 27
Validation mae = 0.427824
Validation band_gap mae = 0.427824
Epoch 28
Validation mae = 0.449475
Validation band_gap mae = 0.449475
Epoch 29
Validation mae = 0.431723
Validation band_gap mae = 0.431723
Epoch 30
Validation mae = 0.439611
Validation band_gap mae = 0.439611
Epoch 31
Validation mae = 0.436018
Validation band_gap mae = 0.436018
Epoch 32
Validation mae = 0.446972
Validation band_gap mae = 0.446972
Epoch 33
Validation mae = 0.431101
Validation band_gap mae = 0.431101
Epoch 34
Validation mae = 0.446613
Validation band_gap mae = 0.446613
Epoch 35
Validation mae = 0.447582
Validation band_gap mae = 0.447582
Epoch 36
Validation mae = 0.474060
Validation band_gap mae = 0.474060
Epoch 37
Validation mae = 0.474446
Validation band_gap mae = 0.474446
Epoch 38
Validation mae = 0.456020
Validation band_gap mae = 0.456020
Epoch 39
Validation mae = 0.453789
Validation band_gap mae = 0.453789
Epoch 40
Validation mae = 0.443137
Validation band_gap mae = 0.443137
Epoch 41
Validation mae = 0.437915
Validation band_gap mae = 0.437915
Epoch 42
Validation mae = 0.457855
Validation band_gap mae = 0.457855
Epoch 43
Validation mae = 0.465320
Validation band_gap mae = 0.465320
Epoch 44
Validation mae = 0.421948
Validation band_gap mae = 0.421948
Epoch 45
Validation mae = 0.437255
Validation band_gap mae = 0.437255
Epoch 46
Validation mae = 0.469340
Validation band_gap mae = 0.469340
Epoch 47
Validation mae = 0.444774
Validation band_gap mae = 0.444774
Epoch 48
Validation mae = 0.440269
Validation band_gap mae = 0.440269
Epoch 49
Validation mae = 0.461479
Validation band_gap mae = 0.461479
Epoch 50
Validation mae = 0.441627
Validation band_gap mae = 0.441627
Epoch 51
Validation mae = 0.449470
Validation band_gap mae = 0.449470
Epoch 52
Validation mae = 0.463397
Validation band_gap mae = 0.463397
Epoch 53
Validation mae = 0.456994
Validation band_gap mae = 0.456994
Epoch 54
Validation mae = 0.455275
Validation band_gap mae = 0.455275
Epoch 55
Validation mae = 0.451993
Validation band_gap mae = 0.451993
Epoch 56
Validation mae = 0.461267
Validation band_gap mae = 0.461267
Epoch 57
Validation mae = 0.440087
Validation band_gap mae = 0.440087
Epoch 58
Validation mae = 0.439335
Validation band_gap mae = 0.439335
Epoch 59
Validation mae = 0.461681
Validation band_gap mae = 0.461681
Epoch 60
Validation mae = 0.457563
Validation band_gap mae = 0.457563
Epoch 61
Validation mae = 0.460435
Validation band_gap mae = 0.460435
Epoch 62
Validation mae = 0.458264
Validation band_gap mae = 0.458264
Epoch 63
Validation mae = 0.437310
Validation band_gap mae = 0.437310
Epoch 64
Validation mae = 0.452236
Validation band_gap mae = 0.452236
Epoch 65
Validation mae = 0.450107
Validation band_gap mae = 0.450107
Epoch 66
Validation mae = 0.458096
Validation band_gap mae = 0.458096
Epoch 67
Validation mae = 0.435087
Validation band_gap mae = 0.435087
Epoch 68
Validation mae = 0.459430
Validation band_gap mae = 0.459430
Epoch 69
Validation mae = 0.493502
Validation band_gap mae = 0.493502
Epoch 70
Validation mae = 0.433770
Validation band_gap mae = 0.433770
Epoch 71
Validation mae = 0.460441
Validation band_gap mae = 0.460441
Epoch 72
Validation mae = 0.446475
Validation band_gap mae = 0.446475
Epoch 73
Validation mae = 0.474597
Validation band_gap mae = 0.474597
Epoch 74
Validation mae = 0.471220
Validation band_gap mae = 0.471220
Epoch 75
Validation mae = 0.443823
Validation band_gap mae = 0.443823
Epoch 76
Validation mae = 0.465752
Validation band_gap mae = 0.465752
Epoch 77
Validation mae = 0.426261
Validation band_gap mae = 0.426261
Epoch 78
Validation mae = 0.425342
Validation band_gap mae = 0.425342
Epoch 79
Validation mae = 0.461535
Validation band_gap mae = 0.461535
Epoch 80
Validation mae = 0.433697
Validation band_gap mae = 0.433697
Epoch 81
Validation mae = 0.431562
Validation band_gap mae = 0.431562
Epoch 82
Validation mae = 0.418328
Validation band_gap mae = 0.418328
Epoch 83
Validation mae = 0.432682
Validation band_gap mae = 0.432682
Epoch 84
Validation mae = 0.441150
Validation band_gap mae = 0.441150
Epoch 85
Validation mae = 0.443378
Validation band_gap mae = 0.443378
Epoch 86
Validation mae = 0.438996
Validation band_gap mae = 0.438996
Epoch 87
Validation mae = 0.453333
Validation band_gap mae = 0.453333
Epoch 88
Validation mae = 0.428943
Validation band_gap mae = 0.428943
Epoch 89
Validation mae = 0.451911
Validation band_gap mae = 0.451911
Epoch 90
Validation mae = 0.423406
Validation band_gap mae = 0.423406
Epoch 91
Validation mae = 0.436492
Validation band_gap mae = 0.436492
Epoch 92
Validation mae = 0.441252
Validation band_gap mae = 0.441252
Epoch 93
Validation mae = 0.438414
Validation band_gap mae = 0.438414
Epoch 94
Validation mae = 0.462088
Validation band_gap mae = 0.462088
Epoch 95
Validation mae = 0.432619
Validation band_gap mae = 0.432619
Epoch 96
Validation mae = 0.431520
Validation band_gap mae = 0.431520
Epoch 97
Validation mae = 0.431987
Validation band_gap mae = 0.431987
Epoch 98
Validation mae = 0.442513
Validation band_gap mae = 0.442513
Epoch 99
Validation mae = 0.444593
Validation band_gap mae = 0.444593
Model 0 best validation mae = 0.510958 on epoch 12
Moving model to cuda
Model 0 test mae = 0.161002
Model 0 test band_gap mae = 0.161002
Ensemble test mae = 0.161002
Ensemble test band_gap mae = 0.161002
==================== fold 6 ====================
Total size = 927 | train size = 742 | val size = 92 | test size = 93
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.849147
Validation band_gap mae = 0.849147
Epoch 1
Validation mae = 0.734355
Validation band_gap mae = 0.734355
Epoch 2
Validation mae = 0.873581
Validation band_gap mae = 0.873581
Epoch 3
Validation mae = 0.733401
Validation band_gap mae = 0.733401
Epoch 4
Validation mae = 0.757446
Validation band_gap mae = 0.757446
Epoch 5
Validation mae = 0.761620
Validation band_gap mae = 0.761620
Epoch 6
Validation mae = 0.789218
Validation band_gap mae = 0.789218
Epoch 7
Validation mae = 0.789931
Validation band_gap mae = 0.789931
Epoch 8
Validation mae = 0.762811
Validation band_gap mae = 0.762811
Epoch 9
Validation mae = 0.796960
Validation band_gap mae = 0.796960
Epoch 10
Validation mae = 0.740554
Validation band_gap mae = 0.740554
Epoch 11
Validation mae = 0.718989
Validation band_gap mae = 0.718989
Epoch 12
Validation mae = 0.769835
Validation band_gap mae = 0.769835
Epoch 13
Validation mae = 0.768378
Validation band_gap mae = 0.768378
Epoch 14
Validation mae = 0.838076
Validation band_gap mae = 0.838076
Epoch 15
Validation mae = 0.795825
Validation band_gap mae = 0.795825
Epoch 16
Validation mae = 0.741225
Validation band_gap mae = 0.741225
Epoch 17
Validation mae = 0.762642
Validation band_gap mae = 0.762642
Epoch 18
Validation mae = 0.724310
Validation band_gap mae = 0.724310
Epoch 19
Validation mae = 0.769870
Validation band_gap mae = 0.769870
Epoch 20
Validation mae = 0.720614
Validation band_gap mae = 0.720614
Epoch 21
Validation mae = 0.716688
Validation band_gap mae = 0.716688
Epoch 22
Validation mae = 0.710843
Validation band_gap mae = 0.710843
Epoch 23
Validation mae = 0.718230
Validation band_gap mae = 0.718230
Epoch 24
Validation mae = 0.726119
Validation band_gap mae = 0.726119
Epoch 25
Validation mae = 0.752452
Validation band_gap mae = 0.752452
Epoch 26
Validation mae = 0.715237
Validation band_gap mae = 0.715237
Epoch 27
Validation mae = 0.779265
Validation band_gap mae = 0.779265
Epoch 28
Validation mae = 0.784976
Validation band_gap mae = 0.784976
Epoch 29
Validation mae = 0.765254
Validation band_gap mae = 0.765254
Epoch 30
Validation mae = 0.720143
Validation band_gap mae = 0.720143
Epoch 31
Validation mae = 0.773569
Validation band_gap mae = 0.773569
Epoch 32
Validation mae = 0.773836
Validation band_gap mae = 0.773836
Epoch 33
Validation mae = 0.945081
Validation band_gap mae = 0.945081
Epoch 34
Validation mae = 0.719329
Validation band_gap mae = 0.719329
Epoch 35
Validation mae = 0.729196
Validation band_gap mae = 0.729196
Epoch 36
Validation mae = 0.811664
Validation band_gap mae = 0.811664
Epoch 37
Validation mae = 0.705082
Validation band_gap mae = 0.705082
Epoch 38
Validation mae = 0.712588
Validation band_gap mae = 0.712588
Epoch 39
Validation mae = 0.760556
Validation band_gap mae = 0.760556
Epoch 40
Validation mae = 0.752323
Validation band_gap mae = 0.752323
Epoch 41
Validation mae = 0.785385
Validation band_gap mae = 0.785385
Epoch 42
Validation mae = 0.729591
Validation band_gap mae = 0.729591
Epoch 43
Validation mae = 0.729670
Validation band_gap mae = 0.729670
Epoch 44
Validation mae = 0.794749
Validation band_gap mae = 0.794749
Epoch 45
Validation mae = 0.733999
Validation band_gap mae = 0.733999
Epoch 46
Validation mae = 0.752115
Validation band_gap mae = 0.752115
Epoch 47
Validation mae = 0.744270
Validation band_gap mae = 0.744270
Epoch 48
Validation mae = 0.734167
Validation band_gap mae = 0.734167
Epoch 49
Validation mae = 0.748729
Validation band_gap mae = 0.748729
Epoch 50
Validation mae = 0.746690
Validation band_gap mae = 0.746690
Epoch 51
Validation mae = 0.738885
Validation band_gap mae = 0.738885
Epoch 52
Validation mae = 0.763863
Validation band_gap mae = 0.763863
Epoch 53
Validation mae = 0.752276
Validation band_gap mae = 0.752276
Epoch 54
Validation mae = 0.759278
Validation band_gap mae = 0.759278
Epoch 55
Validation mae = 0.764101
Validation band_gap mae = 0.764101
Epoch 56
Validation mae = 0.759517
Validation band_gap mae = 0.759517
Epoch 57
Validation mae = 0.756206
Validation band_gap mae = 0.756206
Epoch 58
Validation mae = 0.754813
Validation band_gap mae = 0.754813
Epoch 59
Validation mae = 0.797351
Validation band_gap mae = 0.797351
Epoch 60
Validation mae = 0.758438
Validation band_gap mae = 0.758438
Epoch 61
Validation mae = 0.761737
Validation band_gap mae = 0.761737
Epoch 62
Validation mae = 0.802386
Validation band_gap mae = 0.802386
Epoch 63
Validation mae = 0.750589
Validation band_gap mae = 0.750589
Epoch 64
Validation mae = 0.754584
Validation band_gap mae = 0.754584
Epoch 65
Validation mae = 0.774036
Validation band_gap mae = 0.774036
Epoch 66
Validation mae = 0.761674
Validation band_gap mae = 0.761674
Epoch 67
Validation mae = 0.755463
Validation band_gap mae = 0.755463
Epoch 68
Validation mae = 0.760088
Validation band_gap mae = 0.760088
Epoch 69
Validation mae = 0.781908
Validation band_gap mae = 0.781908
Epoch 70
Validation mae = 0.789950
Validation band_gap mae = 0.789950
Epoch 71
Validation mae = 0.809459
Validation band_gap mae = 0.809459
Epoch 72
Validation mae = 0.792846
Validation band_gap mae = 0.792846
Epoch 73
Validation mae = 0.771022
Validation band_gap mae = 0.771022
Epoch 74
Validation mae = 0.774007
Validation band_gap mae = 0.774007
Epoch 75
Validation mae = 0.783520
Validation band_gap mae = 0.783520
Epoch 76
Validation mae = 0.777338
Validation band_gap mae = 0.777338
Epoch 77
Validation mae = 0.753411
Validation band_gap mae = 0.753411
Epoch 78
Validation mae = 0.749394
Validation band_gap mae = 0.749394
Epoch 79
Validation mae = 0.731939
Validation band_gap mae = 0.731939
Epoch 80
Validation mae = 0.782535
Validation band_gap mae = 0.782535
Epoch 81
Validation mae = 0.758948
Validation band_gap mae = 0.758948
Epoch 82
Validation mae = 0.769228
Validation band_gap mae = 0.769228
Epoch 83
Validation mae = 0.803074
Validation band_gap mae = 0.803074
Epoch 84
Validation mae = 0.744012
Validation band_gap mae = 0.744012
Epoch 85
Validation mae = 0.770345
Validation band_gap mae = 0.770345
Epoch 86
Validation mae = 0.816611
Validation band_gap mae = 0.816611
Epoch 87
Validation mae = 0.747849
Validation band_gap mae = 0.747849
Epoch 88
Validation mae = 0.765530
Validation band_gap mae = 0.765530
Epoch 89
Validation mae = 0.790086
Validation band_gap mae = 0.790086
Epoch 90
Validation mae = 0.778996
Validation band_gap mae = 0.778996
Epoch 91
Validation mae = 0.779794
Validation band_gap mae = 0.779794
Epoch 92
Validation mae = 0.780393
Validation band_gap mae = 0.780393
Epoch 93
Validation mae = 0.742259
Validation band_gap mae = 0.742259
Epoch 94
Validation mae = 0.773171
Validation band_gap mae = 0.773171
Epoch 95
Validation mae = 0.777292
Validation band_gap mae = 0.777292
Epoch 96
Validation mae = 0.789317
Validation band_gap mae = 0.789317
Epoch 97
Validation mae = 0.755473
Validation band_gap mae = 0.755473
Epoch 98
Validation mae = 0.773005
Validation band_gap mae = 0.773005
Epoch 99
Validation mae = 0.770163
Validation band_gap mae = 0.770163
Model 0 best validation mae = 0.945081 on epoch 33
Moving model to cuda
Model 0 test mae = 0.329211
Model 0 test band_gap mae = 0.329211
Ensemble test mae = 0.329211
Ensemble test band_gap mae = 0.329211
==================== fold 7 ====================
Total size = 927 | train size = 743 | val size = 92 | test size = 92
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 1.043231
Validation band_gap mae = 1.043231
Epoch 1
Validation mae = 0.792515
Validation band_gap mae = 0.792515
Epoch 2
Validation mae = 0.906311
Validation band_gap mae = 0.906311
Epoch 3
Validation mae = 0.798510
Validation band_gap mae = 0.798510
Epoch 4
Validation mae = 0.826112
Validation band_gap mae = 0.826112
Epoch 5
Validation mae = 0.816485
Validation band_gap mae = 0.816485
Epoch 6
Validation mae = 0.819508
Validation band_gap mae = 0.819508
Epoch 7
Validation mae = 0.879991
Validation band_gap mae = 0.879991
Epoch 8
Validation mae = 0.823611
Validation band_gap mae = 0.823611
Epoch 9
Validation mae = 0.831396
Validation band_gap mae = 0.831396
Epoch 10
Validation mae = 0.856637
Validation band_gap mae = 0.856637
Epoch 11
Validation mae = 0.993899
Validation band_gap mae = 0.993899
Epoch 12
Validation mae = 0.841479
Validation band_gap mae = 0.841479
Epoch 13
Validation mae = 0.811513
Validation band_gap mae = 0.811513
Epoch 14
Validation mae = 0.826074
Validation band_gap mae = 0.826074
Epoch 15
Validation mae = 0.820842
Validation band_gap mae = 0.820842
Epoch 16
Validation mae = 0.807746
Validation band_gap mae = 0.807746
Epoch 17
Validation mae = 0.824342
Validation band_gap mae = 0.824342
Epoch 18
Validation mae = 0.808932
Validation band_gap mae = 0.808932
Epoch 19
Validation mae = 0.840172
Validation band_gap mae = 0.840172
Epoch 20
Validation mae = 0.816944
Validation band_gap mae = 0.816944
Epoch 21
Validation mae = 0.882124
Validation band_gap mae = 0.882124
Epoch 22
Validation mae = 0.922847
Validation band_gap mae = 0.922847
Epoch 23
Validation mae = 0.827405
Validation band_gap mae = 0.827405
Epoch 24
Validation mae = 0.853368
Validation band_gap mae = 0.853368
Epoch 25
Validation mae = 0.853716
Validation band_gap mae = 0.853716
Epoch 26
Validation mae = 0.902020
Validation band_gap mae = 0.902020
Epoch 27
Validation mae = 0.798423
Validation band_gap mae = 0.798423
Epoch 28
Validation mae = 0.812746
Validation band_gap mae = 0.812746
Epoch 29
Validation mae = 0.853730
Validation band_gap mae = 0.853730
Epoch 30
Validation mae = 0.850426
Validation band_gap mae = 0.850426
Epoch 31
Validation mae = 0.804395
Validation band_gap mae = 0.804395
Epoch 32
Validation mae = 0.980859
Validation band_gap mae = 0.980859
Epoch 33
Validation mae = 0.835335
Validation band_gap mae = 0.835335
Epoch 34
Validation mae = 0.850985
Validation band_gap mae = 0.850985
Epoch 35
Validation mae = 0.807248
Validation band_gap mae = 0.807248
Epoch 36
Validation mae = 0.847287
Validation band_gap mae = 0.847287
Epoch 37
Validation mae = 0.806925
Validation band_gap mae = 0.806925
Epoch 38
Validation mae = 0.865143
Validation band_gap mae = 0.865143
Epoch 39
Validation mae = 0.879967
Validation band_gap mae = 0.879967
Epoch 40
Validation mae = 0.779817
Validation band_gap mae = 0.779817
Epoch 41
Validation mae = 0.907932
Validation band_gap mae = 0.907932
Epoch 42
Validation mae = 0.849165
Validation band_gap mae = 0.849165
Epoch 43
Validation mae = 0.796987
Validation band_gap mae = 0.796987
Epoch 44
Validation mae = 0.803700
Validation band_gap mae = 0.803700
Epoch 45
Validation mae = 0.847570
Validation band_gap mae = 0.847570
Epoch 46
Validation mae = 0.809858
Validation band_gap mae = 0.809858
Epoch 47
Validation mae = 0.799852
Validation band_gap mae = 0.799852
Epoch 48
Validation mae = 0.815773
Validation band_gap mae = 0.815773
Epoch 49
Validation mae = 0.791656
Validation band_gap mae = 0.791656
Epoch 50
Validation mae = 0.849133
Validation band_gap mae = 0.849133
Epoch 51
Validation mae = 0.794649
Validation band_gap mae = 0.794649
Epoch 52
Validation mae = 0.791871
Validation band_gap mae = 0.791871
Epoch 53
Validation mae = 0.795107
Validation band_gap mae = 0.795107
Epoch 54
Validation mae = 0.768074
Validation band_gap mae = 0.768074
Epoch 55
Validation mae = 0.799895
Validation band_gap mae = 0.799895
Epoch 56
Validation mae = 0.796453
Validation band_gap mae = 0.796453
Epoch 57
Validation mae = 0.814601
Validation band_gap mae = 0.814601
Epoch 58
Validation mae = 0.879561
Validation band_gap mae = 0.879561
Epoch 59
Validation mae = 0.801092
Validation band_gap mae = 0.801092
Epoch 60
Validation mae = 0.830913
Validation band_gap mae = 0.830913
Epoch 61
Validation mae = 0.783169
Validation band_gap mae = 0.783169
Epoch 62
Validation mae = 0.810000
Validation band_gap mae = 0.810000
Epoch 63
Validation mae = 0.783073
Validation band_gap mae = 0.783073
Epoch 64
Validation mae = 0.800516
Validation band_gap mae = 0.800516
Epoch 65
Validation mae = 0.795932
Validation band_gap mae = 0.795932
Epoch 66
Validation mae = 0.800233
Validation band_gap mae = 0.800233
Epoch 67
Validation mae = 0.805763
Validation band_gap mae = 0.805763
Epoch 68
Validation mae = 0.806011
Validation band_gap mae = 0.806011
Epoch 69
Validation mae = 0.809620
Validation band_gap mae = 0.809620
Epoch 70
Validation mae = 0.804024
Validation band_gap mae = 0.804024
Epoch 71
Validation mae = 0.804660
Validation band_gap mae = 0.804660
Epoch 72
Validation mae = 0.802424
Validation band_gap mae = 0.802424
Epoch 73
Validation mae = 0.807969
Validation band_gap mae = 0.807969
Epoch 74
Validation mae = 0.797870
Validation band_gap mae = 0.797870
Epoch 75
Validation mae = 0.806703
Validation band_gap mae = 0.806703
Epoch 76
Validation mae = 0.815981
Validation band_gap mae = 0.815981
Epoch 77
Validation mae = 0.799570
Validation band_gap mae = 0.799570
Epoch 78
Validation mae = 0.815896
Validation band_gap mae = 0.815896
Epoch 79
Validation mae = 0.803418
Validation band_gap mae = 0.803418
Epoch 80
Validation mae = 0.807049
Validation band_gap mae = 0.807049
Epoch 81
Validation mae = 0.793660
Validation band_gap mae = 0.793660
Epoch 82
Validation mae = 0.814192
Validation band_gap mae = 0.814192
Epoch 83
Validation mae = 0.799855
Validation band_gap mae = 0.799855
Epoch 84
Validation mae = 0.807658
Validation band_gap mae = 0.807658
Epoch 85
Validation mae = 0.804245
Validation band_gap mae = 0.804245
Epoch 86
Validation mae = 0.811435
Validation band_gap mae = 0.811435
Epoch 87
Validation mae = 0.822894
Validation band_gap mae = 0.822894
Epoch 88
Validation mae = 0.799107
Validation band_gap mae = 0.799107
Epoch 89
Validation mae = 0.818823
Validation band_gap mae = 0.818823
Epoch 90
Validation mae = 0.804328
Validation band_gap mae = 0.804328
Epoch 91
Validation mae = 0.805280
Validation band_gap mae = 0.805280
Epoch 92
Validation mae = 0.820457
Validation band_gap mae = 0.820457
Epoch 93
Validation mae = 0.817211
Validation band_gap mae = 0.817211
Epoch 94
Validation mae = 0.815043
Validation band_gap mae = 0.815043
Epoch 95
Validation mae = 0.816552
Validation band_gap mae = 0.816552
Epoch 96
Validation mae = 0.815061
Validation band_gap mae = 0.815061
Epoch 97
Validation mae = 0.816088
Validation band_gap mae = 0.816088
Epoch 98
Validation mae = 0.815643
Validation band_gap mae = 0.815643
Epoch 99
Validation mae = 0.814200
Validation band_gap mae = 0.814200
Model 0 best validation mae = 1.043231 on epoch 0
Moving model to cuda
Model 0 test mae = 0.515078
Model 0 test band_gap mae = 0.515078
Ensemble test mae = 0.515078
Ensemble test band_gap mae = 0.515078
==================== fold 8 ====================
Total size = 927 | train size = 743 | val size = 92 | test size = 92
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.981767
Validation band_gap mae = 0.981767
Epoch 1
Validation mae = 0.943425
Validation band_gap mae = 0.943425
Epoch 2
Validation mae = 0.756919
Validation band_gap mae = 0.756919
Epoch 3
Validation mae = 0.857888
Validation band_gap mae = 0.857888
Epoch 4
Validation mae = 0.847583
Validation band_gap mae = 0.847583
Epoch 5
Validation mae = 0.816882
Validation band_gap mae = 0.816882
Epoch 6
Validation mae = 0.748527
Validation band_gap mae = 0.748527
Epoch 7
Validation mae = 0.941737
Validation band_gap mae = 0.941737
Epoch 8
Validation mae = 0.701979
Validation band_gap mae = 0.701979
Epoch 9
Validation mae = 0.725154
Validation band_gap mae = 0.725154
Epoch 10
Validation mae = 0.754972
Validation band_gap mae = 0.754972
Epoch 11
Validation mae = 0.826762
Validation band_gap mae = 0.826762
Epoch 12
Validation mae = 0.864554
Validation band_gap mae = 0.864554
Epoch 13
Validation mae = 0.713821
Validation band_gap mae = 0.713821
Epoch 14
Validation mae = 0.723085
Validation band_gap mae = 0.723085
Epoch 15
Validation mae = 0.669281
Validation band_gap mae = 0.669281
Epoch 16
Validation mae = 0.688887
Validation band_gap mae = 0.688887
Epoch 17
Validation mae = 0.702224
Validation band_gap mae = 0.702224
Epoch 18
Validation mae = 0.748889
Validation band_gap mae = 0.748889
Epoch 19
Validation mae = 0.661389
Validation band_gap mae = 0.661389
Epoch 20
Validation mae = 0.719179
Validation band_gap mae = 0.719179
Epoch 21
Validation mae = 0.720878
Validation band_gap mae = 0.720878
Epoch 22
Validation mae = 0.757605
Validation band_gap mae = 0.757605
Epoch 23
Validation mae = 0.822621
Validation band_gap mae = 0.822621
Epoch 24
Validation mae = 0.774734
Validation band_gap mae = 0.774734
Epoch 25
Validation mae = 0.691698
Validation band_gap mae = 0.691698
Epoch 26
Validation mae = 0.702433
Validation band_gap mae = 0.702433
Epoch 27
Validation mae = 0.749651
Validation band_gap mae = 0.749651
Epoch 28
Validation mae = 0.729696
Validation band_gap mae = 0.729696
Epoch 29
Validation mae = 0.844314
Validation band_gap mae = 0.844314
Epoch 30
Validation mae = 0.713311
Validation band_gap mae = 0.713311
Epoch 31
Validation mae = 0.754289
Validation band_gap mae = 0.754289
Epoch 32
Validation mae = 0.734376
Validation band_gap mae = 0.734376
Epoch 33
Validation mae = 0.809449
Validation band_gap mae = 0.809449
Epoch 34
Validation mae = 0.788698
Validation band_gap mae = 0.788698
Epoch 35
Validation mae = 0.652972
Validation band_gap mae = 0.652972
Epoch 36
Validation mae = 0.868187
Validation band_gap mae = 0.868187
Epoch 37
Validation mae = 0.808371
Validation band_gap mae = 0.808371
Epoch 38
Validation mae = 0.815438
Validation band_gap mae = 0.815438
Epoch 39
Validation mae = 0.705881
Validation band_gap mae = 0.705881
Epoch 40
Validation mae = 0.800163
Validation band_gap mae = 0.800163
Epoch 41
Validation mae = 0.690582
Validation band_gap mae = 0.690582
Epoch 42
Validation mae = 0.777767
Validation band_gap mae = 0.777767
Epoch 43
Validation mae = 0.756630
Validation band_gap mae = 0.756630
Epoch 44
Validation mae = 0.702337
Validation band_gap mae = 0.702337
Epoch 45
Validation mae = 0.754295
Validation band_gap mae = 0.754295
Epoch 46
Validation mae = 0.753558
Validation band_gap mae = 0.753558
Epoch 47
Validation mae = 0.729414
Validation band_gap mae = 0.729414
Epoch 48
Validation mae = 0.791906
Validation band_gap mae = 0.791906
Epoch 49
Validation mae = 0.718973
Validation band_gap mae = 0.718973
Epoch 50
Validation mae = 0.896943
Validation band_gap mae = 0.896943
Epoch 51
Validation mae = 0.724597
Validation band_gap mae = 0.724597
Epoch 52
Validation mae = 0.710330
Validation band_gap mae = 0.710330
Epoch 53
Validation mae = 0.652368
Validation band_gap mae = 0.652368
Epoch 54
Validation mae = 0.682149
Validation band_gap mae = 0.682149
Epoch 55
Validation mae = 0.798952
Validation band_gap mae = 0.798952
Epoch 56
Validation mae = 0.746944
Validation band_gap mae = 0.746944
Epoch 57
Validation mae = 0.713624
Validation band_gap mae = 0.713624
Epoch 58
Validation mae = 0.738570
Validation band_gap mae = 0.738570
Epoch 59
Validation mae = 0.697777
Validation band_gap mae = 0.697777
Epoch 60
Validation mae = 0.781582
Validation band_gap mae = 0.781582
Epoch 61
Validation mae = 0.659569
Validation band_gap mae = 0.659569
Epoch 62
Validation mae = 0.694947
Validation band_gap mae = 0.694947
Epoch 63
Validation mae = 0.660950
Validation band_gap mae = 0.660950
Epoch 64
Validation mae = 0.719054
Validation band_gap mae = 0.719054
Epoch 65
Validation mae = 0.657878
Validation band_gap mae = 0.657878
Epoch 66
Validation mae = 0.700315
Validation band_gap mae = 0.700315
Epoch 67
Validation mae = 0.711397
Validation band_gap mae = 0.711397
Epoch 68
Validation mae = 0.718391
Validation band_gap mae = 0.718391
Epoch 69
Validation mae = 0.667608
Validation band_gap mae = 0.667608
Epoch 70
Validation mae = 0.653420
Validation band_gap mae = 0.653420
Epoch 71
Validation mae = 0.692773
Validation band_gap mae = 0.692773
Epoch 72
Validation mae = 0.674671
Validation band_gap mae = 0.674671
Epoch 73
Validation mae = 0.685041
Validation band_gap mae = 0.685041
Epoch 74
Validation mae = 0.721367
Validation band_gap mae = 0.721367
Epoch 75
Validation mae = 0.683573
Validation band_gap mae = 0.683573
Epoch 76
Validation mae = 0.718694
Validation band_gap mae = 0.718694
Epoch 77
Validation mae = 0.678582
Validation band_gap mae = 0.678582
Epoch 78
Validation mae = 0.735842
Validation band_gap mae = 0.735842
Epoch 79
Validation mae = 0.672123
Validation band_gap mae = 0.672123
Epoch 80
Validation mae = 0.697537
Validation band_gap mae = 0.697537
Epoch 81
Validation mae = 0.707391
Validation band_gap mae = 0.707391
Epoch 82
Validation mae = 0.703674
Validation band_gap mae = 0.703674
Epoch 83
Validation mae = 0.720122
Validation band_gap mae = 0.720122
Epoch 84
Validation mae = 0.722177
Validation band_gap mae = 0.722177
Epoch 85
Validation mae = 0.680803
Validation band_gap mae = 0.680803
Epoch 86
Validation mae = 0.687126
Validation band_gap mae = 0.687126
Epoch 87
Validation mae = 0.705165
Validation band_gap mae = 0.705165
Epoch 88
Validation mae = 0.714012
Validation band_gap mae = 0.714012
Epoch 89
Validation mae = 0.767466
Validation band_gap mae = 0.767466
Epoch 90
Validation mae = 0.697357
Validation band_gap mae = 0.697357
Epoch 91
Validation mae = 0.787248
Validation band_gap mae = 0.787248
Epoch 92
Validation mae = 0.759500
Validation band_gap mae = 0.759500
Epoch 93
Validation mae = 0.715123
Validation band_gap mae = 0.715123
Epoch 94
Validation mae = 0.706892
Validation band_gap mae = 0.706892
Epoch 95
Validation mae = 0.706345
Validation band_gap mae = 0.706345
Epoch 96
Validation mae = 0.704076
Validation band_gap mae = 0.704076
Epoch 97
Validation mae = 0.702666
Validation band_gap mae = 0.702666
Epoch 98
Validation mae = 0.702142
Validation band_gap mae = 0.702142
Epoch 99
Validation mae = 0.693237
Validation band_gap mae = 0.693237
Model 0 best validation mae = 0.981767 on epoch 0
Moving model to cuda
Model 0 test mae = 0.458283
Model 0 test band_gap mae = 0.458283
Ensemble test mae = 0.458283
Ensemble test band_gap mae = 0.458283
==================== fold 9 ====================
Total size = 927 | train size = 743 | val size = 92 | test size = 92
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.811534
Validation band_gap mae = 0.811534
Epoch 1
Validation mae = 0.555288
Validation band_gap mae = 0.555288
Epoch 2
Validation mae = 0.729973
Validation band_gap mae = 0.729973
Epoch 3
Validation mae = 0.577113
Validation band_gap mae = 0.577113
Epoch 4
Validation mae = 0.546930
Validation band_gap mae = 0.546930
Epoch 5
Validation mae = 0.453261
Validation band_gap mae = 0.453261
Epoch 6
Validation mae = 0.463394
Validation band_gap mae = 0.463394
Epoch 7
Validation mae = 0.601834
Validation band_gap mae = 0.601834
Epoch 8
Validation mae = 0.465290
Validation band_gap mae = 0.465290
Epoch 9
Validation mae = 0.475302
Validation band_gap mae = 0.475302
Epoch 10
Validation mae = 0.554480
Validation band_gap mae = 0.554480
Epoch 11
Validation mae = 0.491602
Validation band_gap mae = 0.491602
Epoch 12
Validation mae = 0.463461
Validation band_gap mae = 0.463461
Epoch 13
Validation mae = 0.506331
Validation band_gap mae = 0.506331
Epoch 14
Validation mae = 0.457193
Validation band_gap mae = 0.457193
Epoch 15
Validation mae = 0.569925
Validation band_gap mae = 0.569925
Epoch 16
Validation mae = 0.550651
Validation band_gap mae = 0.550651
Epoch 17
Validation mae = 0.471516
Validation band_gap mae = 0.471516
Epoch 18
Validation mae = 0.462381
Validation band_gap mae = 0.462381
Epoch 19
Validation mae = 0.469322
Validation band_gap mae = 0.469322
Epoch 20
Validation mae = 0.527019
Validation band_gap mae = 0.527019
Epoch 21
Validation mae = 0.564832
Validation band_gap mae = 0.564832
Epoch 22
Validation mae = 0.462646
Validation band_gap mae = 0.462646
Epoch 23
Validation mae = 0.460362
Validation band_gap mae = 0.460362
Epoch 24
Validation mae = 0.597143
Validation band_gap mae = 0.597143
Epoch 25
Validation mae = 0.508927
Validation band_gap mae = 0.508927
Epoch 26
Validation mae = 0.548533
Validation band_gap mae = 0.548533
Epoch 27
Validation mae = 0.437396
Validation band_gap mae = 0.437396
Epoch 28
Validation mae = 0.459122
Validation band_gap mae = 0.459122
Epoch 29
Validation mae = 0.453914
Validation band_gap mae = 0.453914
Epoch 30
Validation mae = 0.501135
Validation band_gap mae = 0.501135
Epoch 31
Validation mae = 0.492356
Validation band_gap mae = 0.492356
Epoch 32
Validation mae = 0.483875
Validation band_gap mae = 0.483875
Epoch 33
Validation mae = 0.512597
Validation band_gap mae = 0.512597
Epoch 34
Validation mae = 0.454962
Validation band_gap mae = 0.454962
Epoch 35
Validation mae = 0.461370
Validation band_gap mae = 0.461370
Epoch 36
Validation mae = 0.500242
Validation band_gap mae = 0.500242
Epoch 37
Validation mae = 0.491997
Validation band_gap mae = 0.491997
Epoch 38
Validation mae = 0.484913
Validation band_gap mae = 0.484913
Epoch 39
Validation mae = 0.489066
Validation band_gap mae = 0.489066
Epoch 40
Validation mae = 0.475183
Validation band_gap mae = 0.475183
Epoch 41
Validation mae = 0.522834
Validation band_gap mae = 0.522834
Epoch 42
Validation mae = 0.498762
Validation band_gap mae = 0.498762
Epoch 43
Validation mae = 0.456764
Validation band_gap mae = 0.456764
Epoch 44
Validation mae = 0.490674
Validation band_gap mae = 0.490674
Epoch 45
Validation mae = 0.472669
Validation band_gap mae = 0.472669
Epoch 46
Validation mae = 0.480804
Validation band_gap mae = 0.480804
Epoch 47
Validation mae = 0.551431
Validation band_gap mae = 0.551431
Epoch 48
Validation mae = 0.466851
Validation band_gap mae = 0.466851
Epoch 49
Validation mae = 0.465302
Validation band_gap mae = 0.465302
Epoch 50
Validation mae = 0.480182
Validation band_gap mae = 0.480182
Epoch 51
Validation mae = 0.446392
Validation band_gap mae = 0.446392
Epoch 52
Validation mae = 0.499569
Validation band_gap mae = 0.499569
Epoch 53
Validation mae = 0.437166
Validation band_gap mae = 0.437166
Epoch 54
Validation mae = 0.507662
Validation band_gap mae = 0.507662
Epoch 55
Validation mae = 0.482847
Validation band_gap mae = 0.482847
Epoch 56
Validation mae = 0.504243
Validation band_gap mae = 0.504243
Epoch 57
Validation mae = 0.452236
Validation band_gap mae = 0.452236
Epoch 58
Validation mae = 0.499699
Validation band_gap mae = 0.499699
Epoch 59
Validation mae = 0.464747
Validation band_gap mae = 0.464747
Epoch 60
Validation mae = 0.474422
Validation band_gap mae = 0.474422
Epoch 61
Validation mae = 0.426545
Validation band_gap mae = 0.426545
Epoch 62
Validation mae = 0.520105
Validation band_gap mae = 0.520105
Epoch 63
Validation mae = 0.469969
Validation band_gap mae = 0.469969
Epoch 64
Validation mae = 0.512512
Validation band_gap mae = 0.512512
Epoch 65
Validation mae = 0.469438
Validation band_gap mae = 0.469438
Epoch 66
Validation mae = 0.462850
Validation band_gap mae = 0.462850
Epoch 67
Validation mae = 0.529990
Validation band_gap mae = 0.529990
Epoch 68
Validation mae = 0.478520
Validation band_gap mae = 0.478520
Epoch 69
Validation mae = 0.516240
Validation band_gap mae = 0.516240
Epoch 70
Validation mae = 0.502265
Validation band_gap mae = 0.502265
Epoch 71
Validation mae = 0.532787
Validation band_gap mae = 0.532787
Epoch 72
Validation mae = 0.477552
Validation band_gap mae = 0.477552
Epoch 73
Validation mae = 0.516836
Validation band_gap mae = 0.516836
Epoch 74
Validation mae = 0.490755
Validation band_gap mae = 0.490755
Epoch 75
Validation mae = 0.529885
Validation band_gap mae = 0.529885
Epoch 76
Validation mae = 0.459204
Validation band_gap mae = 0.459204
Epoch 77
Validation mae = 0.518220
Validation band_gap mae = 0.518220
Epoch 78
Validation mae = 0.468252
Validation band_gap mae = 0.468252
Epoch 79
Validation mae = 0.515409
Validation band_gap mae = 0.515409
Epoch 80
Validation mae = 0.434000
Validation band_gap mae = 0.434000
Epoch 81
Validation mae = 0.515216
Validation band_gap mae = 0.515216
Epoch 82
Validation mae = 0.475267
Validation band_gap mae = 0.475267
Epoch 83
Validation mae = 0.455744
Validation band_gap mae = 0.455744
Epoch 84
Validation mae = 0.503508
Validation band_gap mae = 0.503508
Epoch 85
Validation mae = 0.479192
Validation band_gap mae = 0.479192
Epoch 86
Validation mae = 0.508175
Validation band_gap mae = 0.508175
Epoch 87
Validation mae = 0.472277
Validation band_gap mae = 0.472277
Epoch 88
Validation mae = 0.487436
Validation band_gap mae = 0.487436
Epoch 89
Validation mae = 0.483598
Validation band_gap mae = 0.483598
Epoch 90
Validation mae = 0.494935
Validation band_gap mae = 0.494935
Epoch 91
Validation mae = 0.490938
Validation band_gap mae = 0.490938
Epoch 92
Validation mae = 0.485234
Validation band_gap mae = 0.485234
Epoch 93
Validation mae = 0.502914
Validation band_gap mae = 0.502914
Epoch 94
Validation mae = 0.476569
Validation band_gap mae = 0.476569
Epoch 95
Validation mae = 0.520924
Validation band_gap mae = 0.520924
Epoch 96
Validation mae = 0.493988
Validation band_gap mae = 0.493988
Epoch 97
Validation mae = 0.493489
Validation band_gap mae = 0.493489
Epoch 98
Validation mae = 0.548724
Validation band_gap mae = 0.548724
Epoch 99
Validation mae = 0.459148
Validation band_gap mae = 0.459148
Model 0 best validation mae = 0.811534 on epoch 0
Moving model to cuda
Model 0 test mae = 0.675329
Model 0 test band_gap mae = 0.675329
Ensemble test mae = 0.675329
Ensemble test band_gap mae = 0.675329
10-fold cross validation
Seed 0
Fold 0 ==> valid mae = 9.540726 test mae = 6.978208
Fold 0 ==> valid band_gap mae = 9.540726test band_gap mae = 6.978208
Fold 1 ==> valid mae = 3.368571 test mae = 1.662631
Fold 1 ==> valid band_gap mae = 3.368571test band_gap mae = 1.662631
Fold 2 ==> valid mae = 1.724782 test mae = 0.857358
Fold 2 ==> valid band_gap mae = 1.724782test band_gap mae = 0.857358
Fold 3 ==> valid mae = 1.555866 test mae = 0.680146
Fold 3 ==> valid band_gap mae = 1.555866test band_gap mae = 0.680146
Fold 4 ==> valid mae = 0.939587 test mae = 0.844119
Fold 4 ==> valid band_gap mae = 0.939587test band_gap mae = 0.844119
Fold 5 ==> valid mae = 0.510958 test mae = 0.161002
Fold 5 ==> valid band_gap mae = 0.510958test band_gap mae = 0.161002
Fold 6 ==> valid mae = 0.945081 test mae = 0.329211
Fold 6 ==> valid band_gap mae = 0.945081test band_gap mae = 0.329211
Fold 7 ==> valid mae = 1.043231 test mae = 0.515078
Fold 7 ==> valid band_gap mae = 1.043231test band_gap mae = 0.515078
Fold 8 ==> valid mae = 0.981767 test mae = 0.458283
Fold 8 ==> valid band_gap mae = 0.981767test band_gap mae = 0.458283
Fold 9 ==> valid mae = 0.811534 test mae = 0.675329
Fold 9 ==> valid band_gap mae = 0.811534test band_gap mae = 0.675329
Overall valid mae = 2.142210 +/- 2.581192
Overall test mae = 1.316137 +/- 1.926486
Overall test band_gap mae = 1.316137 +/- 1.926486
Loading data
Loading data
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 10.365677
Validation band_gap mae = 10.365677
Epoch 1
Validation mae = 9.692515
Validation band_gap mae = 9.692515
Epoch 2
Validation mae = 6.089774
Validation band_gap mae = 6.089774
Epoch 3
Validation mae = 5.271234
Validation band_gap mae = 5.271234
Epoch 4
Validation mae = 4.751089
Validation band_gap mae = 4.751089
Epoch 5
Validation mae = 4.655618
Validation band_gap mae = 4.655618
Epoch 6
Validation mae = 4.351810
Validation band_gap mae = 4.351810
Epoch 7
Validation mae = 4.762884
Validation band_gap mae = 4.762884
Epoch 8
Validation mae = 4.389328
Validation band_gap mae = 4.389328
Epoch 9
Validation mae = 4.802923
Validation band_gap mae = 4.802923
Epoch 10
Validation mae = 4.483903
Validation band_gap mae = 4.483903
Epoch 11
Validation mae = 5.845996
Validation band_gap mae = 5.845996
Epoch 12
Validation mae = 4.685284
Validation band_gap mae = 4.685284
Epoch 13
Validation mae = 4.949638
Validation band_gap mae = 4.949638
Epoch 14
Validation mae = 4.649152
Validation band_gap mae = 4.649152
Epoch 15
Validation mae = 5.018325
Validation band_gap mae = 5.018325
Epoch 16
Validation mae = 3.664259
Validation band_gap mae = 3.664259
Epoch 17
Validation mae = 4.083241
Validation band_gap mae = 4.083241
Epoch 18
Validation mae = 4.146102
Validation band_gap mae = 4.146102
Epoch 19
Validation mae = 3.739767
Validation band_gap mae = 3.739767
Epoch 20
Validation mae = 4.032318
Validation band_gap mae = 4.032318
Epoch 21
Validation mae = 3.944709
Validation band_gap mae = 3.944709
Epoch 22
Validation mae = 4.507451
Validation band_gap mae = 4.507451
Epoch 23
Validation mae = 4.079175
Validation band_gap mae = 4.079175
Epoch 24
Validation mae = 4.045568
Validation band_gap mae = 4.045568
Epoch 25
Validation mae = 4.014545
Validation band_gap mae = 4.014545
Epoch 26
Validation mae = 3.885175
Validation band_gap mae = 3.885175
Epoch 27
Validation mae = 4.053163
Validation band_gap mae = 4.053163
Epoch 28
Validation mae = 3.856787
Validation band_gap mae = 3.856787
Epoch 29
Validation mae = 3.773318
Validation band_gap mae = 3.773318
Epoch 30
Validation mae = 3.912646
Validation band_gap mae = 3.912646
Epoch 31
Validation mae = 4.079407
Validation band_gap mae = 4.079407
Epoch 32
Validation mae = 4.156901
Validation band_gap mae = 4.156901
Epoch 33
Validation mae = 4.133609
Validation band_gap mae = 4.133609
Epoch 34
Validation mae = 4.042075
Validation band_gap mae = 4.042075
Epoch 35
Validation mae = 3.956484
Validation band_gap mae = 3.956484
Epoch 36
Validation mae = 4.031242
Validation band_gap mae = 4.031242
Epoch 37
Validation mae = 4.046525
Validation band_gap mae = 4.046525
Epoch 38
Validation mae = 3.904566
Validation band_gap mae = 3.904566
Epoch 39
Validation mae = 4.013477
Validation band_gap mae = 4.013477
Epoch 40
Validation mae = 4.036854
Validation band_gap mae = 4.036854
Epoch 41
Validation mae = 4.099866
Validation band_gap mae = 4.099866
Epoch 42
Validation mae = 3.986149
Validation band_gap mae = 3.986149
Epoch 43
Validation mae = 3.985465
Validation band_gap mae = 3.985465
Epoch 44
Validation mae = 4.088102
Validation band_gap mae = 4.088102
Epoch 45
Validation mae = 3.941916
Validation band_gap mae = 3.941916
Epoch 46
Validation mae = 3.962743
Validation band_gap mae = 3.962743
Epoch 47
Validation mae = 4.031036
Validation band_gap mae = 4.031036
Epoch 48
Validation mae = 3.967289
Validation band_gap mae = 3.967289
Epoch 49
Validation mae = 3.925593
Validation band_gap mae = 3.925593
Epoch 50
Validation mae = 3.950666
Validation band_gap mae = 3.950666
Epoch 51
Validation mae = 4.141502
Validation band_gap mae = 4.141502
Epoch 52
Validation mae = 3.998460
Validation band_gap mae = 3.998460
Epoch 53
Validation mae = 3.968256
Validation band_gap mae = 3.968256
Epoch 54
Validation mae = 3.909225
Validation band_gap mae = 3.909225
Epoch 55
Validation mae = 3.853526
Validation band_gap mae = 3.853526
Epoch 56
Validation mae = 3.929820
Validation band_gap mae = 3.929820
Epoch 57
Validation mae = 3.864557
Validation band_gap mae = 3.864557
Epoch 58
Validation mae = 3.946507
Validation band_gap mae = 3.946507
Epoch 59
Validation mae = 4.016349
Validation band_gap mae = 4.016349
Epoch 60
Validation mae = 3.856840
Validation band_gap mae = 3.856840
Epoch 61
Validation mae = 3.941619
Validation band_gap mae = 3.941619
Epoch 62
Validation mae = 3.892156
Validation band_gap mae = 3.892156
Epoch 63
Validation mae = 4.033783
Validation band_gap mae = 4.033783
Epoch 64
Validation mae = 3.887492
Validation band_gap mae = 3.887492
Epoch 65
Validation mae = 3.967509
Validation band_gap mae = 3.967509
Epoch 66
Validation mae = 4.007297
Validation band_gap mae = 4.007297
Epoch 67
Validation mae = 4.033081
Validation band_gap mae = 4.033081
Epoch 68
Validation mae = 3.994852
Validation band_gap mae = 3.994852
Epoch 69
Validation mae = 3.920864
Validation band_gap mae = 3.920864
Epoch 70
Validation mae = 3.868243
Validation band_gap mae = 3.868243
Epoch 71
Validation mae = 3.938997
Validation band_gap mae = 3.938997
Epoch 72
Validation mae = 3.983403
Validation band_gap mae = 3.983403
Epoch 73
Validation mae = 3.928816
Validation band_gap mae = 3.928816
Epoch 74
Validation mae = 3.943805
Validation band_gap mae = 3.943805
Epoch 75
Validation mae = 3.985860
Validation band_gap mae = 3.985860
Epoch 76
Validation mae = 3.968238
Validation band_gap mae = 3.968238
Epoch 77
Validation mae = 3.910196
Validation band_gap mae = 3.910196
Epoch 78
Validation mae = 4.046756
Validation band_gap mae = 4.046756
Epoch 79
Validation mae = 4.011978
Validation band_gap mae = 4.011978
Epoch 80
Validation mae = 3.866713
Validation band_gap mae = 3.866713
Epoch 81
Validation mae = 3.975459
Validation band_gap mae = 3.975459
Epoch 82
Validation mae = 3.976365
Validation band_gap mae = 3.976365
Epoch 83
Validation mae = 3.982263
Validation band_gap mae = 3.982263
Epoch 84
Validation mae = 3.887192
Validation band_gap mae = 3.887192
Epoch 85
Validation mae = 3.954202
Validation band_gap mae = 3.954202
Epoch 86
Validation mae = 3.841194
Validation band_gap mae = 3.841194
Epoch 87
Validation mae = 3.949630
Validation band_gap mae = 3.949630
Epoch 88
Validation mae = 3.885500
Validation band_gap mae = 3.885500
Epoch 89
Validation mae = 3.937405
Validation band_gap mae = 3.937405
Epoch 90
Validation mae = 3.944707
Validation band_gap mae = 3.944707
Epoch 91
Validation mae = 3.939212
Validation band_gap mae = 3.939212
Epoch 92
Validation mae = 3.968297
Validation band_gap mae = 3.968297
Epoch 93
Validation mae = 3.956323
Validation band_gap mae = 3.956323
Epoch 94
Validation mae = 3.889669
Validation band_gap mae = 3.889669
Epoch 95
Validation mae = 3.966201
Validation band_gap mae = 3.966201
Epoch 96
Validation mae = 3.990364
Validation band_gap mae = 3.990364
Epoch 97
Validation mae = 3.938967
Validation band_gap mae = 3.938967
Epoch 98
Validation mae = 3.844706
Validation band_gap mae = 3.844706
Epoch 99
Validation mae = 3.907093
Validation band_gap mae = 3.907093
Model 0 best validation mae = 10.365677 on epoch 0
Moving model to cuda
Model 0 test mae = 9.837577
Model 0 test band_gap mae = 9.837577
Ensemble test mae = 9.837577
Ensemble test band_gap mae = 9.837577
==================== fold 1 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 6.081160
Validation band_gap mae = 6.081160
Epoch 1
Validation mae = 6.106692
Validation band_gap mae = 6.106692
Epoch 2
Validation mae = 6.986115
Validation band_gap mae = 6.986115
Epoch 3
Validation mae = 6.339112
Validation band_gap mae = 6.339112
Epoch 4
Validation mae = 5.988865
Validation band_gap mae = 5.988865
Epoch 5
Validation mae = 6.161120
Validation band_gap mae = 6.161120
Epoch 6
Validation mae = 6.042886
Validation band_gap mae = 6.042886
Epoch 7
Validation mae = 6.854014
Validation band_gap mae = 6.854014
Epoch 8
Validation mae = 6.367166
Validation band_gap mae = 6.367166
Epoch 9
Validation mae = 5.896535
Validation band_gap mae = 5.896535
Epoch 10
Validation mae = 5.881423
Validation band_gap mae = 5.881423
Epoch 11
Validation mae = 5.444895
Validation band_gap mae = 5.444895
Epoch 12
Validation mae = 6.097547
Validation band_gap mae = 6.097547
Epoch 13
Validation mae = 5.826356
Validation band_gap mae = 5.826356
Epoch 14
Validation mae = 6.107827
Validation band_gap mae = 6.107827
Epoch 15
Validation mae = 5.856377
Validation band_gap mae = 5.856377
Epoch 16
Validation mae = 5.362299
Validation band_gap mae = 5.362299
Epoch 17
Validation mae = 5.738481
Validation band_gap mae = 5.738481
Epoch 18
Validation mae = 5.900380
Validation band_gap mae = 5.900380
Epoch 19
Validation mae = 5.611120
Validation band_gap mae = 5.611120
Epoch 20
Validation mae = 5.692708
Validation band_gap mae = 5.692708
Epoch 21
Validation mae = 5.864033
Validation band_gap mae = 5.864033
Epoch 22
Validation mae = 5.680248
Validation band_gap mae = 5.680248
Epoch 23
Validation mae = 5.916185
Validation band_gap mae = 5.916185
Epoch 24
Validation mae = 5.746014
Validation band_gap mae = 5.746014
Epoch 25
Validation mae = 5.681654
Validation band_gap mae = 5.681654
Epoch 26
Validation mae = 5.833056
Validation band_gap mae = 5.833056
Epoch 27
Validation mae = 5.519830
Validation band_gap mae = 5.519830
Epoch 28
Validation mae = 5.988502
Validation band_gap mae = 5.988502
Epoch 29
Validation mae = 5.819842
Validation band_gap mae = 5.819842
Epoch 30
Validation mae = 5.738515
Validation band_gap mae = 5.738515
Epoch 31
Validation mae = 6.100808
Validation band_gap mae = 6.100808
Epoch 32
Validation mae = 5.624330
Validation band_gap mae = 5.624330
Epoch 33
Validation mae = 6.098431
Validation band_gap mae = 6.098431
Epoch 34
Validation mae = 5.542717
Validation band_gap mae = 5.542717
Epoch 35
Validation mae = 5.653957
Validation band_gap mae = 5.653957
Epoch 36
Validation mae = 6.063166
Validation band_gap mae = 6.063166
Epoch 37
Validation mae = 5.988876
Validation band_gap mae = 5.988876
Epoch 38
Validation mae = 5.704138
Validation band_gap mae = 5.704138
Epoch 39
Validation mae = 6.037040
Validation band_gap mae = 6.037040
Epoch 40
Validation mae = 6.054509
Validation band_gap mae = 6.054509
Epoch 41
Validation mae = 5.831231
Validation band_gap mae = 5.831231
Epoch 42
Validation mae = 6.041091
Validation band_gap mae = 6.041091
Epoch 43
Validation mae = 5.744683
Validation band_gap mae = 5.744683
Epoch 44
Validation mae = 5.865217
Validation band_gap mae = 5.865217
Epoch 45
Validation mae = 5.804358
Validation band_gap mae = 5.804358
Epoch 46
Validation mae = 6.100585
Validation band_gap mae = 6.100585
Epoch 47
Validation mae = 5.757898
Validation band_gap mae = 5.757898
Epoch 48
Validation mae = 5.904226
Validation band_gap mae = 5.904226
Epoch 49
Validation mae = 5.883504
Validation band_gap mae = 5.883504
Epoch 50
Validation mae = 5.903672
Validation band_gap mae = 5.903672
Epoch 51
Validation mae = 5.912997
Validation band_gap mae = 5.912997
Epoch 52
Validation mae = 5.898378
Validation band_gap mae = 5.898378
Epoch 53
Validation mae = 5.853826
Validation band_gap mae = 5.853826
Epoch 54
Validation mae = 5.847850
Validation band_gap mae = 5.847850
Epoch 55
Validation mae = 5.997140
Validation band_gap mae = 5.997140
Epoch 56
Validation mae = 5.851020
Validation band_gap mae = 5.851020
Epoch 57
Validation mae = 5.987614
Validation band_gap mae = 5.987614
Epoch 58
Validation mae = 5.852209
Validation band_gap mae = 5.852209
Epoch 59
Validation mae = 5.812306
Validation band_gap mae = 5.812306
Epoch 60
Validation mae = 5.884235
Validation band_gap mae = 5.884235
Epoch 61
Validation mae = 5.849259
Validation band_gap mae = 5.849259
Epoch 62
Validation mae = 5.819213
Validation band_gap mae = 5.819213
Epoch 63
Validation mae = 5.823099
Validation band_gap mae = 5.823099
Epoch 64
Validation mae = 5.899672
Validation band_gap mae = 5.899672
Epoch 65
Validation mae = 5.884347
Validation band_gap mae = 5.884347
Epoch 66
Validation mae = 5.868728
Validation band_gap mae = 5.868728
Epoch 67
Validation mae = 5.918526
Validation band_gap mae = 5.918526
Epoch 68
Validation mae = 6.002712
Validation band_gap mae = 6.002712
Epoch 69
Validation mae = 5.891868
Validation band_gap mae = 5.891868
Epoch 70
Validation mae = 5.896364
Validation band_gap mae = 5.896364
Epoch 71
Validation mae = 5.953705
Validation band_gap mae = 5.953705
Epoch 72
Validation mae = 5.880727
Validation band_gap mae = 5.880727
Epoch 73
Validation mae = 5.831432
Validation band_gap mae = 5.831432
Epoch 74
Validation mae = 5.807518
Validation band_gap mae = 5.807518
Epoch 75
Validation mae = 5.839524
Validation band_gap mae = 5.839524
Epoch 76
Validation mae = 5.918507
Validation band_gap mae = 5.918507
Epoch 77
Validation mae = 5.803797
Validation band_gap mae = 5.803797
Epoch 78
Validation mae = 5.818933
Validation band_gap mae = 5.818933
Epoch 79
Validation mae = 5.826771
Validation band_gap mae = 5.826771
Epoch 80
Validation mae = 5.824987
Validation band_gap mae = 5.824987
Epoch 81
Validation mae = 5.828933
Validation band_gap mae = 5.828933
Epoch 82
Validation mae = 5.797793
Validation band_gap mae = 5.797793
Epoch 83
Validation mae = 5.870199
Validation band_gap mae = 5.870199
Epoch 84
Validation mae = 5.908900
Validation band_gap mae = 5.908900
Epoch 85
Validation mae = 5.846445
Validation band_gap mae = 5.846445
Epoch 86
Validation mae = 5.828692
Validation band_gap mae = 5.828692
Epoch 87
Validation mae = 5.903945
Validation band_gap mae = 5.903945
Epoch 88
Validation mae = 5.805820
Validation band_gap mae = 5.805820
Epoch 89
Validation mae = 5.854173
Validation band_gap mae = 5.854173
Epoch 90
Validation mae = 5.831657
Validation band_gap mae = 5.831657
Epoch 91
Validation mae = 5.905191
Validation band_gap mae = 5.905191
Epoch 92
Validation mae = 5.863505
Validation band_gap mae = 5.863505
Epoch 93
Validation mae = 5.930538
Validation band_gap mae = 5.930538
Epoch 94
Validation mae = 5.974995
Validation band_gap mae = 5.974995
Epoch 95
Validation mae = 5.858426
Validation band_gap mae = 5.858426
Epoch 96
Validation mae = 5.858338
Validation band_gap mae = 5.858338
Epoch 97
Validation mae = 5.801850
Validation band_gap mae = 5.801850
Epoch 98
Validation mae = 5.823056
Validation band_gap mae = 5.823056
Epoch 99
Validation mae = 5.921714
Validation band_gap mae = 5.921714
Model 0 best validation mae = 6.986115 on epoch 2
Moving model to cuda
Model 0 test mae = 4.017481
Model 0 test band_gap mae = 4.017481
Ensemble test mae = 4.017481
Ensemble test band_gap mae = 4.017481
==================== fold 2 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 3.522516
Validation band_gap mae = 3.522516
Epoch 1
Validation mae = 3.540422
Validation band_gap mae = 3.540422
Epoch 2
Validation mae = 2.872324
Validation band_gap mae = 2.872324
Epoch 3
Validation mae = 3.828183
Validation band_gap mae = 3.828183
Epoch 4
Validation mae = 3.536688
Validation band_gap mae = 3.536688
Epoch 5
Validation mae = 3.188465
Validation band_gap mae = 3.188465
Epoch 6
Validation mae = 3.247524
Validation band_gap mae = 3.247524
Epoch 7
Validation mae = 3.406497
Validation band_gap mae = 3.406497
Epoch 8
Validation mae = 2.971380
Validation band_gap mae = 2.971380
Epoch 9
Validation mae = 4.080671
Validation band_gap mae = 4.080671
Epoch 10
Validation mae = 3.091564
Validation band_gap mae = 3.091564
Epoch 11
Validation mae = 4.186166
Validation band_gap mae = 4.186166
Epoch 12
Validation mae = 2.958281
Validation band_gap mae = 2.958281
Epoch 13
Validation mae = 2.873207
Validation band_gap mae = 2.873207
Epoch 14
Validation mae = 2.770190
Validation band_gap mae = 2.770190
Epoch 15
Validation mae = 2.657631
Validation band_gap mae = 2.657631
Epoch 16
Validation mae = 2.738719
Validation band_gap mae = 2.738719
Epoch 17
Validation mae = 2.965266
Validation band_gap mae = 2.965266
Epoch 18
Validation mae = 2.856577
Validation band_gap mae = 2.856577
Epoch 19
Validation mae = 3.649789
Validation band_gap mae = 3.649789
Epoch 20
Validation mae = 3.387745
Validation band_gap mae = 3.387745
Epoch 21
Validation mae = 2.862229
Validation band_gap mae = 2.862229
Epoch 22
Validation mae = 2.868297
Validation band_gap mae = 2.868297
Epoch 23
Validation mae = 2.932150
Validation band_gap mae = 2.932150
Epoch 24
Validation mae = 3.538946
Validation band_gap mae = 3.538946
Epoch 25
Validation mae = 3.631179
Validation band_gap mae = 3.631179
Epoch 26
Validation mae = 2.600908
Validation band_gap mae = 2.600908
Epoch 27
Validation mae = 2.895504
Validation band_gap mae = 2.895504
Epoch 28
Validation mae = 3.481289
Validation band_gap mae = 3.481289
Epoch 29
Validation mae = 2.747662
Validation band_gap mae = 2.747662
Epoch 30
Validation mae = 2.912551
Validation band_gap mae = 2.912551
Epoch 31
Validation mae = 2.870776
Validation band_gap mae = 2.870776
Epoch 32
Validation mae = 2.983928
Validation band_gap mae = 2.983928
Epoch 33
Validation mae = 3.257945
Validation band_gap mae = 3.257945
Epoch 34
Validation mae = 3.341906
Validation band_gap mae = 3.341906
Epoch 35
Validation mae = 2.897608
Validation band_gap mae = 2.897608
Epoch 36
Validation mae = 2.776801
Validation band_gap mae = 2.776801
Epoch 37
Validation mae = 2.984225
Validation band_gap mae = 2.984225
Epoch 38
Validation mae = 2.811584
Validation band_gap mae = 2.811584
Epoch 39
Validation mae = 2.753047
Validation band_gap mae = 2.753047
Epoch 40
Validation mae = 2.511630
Validation band_gap mae = 2.511630
Epoch 41
Validation mae = 2.650687
Validation band_gap mae = 2.650687
Epoch 42
Validation mae = 2.839740
Validation band_gap mae = 2.839740
Epoch 43
Validation mae = 2.635673
Validation band_gap mae = 2.635673
Epoch 44
Validation mae = 2.853311
Validation band_gap mae = 2.853311
Epoch 45
Validation mae = 2.704880
Validation band_gap mae = 2.704880
Epoch 46
Validation mae = 2.633660
Validation band_gap mae = 2.633660
Epoch 47
Validation mae = 2.464161
Validation band_gap mae = 2.464161
Epoch 48
Validation mae = 2.668207
Validation band_gap mae = 2.668207
Epoch 49
Validation mae = 2.867910
Validation band_gap mae = 2.867910
Epoch 50
Validation mae = 2.890892
Validation band_gap mae = 2.890892
Epoch 51
Validation mae = 3.020070
Validation band_gap mae = 3.020070
Epoch 52
Validation mae = 2.870420
Validation band_gap mae = 2.870420
Epoch 53
Validation mae = 2.940561
Validation band_gap mae = 2.940561
Epoch 54
Validation mae = 3.826569
Validation band_gap mae = 3.826569
Epoch 55
Validation mae = 2.590951
Validation band_gap mae = 2.590951
Epoch 56
Validation mae = 3.297184
Validation band_gap mae = 3.297184
Epoch 57
Validation mae = 2.771704
Validation band_gap mae = 2.771704
Epoch 58
Validation mae = 3.211886
Validation band_gap mae = 3.211886
Epoch 59
Validation mae = 2.498668
Validation band_gap mae = 2.498668
Epoch 60
Validation mae = 2.918466
Validation band_gap mae = 2.918466
Epoch 61
Validation mae = 3.707593
Validation band_gap mae = 3.707593
Epoch 62
Validation mae = 2.886298
Validation band_gap mae = 2.886298
Epoch 63
Validation mae = 3.186786
Validation band_gap mae = 3.186786
Epoch 64
Validation mae = 2.921439
Validation band_gap mae = 2.921439
Epoch 65
Validation mae = 2.801872
Validation band_gap mae = 2.801872
Epoch 66
Validation mae = 3.669938
Validation band_gap mae = 3.669938
Epoch 67
Validation mae = 3.225017
Validation band_gap mae = 3.225017
Epoch 68
Validation mae = 2.788821
Validation band_gap mae = 2.788821
Epoch 69
Validation mae = 2.523675
Validation band_gap mae = 2.523675
Epoch 70
Validation mae = 2.835222
Validation band_gap mae = 2.835222
Epoch 71
Validation mae = 2.759154
Validation band_gap mae = 2.759154
Epoch 72
Validation mae = 2.810431
Validation band_gap mae = 2.810431
Epoch 73
Validation mae = 2.813259
Validation band_gap mae = 2.813259
Epoch 74
Validation mae = 1.728065
Validation band_gap mae = 1.728065
Epoch 75
Validation mae = 3.078398
Validation band_gap mae = 3.078398
Epoch 76
Validation mae = 2.906780
Validation band_gap mae = 2.906780
Epoch 77
Validation mae = 2.872625
Validation band_gap mae = 2.872625
Epoch 78
Validation mae = 2.866207
Validation band_gap mae = 2.866207
Epoch 79
Validation mae = 2.940251
Validation band_gap mae = 2.940251
Epoch 80
Validation mae = 2.820795
Validation band_gap mae = 2.820795
Epoch 81
Validation mae = 2.890490
Validation band_gap mae = 2.890490
Epoch 82
Validation mae = 2.900399
Validation band_gap mae = 2.900399
Epoch 83
Validation mae = 2.663076
Validation band_gap mae = 2.663076
Epoch 84
Validation mae = 3.085846
Validation band_gap mae = 3.085846
Epoch 85
Validation mae = 2.649872
Validation band_gap mae = 2.649872
Epoch 86
Validation mae = 2.780377
Validation band_gap mae = 2.780377
Epoch 87
Validation mae = 2.756175
Validation band_gap mae = 2.756175
Epoch 88
Validation mae = 3.045398
Validation band_gap mae = 3.045398
Epoch 89
Validation mae = 2.642810
Validation band_gap mae = 2.642810
Epoch 90
Validation mae = 2.816082
Validation band_gap mae = 2.816082
Epoch 91
Validation mae = 2.781978
Validation band_gap mae = 2.781978
Epoch 92
Validation mae = 2.793978
Validation band_gap mae = 2.793978
Epoch 93
Validation mae = 2.826846
Validation band_gap mae = 2.826846
Epoch 94
Validation mae = 2.778319
Validation band_gap mae = 2.778319
Epoch 95
Validation mae = 2.818970
Validation band_gap mae = 2.818970
Epoch 96
Validation mae = 2.813721
Validation band_gap mae = 2.813721
Epoch 97
Validation mae = 2.782134
Validation band_gap mae = 2.782134
Epoch 98
Validation mae = 2.836417
Validation band_gap mae = 2.836417
Epoch 99
Validation mae = 2.810820
Validation band_gap mae = 2.810820
Model 0 best validation mae = 4.186166 on epoch 11
Moving model to cuda
Model 0 test mae = 2.816748
Model 0 test band_gap mae = 2.816748
Ensemble test mae = 2.816748
Ensemble test band_gap mae = 2.816748
==================== fold 3 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 2.588137
Validation band_gap mae = 2.588137
Epoch 1
Validation mae = 2.728796
Validation band_gap mae = 2.728796
Epoch 2
Validation mae = 2.605099
Validation band_gap mae = 2.605099
Epoch 3
Validation mae = 2.689283
Validation band_gap mae = 2.689283
Epoch 4
Validation mae = 2.588793
Validation band_gap mae = 2.588793
Epoch 5
Validation mae = 2.594041
Validation band_gap mae = 2.594041
Epoch 6
Validation mae = 2.621706
Validation band_gap mae = 2.621706
Epoch 7
Validation mae = 2.610522
Validation band_gap mae = 2.610522
Epoch 8
Validation mae = 2.660810
Validation band_gap mae = 2.660810
Epoch 9
Validation mae = 2.633834
Validation band_gap mae = 2.633834
Epoch 10
Validation mae = 2.688189
Validation band_gap mae = 2.688189
Epoch 11
Validation mae = 2.619184
Validation band_gap mae = 2.619184
Epoch 12
Validation mae = 2.667231
Validation band_gap mae = 2.667231
Epoch 13
Validation mae = 2.693591
Validation band_gap mae = 2.693591
Epoch 14
Validation mae = 2.590297
Validation band_gap mae = 2.590297
Epoch 15
Validation mae = 2.593266
Validation band_gap mae = 2.593266
Epoch 16
Validation mae = 2.658627
Validation band_gap mae = 2.658627
Epoch 17
Validation mae = 2.621189
Validation band_gap mae = 2.621189
Epoch 18
Validation mae = 2.584372
Validation band_gap mae = 2.584372
Epoch 19
Validation mae = 2.579300
Validation band_gap mae = 2.579300
Epoch 20
Validation mae = 2.614657
Validation band_gap mae = 2.614657
Epoch 21
Validation mae = 2.659230
Validation band_gap mae = 2.659230
Epoch 22
Validation mae = 2.668401
Validation band_gap mae = 2.668401
Epoch 23
Validation mae = 2.603725
Validation band_gap mae = 2.603725
Epoch 24
Validation mae = 2.569752
Validation band_gap mae = 2.569752
Epoch 25
Validation mae = 2.665636
Validation band_gap mae = 2.665636
Epoch 26
Validation mae = 2.620633
Validation band_gap mae = 2.620633
Epoch 27
Validation mae = 2.630087
Validation band_gap mae = 2.630087
Epoch 28
Validation mae = 2.576789
Validation band_gap mae = 2.576789
Epoch 29
Validation mae = 2.671770
Validation band_gap mae = 2.671770
Epoch 30
Validation mae = 2.612883
Validation band_gap mae = 2.612883
Epoch 31
Validation mae = 2.695980
Validation band_gap mae = 2.695980
Epoch 32
Validation mae = 2.576496
Validation band_gap mae = 2.576496
Epoch 33
Validation mae = 2.645020
Validation band_gap mae = 2.645020
Epoch 34
Validation mae = 2.607562
Validation band_gap mae = 2.607562
Epoch 35
Validation mae = 2.635345
Validation band_gap mae = 2.635345
Epoch 36
Validation mae = 2.576999
Validation band_gap mae = 2.576999
Epoch 37
Validation mae = 2.610218
Validation band_gap mae = 2.610218
Epoch 38
Validation mae = 2.645533
Validation band_gap mae = 2.645533
Epoch 39
Validation mae = 2.610552
Validation band_gap mae = 2.610552
Epoch 40
Validation mae = 2.634074
Validation band_gap mae = 2.634074
Epoch 41
Validation mae = 2.669765
Validation band_gap mae = 2.669765
Epoch 42
Validation mae = 2.619748
Validation band_gap mae = 2.619748
Epoch 43
Validation mae = 2.626428
Validation band_gap mae = 2.626428
Epoch 44
Validation mae = 2.718055
Validation band_gap mae = 2.718055
Epoch 45
Validation mae = 2.634584
Validation band_gap mae = 2.634584
Epoch 46
Validation mae = 2.615176
Validation band_gap mae = 2.615176
Epoch 47
Validation mae = 2.586593
Validation band_gap mae = 2.586593
Epoch 48
Validation mae = 2.593785
Validation band_gap mae = 2.593785
Epoch 49
Validation mae = 2.625230
Validation band_gap mae = 2.625230
Epoch 50
Validation mae = 2.622559
Validation band_gap mae = 2.622559
Epoch 51
Validation mae = 2.603150
Validation band_gap mae = 2.603150
Epoch 52
Validation mae = 2.602726
Validation band_gap mae = 2.602726
Epoch 53
Validation mae = 2.626281
Validation band_gap mae = 2.626281
Epoch 54
Validation mae = 2.645903
Validation band_gap mae = 2.645903
Epoch 55
Validation mae = 2.593269
Validation band_gap mae = 2.593269
Epoch 56
Validation mae = 2.734298
Validation band_gap mae = 2.734298
Epoch 57
Validation mae = 2.648192
Validation band_gap mae = 2.648192
Epoch 58
Validation mae = 2.601852
Validation band_gap mae = 2.601852
Epoch 59
Validation mae = 2.669182
Validation band_gap mae = 2.669182
Epoch 60
Validation mae = 2.642668
Validation band_gap mae = 2.642668
Epoch 61
Validation mae = 2.603085
Validation band_gap mae = 2.603085
Epoch 62
Validation mae = 2.827920
Validation band_gap mae = 2.827920
Epoch 63
Validation mae = 2.603239
Validation band_gap mae = 2.603239
Epoch 64
Validation mae = 2.692973
Validation band_gap mae = 2.692973
Epoch 65
Validation mae = 2.641789
Validation band_gap mae = 2.641789
Epoch 66
Validation mae = 2.592477
Validation band_gap mae = 2.592477
Epoch 67
Validation mae = 2.653515
Validation band_gap mae = 2.653515
Epoch 68
Validation mae = 2.596882
Validation band_gap mae = 2.596882
Epoch 69
Validation mae = 2.598416
Validation band_gap mae = 2.598416
Epoch 70
Validation mae = 2.594903
Validation band_gap mae = 2.594903
Epoch 71
Validation mae = 2.634092
Validation band_gap mae = 2.634092
Epoch 72
Validation mae = 2.645536
Validation band_gap mae = 2.645536
Epoch 73
Validation mae = 2.594343
Validation band_gap mae = 2.594343
Epoch 74
Validation mae = 2.613239
Validation band_gap mae = 2.613239
Epoch 75
Validation mae = 2.621789
Validation band_gap mae = 2.621789
Epoch 76
Validation mae = 2.667197
Validation band_gap mae = 2.667197
Epoch 77
Validation mae = 2.657554
Validation band_gap mae = 2.657554
Epoch 78
Validation mae = 2.617818
Validation band_gap mae = 2.617818
Epoch 79
Validation mae = 2.642835
Validation band_gap mae = 2.642835
Epoch 80
Validation mae = 2.626948
Validation band_gap mae = 2.626948
Epoch 81
Validation mae = 2.645634
Validation band_gap mae = 2.645634
Epoch 82
Validation mae = 2.611766
Validation band_gap mae = 2.611766
Epoch 83
Validation mae = 2.661059
Validation band_gap mae = 2.661059
Epoch 84
Validation mae = 2.654684
Validation band_gap mae = 2.654684
Epoch 85
Validation mae = 2.612670
Validation band_gap mae = 2.612670
Epoch 86
Validation mae = 2.653452
Validation band_gap mae = 2.653452
Epoch 87
Validation mae = 2.625586
Validation band_gap mae = 2.625586
Epoch 88
Validation mae = 2.612366
Validation band_gap mae = 2.612366
Epoch 89
Validation mae = 2.671784
Validation band_gap mae = 2.671784
Epoch 90
Validation mae = 2.646106
Validation band_gap mae = 2.646106
Epoch 91
Validation mae = 2.604218
Validation band_gap mae = 2.604218
Epoch 92
Validation mae = 2.640961
Validation band_gap mae = 2.640961
Epoch 93
Validation mae = 2.636550
Validation band_gap mae = 2.636550
Epoch 94
Validation mae = 2.626474
Validation band_gap mae = 2.626474
Epoch 95
Validation mae = 2.672344
Validation band_gap mae = 2.672344
Epoch 96
Validation mae = 2.641897
Validation band_gap mae = 2.641897
Epoch 97
Validation mae = 2.648856
Validation band_gap mae = 2.648856
Epoch 98
Validation mae = 2.633502
Validation band_gap mae = 2.633502
Epoch 99
Validation mae = 2.664671
Validation band_gap mae = 2.664671
Model 0 best validation mae = 2.827920 on epoch 62
Moving model to cuda
Model 0 test mae = 0.464148
Model 0 test band_gap mae = 0.464148
Ensemble test mae = 0.464148
Ensemble test band_gap mae = 0.464148
==================== fold 4 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.943382
Validation band_gap mae = 0.943382
Epoch 1
Validation mae = 0.997641
Validation band_gap mae = 0.997641
Epoch 2
Validation mae = 0.784408
Validation band_gap mae = 0.784408
Epoch 3
Validation mae = 0.493237
Validation band_gap mae = 0.493237
Epoch 4
Validation mae = 0.474855
Validation band_gap mae = 0.474855
Epoch 5
Validation mae = 0.559846
Validation band_gap mae = 0.559846
Epoch 6
Validation mae = 1.299961
Validation band_gap mae = 1.299961
Epoch 7
Validation mae = 1.986925
Validation band_gap mae = 1.986925
Epoch 8
Validation mae = 1.056721
Validation band_gap mae = 1.056721
Epoch 9
Validation mae = 1.007738
Validation band_gap mae = 1.007738
Epoch 10
Validation mae = 0.937929
Validation band_gap mae = 0.937929
Epoch 11
Validation mae = 0.671348
Validation band_gap mae = 0.671348
Epoch 12
Validation mae = 0.852264
Validation band_gap mae = 0.852264
Epoch 13
Validation mae = 0.731633
Validation band_gap mae = 0.731633
Epoch 14
Validation mae = 1.056187
Validation band_gap mae = 1.056187
Epoch 15
Validation mae = 0.895107
Validation band_gap mae = 0.895107
Epoch 16
Validation mae = 0.857768
Validation band_gap mae = 0.857768
Epoch 17
Validation mae = 0.945698
Validation band_gap mae = 0.945698
Epoch 18
Validation mae = 0.725085
Validation band_gap mae = 0.725085
Epoch 19
Validation mae = 0.430341
Validation band_gap mae = 0.430341
Epoch 20
Validation mae = 0.579162
Validation band_gap mae = 0.579162
Epoch 21
Validation mae = 0.764636
Validation band_gap mae = 0.764636
Epoch 22
Validation mae = 0.820750
Validation band_gap mae = 0.820750
Epoch 23
Validation mae = 0.541244
Validation band_gap mae = 0.541244
Epoch 24
Validation mae = 0.706434
Validation band_gap mae = 0.706434
Epoch 25
Validation mae = 0.564522
Validation band_gap mae = 0.564522
Epoch 26
Validation mae = 0.890899
Validation band_gap mae = 0.890899
Epoch 27
Validation mae = 0.726000
Validation band_gap mae = 0.726000
Epoch 28
Validation mae = 1.344278
Validation band_gap mae = 1.344278
Epoch 29
Validation mae = 0.464538
Validation band_gap mae = 0.464538
Epoch 30
Validation mae = 1.217487
Validation band_gap mae = 1.217487
Epoch 31
Validation mae = 0.630355
Validation band_gap mae = 0.630355
Epoch 32
Validation mae = 0.697089
Validation band_gap mae = 0.697089
Epoch 33
Validation mae = 0.795070
Validation band_gap mae = 0.795070
Epoch 34
Validation mae = 0.909156
Validation band_gap mae = 0.909156
Epoch 35
Validation mae = 1.928130
Validation band_gap mae = 1.928130
Epoch 36
Validation mae = 0.503699
Validation band_gap mae = 0.503699
Epoch 37
Validation mae = 1.221225
Validation band_gap mae = 1.221225
Epoch 38
Validation mae = 1.105390
Validation band_gap mae = 1.105390
Epoch 39
Validation mae = 0.762483
Validation band_gap mae = 0.762483
Epoch 40
Validation mae = 0.814705
Validation band_gap mae = 0.814705
Epoch 41
Validation mae = 0.446740
Validation band_gap mae = 0.446740
Epoch 42
Validation mae = 0.518846
Validation band_gap mae = 0.518846
Epoch 43
Validation mae = 0.837410
Validation band_gap mae = 0.837410
Epoch 44
Validation mae = 0.747591
Validation band_gap mae = 0.747591
Epoch 45
Validation mae = 0.774721
Validation band_gap mae = 0.774721
Epoch 46
Validation mae = 0.588944
Validation band_gap mae = 0.588944
Epoch 47
Validation mae = 0.605030
Validation band_gap mae = 0.605030
Epoch 48
Validation mae = 0.707735
Validation band_gap mae = 0.707735
Epoch 49
Validation mae = 0.571236
Validation band_gap mae = 0.571236
Epoch 50
Validation mae = 0.843155
Validation band_gap mae = 0.843155
Epoch 51
Validation mae = 0.965809
Validation band_gap mae = 0.965809
Epoch 52
Validation mae = 0.841900
Validation band_gap mae = 0.841900
Epoch 53
Validation mae = 0.797323
Validation band_gap mae = 0.797323
Epoch 54
Validation mae = 0.926104
Validation band_gap mae = 0.926104
Epoch 55
Validation mae = 1.049566
Validation band_gap mae = 1.049566
Epoch 56
Validation mae = 0.393882
Validation band_gap mae = 0.393882
Epoch 57
Validation mae = 0.931272
Validation band_gap mae = 0.931272
Epoch 58
Validation mae = 0.512662
Validation band_gap mae = 0.512662
Epoch 59
Validation mae = 0.585497
Validation band_gap mae = 0.585497
Epoch 60
Validation mae = 0.637060
Validation band_gap mae = 0.637060
Epoch 61
Validation mae = 0.518725
Validation band_gap mae = 0.518725
Epoch 62
Validation mae = 0.604311
Validation band_gap mae = 0.604311
Epoch 63
Validation mae = 0.733180
Validation band_gap mae = 0.733180
Epoch 64
Validation mae = 0.909060
Validation band_gap mae = 0.909060
Epoch 65
Validation mae = 0.652127
Validation band_gap mae = 0.652127
Epoch 66
Validation mae = 0.481232
Validation band_gap mae = 0.481232
Epoch 67
Validation mae = 0.835741
Validation band_gap mae = 0.835741
Epoch 68
Validation mae = 0.444925
Validation band_gap mae = 0.444925
Epoch 69
Validation mae = 0.776862
Validation band_gap mae = 0.776862
Epoch 70
Validation mae = 0.430383
Validation band_gap mae = 0.430383
Epoch 71
Validation mae = 0.463300
Validation band_gap mae = 0.463300
Epoch 72
Validation mae = 0.531578
Validation band_gap mae = 0.531578
Epoch 73
Validation mae = 0.625739
Validation band_gap mae = 0.625739
Epoch 74
Validation mae = 0.791025
Validation band_gap mae = 0.791025
Epoch 75
Validation mae = 0.683706
Validation band_gap mae = 0.683706
Epoch 76
Validation mae = 0.598734
Validation band_gap mae = 0.598734
Epoch 77
Validation mae = 0.787576
Validation band_gap mae = 0.787576
Epoch 78
Validation mae = 0.522806
Validation band_gap mae = 0.522806
Epoch 79
Validation mae = 1.240836
Validation band_gap mae = 1.240836
Epoch 80
Validation mae = 0.706807
Validation band_gap mae = 0.706807
Epoch 81
Validation mae = 0.575542
Validation band_gap mae = 0.575542
Epoch 82
Validation mae = 0.833985
Validation band_gap mae = 0.833985
Epoch 83
Validation mae = 0.453130
Validation band_gap mae = 0.453130
Epoch 84
Validation mae = 0.427195
Validation band_gap mae = 0.427195
Epoch 85
Validation mae = 0.613541
Validation band_gap mae = 0.613541
Epoch 86
Validation mae = 0.387265
Validation band_gap mae = 0.387265
Epoch 87
Validation mae = 0.454356
Validation band_gap mae = 0.454356
Epoch 88
Validation mae = 0.506922
Validation band_gap mae = 0.506922
Epoch 89
Validation mae = 0.494696
Validation band_gap mae = 0.494696
Epoch 90
Validation mae = 0.464712
Validation band_gap mae = 0.464712
Epoch 91
Validation mae = 0.427513
Validation band_gap mae = 0.427513
Epoch 92
Validation mae = 0.484055
Validation band_gap mae = 0.484055
Epoch 93
Validation mae = 0.407756
Validation band_gap mae = 0.407756
Epoch 94
Validation mae = 0.481304
Validation band_gap mae = 0.481304
Epoch 95
Validation mae = 0.487699
Validation band_gap mae = 0.487699
Epoch 96
Validation mae = 0.438826
Validation band_gap mae = 0.438826
Epoch 97
Validation mae = 0.446472
Validation band_gap mae = 0.446472
Epoch 98
Validation mae = 0.441617
Validation band_gap mae = 0.441617
Epoch 99
Validation mae = 0.616503
Validation band_gap mae = 0.616503
Model 0 best validation mae = 1.986925 on epoch 7
Moving model to cuda
Model 0 test mae = 1.713111
Model 0 test band_gap mae = 1.713111
Ensemble test mae = 1.713111
Ensemble test band_gap mae = 1.713111
==================== fold 5 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.435697
Validation band_gap mae = 0.435697
Epoch 1
Validation mae = 0.380579
Validation band_gap mae = 0.380579
Epoch 2
Validation mae = 0.363015
Validation band_gap mae = 0.363015
Epoch 3
Validation mae = 0.287214
Validation band_gap mae = 0.287214
Epoch 4
Validation mae = 0.289941
Validation band_gap mae = 0.289941
Epoch 5
Validation mae = 0.340418
Validation band_gap mae = 0.340418
Epoch 6
Validation mae = 0.312489
Validation band_gap mae = 0.312489
Epoch 7
Validation mae = 0.282809
Validation band_gap mae = 0.282809
Epoch 8
Validation mae = 0.283353
Validation band_gap mae = 0.283353
Epoch 9
Validation mae = 0.277251
Validation band_gap mae = 0.277251
Epoch 10
Validation mae = 0.363547
Validation band_gap mae = 0.363547
Epoch 11
Validation mae = 0.362521
Validation band_gap mae = 0.362521
Epoch 12
Validation mae = 0.335619
Validation band_gap mae = 0.335619
Epoch 13
Validation mae = 0.277645
Validation band_gap mae = 0.277645
Epoch 14
Validation mae = 0.281196
Validation band_gap mae = 0.281196
Epoch 15
Validation mae = 0.310182
Validation band_gap mae = 0.310182
Epoch 16
Validation mae = 0.285111
Validation band_gap mae = 0.285111
Epoch 17
Validation mae = 0.300100
Validation band_gap mae = 0.300100
Epoch 18
Validation mae = 0.318735
Validation band_gap mae = 0.318735
Epoch 19
Validation mae = 0.277500
Validation band_gap mae = 0.277500
Epoch 20
Validation mae = 0.400156
Validation band_gap mae = 0.400156
Epoch 21
Validation mae = 0.330447
Validation band_gap mae = 0.330447
Epoch 22
Validation mae = 0.291493
Validation band_gap mae = 0.291493
Epoch 23
Validation mae = 0.333002
Validation band_gap mae = 0.333002
Epoch 24
Validation mae = 0.269493
Validation band_gap mae = 0.269493
Epoch 25
Validation mae = 0.275363
Validation band_gap mae = 0.275363
Epoch 26
Validation mae = 0.586861
Validation band_gap mae = 0.586861
Epoch 27
Validation mae = 0.376758
Validation band_gap mae = 0.376758
Epoch 28
Validation mae = 0.415256
Validation band_gap mae = 0.415256
Epoch 29
Validation mae = 0.348841
Validation band_gap mae = 0.348841
Epoch 30
Validation mae = 0.429703
Validation band_gap mae = 0.429703
Epoch 31
Validation mae = 0.387418
Validation band_gap mae = 0.387418
Epoch 32
Validation mae = 0.281369
Validation band_gap mae = 0.281369
Epoch 33
Validation mae = 0.298918
Validation band_gap mae = 0.298918
Epoch 34
Validation mae = 0.271148
Validation band_gap mae = 0.271148
Epoch 35
Validation mae = 0.348884
Validation band_gap mae = 0.348884
Epoch 36
Validation mae = 0.308108
Validation band_gap mae = 0.308108
Epoch 37
Validation mae = 0.311818
Validation band_gap mae = 0.311818
Epoch 38
Validation mae = 0.270995
Validation band_gap mae = 0.270995
Epoch 39
Validation mae = 0.279089
Validation band_gap mae = 0.279089
Epoch 40
Validation mae = 0.268114
Validation band_gap mae = 0.268114
Epoch 41
Validation mae = 0.367107
Validation band_gap mae = 0.367107
Epoch 42
Validation mae = 0.392285
Validation band_gap mae = 0.392285
Epoch 43
Validation mae = 0.311441
Validation band_gap mae = 0.311441
Epoch 44
Validation mae = 0.274879
Validation band_gap mae = 0.274879
Epoch 45
Validation mae = 0.322486
Validation band_gap mae = 0.322486
Epoch 46
Validation mae = 0.272864
Validation band_gap mae = 0.272864
Epoch 47
Validation mae = 0.260841
Validation band_gap mae = 0.260841
Epoch 48
Validation mae = 0.283694
Validation band_gap mae = 0.283694
Epoch 49
Validation mae = 0.272188
Validation band_gap mae = 0.272188
Epoch 50
Validation mae = 0.317386
Validation band_gap mae = 0.317386
Epoch 51
Validation mae = 0.350828
Validation band_gap mae = 0.350828
Epoch 52
Validation mae = 0.265487
Validation band_gap mae = 0.265487
Epoch 53
Validation mae = 0.301038
Validation band_gap mae = 0.301038
Epoch 54
Validation mae = 0.244924
Validation band_gap mae = 0.244924
Epoch 55
Validation mae = 0.320928
Validation band_gap mae = 0.320928
Epoch 56
Validation mae = 0.351337
Validation band_gap mae = 0.351337
Epoch 57
Validation mae = 0.304836
Validation band_gap mae = 0.304836
Epoch 58
Validation mae = 0.259551
Validation band_gap mae = 0.259551
Epoch 59
Validation mae = 0.288672
Validation band_gap mae = 0.288672
Epoch 60
Validation mae = 0.380880
Validation band_gap mae = 0.380880
Epoch 61
Validation mae = 0.273402
Validation band_gap mae = 0.273402
Epoch 62
Validation mae = 0.281303
Validation band_gap mae = 0.281303
Epoch 63
Validation mae = 0.240425
Validation band_gap mae = 0.240425
Epoch 64
Validation mae = 0.397969
Validation band_gap mae = 0.397969
Epoch 65
Validation mae = 0.269591
Validation band_gap mae = 0.269591
Epoch 66
Validation mae = 0.263945
Validation band_gap mae = 0.263945
Epoch 67
Validation mae = 0.308078
Validation band_gap mae = 0.308078
Epoch 68
Validation mae = 0.351814
Validation band_gap mae = 0.351814
Epoch 69
Validation mae = 0.258130
Validation band_gap mae = 0.258130
Epoch 70
Validation mae = 0.256219
Validation band_gap mae = 0.256219
Epoch 71
Validation mae = 0.347945
Validation band_gap mae = 0.347945
Epoch 72
Validation mae = 0.275018
Validation band_gap mae = 0.275018
Epoch 73
Validation mae = 0.293424
Validation band_gap mae = 0.293424
Epoch 74
Validation mae = 0.375295
Validation band_gap mae = 0.375295
Epoch 75
Validation mae = 0.259094
Validation band_gap mae = 0.259094
Epoch 76
Validation mae = 0.260827
Validation band_gap mae = 0.260827
Epoch 77
Validation mae = 0.464808
Validation band_gap mae = 0.464808
Epoch 78
Validation mae = 0.303410
Validation band_gap mae = 0.303410
Epoch 79
Validation mae = 0.264615
Validation band_gap mae = 0.264615
Epoch 80
Validation mae = 0.246017
Validation band_gap mae = 0.246017
Epoch 81
Validation mae = 0.287422
Validation band_gap mae = 0.287422
Epoch 82
Validation mae = 0.284214
Validation band_gap mae = 0.284214
Epoch 83
Validation mae = 0.289509
Validation band_gap mae = 0.289509
Epoch 84
Validation mae = 0.292244
Validation band_gap mae = 0.292244
Epoch 85
Validation mae = 0.287775
Validation band_gap mae = 0.287775
Epoch 86
Validation mae = 0.284588
Validation band_gap mae = 0.284588
Epoch 87
Validation mae = 0.284161
Validation band_gap mae = 0.284161
Epoch 88
Validation mae = 0.289359
Validation band_gap mae = 0.289359
Epoch 89
Validation mae = 0.294957
Validation band_gap mae = 0.294957
Epoch 90
Validation mae = 0.286975
Validation band_gap mae = 0.286975
Epoch 91
Validation mae = 0.288191
Validation band_gap mae = 0.288191
Epoch 92
Validation mae = 0.296971
Validation band_gap mae = 0.296971
Epoch 93
Validation mae = 0.289775
Validation band_gap mae = 0.289775
Epoch 94
Validation mae = 0.284191
Validation band_gap mae = 0.284191
Epoch 95
Validation mae = 0.283371
Validation band_gap mae = 0.283371
Epoch 96
Validation mae = 0.293360
Validation band_gap mae = 0.293360
Epoch 97
Validation mae = 0.285154
Validation band_gap mae = 0.285154
Epoch 98
Validation mae = 0.284518
Validation band_gap mae = 0.284518
Epoch 99
Validation mae = 0.290719
Validation band_gap mae = 0.290719
Model 0 best validation mae = 0.586861 on epoch 26
Moving model to cuda
Model 0 test mae = 0.622898
Model 0 test band_gap mae = 0.622898
Ensemble test mae = 0.622898
Ensemble test band_gap mae = 0.622898
==================== fold 6 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.390850
Validation band_gap mae = 0.390850
Epoch 1
Validation mae = 0.411506
Validation band_gap mae = 0.411506
Epoch 2
Validation mae = 0.402760
Validation band_gap mae = 0.402760
Epoch 3
Validation mae = 0.336682
Validation band_gap mae = 0.336682
Epoch 4
Validation mae = 0.335578
Validation band_gap mae = 0.335578
Epoch 5
Validation mae = 0.507615
Validation band_gap mae = 0.507615
Epoch 6
Validation mae = 0.468075
Validation band_gap mae = 0.468075
Epoch 7
Validation mae = 0.322843
Validation band_gap mae = 0.322843
Epoch 8
Validation mae = 0.362227
Validation band_gap mae = 0.362227
Epoch 9
Validation mae = 0.322692
Validation band_gap mae = 0.322692
Epoch 10
Validation mae = 0.315231
Validation band_gap mae = 0.315231
Epoch 11
Validation mae = 0.319667
Validation band_gap mae = 0.319667
Epoch 12
Validation mae = 0.489655
Validation band_gap mae = 0.489655
Epoch 13
Validation mae = 0.513634
Validation band_gap mae = 0.513634
Epoch 14
Validation mae = 0.353668
Validation band_gap mae = 0.353668
Epoch 15
Validation mae = 0.351499
Validation band_gap mae = 0.351499
Epoch 16
Validation mae = 0.335593
Validation band_gap mae = 0.335593
Epoch 17
Validation mae = 0.296877
Validation band_gap mae = 0.296877
Epoch 18
Validation mae = 0.314681
Validation band_gap mae = 0.314681
Epoch 19
Validation mae = 0.348770
Validation band_gap mae = 0.348770
Epoch 20
Validation mae = 0.319634
Validation band_gap mae = 0.319634
Epoch 21
Validation mae = 0.363107
Validation band_gap mae = 0.363107
Epoch 22
Validation mae = 0.316536
Validation band_gap mae = 0.316536
Epoch 23
Validation mae = 0.318481
Validation band_gap mae = 0.318481
Epoch 24
Validation mae = 0.422416
Validation band_gap mae = 0.422416
Epoch 25
Validation mae = 0.327467
Validation band_gap mae = 0.327467
Epoch 26
Validation mae = 0.310741
Validation band_gap mae = 0.310741
Epoch 27
Validation mae = 0.313008
Validation band_gap mae = 0.313008
Epoch 28
Validation mae = 0.326020
Validation band_gap mae = 0.326020
Epoch 29
Validation mae = 0.500519
Validation band_gap mae = 0.500519
Epoch 30
Validation mae = 0.404832
Validation band_gap mae = 0.404832
Epoch 31
Validation mae = 0.330393
Validation band_gap mae = 0.330393
Epoch 32
Validation mae = 0.355819
Validation band_gap mae = 0.355819
Epoch 33
Validation mae = 0.385305
Validation band_gap mae = 0.385305
Epoch 34
Validation mae = 0.380076
Validation band_gap mae = 0.380076
Epoch 35
Validation mae = 0.358712
Validation band_gap mae = 0.358712
Epoch 36
Validation mae = 0.400515
Validation band_gap mae = 0.400515
Epoch 37
Validation mae = 0.292743
Validation band_gap mae = 0.292743
Epoch 38
Validation mae = 0.407882
Validation band_gap mae = 0.407882
Epoch 39
Validation mae = 0.279609
Validation band_gap mae = 0.279609
Epoch 40
Validation mae = 0.303419
Validation band_gap mae = 0.303419
Epoch 41
Validation mae = 0.374361
Validation band_gap mae = 0.374361
Epoch 42
Validation mae = 0.453144
Validation band_gap mae = 0.453144
Epoch 43
Validation mae = 0.335012
Validation band_gap mae = 0.335012
Epoch 44
Validation mae = 0.445740
Validation band_gap mae = 0.445740
Epoch 45
Validation mae = 0.309479
Validation band_gap mae = 0.309479
Epoch 46
Validation mae = 0.278179
Validation band_gap mae = 0.278179
Epoch 47
Validation mae = 0.320926
Validation band_gap mae = 0.320926
Epoch 48
Validation mae = 0.366491
Validation band_gap mae = 0.366491
Epoch 49
Validation mae = 0.311365
Validation band_gap mae = 0.311365
Epoch 50
Validation mae = 0.335922
Validation band_gap mae = 0.335922
Epoch 51
Validation mae = 0.313113
Validation band_gap mae = 0.313113
Epoch 52
Validation mae = 0.306113
Validation band_gap mae = 0.306113
Epoch 53
Validation mae = 0.320234
Validation band_gap mae = 0.320234
Epoch 54
Validation mae = 0.307903
Validation band_gap mae = 0.307903
Epoch 55
Validation mae = 0.449349
Validation band_gap mae = 0.449349
Epoch 56
Validation mae = 0.300109
Validation band_gap mae = 0.300109
Epoch 57
Validation mae = 0.298308
Validation band_gap mae = 0.298308
Epoch 58
Validation mae = 0.333829
Validation band_gap mae = 0.333829
Epoch 59
Validation mae = 0.316373
Validation band_gap mae = 0.316373
Epoch 60
Validation mae = 0.302392
Validation band_gap mae = 0.302392
Epoch 61
Validation mae = 0.280583
Validation band_gap mae = 0.280583
Epoch 62
Validation mae = 0.284925
Validation band_gap mae = 0.284925
Epoch 63
Validation mae = 0.302899
Validation band_gap mae = 0.302899
Epoch 64
Validation mae = 0.295285
Validation band_gap mae = 0.295285
Epoch 65
Validation mae = 0.306374
Validation band_gap mae = 0.306374
Epoch 66
Validation mae = 0.304778
Validation band_gap mae = 0.304778
Epoch 67
Validation mae = 0.330843
Validation band_gap mae = 0.330843
Epoch 68
Validation mae = 0.327104
Validation band_gap mae = 0.327104
Epoch 69
Validation mae = 0.304364
Validation band_gap mae = 0.304364
Epoch 70
Validation mae = 0.364507
Validation band_gap mae = 0.364507
Epoch 71
Validation mae = 0.358267
Validation band_gap mae = 0.358267
Epoch 72
Validation mae = 0.304677
Validation band_gap mae = 0.304677
Epoch 73
Validation mae = 0.283194
Validation band_gap mae = 0.283194
Epoch 74
Validation mae = 0.350008
Validation band_gap mae = 0.350008
Epoch 75
Validation mae = 0.297979
Validation band_gap mae = 0.297979
Epoch 76
Validation mae = 0.323290
Validation band_gap mae = 0.323290
Epoch 77
Validation mae = 0.324210
Validation band_gap mae = 0.324210
Epoch 78
Validation mae = 0.300317
Validation band_gap mae = 0.300317
Epoch 79
Validation mae = 0.320209
Validation band_gap mae = 0.320209
Epoch 80
Validation mae = 0.325145
Validation band_gap mae = 0.325145
Epoch 81
Validation mae = 0.330564
Validation band_gap mae = 0.330564
Epoch 82
Validation mae = 0.314703
Validation band_gap mae = 0.314703
Epoch 83
Validation mae = 0.310253
Validation band_gap mae = 0.310253
Epoch 84
Validation mae = 0.301285
Validation band_gap mae = 0.301285
Epoch 85
Validation mae = 0.304489
Validation band_gap mae = 0.304489
Epoch 86
Validation mae = 0.300079
Validation band_gap mae = 0.300079
Epoch 87
Validation mae = 0.304778
Validation band_gap mae = 0.304778
Epoch 88
Validation mae = 0.299316
Validation band_gap mae = 0.299316
Epoch 89
Validation mae = 0.305596
Validation band_gap mae = 0.305596
Epoch 90
Validation mae = 0.300296
Validation band_gap mae = 0.300296
Epoch 91
Validation mae = 0.304352
Validation band_gap mae = 0.304352
Epoch 92
Validation mae = 0.302520
Validation band_gap mae = 0.302520
Epoch 93
Validation mae = 0.302273
Validation band_gap mae = 0.302273
Epoch 94
Validation mae = 0.305064
Validation band_gap mae = 0.305064
Epoch 95
Validation mae = 0.303700
Validation band_gap mae = 0.303700
Epoch 96
Validation mae = 0.303365
Validation band_gap mae = 0.303365
Epoch 97
Validation mae = 0.306955
Validation band_gap mae = 0.306955
Epoch 98
Validation mae = 0.305106
Validation band_gap mae = 0.305106
Epoch 99
Validation mae = 0.304323
Validation band_gap mae = 0.304323
Model 0 best validation mae = 0.513634 on epoch 13
Moving model to cuda
Model 0 test mae = 0.545172
Model 0 test band_gap mae = 0.545172
Ensemble test mae = 0.545172
Ensemble test band_gap mae = 0.545172
==================== fold 7 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.233092
Validation band_gap mae = 0.233092
Epoch 1
Validation mae = 0.450304
Validation band_gap mae = 0.450304
Epoch 2
Validation mae = 0.149573
Validation band_gap mae = 0.149573
Epoch 3
Validation mae = 0.222405
Validation band_gap mae = 0.222405
Epoch 4
Validation mae = 0.252824
Validation band_gap mae = 0.252824
Epoch 5
Validation mae = 0.139110
Validation band_gap mae = 0.139110
Epoch 6
Validation mae = 0.336834
Validation band_gap mae = 0.336834
Epoch 7
Validation mae = 0.213058
Validation band_gap mae = 0.213058
Epoch 8
Validation mae = 0.273341
Validation band_gap mae = 0.273341
Epoch 9
Validation mae = 0.133716
Validation band_gap mae = 0.133716
Epoch 10
Validation mae = 0.159982
Validation band_gap mae = 0.159982
Epoch 11
Validation mae = 0.194511
Validation band_gap mae = 0.194511
Epoch 12
Validation mae = 0.180651
Validation band_gap mae = 0.180651
Epoch 13
Validation mae = 0.148332
Validation band_gap mae = 0.148332
Epoch 14
Validation mae = 0.181420
Validation band_gap mae = 0.181420
Epoch 15
Validation mae = 0.173577
Validation band_gap mae = 0.173577
Epoch 16
Validation mae = 0.296362
Validation band_gap mae = 0.296362
Epoch 17
Validation mae = 0.176954
Validation band_gap mae = 0.176954
Epoch 18
Validation mae = 0.213106
Validation band_gap mae = 0.213106
Epoch 19
Validation mae = 0.315351
Validation band_gap mae = 0.315351
Epoch 20
Validation mae = 0.141213
Validation band_gap mae = 0.141213
Epoch 21
Validation mae = 0.198014
Validation band_gap mae = 0.198014
Epoch 22
Validation mae = 0.232383
Validation band_gap mae = 0.232383
Epoch 23
Validation mae = 0.133345
Validation band_gap mae = 0.133345
Epoch 24
Validation mae = 0.099683
Validation band_gap mae = 0.099683
Epoch 25
Validation mae = 0.159994
Validation band_gap mae = 0.159994
Epoch 26
Validation mae = 0.114072
Validation band_gap mae = 0.114072
Epoch 27
Validation mae = 0.163190
Validation band_gap mae = 0.163190
Epoch 28
Validation mae = 0.186952
Validation band_gap mae = 0.186952
Epoch 29
Validation mae = 0.152593
Validation band_gap mae = 0.152593
Epoch 30
Validation mae = 0.095233
Validation band_gap mae = 0.095233
Epoch 31
Validation mae = 0.148973
Validation band_gap mae = 0.148973
Epoch 32
Validation mae = 0.140087
Validation band_gap mae = 0.140087
Epoch 33
Validation mae = 0.141764
Validation band_gap mae = 0.141764
Epoch 34
Validation mae = 0.140866
Validation band_gap mae = 0.140866
Epoch 35
Validation mae = 0.138321
Validation band_gap mae = 0.138321
Epoch 36
Validation mae = 0.237388
Validation band_gap mae = 0.237388
Epoch 37
Validation mae = 0.178299
Validation band_gap mae = 0.178299
Epoch 38
Validation mae = 0.270947
Validation band_gap mae = 0.270947
Epoch 39
Validation mae = 0.162707
Validation band_gap mae = 0.162707
Epoch 40
Validation mae = 0.122710
Validation band_gap mae = 0.122710
Epoch 41
Validation mae = 0.167480
Validation band_gap mae = 0.167480
Epoch 42
Validation mae = 0.310596
Validation band_gap mae = 0.310596
Epoch 43
Validation mae = 0.208732
Validation band_gap mae = 0.208732
Epoch 44
Validation mae = 0.149240
Validation band_gap mae = 0.149240
Epoch 45
Validation mae = 0.248075
Validation band_gap mae = 0.248075
Epoch 46
Validation mae = 0.399412
Validation band_gap mae = 0.399412
Epoch 47
Validation mae = 0.242404
Validation band_gap mae = 0.242404
Epoch 48
Validation mae = 0.209805
Validation band_gap mae = 0.209805
Epoch 49
Validation mae = 0.124205
Validation band_gap mae = 0.124205
Epoch 50
Validation mae = 0.168340
Validation band_gap mae = 0.168340
Epoch 51
Validation mae = 0.184025
Validation band_gap mae = 0.184025
Epoch 52
Validation mae = 0.108098
Validation band_gap mae = 0.108098
Epoch 53
Validation mae = 0.105967
Validation band_gap mae = 0.105967
Epoch 54
Validation mae = 0.153338
Validation band_gap mae = 0.153338
Epoch 55
Validation mae = 0.153299
Validation band_gap mae = 0.153299
Epoch 56
Validation mae = 0.148718
Validation band_gap mae = 0.148718
Epoch 57
Validation mae = 0.176360
Validation band_gap mae = 0.176360
Epoch 58
Validation mae = 0.153707
Validation band_gap mae = 0.153707
Epoch 59
Validation mae = 0.111463
Validation band_gap mae = 0.111463
Epoch 60
Validation mae = 0.100079
Validation band_gap mae = 0.100079
Epoch 61
Validation mae = 0.196571
Validation band_gap mae = 0.196571
Epoch 62
Validation mae = 0.119268
Validation band_gap mae = 0.119268
Epoch 63
Validation mae = 0.223221
Validation band_gap mae = 0.223221
Epoch 64
Validation mae = 0.140575
Validation band_gap mae = 0.140575
Epoch 65
Validation mae = 0.110269
Validation band_gap mae = 0.110269
Epoch 66
Validation mae = 0.128897
Validation band_gap mae = 0.128897
Epoch 67
Validation mae = 0.173921
Validation band_gap mae = 0.173921
Epoch 68
Validation mae = 0.159845
Validation band_gap mae = 0.159845
Epoch 69
Validation mae = 0.142640
Validation band_gap mae = 0.142640
Epoch 70
Validation mae = 0.211062
Validation band_gap mae = 0.211062
Epoch 71
Validation mae = 0.098487
Validation band_gap mae = 0.098487
Epoch 72
Validation mae = 0.187112
Validation band_gap mae = 0.187112
Epoch 73
Validation mae = 0.257007
Validation band_gap mae = 0.257007
Epoch 74
Validation mae = 0.117969
Validation band_gap mae = 0.117969
Epoch 75
Validation mae = 0.104386
Validation band_gap mae = 0.104386
Epoch 76
Validation mae = 0.101139
Validation band_gap mae = 0.101139
Epoch 77
Validation mae = 0.110509
Validation band_gap mae = 0.110509
Epoch 78
Validation mae = 0.110415
Validation band_gap mae = 0.110415
Epoch 79
Validation mae = 0.119863
Validation band_gap mae = 0.119863
Epoch 80
Validation mae = 0.135637
Validation band_gap mae = 0.135637
Epoch 81
Validation mae = 0.112196
Validation band_gap mae = 0.112196
Epoch 82
Validation mae = 0.118741
Validation band_gap mae = 0.118741
Epoch 83
Validation mae = 0.114900
Validation band_gap mae = 0.114900
Epoch 84
Validation mae = 0.129684
Validation band_gap mae = 0.129684
Epoch 85
Validation mae = 0.118992
Validation band_gap mae = 0.118992
Epoch 86
Validation mae = 0.111592
Validation band_gap mae = 0.111592
Epoch 87
Validation mae = 0.175930
Validation band_gap mae = 0.175930
Epoch 88
Validation mae = 0.115632
Validation band_gap mae = 0.115632
Epoch 89
Validation mae = 0.107740
Validation band_gap mae = 0.107740
Epoch 90
Validation mae = 0.172543
Validation band_gap mae = 0.172543
Epoch 91
Validation mae = 0.113604
Validation band_gap mae = 0.113604
Epoch 92
Validation mae = 0.116376
Validation band_gap mae = 0.116376
Epoch 93
Validation mae = 0.114456
Validation band_gap mae = 0.114456
Epoch 94
Validation mae = 0.132271
Validation band_gap mae = 0.132271
Epoch 95
Validation mae = 0.131659
Validation band_gap mae = 0.131659
Epoch 96
Validation mae = 0.119157
Validation band_gap mae = 0.119157
Epoch 97
Validation mae = 0.195736
Validation band_gap mae = 0.195736
Epoch 98
Validation mae = 0.116938
Validation band_gap mae = 0.116938
Epoch 99
Validation mae = 0.123871
Validation band_gap mae = 0.123871
Model 0 best validation mae = 0.450304 on epoch 1
Moving model to cuda
Model 0 test mae = 0.448352
Model 0 test band_gap mae = 0.448352
Ensemble test mae = 0.448352
Ensemble test band_gap mae = 0.448352
==================== fold 8 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.309715
Validation band_gap mae = 0.309715
Epoch 1
Validation mae = 0.354550
Validation band_gap mae = 0.354550
Epoch 2
Validation mae = 0.468746
Validation band_gap mae = 0.468746
Epoch 3
Validation mae = 0.379027
Validation band_gap mae = 0.379027
Epoch 4
Validation mae = 0.303611
Validation band_gap mae = 0.303611
Epoch 5
Validation mae = 0.352930
Validation band_gap mae = 0.352930
Epoch 6
Validation mae = 0.328315
Validation band_gap mae = 0.328315
Epoch 7
Validation mae = 0.319639
Validation band_gap mae = 0.319639
Epoch 8
Validation mae = 0.375223
Validation band_gap mae = 0.375223
Epoch 9
Validation mae = 0.302078
Validation band_gap mae = 0.302078
Epoch 10
Validation mae = 0.315980
Validation band_gap mae = 0.315980
Epoch 11
Validation mae = 0.300858
Validation band_gap mae = 0.300858
Epoch 12
Validation mae = 0.297186
Validation band_gap mae = 0.297186
Epoch 13
Validation mae = 0.296642
Validation band_gap mae = 0.296642
Epoch 14
Validation mae = 0.338017
Validation band_gap mae = 0.338017
Epoch 15
Validation mae = 0.322672
Validation band_gap mae = 0.322672
Epoch 16
Validation mae = 0.403075
Validation band_gap mae = 0.403075
Epoch 17
Validation mae = 0.287850
Validation band_gap mae = 0.287850
Epoch 18
Validation mae = 0.270149
Validation band_gap mae = 0.270149
Epoch 19
Validation mae = 0.331380
Validation band_gap mae = 0.331380
Epoch 20
Validation mae = 0.276098
Validation band_gap mae = 0.276098
Epoch 21
Validation mae = 0.328855
Validation band_gap mae = 0.328855
Epoch 22
Validation mae = 0.281407
Validation band_gap mae = 0.281407
Epoch 23
Validation mae = 0.320862
Validation band_gap mae = 0.320862
Epoch 24
Validation mae = 0.375042
Validation band_gap mae = 0.375042
Epoch 25
Validation mae = 0.295946
Validation band_gap mae = 0.295946
Epoch 26
Validation mae = 0.323260
Validation band_gap mae = 0.323260
Epoch 27
Validation mae = 0.302643
Validation band_gap mae = 0.302643
Epoch 28
Validation mae = 0.264688
Validation band_gap mae = 0.264688
Epoch 29
Validation mae = 0.309830
Validation band_gap mae = 0.309830
Epoch 30
Validation mae = 0.273920
Validation band_gap mae = 0.273920
Epoch 31
Validation mae = 0.283317
Validation band_gap mae = 0.283317
Epoch 32
Validation mae = 0.348640
Validation band_gap mae = 0.348640
Epoch 33
Validation mae = 0.278563
Validation band_gap mae = 0.278563
Epoch 34
Validation mae = 0.278591
Validation band_gap mae = 0.278591
Epoch 35
Validation mae = 0.310160
Validation band_gap mae = 0.310160
Epoch 36
Validation mae = 0.262428
Validation band_gap mae = 0.262428
Epoch 37
Validation mae = 0.333269
Validation band_gap mae = 0.333269
Epoch 38
Validation mae = 0.395653
Validation band_gap mae = 0.395653
Epoch 39
Validation mae = 0.291011
Validation band_gap mae = 0.291011
Epoch 40
Validation mae = 0.269213
Validation band_gap mae = 0.269213
Epoch 41
Validation mae = 0.259791
Validation band_gap mae = 0.259791
Epoch 42
Validation mae = 0.266702
Validation band_gap mae = 0.266702
Epoch 43
Validation mae = 0.259307
Validation band_gap mae = 0.259307
Epoch 44
Validation mae = 0.257764
Validation band_gap mae = 0.257764
Epoch 45
Validation mae = 0.361889
Validation band_gap mae = 0.361889
Epoch 46
Validation mae = 0.387020
Validation band_gap mae = 0.387020
Epoch 47
Validation mae = 0.340501
Validation band_gap mae = 0.340501
Epoch 48
Validation mae = 0.277865
Validation band_gap mae = 0.277865
Epoch 49
Validation mae = 0.372991
Validation band_gap mae = 0.372991
Epoch 50
Validation mae = 0.274278
Validation band_gap mae = 0.274278
Epoch 51
Validation mae = 0.293062
Validation band_gap mae = 0.293062
Epoch 52
Validation mae = 0.286389
Validation band_gap mae = 0.286389
Epoch 53
Validation mae = 0.276138
Validation band_gap mae = 0.276138
Epoch 54
Validation mae = 0.262368
Validation band_gap mae = 0.262368
Epoch 55
Validation mae = 0.265752
Validation band_gap mae = 0.265752
Epoch 56
Validation mae = 0.285643
Validation band_gap mae = 0.285643
Epoch 57
Validation mae = 0.288058
Validation band_gap mae = 0.288058
Epoch 58
Validation mae = 0.295479
Validation band_gap mae = 0.295479
Epoch 59
Validation mae = 0.319173
Validation band_gap mae = 0.319173
Epoch 60
Validation mae = 0.410379
Validation band_gap mae = 0.410379
Epoch 61
Validation mae = 0.313742
Validation band_gap mae = 0.313742
Epoch 62
Validation mae = 0.261079
Validation band_gap mae = 0.261079
Epoch 63
Validation mae = 0.273338
Validation band_gap mae = 0.273338
Epoch 64
Validation mae = 0.354049
Validation band_gap mae = 0.354049
Epoch 65
Validation mae = 0.272180
Validation band_gap mae = 0.272180
Epoch 66
Validation mae = 0.271270
Validation band_gap mae = 0.271270
Epoch 67
Validation mae = 0.242676
Validation band_gap mae = 0.242676
Epoch 68
Validation mae = 0.275951
Validation band_gap mae = 0.275951
Epoch 69
Validation mae = 0.284728
Validation band_gap mae = 0.284728
Epoch 70
Validation mae = 0.337800
Validation band_gap mae = 0.337800
Epoch 71
Validation mae = 0.297161
Validation band_gap mae = 0.297161
Epoch 72
Validation mae = 0.279145
Validation band_gap mae = 0.279145
Epoch 73
Validation mae = 0.342367
Validation band_gap mae = 0.342367
Epoch 74
Validation mae = 0.267070
Validation band_gap mae = 0.267070
Epoch 75
Validation mae = 0.271547
Validation band_gap mae = 0.271547
Epoch 76
Validation mae = 0.284562
Validation band_gap mae = 0.284562
Epoch 77
Validation mae = 0.257480
Validation band_gap mae = 0.257480
Epoch 78
Validation mae = 0.278364
Validation band_gap mae = 0.278364
Epoch 79
Validation mae = 0.297797
Validation band_gap mae = 0.297797
Epoch 80
Validation mae = 0.268920
Validation band_gap mae = 0.268920
Epoch 81
Validation mae = 0.289782
Validation band_gap mae = 0.289782
Epoch 82
Validation mae = 0.274167
Validation band_gap mae = 0.274167
Epoch 83
Validation mae = 0.291316
Validation band_gap mae = 0.291316
Epoch 84
Validation mae = 0.279787
Validation band_gap mae = 0.279787
Epoch 85
Validation mae = 0.277853
Validation band_gap mae = 0.277853
Epoch 86
Validation mae = 0.298278
Validation band_gap mae = 0.298278
Epoch 87
Validation mae = 0.276002
Validation band_gap mae = 0.276002
Epoch 88
Validation mae = 0.282132
Validation band_gap mae = 0.282132
Epoch 89
Validation mae = 0.288912
Validation band_gap mae = 0.288912
Epoch 90
Validation mae = 0.283058
Validation band_gap mae = 0.283058
Epoch 91
Validation mae = 0.284516
Validation band_gap mae = 0.284516
Epoch 92
Validation mae = 0.277470
Validation band_gap mae = 0.277470
Epoch 93
Validation mae = 0.274978
Validation band_gap mae = 0.274978
Epoch 94
Validation mae = 0.289745
Validation band_gap mae = 0.289745
Epoch 95
Validation mae = 0.277146
Validation band_gap mae = 0.277146
Epoch 96
Validation mae = 0.281357
Validation band_gap mae = 0.281357
Epoch 97
Validation mae = 0.294890
Validation band_gap mae = 0.294890
Epoch 98
Validation mae = 0.281824
Validation band_gap mae = 0.281824
Epoch 99
Validation mae = 0.287973
Validation band_gap mae = 0.287973
Model 0 best validation mae = 0.468746 on epoch 2
Moving model to cuda
Model 0 test mae = 0.267900
Model 0 test band_gap mae = 0.267900
Ensemble test mae = 0.267900
Ensemble test band_gap mae = 0.267900
==================== fold 9 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.425948
Validation band_gap mae = 0.425948
Epoch 1
Validation mae = 0.575630
Validation band_gap mae = 0.575630
Epoch 2
Validation mae = 0.562072
Validation band_gap mae = 0.562072
Epoch 3
Validation mae = 0.448950
Validation band_gap mae = 0.448950
Epoch 4
Validation mae = 0.483077
Validation band_gap mae = 0.483077
Epoch 5
Validation mae = 0.468748
Validation band_gap mae = 0.468748
Epoch 6
Validation mae = 0.532278
Validation band_gap mae = 0.532278
Epoch 7
Validation mae = 0.468628
Validation band_gap mae = 0.468628
Epoch 8
Validation mae = 0.423702
Validation band_gap mae = 0.423702
Epoch 9
Validation mae = 0.424088
Validation band_gap mae = 0.424088
Epoch 10
Validation mae = 0.419758
Validation band_gap mae = 0.419758
Epoch 11
Validation mae = 0.511901
Validation band_gap mae = 0.511901
Epoch 12
Validation mae = 0.526777
Validation band_gap mae = 0.526777
Epoch 13
Validation mae = 0.612693
Validation band_gap mae = 0.612693
Epoch 14
Validation mae = 0.527791
Validation band_gap mae = 0.527791
Epoch 15
Validation mae = 0.415670
Validation band_gap mae = 0.415670
Epoch 16
Validation mae = 0.471001
Validation band_gap mae = 0.471001
Epoch 17
Validation mae = 0.429773
Validation band_gap mae = 0.429773
Epoch 18
Validation mae = 0.441774
Validation band_gap mae = 0.441774
Epoch 19
Validation mae = 0.528128
Validation band_gap mae = 0.528128
Epoch 20
Validation mae = 0.425899
Validation band_gap mae = 0.425899
Epoch 21
Validation mae = 0.460853
Validation band_gap mae = 0.460853
Epoch 22
Validation mae = 0.430621
Validation band_gap mae = 0.430621
Epoch 23
Validation mae = 0.442913
Validation band_gap mae = 0.442913
Epoch 24
Validation mae = 0.446512
Validation band_gap mae = 0.446512
Epoch 25
Validation mae = 0.427936
Validation band_gap mae = 0.427936
Epoch 26
Validation mae = 0.495620
Validation band_gap mae = 0.495620
Epoch 27
Validation mae = 0.447153
Validation band_gap mae = 0.447153
Epoch 28
Validation mae = 0.497238
Validation band_gap mae = 0.497238
Epoch 29
Validation mae = 0.441420
Validation band_gap mae = 0.441420
Epoch 30
Validation mae = 0.478062
Validation band_gap mae = 0.478062
Epoch 31
Validation mae = 0.496807
Validation band_gap mae = 0.496807
Epoch 32
Validation mae = 0.421879
Validation band_gap mae = 0.421879
Epoch 33
Validation mae = 0.492545
Validation band_gap mae = 0.492545
Epoch 34
Validation mae = 0.422319
Validation band_gap mae = 0.422319
Epoch 35
Validation mae = 0.447425
Validation band_gap mae = 0.447425
Epoch 36
Validation mae = 0.472670
Validation band_gap mae = 0.472670
Epoch 37
Validation mae = 0.424729
Validation band_gap mae = 0.424729
Epoch 38
Validation mae = 0.414119
Validation band_gap mae = 0.414119
Epoch 39
Validation mae = 0.432415
Validation band_gap mae = 0.432415
Epoch 40
Validation mae = 0.425268
Validation band_gap mae = 0.425268
Epoch 41
Validation mae = 0.444942
Validation band_gap mae = 0.444942
Epoch 42
Validation mae = 0.468618
Validation band_gap mae = 0.468618
Epoch 43
Validation mae = 0.431314
Validation band_gap mae = 0.431314
Epoch 44
Validation mae = 0.461073
Validation band_gap mae = 0.461073
Epoch 45
Validation mae = 0.411588
Validation band_gap mae = 0.411588
Epoch 46
Validation mae = 0.423175
Validation band_gap mae = 0.423175
Epoch 47
Validation mae = 0.465384
Validation band_gap mae = 0.465384
Epoch 48
Validation mae = 0.461327
Validation band_gap mae = 0.461327
Epoch 49
Validation mae = 0.424201
Validation band_gap mae = 0.424201
Epoch 50
Validation mae = 0.427040
Validation band_gap mae = 0.427040
Epoch 51
Validation mae = 0.428714
Validation band_gap mae = 0.428714
Epoch 52
Validation mae = 0.509316
Validation band_gap mae = 0.509316
Epoch 53
Validation mae = 0.502390
Validation band_gap mae = 0.502390
Epoch 54
Validation mae = 0.450588
Validation band_gap mae = 0.450588
Epoch 55
Validation mae = 0.446991
Validation band_gap mae = 0.446991
Epoch 56
Validation mae = 0.468915
Validation band_gap mae = 0.468915
Epoch 57
Validation mae = 0.427800
Validation band_gap mae = 0.427800
Epoch 58
Validation mae = 0.438462
Validation band_gap mae = 0.438462
Epoch 59
Validation mae = 0.431823
Validation band_gap mae = 0.431823
Epoch 60
Validation mae = 0.433662
Validation band_gap mae = 0.433662
Epoch 61
Validation mae = 0.428435
Validation band_gap mae = 0.428435
Epoch 62
Validation mae = 0.430095
Validation band_gap mae = 0.430095
Epoch 63
Validation mae = 0.428364
Validation band_gap mae = 0.428364
Epoch 64
Validation mae = 0.420427
Validation band_gap mae = 0.420427
Epoch 65
Validation mae = 0.437939
Validation band_gap mae = 0.437939
Epoch 66
Validation mae = 0.457447
Validation band_gap mae = 0.457447
Epoch 67
Validation mae = 0.418296
Validation band_gap mae = 0.418296
Epoch 68
Validation mae = 0.442235
Validation band_gap mae = 0.442235
Epoch 69
Validation mae = 0.426716
Validation band_gap mae = 0.426716
Epoch 70
Validation mae = 0.426762
Validation band_gap mae = 0.426762
Epoch 71
Validation mae = 0.435974
Validation band_gap mae = 0.435974
Epoch 72
Validation mae = 0.447613
Validation band_gap mae = 0.447613
Epoch 73
Validation mae = 0.417694
Validation band_gap mae = 0.417694
Epoch 74
Validation mae = 0.421822
Validation band_gap mae = 0.421822
Epoch 75
Validation mae = 0.445773
Validation band_gap mae = 0.445773
Epoch 76
Validation mae = 0.420973
Validation band_gap mae = 0.420973
Epoch 77
Validation mae = 0.422508
Validation band_gap mae = 0.422508
Epoch 78
Validation mae = 0.432036
Validation band_gap mae = 0.432036
Epoch 79
Validation mae = 0.434696
Validation band_gap mae = 0.434696
Epoch 80
Validation mae = 0.444030
Validation band_gap mae = 0.444030
Epoch 81
Validation mae = 0.449978
Validation band_gap mae = 0.449978
Epoch 82
Validation mae = 0.427925
Validation band_gap mae = 0.427925
Epoch 83
Validation mae = 0.487774
Validation band_gap mae = 0.487774
Epoch 84
Validation mae = 0.420086
Validation band_gap mae = 0.420086
Epoch 85
Validation mae = 0.427712
Validation band_gap mae = 0.427712
Epoch 86
Validation mae = 0.436965
Validation band_gap mae = 0.436965
Epoch 87
Validation mae = 0.448684
Validation band_gap mae = 0.448684
Epoch 88
Validation mae = 0.421655
Validation band_gap mae = 0.421655
Epoch 89
Validation mae = 0.424410
Validation band_gap mae = 0.424410
Epoch 90
Validation mae = 0.433677
Validation band_gap mae = 0.433677
Epoch 91
Validation mae = 0.418734
Validation band_gap mae = 0.418734
Epoch 92
Validation mae = 0.422194
Validation band_gap mae = 0.422194
Epoch 93
Validation mae = 0.436103
Validation band_gap mae = 0.436103
Epoch 94
Validation mae = 0.421687
Validation band_gap mae = 0.421687
Epoch 95
Validation mae = 0.422487
Validation band_gap mae = 0.422487
Epoch 96
Validation mae = 0.438623
Validation band_gap mae = 0.438623
Epoch 97
Validation mae = 0.420806
Validation band_gap mae = 0.420806
Epoch 98
Validation mae = 0.423799
Validation band_gap mae = 0.423799
Epoch 99
Validation mae = 0.417333
Validation band_gap mae = 0.417333
Model 0 best validation mae = 0.612693 on epoch 13
Moving model to cuda
Model 0 test mae = 0.355680
Model 0 test band_gap mae = 0.355680
Ensemble test mae = 0.355680
Ensemble test band_gap mae = 0.355680
10-fold cross validation
Seed 0
Fold 0 ==> valid mae = 10.365677 test mae = 9.837577
Fold 0 ==> valid band_gap mae = 10.365677test band_gap mae = 9.837577
Fold 1 ==> valid mae = 6.986115 test mae = 4.017481
Fold 1 ==> valid band_gap mae = 6.986115test band_gap mae = 4.017481
Fold 2 ==> valid mae = 4.186166 test mae = 2.816748
Fold 2 ==> valid band_gap mae = 4.186166test band_gap mae = 2.816748
Fold 3 ==> valid mae = 2.827920 test mae = 0.464148
Fold 3 ==> valid band_gap mae = 2.827920test band_gap mae = 0.464148
Fold 4 ==> valid mae = 1.986925 test mae = 1.713111
Fold 4 ==> valid band_gap mae = 1.986925test band_gap mae = 1.713111
Fold 5 ==> valid mae = 0.586861 test mae = 0.622898
Fold 5 ==> valid band_gap mae = 0.586861test band_gap mae = 0.622898
Fold 6 ==> valid mae = 0.513634 test mae = 0.545172
Fold 6 ==> valid band_gap mae = 0.513634test band_gap mae = 0.545172
Fold 7 ==> valid mae = 0.450304 test mae = 0.448352
Fold 7 ==> valid band_gap mae = 0.450304test band_gap mae = 0.448352
Fold 8 ==> valid mae = 0.468746 test mae = 0.267900
Fold 8 ==> valid band_gap mae = 0.468746test band_gap mae = 0.267900
Fold 9 ==> valid mae = 0.612693 test mae = 0.355680
Fold 9 ==> valid band_gap mae = 0.612693test band_gap mae = 0.355680
Overall valid mae = 2.898504 +/- 3.211151
Overall test mae = 2.108907 +/- 2.839224
Overall test band_gap mae = 2.108907 +/- 2.839224
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 1.242148
Validation band_gap mae = 1.242148
Epoch 1
Validation mae = 1.213592
Validation band_gap mae = 1.213592
Epoch 2
Validation mae = 1.184698
Validation band_gap mae = 1.184698
Epoch 3
Validation mae = 1.468933
Validation band_gap mae = 1.468933
Epoch 4
Validation mae = 1.208486
Validation band_gap mae = 1.208486
Epoch 5
Validation mae = 1.075991
Validation band_gap mae = 1.075991
Epoch 6
Validation mae = 1.143130
Validation band_gap mae = 1.143130
Epoch 7
Validation mae = 1.013015
Validation band_gap mae = 1.013015
Epoch 8
Validation mae = 1.018764
Validation band_gap mae = 1.018764
Epoch 9
Validation mae = 1.215250
Validation band_gap mae = 1.215250
Epoch 10
Validation mae = 1.037606
Validation band_gap mae = 1.037606
Epoch 11
Validation mae = 1.170897
Validation band_gap mae = 1.170897
Epoch 12
Validation mae = 1.088740
Validation band_gap mae = 1.088740
Epoch 13
Validation mae = 0.981211
Validation band_gap mae = 0.981211
Epoch 14
Validation mae = 1.106711
Validation band_gap mae = 1.106711
Epoch 15
Validation mae = 1.017259
Validation band_gap mae = 1.017259
Epoch 16
Validation mae = 0.979882
Validation band_gap mae = 0.979882
Epoch 17
Validation mae = 1.042309
Validation band_gap mae = 1.042309
Epoch 18
Validation mae = 1.052813
Validation band_gap mae = 1.052813
Epoch 19
Validation mae = 0.989663
Validation band_gap mae = 0.989663
Epoch 20
Validation mae = 1.319655
Validation band_gap mae = 1.319655
Epoch 21
Validation mae = 0.974392
Validation band_gap mae = 0.974392
Epoch 22
Validation mae = 1.111172
Validation band_gap mae = 1.111172
Epoch 23
Validation mae = 1.066800
Validation band_gap mae = 1.066800
Epoch 24
Validation mae = 0.995813
Validation band_gap mae = 0.995813
Epoch 25
Validation mae = 1.034634
Validation band_gap mae = 1.034634
Epoch 26
Validation mae = 0.976468
Validation band_gap mae = 0.976468
Epoch 27
Validation mae = 0.993262
Validation band_gap mae = 0.993262
Epoch 28
Validation mae = 1.099614
Validation band_gap mae = 1.099614
Epoch 29
Validation mae = 1.134348
Validation band_gap mae = 1.134348
Epoch 30
Validation mae = 1.069468
Validation band_gap mae = 1.069468
Epoch 31
Validation mae = 1.049995
Validation band_gap mae = 1.049995
Epoch 32
Validation mae = 1.075853
Validation band_gap mae = 1.075853
Epoch 33
Validation mae = 1.036137
Validation band_gap mae = 1.036137
Epoch 34
Validation mae = 1.130754
Validation band_gap mae = 1.130754
Epoch 35
Validation mae = 1.049005
Validation band_gap mae = 1.049005
Epoch 36
Validation mae = 1.160804
Validation band_gap mae = 1.160804
Epoch 37
Validation mae = 1.029491
Validation band_gap mae = 1.029491
Epoch 38
Validation mae = 1.151516
Validation band_gap mae = 1.151516
Epoch 39
Validation mae = 1.040375
Validation band_gap mae = 1.040375
Epoch 40
Validation mae = 1.178872
Validation band_gap mae = 1.178872
Epoch 41
Validation mae = 1.054621
Validation band_gap mae = 1.054621
Epoch 42
Validation mae = 1.154995
Validation band_gap mae = 1.154995
Epoch 43
Validation mae = 1.094377
Validation band_gap mae = 1.094377
Epoch 44
Validation mae = 1.212010
Validation band_gap mae = 1.212010
Epoch 45
Validation mae = 1.061672
Validation band_gap mae = 1.061672
Epoch 46
Validation mae = 1.151414
Validation band_gap mae = 1.151414
Epoch 47
Validation mae = 1.116065
Validation band_gap mae = 1.116065
Epoch 48
Validation mae = 1.128062
Validation band_gap mae = 1.128062
Epoch 49
Validation mae = 1.160657
Validation band_gap mae = 1.160657
Epoch 50
Validation mae = 1.114532
Validation band_gap mae = 1.114532
Epoch 51
Validation mae = 1.152841
Validation band_gap mae = 1.152841
Epoch 52
Validation mae = 1.122798
Validation band_gap mae = 1.122798
Epoch 53
Validation mae = 1.170758
Validation band_gap mae = 1.170758
Epoch 54
Validation mae = 1.164796
Validation band_gap mae = 1.164796
Epoch 55
Validation mae = 1.162897
Validation band_gap mae = 1.162897
Epoch 56
Validation mae = 1.141596
Validation band_gap mae = 1.141596
Epoch 57
Validation mae = 1.100517
Validation band_gap mae = 1.100517
Epoch 58
Validation mae = 1.159394
Validation band_gap mae = 1.159394
Epoch 59
Validation mae = 1.123660
Validation band_gap mae = 1.123660
Epoch 60
Validation mae = 1.128899
Validation band_gap mae = 1.128899
Epoch 61
Validation mae = 1.164605
Validation band_gap mae = 1.164605
Epoch 62
Validation mae = 1.130471
Validation band_gap mae = 1.130471
Epoch 63
Validation mae = 1.164929
Validation band_gap mae = 1.164929
Epoch 64
Validation mae = 1.115836
Validation band_gap mae = 1.115836
Epoch 65
Validation mae = 1.136827
Validation band_gap mae = 1.136827
Epoch 66
Validation mae = 1.179150
Validation band_gap mae = 1.179150
Epoch 67
Validation mae = 1.140872
Validation band_gap mae = 1.140872
Epoch 68
Validation mae = 1.169609
Validation band_gap mae = 1.169609
Epoch 69
Validation mae = 1.140779
Validation band_gap mae = 1.140779
Epoch 70
Validation mae = 1.156329
Validation band_gap mae = 1.156329
Epoch 71
Validation mae = 1.170666
Validation band_gap mae = 1.170666
Epoch 72
Validation mae = 1.141583
Validation band_gap mae = 1.141583
Epoch 73
Validation mae = 1.140406
Validation band_gap mae = 1.140406
Epoch 74
Validation mae = 1.125679
Validation band_gap mae = 1.125679
Epoch 75
Validation mae = 1.187122
Validation band_gap mae = 1.187122
Epoch 76
Validation mae = 1.146413
Validation band_gap mae = 1.146413
Epoch 77
Validation mae = 1.189543
Validation band_gap mae = 1.189543
Epoch 78
Validation mae = 1.125686
Validation band_gap mae = 1.125686
Epoch 79
Validation mae = 1.144059
Validation band_gap mae = 1.144059
Epoch 80
Validation mae = 1.130334
Validation band_gap mae = 1.130334
Epoch 81
Validation mae = 1.155180
Validation band_gap mae = 1.155180
Epoch 82
Validation mae = 1.151953
Validation band_gap mae = 1.151953
Epoch 83
Validation mae = 1.147418
Validation band_gap mae = 1.147418
Epoch 84
Validation mae = 1.173152
Validation band_gap mae = 1.173152
Epoch 85
Validation mae = 1.135228
Validation band_gap mae = 1.135228
Epoch 86
Validation mae = 1.163913
Validation band_gap mae = 1.163913
Epoch 87
Validation mae = 1.137665
Validation band_gap mae = 1.137665
Epoch 88
Validation mae = 1.157187
Validation band_gap mae = 1.157187
Epoch 89
Validation mae = 1.158314
Validation band_gap mae = 1.158314
Epoch 90
Validation mae = 1.139400
Validation band_gap mae = 1.139400
Epoch 91
Validation mae = 1.154702
Validation band_gap mae = 1.154702
Epoch 92
Validation mae = 1.136964
Validation band_gap mae = 1.136964
Epoch 93
Validation mae = 1.144085
Validation band_gap mae = 1.144085
Epoch 94
Validation mae = 1.150058
Validation band_gap mae = 1.150058
Epoch 95
Validation mae = 1.139854
Validation band_gap mae = 1.139854
Epoch 96
Validation mae = 1.152188
Validation band_gap mae = 1.152188
Epoch 97
Validation mae = 1.145974
Validation band_gap mae = 1.145974
Epoch 98
Validation mae = 1.121224
Validation band_gap mae = 1.121224
Epoch 99
Validation mae = 1.131463
Validation band_gap mae = 1.131463
Model 0 best validation mae = 1.468933 on epoch 3
Moving model to cuda
Model 0 test mae = 1.519323
Model 0 test band_gap mae = 1.519323
Ensemble test mae = 1.519323
Ensemble test band_gap mae = 1.519323
==================== fold 1 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 1.238708
Validation band_gap mae = 1.238708
Epoch 1
Validation mae = 1.197371
Validation band_gap mae = 1.197371
Epoch 2
Validation mae = 1.226453
Validation band_gap mae = 1.226453
Epoch 3
Validation mae = 1.237244
Validation band_gap mae = 1.237244
Epoch 4
Validation mae = 1.130293
Validation band_gap mae = 1.130293
Epoch 5
Validation mae = 1.089161
Validation band_gap mae = 1.089161
Epoch 6
Validation mae = 1.106616
Validation band_gap mae = 1.106616
Epoch 7
Validation mae = 1.106880
Validation band_gap mae = 1.106880
Epoch 8
Validation mae = 1.173015
Validation band_gap mae = 1.173015
Epoch 9
Validation mae = 1.148897
Validation band_gap mae = 1.148897
Epoch 10
Validation mae = 1.095228
Validation band_gap mae = 1.095228
Epoch 11
Validation mae = 1.039184
Validation band_gap mae = 1.039184
Epoch 12
Validation mae = 1.062584
Validation band_gap mae = 1.062584
Epoch 13
Validation mae = 1.093554
Validation band_gap mae = 1.093554
Epoch 14
Validation mae = 1.024302
Validation band_gap mae = 1.024302
Epoch 15
Validation mae = 1.053100
Validation band_gap mae = 1.053100
Epoch 16
Validation mae = 1.077513
Validation band_gap mae = 1.077513
Epoch 17
Validation mae = 1.088883
Validation band_gap mae = 1.088883
Epoch 18
Validation mae = 1.062644
Validation band_gap mae = 1.062644
Epoch 19
Validation mae = 1.060858
Validation band_gap mae = 1.060858
Epoch 20
Validation mae = 1.065082
Validation band_gap mae = 1.065082
Epoch 21
Validation mae = 1.059046
Validation band_gap mae = 1.059046
Epoch 22
Validation mae = 1.044166
Validation band_gap mae = 1.044166
Epoch 23
Validation mae = 1.144535
Validation band_gap mae = 1.144535
Epoch 24
Validation mae = 1.060583
Validation band_gap mae = 1.060583
Epoch 25
Validation mae = 1.083128
Validation band_gap mae = 1.083128
Epoch 26
Validation mae = 1.053185
Validation band_gap mae = 1.053185
Epoch 27
Validation mae = 1.105679
Validation band_gap mae = 1.105679
Epoch 28
Validation mae = 1.139100
Validation band_gap mae = 1.139100
Epoch 29
Validation mae = 1.173709
Validation band_gap mae = 1.173709
Epoch 30
Validation mae = 1.142623
Validation band_gap mae = 1.142623
Epoch 31
Validation mae = 1.146737
Validation band_gap mae = 1.146737
Epoch 32
Validation mae = 1.090932
Validation band_gap mae = 1.090932
Epoch 33
Validation mae = 1.084131
Validation band_gap mae = 1.084131
Epoch 34
Validation mae = 1.097211
Validation band_gap mae = 1.097211
Epoch 35
Validation mae = 1.168253
Validation band_gap mae = 1.168253
Epoch 36
Validation mae = 1.158934
Validation band_gap mae = 1.158934
Epoch 37
Validation mae = 1.163593
Validation band_gap mae = 1.163593
Epoch 38
Validation mae = 1.142080
Validation band_gap mae = 1.142080
Epoch 39
Validation mae = 1.111378
Validation band_gap mae = 1.111378
Epoch 40
Validation mae = 1.140893
Validation band_gap mae = 1.140893
Epoch 41
Validation mae = 1.141452
Validation band_gap mae = 1.141452
Epoch 42
Validation mae = 1.137241
Validation band_gap mae = 1.137241
Epoch 43
Validation mae = 1.183543
Validation band_gap mae = 1.183543
Epoch 44
Validation mae = 1.117760
Validation band_gap mae = 1.117760
Epoch 45
Validation mae = 1.219760
Validation band_gap mae = 1.219760
Epoch 46
Validation mae = 1.130904
Validation band_gap mae = 1.130904
Epoch 47
Validation mae = 1.111797
Validation band_gap mae = 1.111797
Epoch 48
Validation mae = 1.163844
Validation band_gap mae = 1.163844
Epoch 49
Validation mae = 1.147799
Validation band_gap mae = 1.147799
Epoch 50
Validation mae = 1.153004
Validation band_gap mae = 1.153004
Epoch 51
Validation mae = 1.148351
Validation band_gap mae = 1.148351
Epoch 52
Validation mae = 1.155192
Validation band_gap mae = 1.155192
Epoch 53
Validation mae = 1.137926
Validation band_gap mae = 1.137926
Epoch 54
Validation mae = 1.146913
Validation band_gap mae = 1.146913
Epoch 55
Validation mae = 1.173191
Validation band_gap mae = 1.173191
Epoch 56
Validation mae = 1.102637
Validation band_gap mae = 1.102637
Epoch 57
Validation mae = 1.140682
Validation band_gap mae = 1.140682
Epoch 58
Validation mae = 1.152620
Validation band_gap mae = 1.152620
Epoch 59
Validation mae = 1.183868
Validation band_gap mae = 1.183868
Epoch 60
Validation mae = 1.156001
Validation band_gap mae = 1.156001
Epoch 61
Validation mae = 1.149137
Validation band_gap mae = 1.149137
Epoch 62
Validation mae = 1.148229
Validation band_gap mae = 1.148229
Epoch 63
Validation mae = 1.125009
Validation band_gap mae = 1.125009
Epoch 64
Validation mae = 1.156479
Validation band_gap mae = 1.156479
Epoch 65
Validation mae = 1.146310
Validation band_gap mae = 1.146310
Epoch 66
Validation mae = 1.153775
Validation band_gap mae = 1.153775
Epoch 67
Validation mae = 1.168593
Validation band_gap mae = 1.168593
Epoch 68
Validation mae = 1.150195
Validation band_gap mae = 1.150195
Epoch 69
Validation mae = 1.175792
Validation band_gap mae = 1.175792
Epoch 70
Validation mae = 1.142332
Validation band_gap mae = 1.142332
Epoch 71
Validation mae = 1.179831
Validation band_gap mae = 1.179831
Epoch 72
Validation mae = 1.153833
Validation band_gap mae = 1.153833
Epoch 73
Validation mae = 1.151158
Validation band_gap mae = 1.151158
Epoch 74
Validation mae = 1.179027
Validation band_gap mae = 1.179027
Epoch 75
Validation mae = 1.164724
Validation band_gap mae = 1.164724
Epoch 76
Validation mae = 1.161248
Validation band_gap mae = 1.161248
Epoch 77
Validation mae = 1.183800
Validation band_gap mae = 1.183800
Epoch 78
Validation mae = 1.143522
Validation band_gap mae = 1.143522
Epoch 79
Validation mae = 1.166684
Validation band_gap mae = 1.166684
Epoch 80
Validation mae = 1.166944
Validation band_gap mae = 1.166944
Epoch 81
Validation mae = 1.182862
Validation band_gap mae = 1.182862
Epoch 82
Validation mae = 1.172577
Validation band_gap mae = 1.172577
Epoch 83
Validation mae = 1.180913
Validation band_gap mae = 1.180913
Epoch 84
Validation mae = 1.140438
Validation band_gap mae = 1.140438
Epoch 85
Validation mae = 1.148306
Validation band_gap mae = 1.148306
Epoch 86
Validation mae = 1.155976
Validation band_gap mae = 1.155976
Epoch 87
Validation mae = 1.152652
Validation band_gap mae = 1.152652
Epoch 88
Validation mae = 1.162873
Validation band_gap mae = 1.162873
Epoch 89
Validation mae = 1.159818
Validation band_gap mae = 1.159818
Epoch 90
Validation mae = 1.194416
Validation band_gap mae = 1.194416
Epoch 91
Validation mae = 1.144962
Validation band_gap mae = 1.144962
Epoch 92
Validation mae = 1.143703
Validation band_gap mae = 1.143703
Epoch 93
Validation mae = 1.163528
Validation band_gap mae = 1.163528
Epoch 94
Validation mae = 1.191339
Validation band_gap mae = 1.191339
Epoch 95
Validation mae = 1.168002
Validation band_gap mae = 1.168002
Epoch 96
Validation mae = 1.153471
Validation band_gap mae = 1.153471
Epoch 97
Validation mae = 1.156961
Validation band_gap mae = 1.156961
Epoch 98
Validation mae = 1.148674
Validation band_gap mae = 1.148674
Epoch 99
Validation mae = 1.159210
Validation band_gap mae = 1.159210
Model 0 best validation mae = 1.238708 on epoch 0
Moving model to cuda
Model 0 test mae = 0.797192
Model 0 test band_gap mae = 0.797192
Ensemble test mae = 0.797192
Ensemble test band_gap mae = 0.797192
==================== fold 2 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 1.077900
Validation band_gap mae = 1.077900
Epoch 1
Validation mae = 1.053553
Validation band_gap mae = 1.053553
Epoch 2
Validation mae = 1.100163
Validation band_gap mae = 1.100163
Epoch 3
Validation mae = 1.010384
Validation band_gap mae = 1.010384
Epoch 4
Validation mae = 1.018258
Validation band_gap mae = 1.018258
Epoch 5
Validation mae = 1.008863
Validation band_gap mae = 1.008863
Epoch 6
Validation mae = 0.995470
Validation band_gap mae = 0.995470
Epoch 7
Validation mae = 1.018045
Validation band_gap mae = 1.018045
Epoch 8
Validation mae = 1.001997
Validation band_gap mae = 1.001997
Epoch 9
Validation mae = 1.004068
Validation band_gap mae = 1.004068
Epoch 10
Validation mae = 0.997642
Validation band_gap mae = 0.997642
Epoch 11
Validation mae = 1.012165
Validation band_gap mae = 1.012165
Epoch 12
Validation mae = 1.001742
Validation band_gap mae = 1.001742
Epoch 13
Validation mae = 1.028304
Validation band_gap mae = 1.028304
Epoch 14
Validation mae = 0.980695
Validation band_gap mae = 0.980695
Epoch 15
Validation mae = 1.031196
Validation band_gap mae = 1.031196
Epoch 16
Validation mae = 1.056668
Validation band_gap mae = 1.056668
Epoch 17
Validation mae = 1.083620
Validation band_gap mae = 1.083620
Epoch 18
Validation mae = 1.001911
Validation band_gap mae = 1.001911
Epoch 19
Validation mae = 1.013872
Validation band_gap mae = 1.013872
Epoch 20
Validation mae = 1.004248
Validation band_gap mae = 1.004248
Epoch 21
Validation mae = 1.025789
Validation band_gap mae = 1.025789
Epoch 22
Validation mae = 1.053149
Validation band_gap mae = 1.053149
Epoch 23
Validation mae = 1.035401
Validation band_gap mae = 1.035401
Epoch 24
Validation mae = 1.061132
Validation band_gap mae = 1.061132
Epoch 25
Validation mae = 0.972959
Validation band_gap mae = 0.972959
Epoch 26
Validation mae = 1.059694
Validation band_gap mae = 1.059694
Epoch 27
Validation mae = 0.989109
Validation band_gap mae = 0.989109
Epoch 28
Validation mae = 1.011425
Validation band_gap mae = 1.011425
Epoch 29
Validation mae = 1.070710
Validation band_gap mae = 1.070710
Epoch 30
Validation mae = 1.069347
Validation band_gap mae = 1.069347
Epoch 31
Validation mae = 1.033939
Validation band_gap mae = 1.033939
Epoch 32
Validation mae = 1.028296
Validation band_gap mae = 1.028296
Epoch 33
Validation mae = 1.042677
Validation band_gap mae = 1.042677
Epoch 34
Validation mae = 0.982014
Validation band_gap mae = 0.982014
Epoch 35
Validation mae = 1.023958
Validation band_gap mae = 1.023958
Epoch 36
Validation mae = 1.023056
Validation band_gap mae = 1.023056
Epoch 37
Validation mae = 1.039064
Validation band_gap mae = 1.039064
Epoch 38
Validation mae = 1.066114
Validation band_gap mae = 1.066114
Epoch 39
Validation mae = 1.057354
Validation band_gap mae = 1.057354
Epoch 40
Validation mae = 1.037414
Validation band_gap mae = 1.037414
Epoch 41
Validation mae = 1.048361
Validation band_gap mae = 1.048361
Epoch 42
Validation mae = 1.046956
Validation band_gap mae = 1.046956
Epoch 43
Validation mae = 1.035077
Validation band_gap mae = 1.035077
Epoch 44
Validation mae = 1.046166
Validation band_gap mae = 1.046166
Epoch 45
Validation mae = 1.049545
Validation band_gap mae = 1.049545
Epoch 46
Validation mae = 1.053924
Validation band_gap mae = 1.053924
Epoch 47
Validation mae = 1.034876
Validation band_gap mae = 1.034876
Epoch 48
Validation mae = 1.039901
Validation band_gap mae = 1.039901
Epoch 49
Validation mae = 1.025482
Validation band_gap mae = 1.025482
Epoch 50
Validation mae = 0.997923
Validation band_gap mae = 0.997923
Epoch 51
Validation mae = 1.050522
Validation band_gap mae = 1.050522
Epoch 52
Validation mae = 0.982079
Validation band_gap mae = 0.982079
Epoch 53
Validation mae = 1.013631
Validation band_gap mae = 1.013631
Epoch 54
Validation mae = 1.006521
Validation band_gap mae = 1.006521
Epoch 55
Validation mae = 1.033251
Validation band_gap mae = 1.033251
Epoch 56
Validation mae = 1.056330
Validation band_gap mae = 1.056330
Epoch 57
Validation mae = 1.027902
Validation band_gap mae = 1.027902
Epoch 58
Validation mae = 1.061196
Validation band_gap mae = 1.061196
Epoch 59
Validation mae = 1.017242
Validation band_gap mae = 1.017242
Epoch 60
Validation mae = 1.047103
Validation band_gap mae = 1.047103
Epoch 61
Validation mae = 1.045101
Validation band_gap mae = 1.045101
Epoch 62
Validation mae = 0.999474
Validation band_gap mae = 0.999474
Epoch 63
Validation mae = 1.038295
Validation band_gap mae = 1.038295
Epoch 64
Validation mae = 1.030612
Validation band_gap mae = 1.030612
Epoch 65
Validation mae = 1.006276
Validation band_gap mae = 1.006276
Epoch 66
Validation mae = 1.041275
Validation band_gap mae = 1.041275
Epoch 67
Validation mae = 1.027740
Validation band_gap mae = 1.027740
Epoch 68
Validation mae = 1.025823
Validation band_gap mae = 1.025823
Epoch 69
Validation mae = 1.043177
Validation band_gap mae = 1.043177
Epoch 70
Validation mae = 1.036431
Validation band_gap mae = 1.036431
Epoch 71
Validation mae = 1.033327
Validation band_gap mae = 1.033327
Epoch 72
Validation mae = 1.029091
Validation band_gap mae = 1.029091
Epoch 73
Validation mae = 1.033723
Validation band_gap mae = 1.033723
Epoch 74
Validation mae = 1.024146
Validation band_gap mae = 1.024146
Epoch 75
Validation mae = 1.061341
Validation band_gap mae = 1.061341
Epoch 76
Validation mae = 1.022821
Validation band_gap mae = 1.022821
Epoch 77
Validation mae = 1.055846
Validation band_gap mae = 1.055846
Epoch 78
Validation mae = 1.022269
Validation band_gap mae = 1.022269
Epoch 79
Validation mae = 1.017281
Validation band_gap mae = 1.017281
Epoch 80
Validation mae = 1.045952
Validation band_gap mae = 1.045952
Epoch 81
Validation mae = 1.032852
Validation band_gap mae = 1.032852
Epoch 82
Validation mae = 1.025136
Validation band_gap mae = 1.025136
Epoch 83
Validation mae = 1.038549
Validation band_gap mae = 1.038549
Epoch 84
Validation mae = 1.038507
Validation band_gap mae = 1.038507
Epoch 85
Validation mae = 1.036453
Validation band_gap mae = 1.036453
Epoch 86
Validation mae = 1.038000
Validation band_gap mae = 1.038000
Epoch 87
Validation mae = 1.024856
Validation band_gap mae = 1.024856
Epoch 88
Validation mae = 1.039890
Validation band_gap mae = 1.039890
Epoch 89
Validation mae = 1.033294
Validation band_gap mae = 1.033294
Epoch 90
Validation mae = 1.020407
Validation band_gap mae = 1.020407
Epoch 91
Validation mae = 1.030017
Validation band_gap mae = 1.030017
Epoch 92
Validation mae = 1.031101
Validation band_gap mae = 1.031101
Epoch 93
Validation mae = 1.032407
Validation band_gap mae = 1.032407
Epoch 94
Validation mae = 1.032836
Validation band_gap mae = 1.032836
Epoch 95
Validation mae = 1.033097
Validation band_gap mae = 1.033097
Epoch 96
Validation mae = 1.032058
Validation band_gap mae = 1.032058
Epoch 97
Validation mae = 1.035077
Validation band_gap mae = 1.035077
Epoch 98
Validation mae = 1.024699
Validation band_gap mae = 1.024699
Epoch 99
Validation mae = 1.025661
Validation band_gap mae = 1.025661
Model 0 best validation mae = 1.100163 on epoch 2
Moving model to cuda
Model 0 test mae = 1.032439
Model 0 test band_gap mae = 1.032439
Ensemble test mae = 1.032439
Ensemble test band_gap mae = 1.032439
==================== fold 3 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 1.002598
Validation band_gap mae = 1.002598
Epoch 1
Validation mae = 0.967185
Validation band_gap mae = 0.967185
Epoch 2
Validation mae = 0.928972
Validation band_gap mae = 0.928972
Epoch 3
Validation mae = 0.904818
Validation band_gap mae = 0.904818
Epoch 4
Validation mae = 0.909152
Validation band_gap mae = 0.909152
Epoch 5
Validation mae = 0.899652
Validation band_gap mae = 0.899652
Epoch 6
Validation mae = 0.916158
Validation band_gap mae = 0.916158
Epoch 7
Validation mae = 0.915102
Validation band_gap mae = 0.915102
Epoch 8
Validation mae = 0.919545
Validation band_gap mae = 0.919545
Epoch 9
Validation mae = 0.879547
Validation band_gap mae = 0.879547
Epoch 10
Validation mae = 0.870114
Validation band_gap mae = 0.870114
Epoch 11
Validation mae = 0.890026
Validation band_gap mae = 0.890026
Epoch 12
Validation mae = 0.890364
Validation band_gap mae = 0.890364
Epoch 13
Validation mae = 0.892623
Validation band_gap mae = 0.892623
Epoch 14
Validation mae = 0.871884
Validation band_gap mae = 0.871884
Epoch 15
Validation mae = 0.870407
Validation band_gap mae = 0.870407
Epoch 16
Validation mae = 0.877708
Validation band_gap mae = 0.877708
Epoch 17
Validation mae = 0.872138
Validation band_gap mae = 0.872138
Epoch 18
Validation mae = 0.843893
Validation band_gap mae = 0.843893
Epoch 19
Validation mae = 0.862121
Validation band_gap mae = 0.862121
Epoch 20
Validation mae = 0.905766
Validation band_gap mae = 0.905766
Epoch 21
Validation mae = 0.892119
Validation band_gap mae = 0.892119
Epoch 22
Validation mae = 0.912611
Validation band_gap mae = 0.912611
Epoch 23
Validation mae = 0.939156
Validation band_gap mae = 0.939156
Epoch 24
Validation mae = 0.874829
Validation band_gap mae = 0.874829
Epoch 25
Validation mae = 0.915749
Validation band_gap mae = 0.915749
Epoch 26
Validation mae = 0.868030
Validation band_gap mae = 0.868030
Epoch 27
Validation mae = 0.945491
Validation band_gap mae = 0.945491
Epoch 28
Validation mae = 0.920194
Validation band_gap mae = 0.920194
Epoch 29
Validation mae = 0.929890
Validation band_gap mae = 0.929890
Epoch 30
Validation mae = 0.887416
Validation band_gap mae = 0.887416
Epoch 31
Validation mae = 0.916031
Validation band_gap mae = 0.916031
Epoch 32
Validation mae = 0.930480
Validation band_gap mae = 0.930480
Epoch 33
Validation mae = 0.893522
Validation band_gap mae = 0.893522
Epoch 34
Validation mae = 0.960947
Validation band_gap mae = 0.960947
Epoch 35
Validation mae = 0.905507
Validation band_gap mae = 0.905507
Epoch 36
Validation mae = 0.873427
Validation band_gap mae = 0.873427
Epoch 37
Validation mae = 0.947359
Validation band_gap mae = 0.947359
Epoch 38
Validation mae = 0.903623
Validation band_gap mae = 0.903623
Epoch 39
Validation mae = 0.931302
Validation band_gap mae = 0.931302
Epoch 40
Validation mae = 0.958442
Validation band_gap mae = 0.958442
Epoch 41
Validation mae = 0.938022
Validation band_gap mae = 0.938022
Epoch 42
Validation mae = 0.933553
Validation band_gap mae = 0.933553
Epoch 43
Validation mae = 0.946761
Validation band_gap mae = 0.946761
Epoch 44
Validation mae = 0.955401
Validation band_gap mae = 0.955401
Epoch 45
Validation mae = 0.949227
Validation band_gap mae = 0.949227
Epoch 46
Validation mae = 0.967228
Validation band_gap mae = 0.967228
Epoch 47
Validation mae = 0.952245
Validation band_gap mae = 0.952245
Epoch 48
Validation mae = 0.945242
Validation band_gap mae = 0.945242
Epoch 49
Validation mae = 0.959575
Validation band_gap mae = 0.959575
Epoch 50
Validation mae = 0.961118
Validation band_gap mae = 0.961118
Epoch 51
Validation mae = 0.964218
Validation band_gap mae = 0.964218
Epoch 52
Validation mae = 0.982480
Validation band_gap mae = 0.982480
Epoch 53
Validation mae = 0.951909
Validation band_gap mae = 0.951909
Epoch 54
Validation mae = 0.987694
Validation band_gap mae = 0.987694
Epoch 55
Validation mae = 0.999178
Validation band_gap mae = 0.999178
Epoch 56
Validation mae = 1.003985
Validation band_gap mae = 1.003985
Epoch 57
Validation mae = 0.993883
Validation band_gap mae = 0.993883
Epoch 58
Validation mae = 0.968016
Validation band_gap mae = 0.968016
Epoch 59
Validation mae = 0.973291
Validation band_gap mae = 0.973291
Epoch 60
Validation mae = 0.999389
Validation band_gap mae = 0.999389
Epoch 61
Validation mae = 0.996648
Validation band_gap mae = 0.996648
Epoch 62
Validation mae = 0.983965
Validation band_gap mae = 0.983965
Epoch 63
Validation mae = 0.999625
Validation band_gap mae = 0.999625
Epoch 64
Validation mae = 0.995401
Validation band_gap mae = 0.995401
Epoch 65
Validation mae = 0.992442
Validation band_gap mae = 0.992442
Epoch 66
Validation mae = 0.975742
Validation band_gap mae = 0.975742
Epoch 67
Validation mae = 0.981457
Validation band_gap mae = 0.981457
Epoch 68
Validation mae = 0.998299
Validation band_gap mae = 0.998299
Epoch 69
Validation mae = 1.013012
Validation band_gap mae = 1.013012
Epoch 70
Validation mae = 1.004667
Validation band_gap mae = 1.004667
Epoch 71
Validation mae = 1.005193
Validation band_gap mae = 1.005193
Epoch 72
Validation mae = 0.990099
Validation band_gap mae = 0.990099
Epoch 73
Validation mae = 0.987404
Validation band_gap mae = 0.987404
Epoch 74
Validation mae = 0.990432
Validation band_gap mae = 0.990432
Epoch 75
Validation mae = 1.011619
Validation band_gap mae = 1.011619
Epoch 76
Validation mae = 0.979667
Validation band_gap mae = 0.979667
Epoch 77
Validation mae = 0.994538
Validation band_gap mae = 0.994538
Epoch 78
Validation mae = 0.991899
Validation band_gap mae = 0.991899
Epoch 79
Validation mae = 0.964178
Validation band_gap mae = 0.964178
Epoch 80
Validation mae = 0.977158
Validation band_gap mae = 0.977158
Epoch 81
Validation mae = 0.985234
Validation band_gap mae = 0.985234
Epoch 82
Validation mae = 0.989842
Validation band_gap mae = 0.989842
Epoch 83
Validation mae = 0.989147
Validation band_gap mae = 0.989147
Epoch 84
Validation mae = 0.995137
Validation band_gap mae = 0.995137
Epoch 85
Validation mae = 0.991050
Validation band_gap mae = 0.991050
Epoch 86
Validation mae = 0.980082
Validation band_gap mae = 0.980082
Epoch 87
Validation mae = 0.986010
Validation band_gap mae = 0.986010
Epoch 88
Validation mae = 0.990119
Validation band_gap mae = 0.990119
Epoch 89
Validation mae = 0.994411
Validation band_gap mae = 0.994411
Epoch 90
Validation mae = 0.997605
Validation band_gap mae = 0.997605
Epoch 91
Validation mae = 0.993393
Validation band_gap mae = 0.993393
Epoch 92
Validation mae = 0.991775
Validation band_gap mae = 0.991775
Epoch 93
Validation mae = 0.992390
Validation band_gap mae = 0.992390
Epoch 94
Validation mae = 0.995557
Validation band_gap mae = 0.995557
Epoch 95
Validation mae = 0.993467
Validation band_gap mae = 0.993467
Epoch 96
Validation mae = 0.987036
Validation band_gap mae = 0.987036
Epoch 97
Validation mae = 0.996532
Validation band_gap mae = 0.996532
Epoch 98
Validation mae = 0.983821
Validation band_gap mae = 0.983821
Epoch 99
Validation mae = 0.993883
Validation band_gap mae = 0.993883
Model 0 best validation mae = 1.013012 on epoch 69
Moving model to cuda
Model 0 test mae = 0.708166
Model 0 test band_gap mae = 0.708166
Ensemble test mae = 0.708166
Ensemble test band_gap mae = 0.708166
==================== fold 4 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.809669
Validation band_gap mae = 0.809669
Epoch 1
Validation mae = 0.684451
Validation band_gap mae = 0.684451
Epoch 2
Validation mae = 0.673357
Validation band_gap mae = 0.673357
Epoch 3
Validation mae = 0.617656
Validation band_gap mae = 0.617656
Epoch 4
Validation mae = 0.669260
Validation band_gap mae = 0.669260
Epoch 5
Validation mae = 0.665162
Validation band_gap mae = 0.665162
Epoch 6
Validation mae = 0.621580
Validation band_gap mae = 0.621580
Epoch 7
Validation mae = 0.629217
Validation band_gap mae = 0.629217
Epoch 8
Validation mae = 0.607249
Validation band_gap mae = 0.607249
Epoch 9
Validation mae = 0.611087
Validation band_gap mae = 0.611087
Epoch 10
Validation mae = 0.633108
Validation band_gap mae = 0.633108
Epoch 11
Validation mae = 0.611201
Validation band_gap mae = 0.611201
Epoch 12
Validation mae = 0.629124
Validation band_gap mae = 0.629124
Epoch 13
Validation mae = 0.635658
Validation band_gap mae = 0.635658
Epoch 14
Validation mae = 0.611070
Validation band_gap mae = 0.611070
Epoch 15
Validation mae = 0.606327
Validation band_gap mae = 0.606327
Epoch 16
Validation mae = 0.605851
Validation band_gap mae = 0.605851
Epoch 17
Validation mae = 0.591643
Validation band_gap mae = 0.591643
Epoch 18
Validation mae = 0.581158
Validation band_gap mae = 0.581158
Epoch 19
Validation mae = 0.614672
Validation band_gap mae = 0.614672
Epoch 20
Validation mae = 0.618007
Validation band_gap mae = 0.618007
Epoch 21
Validation mae = 0.620701
Validation band_gap mae = 0.620701
Epoch 22
Validation mae = 0.608881
Validation band_gap mae = 0.608881
Epoch 23
Validation mae = 0.637870
Validation band_gap mae = 0.637870
Epoch 24
Validation mae = 0.634024
Validation band_gap mae = 0.634024
Epoch 25
Validation mae = 0.606638
Validation band_gap mae = 0.606638
Epoch 26
Validation mae = 0.643130
Validation band_gap mae = 0.643130
Epoch 27
Validation mae = 0.603750
Validation band_gap mae = 0.603750
Epoch 28
Validation mae = 0.616707
Validation band_gap mae = 0.616707
Epoch 29
Validation mae = 0.625928
Validation band_gap mae = 0.625928
Epoch 30
Validation mae = 0.601509
Validation band_gap mae = 0.601509
Epoch 31
Validation mae = 0.648929
Validation band_gap mae = 0.648929
Epoch 32
Validation mae = 0.623248
Validation band_gap mae = 0.623248
Epoch 33
Validation mae = 0.628449
Validation band_gap mae = 0.628449
Epoch 34
Validation mae = 0.619156
Validation band_gap mae = 0.619156
Epoch 35
Validation mae = 0.592616
Validation band_gap mae = 0.592616
Epoch 36
Validation mae = 0.601332
Validation band_gap mae = 0.601332
Epoch 37
Validation mae = 0.630120
Validation band_gap mae = 0.630120
Epoch 38
Validation mae = 0.596985
Validation band_gap mae = 0.596985
Epoch 39
Validation mae = 0.623851
Validation band_gap mae = 0.623851
Epoch 40
Validation mae = 0.645183
Validation band_gap mae = 0.645183
Epoch 41
Validation mae = 0.615662
Validation band_gap mae = 0.615662
Epoch 42
Validation mae = 0.607288
Validation band_gap mae = 0.607288
Epoch 43
Validation mae = 0.603110
Validation band_gap mae = 0.603110
Epoch 44
Validation mae = 0.636677
Validation band_gap mae = 0.636677
Epoch 45
Validation mae = 0.611079
Validation band_gap mae = 0.611079
Epoch 46
Validation mae = 0.636969
Validation band_gap mae = 0.636969
Epoch 47
Validation mae = 0.632508
Validation band_gap mae = 0.632508
Epoch 48
Validation mae = 0.617765
Validation band_gap mae = 0.617765
Epoch 49
Validation mae = 0.647638
Validation band_gap mae = 0.647638
Epoch 50
Validation mae = 0.671270
Validation band_gap mae = 0.671270
Epoch 51
Validation mae = 0.614040
Validation band_gap mae = 0.614040
Epoch 52
Validation mae = 0.609534
Validation band_gap mae = 0.609534
Epoch 53
Validation mae = 0.647131
Validation band_gap mae = 0.647131
Epoch 54
Validation mae = 0.667641
Validation band_gap mae = 0.667641
Epoch 55
Validation mae = 0.622841
Validation band_gap mae = 0.622841
Epoch 56
Validation mae = 0.667211
Validation band_gap mae = 0.667211
Epoch 57
Validation mae = 0.634845
Validation band_gap mae = 0.634845
Epoch 58
Validation mae = 0.662115
Validation band_gap mae = 0.662115
Epoch 59
Validation mae = 0.646970
Validation band_gap mae = 0.646970
Epoch 60
Validation mae = 0.665708
Validation band_gap mae = 0.665708
Epoch 61
Validation mae = 0.683282
Validation band_gap mae = 0.683282
Epoch 62
Validation mae = 0.647599
Validation band_gap mae = 0.647599
Epoch 63
Validation mae = 0.642788
Validation band_gap mae = 0.642788
Epoch 64
Validation mae = 0.638843
Validation band_gap mae = 0.638843
Epoch 65
Validation mae = 0.641944
Validation band_gap mae = 0.641944
Epoch 66
Validation mae = 0.655023
Validation band_gap mae = 0.655023
Epoch 67
Validation mae = 0.663929
Validation band_gap mae = 0.663929
Epoch 68
Validation mae = 0.642345
Validation band_gap mae = 0.642345
Epoch 69
Validation mae = 0.665929
Validation band_gap mae = 0.665929
Epoch 70
Validation mae = 0.653749
Validation band_gap mae = 0.653749
Epoch 71
Validation mae = 0.655929
Validation band_gap mae = 0.655929
Epoch 72
Validation mae = 0.649933
Validation band_gap mae = 0.649933
Epoch 73
Validation mae = 0.650980
Validation band_gap mae = 0.650980
Epoch 74
Validation mae = 0.622024
Validation band_gap mae = 0.622024
Epoch 75
Validation mae = 0.652914
Validation band_gap mae = 0.652914
Epoch 76
Validation mae = 0.664129
Validation band_gap mae = 0.664129
Epoch 77
Validation mae = 0.639764
Validation band_gap mae = 0.639764
Epoch 78
Validation mae = 0.642233
Validation band_gap mae = 0.642233
Epoch 79
Validation mae = 0.659828
Validation band_gap mae = 0.659828
Epoch 80
Validation mae = 0.633974
Validation band_gap mae = 0.633974
Epoch 81
Validation mae = 0.656727
Validation band_gap mae = 0.656727
Epoch 82
Validation mae = 0.645569
Validation band_gap mae = 0.645569
Epoch 83
Validation mae = 0.647540
Validation band_gap mae = 0.647540
Epoch 84
Validation mae = 0.650866
Validation band_gap mae = 0.650866
Epoch 85
Validation mae = 0.668611
Validation band_gap mae = 0.668611
Epoch 86
Validation mae = 0.661427
Validation band_gap mae = 0.661427
Epoch 87
Validation mae = 0.635949
Validation band_gap mae = 0.635949
Epoch 88
Validation mae = 0.679118
Validation band_gap mae = 0.679118
Epoch 89
Validation mae = 0.646251
Validation band_gap mae = 0.646251
Epoch 90
Validation mae = 0.669923
Validation band_gap mae = 0.669923
Epoch 91
Validation mae = 0.645780
Validation band_gap mae = 0.645780
Epoch 92
Validation mae = 0.664412
Validation band_gap mae = 0.664412
Epoch 93
Validation mae = 0.654924
Validation band_gap mae = 0.654924
Epoch 94
Validation mae = 0.684456
Validation band_gap mae = 0.684456
Epoch 95
Validation mae = 0.640494
Validation band_gap mae = 0.640494
Epoch 96
Validation mae = 0.669755
Validation band_gap mae = 0.669755
Epoch 97
Validation mae = 0.644274
Validation band_gap mae = 0.644274
Epoch 98
Validation mae = 0.632899
Validation band_gap mae = 0.632899
Epoch 99
Validation mae = 0.654805
Validation band_gap mae = 0.654805
Model 0 best validation mae = 0.809669 on epoch 0
Moving model to cuda
Model 0 test mae = 0.881562
Model 0 test band_gap mae = 0.881562
Ensemble test mae = 0.881562
Ensemble test band_gap mae = 0.881562
==================== fold 5 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.896928
Validation band_gap mae = 0.896928
Epoch 1
Validation mae = 0.913943
Validation band_gap mae = 0.913943
Epoch 2
Validation mae = 0.871637
Validation band_gap mae = 0.871637
Epoch 3
Validation mae = 0.814107
Validation band_gap mae = 0.814107
Epoch 4
Validation mae = 0.862263
Validation band_gap mae = 0.862263
Epoch 5
Validation mae = 0.813584
Validation band_gap mae = 0.813584
Epoch 6
Validation mae = 0.794861
Validation band_gap mae = 0.794861
Epoch 7
Validation mae = 0.761350
Validation band_gap mae = 0.761350
Epoch 8
Validation mae = 0.785757
Validation band_gap mae = 0.785757
Epoch 9
Validation mae = 0.764779
Validation band_gap mae = 0.764779
Epoch 10
Validation mae = 0.762504
Validation band_gap mae = 0.762504
Epoch 11
Validation mae = 0.755805
Validation band_gap mae = 0.755805
Epoch 12
Validation mae = 0.769444
Validation band_gap mae = 0.769444
Epoch 13
Validation mae = 0.744891
Validation band_gap mae = 0.744891
Epoch 14
Validation mae = 0.782180
Validation band_gap mae = 0.782180
Epoch 15
Validation mae = 0.814429
Validation band_gap mae = 0.814429
Epoch 16
Validation mae = 0.776267
Validation band_gap mae = 0.776267
Epoch 17
Validation mae = 0.789510
Validation band_gap mae = 0.789510
Epoch 18
Validation mae = 0.822779
Validation band_gap mae = 0.822779
Epoch 19
Validation mae = 0.762923
Validation band_gap mae = 0.762923
Epoch 20
Validation mae = 0.788439
Validation band_gap mae = 0.788439
Epoch 21
Validation mae = 0.760136
Validation band_gap mae = 0.760136
Epoch 22
Validation mae = 0.764759
Validation band_gap mae = 0.764759
Epoch 23
Validation mae = 0.846775
Validation band_gap mae = 0.846775
Epoch 24
Validation mae = 0.796514
Validation band_gap mae = 0.796514
Epoch 25
Validation mae = 0.754862
Validation band_gap mae = 0.754862
Epoch 26
Validation mae = 0.780258
Validation band_gap mae = 0.780258
Epoch 27
Validation mae = 0.788981
Validation band_gap mae = 0.788981
Epoch 28
Validation mae = 0.788694
Validation band_gap mae = 0.788694
Epoch 29
Validation mae = 0.806169
Validation band_gap mae = 0.806169
Epoch 30
Validation mae = 0.794550
Validation band_gap mae = 0.794550
Epoch 31
Validation mae = 0.798134
Validation band_gap mae = 0.798134
Epoch 32
Validation mae = 0.809292
Validation band_gap mae = 0.809292
Epoch 33
Validation mae = 0.826914
Validation band_gap mae = 0.826914
Epoch 34
Validation mae = 0.827682
Validation band_gap mae = 0.827682
Epoch 35
Validation mae = 0.815269
Validation band_gap mae = 0.815269
Epoch 36
Validation mae = 0.854511
Validation band_gap mae = 0.854511
Epoch 37
Validation mae = 0.824344
Validation band_gap mae = 0.824344
Epoch 38
Validation mae = 0.822581
Validation band_gap mae = 0.822581
Epoch 39
Validation mae = 0.901136
Validation band_gap mae = 0.901136
Epoch 40
Validation mae = 0.828780
Validation band_gap mae = 0.828780
Epoch 41
Validation mae = 0.832025
Validation band_gap mae = 0.832025
Epoch 42
Validation mae = 0.820755
Validation band_gap mae = 0.820755
Epoch 43
Validation mae = 0.851479
Validation band_gap mae = 0.851479
Epoch 44
Validation mae = 0.840017
Validation band_gap mae = 0.840017
Epoch 45
Validation mae = 0.831651
Validation band_gap mae = 0.831651
Epoch 46
Validation mae = 0.844958
Validation band_gap mae = 0.844958
Epoch 47
Validation mae = 0.827980
Validation band_gap mae = 0.827980
Epoch 48
Validation mae = 0.833711
Validation band_gap mae = 0.833711
Epoch 49
Validation mae = 0.835225
Validation band_gap mae = 0.835225
Epoch 50
Validation mae = 0.875488
Validation band_gap mae = 0.875488
Epoch 51
Validation mae = 0.792433
Validation band_gap mae = 0.792433
Epoch 52
Validation mae = 0.833384
Validation band_gap mae = 0.833384
Epoch 53
Validation mae = 0.828431
Validation band_gap mae = 0.828431
Epoch 54
Validation mae = 0.829474
Validation band_gap mae = 0.829474
Epoch 55
Validation mae = 0.819873
Validation band_gap mae = 0.819873
Epoch 56
Validation mae = 0.839203
Validation band_gap mae = 0.839203
Epoch 57
Validation mae = 0.835851
Validation band_gap mae = 0.835851
Epoch 58
Validation mae = 0.844198
Validation band_gap mae = 0.844198
Epoch 59
Validation mae = 0.855973
Validation band_gap mae = 0.855973
Epoch 60
Validation mae = 0.843683
Validation band_gap mae = 0.843683
Epoch 61
Validation mae = 0.845292
Validation band_gap mae = 0.845292
Epoch 62
Validation mae = 0.866399
Validation band_gap mae = 0.866399
Epoch 63
Validation mae = 0.839951
Validation band_gap mae = 0.839951
Epoch 64
Validation mae = 0.845223
Validation band_gap mae = 0.845223
Epoch 65
Validation mae = 0.837930
Validation band_gap mae = 0.837930
Epoch 66
Validation mae = 0.848819
Validation band_gap mae = 0.848819
Epoch 67
Validation mae = 0.831164
Validation band_gap mae = 0.831164
Epoch 68
Validation mae = 0.856660
Validation band_gap mae = 0.856660
Epoch 69
Validation mae = 0.850372
Validation band_gap mae = 0.850372
Epoch 70
Validation mae = 0.852823
Validation band_gap mae = 0.852823
Epoch 71
Validation mae = 0.838355
Validation band_gap mae = 0.838355
Epoch 72
Validation mae = 0.851554
Validation band_gap mae = 0.851554
Epoch 73
Validation mae = 0.843999
Validation band_gap mae = 0.843999
Epoch 74
Validation mae = 0.854050
Validation band_gap mae = 0.854050
Epoch 75
Validation mae = 0.843284
Validation band_gap mae = 0.843284
Epoch 76
Validation mae = 0.843747
Validation band_gap mae = 0.843747
Epoch 77
Validation mae = 0.841783
Validation band_gap mae = 0.841783
Epoch 78
Validation mae = 0.846797
Validation band_gap mae = 0.846797
Epoch 79
Validation mae = 0.845472
Validation band_gap mae = 0.845472
Epoch 80
Validation mae = 0.851668
Validation band_gap mae = 0.851668
Epoch 81
Validation mae = 0.859610
Validation band_gap mae = 0.859610
Epoch 82
Validation mae = 0.850688
Validation band_gap mae = 0.850688
Epoch 83
Validation mae = 0.845393
Validation band_gap mae = 0.845393
Epoch 84
Validation mae = 0.847637
Validation band_gap mae = 0.847637
Epoch 85
Validation mae = 0.844883
Validation band_gap mae = 0.844883
Epoch 86
Validation mae = 0.840987
Validation band_gap mae = 0.840987
Epoch 87
Validation mae = 0.848988
Validation band_gap mae = 0.848988
Epoch 88
Validation mae = 0.853512
Validation band_gap mae = 0.853512
Epoch 89
Validation mae = 0.852976
Validation band_gap mae = 0.852976
Epoch 90
Validation mae = 0.848555
Validation band_gap mae = 0.848555
Epoch 91
Validation mae = 0.849169
Validation band_gap mae = 0.849169
Epoch 92
Validation mae = 0.851770
Validation band_gap mae = 0.851770
Epoch 93
Validation mae = 0.846343
Validation band_gap mae = 0.846343
Epoch 94
Validation mae = 0.847858
Validation band_gap mae = 0.847858
Epoch 95
Validation mae = 0.844215
Validation band_gap mae = 0.844215
Epoch 96
Validation mae = 0.851051
Validation band_gap mae = 0.851051
Epoch 97
Validation mae = 0.851855
Validation band_gap mae = 0.851855
Epoch 98
Validation mae = 0.847673
Validation band_gap mae = 0.847673
Epoch 99
Validation mae = 0.847943
Validation band_gap mae = 0.847943
Model 0 best validation mae = 0.913943 on epoch 1
Moving model to cuda
Model 0 test mae = 0.511758
Model 0 test band_gap mae = 0.511758
Ensemble test mae = 0.511758
Ensemble test band_gap mae = 0.511758
==================== fold 6 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.794909
Validation band_gap mae = 0.794909
Epoch 1
Validation mae = 0.862631
Validation band_gap mae = 0.862631
Epoch 2
Validation mae = 0.854789
Validation band_gap mae = 0.854789
Epoch 3
Validation mae = 0.765900
Validation band_gap mae = 0.765900
Epoch 4
Validation mae = 0.749455
Validation band_gap mae = 0.749455
Epoch 5
Validation mae = 0.713229
Validation band_gap mae = 0.713229
Epoch 6
Validation mae = 0.709793
Validation band_gap mae = 0.709793
Epoch 7
Validation mae = 0.724821
Validation band_gap mae = 0.724821
Epoch 8
Validation mae = 0.743409
Validation band_gap mae = 0.743409
Epoch 9
Validation mae = 0.703562
Validation band_gap mae = 0.703562
Epoch 10
Validation mae = 0.703697
Validation band_gap mae = 0.703697
Epoch 11
Validation mae = 0.686991
Validation band_gap mae = 0.686991
Epoch 12
Validation mae = 0.669463
Validation band_gap mae = 0.669463
Epoch 13
Validation mae = 0.674661
Validation band_gap mae = 0.674661
Epoch 14
Validation mae = 0.695857
Validation band_gap mae = 0.695857
Epoch 15
Validation mae = 0.716391
Validation band_gap mae = 0.716391
Epoch 16
Validation mae = 0.792422
Validation band_gap mae = 0.792422
Epoch 17
Validation mae = 0.660729
Validation band_gap mae = 0.660729
Epoch 18
Validation mae = 0.693538
Validation band_gap mae = 0.693538
Epoch 19
Validation mae = 0.678256
Validation band_gap mae = 0.678256
Epoch 20
Validation mae = 0.675329
Validation band_gap mae = 0.675329
Epoch 21
Validation mae = 0.666768
Validation band_gap mae = 0.666768
Epoch 22
Validation mae = 0.696302
Validation band_gap mae = 0.696302
Epoch 23
Validation mae = 0.665000
Validation band_gap mae = 0.665000
Epoch 24
Validation mae = 0.679366
Validation band_gap mae = 0.679366
Epoch 25
Validation mae = 0.713673
Validation band_gap mae = 0.713673
Epoch 26
Validation mae = 0.702607
Validation band_gap mae = 0.702607
Epoch 27
Validation mae = 0.688275
Validation band_gap mae = 0.688275
Epoch 28
Validation mae = 0.726594
Validation band_gap mae = 0.726594
Epoch 29
Validation mae = 0.678455
Validation band_gap mae = 0.678455
Epoch 30
Validation mae = 0.724872
Validation band_gap mae = 0.724872
Epoch 31
Validation mae = 0.716265
Validation band_gap mae = 0.716265
Epoch 32
Validation mae = 0.733287
Validation band_gap mae = 0.733287
Epoch 33
Validation mae = 0.699600
Validation band_gap mae = 0.699600
Epoch 34
Validation mae = 0.758069
Validation band_gap mae = 0.758069
Epoch 35
Validation mae = 0.718877
Validation band_gap mae = 0.718877
Epoch 36
Validation mae = 0.799977
Validation band_gap mae = 0.799977
Epoch 37
Validation mae = 0.777334
Validation band_gap mae = 0.777334
Epoch 38
Validation mae = 0.738305
Validation band_gap mae = 0.738305
Epoch 39
Validation mae = 0.766471
Validation band_gap mae = 0.766471
Epoch 40
Validation mae = 0.732234
Validation band_gap mae = 0.732234
Epoch 41
Validation mae = 0.756811
Validation band_gap mae = 0.756811
Epoch 42
Validation mae = 0.762919
Validation band_gap mae = 0.762919
Epoch 43
Validation mae = 0.775008
Validation band_gap mae = 0.775008
Epoch 44
Validation mae = 0.759560
Validation band_gap mae = 0.759560
Epoch 45
Validation mae = 0.764406
Validation band_gap mae = 0.764406
Epoch 46
Validation mae = 0.784851
Validation band_gap mae = 0.784851
Epoch 47
Validation mae = 0.742841
Validation band_gap mae = 0.742841
Epoch 48
Validation mae = 0.786614
Validation band_gap mae = 0.786614
Epoch 49
Validation mae = 0.777008
Validation band_gap mae = 0.777008
Epoch 50
Validation mae = 0.780312
Validation band_gap mae = 0.780312
Epoch 51
Validation mae = 0.755253
Validation band_gap mae = 0.755253
Epoch 52
Validation mae = 0.767688
Validation band_gap mae = 0.767688
Epoch 53
Validation mae = 0.786091
Validation band_gap mae = 0.786091
Epoch 54
Validation mae = 0.785860
Validation band_gap mae = 0.785860
Epoch 55
Validation mae = 0.786546
Validation band_gap mae = 0.786546
Epoch 56
Validation mae = 0.791068
Validation band_gap mae = 0.791068
Epoch 57
Validation mae = 0.790426
Validation band_gap mae = 0.790426
Epoch 58
Validation mae = 0.792946
Validation band_gap mae = 0.792946
Epoch 59
Validation mae = 0.799536
Validation band_gap mae = 0.799536
Epoch 60
Validation mae = 0.777320
Validation band_gap mae = 0.777320
Epoch 61
Validation mae = 0.812912
Validation band_gap mae = 0.812912
Epoch 62
Validation mae = 0.799662
Validation band_gap mae = 0.799662
Epoch 63
Validation mae = 0.812943
Validation band_gap mae = 0.812943
Epoch 64
Validation mae = 0.775393
Validation band_gap mae = 0.775393
Epoch 65
Validation mae = 0.781992
Validation band_gap mae = 0.781992
Epoch 66
Validation mae = 0.796247
Validation band_gap mae = 0.796247
Epoch 67
Validation mae = 0.787413
Validation band_gap mae = 0.787413
Epoch 68
Validation mae = 0.809174
Validation band_gap mae = 0.809174
Epoch 69
Validation mae = 0.802237
Validation band_gap mae = 0.802237
Epoch 70
Validation mae = 0.794877
Validation band_gap mae = 0.794877
Epoch 71
Validation mae = 0.802906
Validation band_gap mae = 0.802906
Epoch 72
Validation mae = 0.796977
Validation band_gap mae = 0.796977
Epoch 73
Validation mae = 0.794972
Validation band_gap mae = 0.794972
Epoch 74
Validation mae = 0.807040
Validation band_gap mae = 0.807040
Epoch 75
Validation mae = 0.802352
Validation band_gap mae = 0.802352
Epoch 76
Validation mae = 0.832085
Validation band_gap mae = 0.832085
Epoch 77
Validation mae = 0.803211
Validation band_gap mae = 0.803211
Epoch 78
Validation mae = 0.799630
Validation band_gap mae = 0.799630
Epoch 79
Validation mae = 0.810882
Validation band_gap mae = 0.810882
Epoch 80
Validation mae = 0.811434
Validation band_gap mae = 0.811434
Epoch 81
Validation mae = 0.803743
Validation band_gap mae = 0.803743
Epoch 82
Validation mae = 0.807225
Validation band_gap mae = 0.807225
Epoch 83
Validation mae = 0.812507
Validation band_gap mae = 0.812507
Epoch 84
Validation mae = 0.800735
Validation band_gap mae = 0.800735
Epoch 85
Validation mae = 0.804713
Validation band_gap mae = 0.804713
Epoch 86
Validation mae = 0.803182
Validation band_gap mae = 0.803182
Epoch 87
Validation mae = 0.808038
Validation band_gap mae = 0.808038
Epoch 88
Validation mae = 0.804250
Validation band_gap mae = 0.804250
Epoch 89
Validation mae = 0.809232
Validation band_gap mae = 0.809232
Epoch 90
Validation mae = 0.814381
Validation band_gap mae = 0.814381
Epoch 91
Validation mae = 0.806665
Validation band_gap mae = 0.806665
Epoch 92
Validation mae = 0.807230
Validation band_gap mae = 0.807230
Epoch 93
Validation mae = 0.808989
Validation band_gap mae = 0.808989
Epoch 94
Validation mae = 0.819002
Validation band_gap mae = 0.819002
Epoch 95
Validation mae = 0.803413
Validation band_gap mae = 0.803413
Epoch 96
Validation mae = 0.816320
Validation band_gap mae = 0.816320
Epoch 97
Validation mae = 0.809301
Validation band_gap mae = 0.809301
Epoch 98
Validation mae = 0.812936
Validation band_gap mae = 0.812936
Epoch 99
Validation mae = 0.811410
Validation band_gap mae = 0.811410
Model 0 best validation mae = 0.862631 on epoch 1
Moving model to cuda
Model 0 test mae = 0.779568
Model 0 test band_gap mae = 0.779568
Ensemble test mae = 0.779568
Ensemble test band_gap mae = 0.779568
==================== fold 7 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.760755
Validation band_gap mae = 0.760755
Epoch 1
Validation mae = 0.772459
Validation band_gap mae = 0.772459
Epoch 2
Validation mae = 0.767953
Validation band_gap mae = 0.767953
Epoch 3
Validation mae = 0.709756
Validation band_gap mae = 0.709756
Epoch 4
Validation mae = 0.691588
Validation band_gap mae = 0.691588
Epoch 5
Validation mae = 0.697135
Validation band_gap mae = 0.697135
Epoch 6
Validation mae = 0.705526
Validation band_gap mae = 0.705526
Epoch 7
Validation mae = 0.676524
Validation band_gap mae = 0.676524
Epoch 8
Validation mae = 0.724651
Validation band_gap mae = 0.724651
Epoch 9
Validation mae = 0.706097
Validation band_gap mae = 0.706097
Epoch 10
Validation mae = 0.673845
Validation band_gap mae = 0.673845
Epoch 11
Validation mae = 0.741405
Validation band_gap mae = 0.741405
Epoch 12
Validation mae = 0.669162
Validation band_gap mae = 0.669162
Epoch 13
Validation mae = 0.778914
Validation band_gap mae = 0.778914
Epoch 14
Validation mae = 0.688929
Validation band_gap mae = 0.688929
Epoch 15
Validation mae = 0.718144
Validation band_gap mae = 0.718144
Epoch 16
Validation mae = 0.661775
Validation band_gap mae = 0.661775
Epoch 17
Validation mae = 0.705377
Validation band_gap mae = 0.705377
Epoch 18
Validation mae = 0.719984
Validation band_gap mae = 0.719984
Epoch 19
Validation mae = 0.723204
Validation band_gap mae = 0.723204
Epoch 20
Validation mae = 0.674994
Validation band_gap mae = 0.674994
Epoch 21
Validation mae = 0.693674
Validation band_gap mae = 0.693674
Epoch 22
Validation mae = 0.736326
Validation band_gap mae = 0.736326
Epoch 23
Validation mae = 0.780572
Validation band_gap mae = 0.780572
Epoch 24
Validation mae = 0.720419
Validation band_gap mae = 0.720419
Epoch 25
Validation mae = 0.694122
Validation band_gap mae = 0.694122
Epoch 26
Validation mae = 0.778395
Validation band_gap mae = 0.778395
Epoch 27
Validation mae = 0.801776
Validation band_gap mae = 0.801776
Epoch 28
Validation mae = 0.693839
Validation band_gap mae = 0.693839
Epoch 29
Validation mae = 0.785375
Validation band_gap mae = 0.785375
Epoch 30
Validation mae = 0.754703
Validation band_gap mae = 0.754703
Epoch 31
Validation mae = 0.753248
Validation band_gap mae = 0.753248
Epoch 32
Validation mae = 0.765229
Validation band_gap mae = 0.765229
Epoch 33
Validation mae = 0.714127
Validation band_gap mae = 0.714127
Epoch 34
Validation mae = 0.727337
Validation band_gap mae = 0.727337
Epoch 35
Validation mae = 0.746086
Validation band_gap mae = 0.746086
Epoch 36
Validation mae = 0.816836
Validation band_gap mae = 0.816836
Epoch 37
Validation mae = 0.752729
Validation band_gap mae = 0.752729
Epoch 38
Validation mae = 0.750565
Validation band_gap mae = 0.750565
Epoch 39
Validation mae = 0.829227
Validation band_gap mae = 0.829227
Epoch 40
Validation mae = 0.740706
Validation band_gap mae = 0.740706
Epoch 41
Validation mae = 0.783641
Validation band_gap mae = 0.783641
Epoch 42
Validation mae = 0.759100
Validation band_gap mae = 0.759100
Epoch 43
Validation mae = 0.813236
Validation band_gap mae = 0.813236
Epoch 44
Validation mae = 0.829534
Validation band_gap mae = 0.829534
Epoch 45
Validation mae = 0.778334
Validation band_gap mae = 0.778334
Epoch 46
Validation mae = 0.774193
Validation band_gap mae = 0.774193
Epoch 47
Validation mae = 0.832961
Validation band_gap mae = 0.832961
Epoch 48
Validation mae = 0.761261
Validation band_gap mae = 0.761261
Epoch 49
Validation mae = 0.800065
Validation band_gap mae = 0.800065
Epoch 50
Validation mae = 0.727546
Validation band_gap mae = 0.727546
Epoch 51
Validation mae = 0.756839
Validation band_gap mae = 0.756839
Epoch 52
Validation mae = 0.830821
Validation band_gap mae = 0.830821
Epoch 53
Validation mae = 0.749289
Validation band_gap mae = 0.749289
Epoch 54
Validation mae = 0.800216
Validation band_gap mae = 0.800216
Epoch 55
Validation mae = 0.813586
Validation band_gap mae = 0.813586
Epoch 56
Validation mae = 0.745712
Validation band_gap mae = 0.745712
Epoch 57
Validation mae = 0.752263
Validation band_gap mae = 0.752263
Epoch 58
Validation mae = 0.799786
Validation band_gap mae = 0.799786
Epoch 59
Validation mae = 0.736761
Validation band_gap mae = 0.736761
Epoch 60
Validation mae = 0.775743
Validation band_gap mae = 0.775743
Epoch 61
Validation mae = 0.773764
Validation band_gap mae = 0.773764
Epoch 62
Validation mae = 0.751515
Validation band_gap mae = 0.751515
Epoch 63
Validation mae = 0.806040
Validation band_gap mae = 0.806040
Epoch 64
Validation mae = 0.748576
Validation band_gap mae = 0.748576
Epoch 65
Validation mae = 0.768810
Validation band_gap mae = 0.768810
Epoch 66
Validation mae = 0.744923
Validation band_gap mae = 0.744923
Epoch 67
Validation mae = 0.820297
Validation band_gap mae = 0.820297
Epoch 68
Validation mae = 0.790476
Validation band_gap mae = 0.790476
Epoch 69
Validation mae = 0.788203
Validation band_gap mae = 0.788203
Epoch 70
Validation mae = 0.770086
Validation band_gap mae = 0.770086
Epoch 71
Validation mae = 0.770514
Validation band_gap mae = 0.770514
Epoch 72
Validation mae = 0.743778
Validation band_gap mae = 0.743778
Epoch 73
Validation mae = 0.747845
Validation band_gap mae = 0.747845
Epoch 74
Validation mae = 0.745857
Validation band_gap mae = 0.745857
Epoch 75
Validation mae = 0.816871
Validation band_gap mae = 0.816871
Epoch 76
Validation mae = 0.790633
Validation band_gap mae = 0.790633
Epoch 77
Validation mae = 0.804834
Validation band_gap mae = 0.804834
Epoch 78
Validation mae = 0.770345
Validation band_gap mae = 0.770345
Epoch 79
Validation mae = 0.779171
Validation band_gap mae = 0.779171
Epoch 80
Validation mae = 0.820842
Validation band_gap mae = 0.820842
Epoch 81
Validation mae = 0.741273
Validation band_gap mae = 0.741273
Epoch 82
Validation mae = 0.768331
Validation band_gap mae = 0.768331
Epoch 83
Validation mae = 0.775266
Validation band_gap mae = 0.775266
Epoch 84
Validation mae = 0.771876
Validation band_gap mae = 0.771876
Epoch 85
Validation mae = 0.773394
Validation band_gap mae = 0.773394
Epoch 86
Validation mae = 0.773214
Validation band_gap mae = 0.773214
Epoch 87
Validation mae = 0.760049
Validation band_gap mae = 0.760049
Epoch 88
Validation mae = 0.782918
Validation band_gap mae = 0.782918
Epoch 89
Validation mae = 0.757748
Validation band_gap mae = 0.757748
Epoch 90
Validation mae = 0.762872
Validation band_gap mae = 0.762872
Epoch 91
Validation mae = 0.784210
Validation band_gap mae = 0.784210
Epoch 92
Validation mae = 0.780286
Validation band_gap mae = 0.780286
Epoch 93
Validation mae = 0.765193
Validation band_gap mae = 0.765193
Epoch 94
Validation mae = 0.761016
Validation band_gap mae = 0.761016
Epoch 95
Validation mae = 0.785425
Validation band_gap mae = 0.785425
Epoch 96
Validation mae = 0.750373
Validation band_gap mae = 0.750373
Epoch 97
Validation mae = 0.774968
Validation band_gap mae = 0.774968
Epoch 98
Validation mae = 0.746931
Validation band_gap mae = 0.746931
Epoch 99
Validation mae = 0.789870
Validation band_gap mae = 0.789870
Model 0 best validation mae = 0.832961 on epoch 47
Moving model to cuda
Model 0 test mae = 0.815625
Model 0 test band_gap mae = 0.815625
Ensemble test mae = 0.815625
Ensemble test band_gap mae = 0.815625
==================== fold 8 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.759088
Validation band_gap mae = 0.759088
Epoch 1
Validation mae = 0.779857
Validation band_gap mae = 0.779857
Epoch 2
Validation mae = 0.677670
Validation band_gap mae = 0.677670
Epoch 3
Validation mae = 0.661553
Validation band_gap mae = 0.661553
Epoch 4
Validation mae = 0.741157
Validation band_gap mae = 0.741157
Epoch 5
Validation mae = 0.696305
Validation band_gap mae = 0.696305
Epoch 6
Validation mae = 0.631863
Validation band_gap mae = 0.631863
Epoch 7
Validation mae = 0.676497
Validation band_gap mae = 0.676497
Epoch 8
Validation mae = 0.606960
Validation band_gap mae = 0.606960
Epoch 9
Validation mae = 0.612104
Validation band_gap mae = 0.612104
Epoch 10
Validation mae = 0.619325
Validation band_gap mae = 0.619325
Epoch 11
Validation mae = 0.618903
Validation band_gap mae = 0.618903
Epoch 12
Validation mae = 0.659762
Validation band_gap mae = 0.659762
Epoch 13
Validation mae = 0.599848
Validation band_gap mae = 0.599848
Epoch 14
Validation mae = 0.610799
Validation band_gap mae = 0.610799
Epoch 15
Validation mae = 0.610572
Validation band_gap mae = 0.610572
Epoch 16
Validation mae = 0.603870
Validation band_gap mae = 0.603870
Epoch 17
Validation mae = 0.660494
Validation band_gap mae = 0.660494
Epoch 18
Validation mae = 0.608356
Validation band_gap mae = 0.608356
Epoch 19
Validation mae = 0.643991
Validation band_gap mae = 0.643991
Epoch 20
Validation mae = 0.626992
Validation band_gap mae = 0.626992
Epoch 21
Validation mae = 0.664127
Validation band_gap mae = 0.664127
Epoch 22
Validation mae = 0.711923
Validation band_gap mae = 0.711923
Epoch 23
Validation mae = 0.617464
Validation band_gap mae = 0.617464
Epoch 24
Validation mae = 0.719490
Validation band_gap mae = 0.719490
Epoch 25
Validation mae = 0.610841
Validation band_gap mae = 0.610841
Epoch 26
Validation mae = 0.745387
Validation band_gap mae = 0.745387
Epoch 27
Validation mae = 0.655518
Validation band_gap mae = 0.655518
Epoch 28
Validation mae = 0.639691
Validation band_gap mae = 0.639691
Epoch 29
Validation mae = 0.640447
Validation band_gap mae = 0.640447
Epoch 30
Validation mae = 0.640847
Validation band_gap mae = 0.640847
Epoch 31
Validation mae = 0.636993
Validation band_gap mae = 0.636993
Epoch 32
Validation mae = 0.630697
Validation band_gap mae = 0.630697
Epoch 33
Validation mae = 0.707828
Validation band_gap mae = 0.707828
Epoch 34
Validation mae = 0.637711
Validation band_gap mae = 0.637711
Epoch 35
Validation mae = 0.659174
Validation band_gap mae = 0.659174
Epoch 36
Validation mae = 0.658737
Validation band_gap mae = 0.658737
Epoch 37
Validation mae = 0.657841
Validation band_gap mae = 0.657841
Epoch 38
Validation mae = 0.687773
Validation band_gap mae = 0.687773
Epoch 39
Validation mae = 0.659835
Validation band_gap mae = 0.659835
Epoch 40
Validation mae = 0.643940
Validation band_gap mae = 0.643940
Epoch 41
Validation mae = 0.645641
Validation band_gap mae = 0.645641
Epoch 42
Validation mae = 0.662116
Validation band_gap mae = 0.662116
Epoch 43
Validation mae = 0.675779
Validation band_gap mae = 0.675779
Epoch 44
Validation mae = 0.665554
Validation band_gap mae = 0.665554
Epoch 45
Validation mae = 0.659971
Validation band_gap mae = 0.659971
Epoch 46
Validation mae = 0.671089
Validation band_gap mae = 0.671089
Epoch 47
Validation mae = 0.667167
Validation band_gap mae = 0.667167
Epoch 48
Validation mae = 0.681392
Validation band_gap mae = 0.681392
Epoch 49
Validation mae = 0.664805
Validation band_gap mae = 0.664805
Epoch 50
Validation mae = 0.666238
Validation band_gap mae = 0.666238
Epoch 51
Validation mae = 0.679080
Validation band_gap mae = 0.679080
Epoch 52
Validation mae = 0.684969
Validation band_gap mae = 0.684969
Epoch 53
Validation mae = 0.710177
Validation band_gap mae = 0.710177
Epoch 54
Validation mae = 0.686954
Validation band_gap mae = 0.686954
Epoch 55
Validation mae = 0.656394
Validation band_gap mae = 0.656394
Epoch 56
Validation mae = 0.680473
Validation band_gap mae = 0.680473
Epoch 57
Validation mae = 0.682627
Validation band_gap mae = 0.682627
Epoch 58
Validation mae = 0.739649
Validation band_gap mae = 0.739649
Epoch 59
Validation mae = 0.653205
Validation band_gap mae = 0.653205
Epoch 60
Validation mae = 0.694943
Validation band_gap mae = 0.694943
Epoch 61
Validation mae = 0.663795
Validation band_gap mae = 0.663795
Epoch 62
Validation mae = 0.679790
Validation band_gap mae = 0.679790
Epoch 63
Validation mae = 0.699136
Validation band_gap mae = 0.699136
Epoch 64
Validation mae = 0.683403
Validation band_gap mae = 0.683403
Epoch 65
Validation mae = 0.694317
Validation band_gap mae = 0.694317
Epoch 66
Validation mae = 0.682286
Validation band_gap mae = 0.682286
Epoch 67
Validation mae = 0.690262
Validation band_gap mae = 0.690262
Epoch 68
Validation mae = 0.697586
Validation band_gap mae = 0.697586
Epoch 69
Validation mae = 0.668818
Validation band_gap mae = 0.668818
Epoch 70
Validation mae = 0.687407
Validation band_gap mae = 0.687407
Epoch 71
Validation mae = 0.703270
Validation band_gap mae = 0.703270
Epoch 72
Validation mae = 0.668426
Validation band_gap mae = 0.668426
Epoch 73
Validation mae = 0.709013
Validation band_gap mae = 0.709013
Epoch 74
Validation mae = 0.689575
Validation band_gap mae = 0.689575
Epoch 75
Validation mae = 0.693603
Validation band_gap mae = 0.693603
Epoch 76
Validation mae = 0.688785
Validation band_gap mae = 0.688785
Epoch 77
Validation mae = 0.687562
Validation band_gap mae = 0.687562
Epoch 78
Validation mae = 0.695015
Validation band_gap mae = 0.695015
Epoch 79
Validation mae = 0.700363
Validation band_gap mae = 0.700363
Epoch 80
Validation mae = 0.699229
Validation band_gap mae = 0.699229
Epoch 81
Validation mae = 0.688643
Validation band_gap mae = 0.688643
Epoch 82
Validation mae = 0.690979
Validation band_gap mae = 0.690979
Epoch 83
Validation mae = 0.679009
Validation band_gap mae = 0.679009
Epoch 84
Validation mae = 0.687365
Validation band_gap mae = 0.687365
Epoch 85
Validation mae = 0.709139
Validation band_gap mae = 0.709139
Epoch 86
Validation mae = 0.703227
Validation band_gap mae = 0.703227
Epoch 87
Validation mae = 0.695201
Validation band_gap mae = 0.695201
Epoch 88
Validation mae = 0.684701
Validation band_gap mae = 0.684701
Epoch 89
Validation mae = 0.681383
Validation band_gap mae = 0.681383
Epoch 90
Validation mae = 0.689959
Validation band_gap mae = 0.689959
Epoch 91
Validation mae = 0.703384
Validation band_gap mae = 0.703384
Epoch 92
Validation mae = 0.697940
Validation band_gap mae = 0.697940
Epoch 93
Validation mae = 0.691275
Validation band_gap mae = 0.691275
Epoch 94
Validation mae = 0.691980
Validation band_gap mae = 0.691980
Epoch 95
Validation mae = 0.701936
Validation band_gap mae = 0.701936
Epoch 96
Validation mae = 0.692891
Validation band_gap mae = 0.692891
Epoch 97
Validation mae = 0.700923
Validation band_gap mae = 0.700923
Epoch 98
Validation mae = 0.691118
Validation band_gap mae = 0.691118
Epoch 99
Validation mae = 0.702697
Validation band_gap mae = 0.702697
Model 0 best validation mae = 0.779857 on epoch 1
Moving model to cuda
Model 0 test mae = 0.638213
Model 0 test band_gap mae = 0.638213
Ensemble test mae = 0.638213
Ensemble test band_gap mae = 0.638213
==================== fold 9 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Validation mae = 0.915858
Validation band_gap mae = 0.915858
Epoch 1
Validation mae = 0.884492
Validation band_gap mae = 0.884492
Epoch 2
Validation mae = 0.884820
Validation band_gap mae = 0.884820
Epoch 3
Validation mae = 0.896433
Validation band_gap mae = 0.896433
Epoch 4
Validation mae = 0.896744
Validation band_gap mae = 0.896744
Epoch 5
Validation mae = 0.915646
Validation band_gap mae = 0.915646
Epoch 6
Validation mae = 0.874881
Validation band_gap mae = 0.874881
Epoch 7
Validation mae = 0.880975
Validation band_gap mae = 0.880975
Epoch 8
Validation mae = 0.865326
Validation band_gap mae = 0.865326
Epoch 9
Validation mae = 0.882575
Validation band_gap mae = 0.882575
Epoch 10
Validation mae = 0.905626
Validation band_gap mae = 0.905626
Epoch 11
Validation mae = 0.839450
Validation band_gap mae = 0.839450
Epoch 12
Validation mae = 0.888704
Validation band_gap mae = 0.888704
Epoch 13
Validation mae = 0.880052
Validation band_gap mae = 0.880052
Epoch 14
Validation mae = 0.822874
Validation band_gap mae = 0.822874
Epoch 15
Validation mae = 0.855557
Validation band_gap mae = 0.855557
Epoch 16
Validation mae = 0.892269
Validation band_gap mae = 0.892269
Epoch 17
Validation mae = 0.861480
Validation band_gap mae = 0.861480
Epoch 18
Validation mae = 0.865496
Validation band_gap mae = 0.865496
Epoch 19
Validation mae = 0.857697
Validation band_gap mae = 0.857697
Epoch 20
Validation mae = 0.860819
Validation band_gap mae = 0.860819
Epoch 21
Validation mae = 0.881278
Validation band_gap mae = 0.881278
Epoch 22
Validation mae = 0.870022
Validation band_gap mae = 0.870022
Epoch 23
Validation mae = 0.834926
Validation band_gap mae = 0.834926
Epoch 24
Validation mae = 0.829496
Validation band_gap mae = 0.829496
Epoch 25
Validation mae = 0.843074
Validation band_gap mae = 0.843074
Epoch 26
Validation mae = 0.851341
Validation band_gap mae = 0.851341
Epoch 27
Validation mae = 0.882842
Validation band_gap mae = 0.882842
Epoch 28
Validation mae = 0.858878
Validation band_gap mae = 0.858878
Epoch 29
Validation mae = 0.865450
Validation band_gap mae = 0.865450
Epoch 30
Validation mae = 0.923626
Validation band_gap mae = 0.923626
Epoch 31
Validation mae = 0.889170
Validation band_gap mae = 0.889170
Epoch 32
Validation mae = 0.867910
Validation band_gap mae = 0.867910
Epoch 33
Validation mae = 0.866951
Validation band_gap mae = 0.866951
Epoch 34
Validation mae = 0.860961
Validation band_gap mae = 0.860961
Epoch 35
Validation mae = 0.872725
Validation band_gap mae = 0.872725
Epoch 36
Validation mae = 0.892011
Validation band_gap mae = 0.892011
Epoch 37
Validation mae = 0.857434
Validation band_gap mae = 0.857434
Epoch 38
Validation mae = 0.902602
Validation band_gap mae = 0.902602
Epoch 39
Validation mae = 0.865389
Validation band_gap mae = 0.865389
Epoch 40
Validation mae = 0.876651
Validation band_gap mae = 0.876651
Epoch 41
Validation mae = 0.913141
Validation band_gap mae = 0.913141
Epoch 42
Validation mae = 0.895390
Validation band_gap mae = 0.895390
Epoch 43
Validation mae = 0.898352
Validation band_gap mae = 0.898352
Epoch 44
Validation mae = 0.901944
Validation band_gap mae = 0.901944
Epoch 45
Validation mae = 0.871171
Validation band_gap mae = 0.871171
Epoch 46
Validation mae = 0.860533
Validation band_gap mae = 0.860533
Epoch 47
Validation mae = 0.889479
Validation band_gap mae = 0.889479
Epoch 48
Validation mae = 0.910093
Validation band_gap mae = 0.910093
Epoch 49
Validation mae = 0.918950
Validation band_gap mae = 0.918950
Epoch 50
Validation mae = 0.874989
Validation band_gap mae = 0.874989
Epoch 51
Validation mae = 0.861087
Validation band_gap mae = 0.861087
Epoch 52
Validation mae = 0.867161
Validation band_gap mae = 0.867161
Epoch 53
Validation mae = 0.889326
Validation band_gap mae = 0.889326
Epoch 54
Validation mae = 0.879599
Validation band_gap mae = 0.879599
Epoch 55
Validation mae = 0.887465
Validation band_gap mae = 0.887465
Epoch 56
Validation mae = 0.855367
Validation band_gap mae = 0.855367
Epoch 57
Validation mae = 0.926695
Validation band_gap mae = 0.926695
Epoch 58
Validation mae = 0.858719
Validation band_gap mae = 0.858719
Epoch 59
Validation mae = 0.890439
Validation band_gap mae = 0.890439
Epoch 60
Validation mae = 0.865285
Validation band_gap mae = 0.865285
Epoch 61
Validation mae = 0.865779
Validation band_gap mae = 0.865779
Epoch 62
Validation mae = 0.875667
Validation band_gap mae = 0.875667
Epoch 63
Validation mae = 0.869882
Validation band_gap mae = 0.869882
Epoch 64
Validation mae = 0.906074
Validation band_gap mae = 0.906074
Epoch 65
Validation mae = 0.890017
Validation band_gap mae = 0.890017
Epoch 66
Validation mae = 0.849851
Validation band_gap mae = 0.849851
Epoch 67
Validation mae = 0.880721
Validation band_gap mae = 0.880721
Epoch 68
Validation mae = 0.870697
Validation band_gap mae = 0.870697
Epoch 69
Validation mae = 0.880156
Validation band_gap mae = 0.880156
Epoch 70
Validation mae = 0.883249
Validation band_gap mae = 0.883249
Epoch 71
Validation mae = 0.895807
Validation band_gap mae = 0.895807
Epoch 72
Validation mae = 0.875379
Validation band_gap mae = 0.875379
Epoch 73
Validation mae = 0.885962
Validation band_gap mae = 0.885962
Epoch 74
Validation mae = 0.901816
Validation band_gap mae = 0.901816
Epoch 75
Validation mae = 0.906310
Validation band_gap mae = 0.906310
Epoch 76
Validation mae = 0.885502
Validation band_gap mae = 0.885502
Epoch 77
Validation mae = 0.867394
Validation band_gap mae = 0.867394
Epoch 78
Validation mae = 0.864945
Validation band_gap mae = 0.864945
Epoch 79
Validation mae = 0.873472
Validation band_gap mae = 0.873472
Epoch 80
Validation mae = 0.862341
Validation band_gap mae = 0.862341
Epoch 81
Validation mae = 0.898334
Validation band_gap mae = 0.898334
Epoch 82
Validation mae = 0.878665
Validation band_gap mae = 0.878665
Epoch 83
Validation mae = 0.861021
Validation band_gap mae = 0.861021
Epoch 84
Validation mae = 0.889417
Validation band_gap mae = 0.889417
Epoch 85
Validation mae = 0.898535
Validation band_gap mae = 0.898535
Epoch 86
Validation mae = 0.918437
Validation band_gap mae = 0.918437
Epoch 87
Validation mae = 0.879081
Validation band_gap mae = 0.879081
Epoch 88
Validation mae = 0.876901
Validation band_gap mae = 0.876901
Epoch 89
Validation mae = 0.872240
Validation band_gap mae = 0.872240
Epoch 90
Validation mae = 0.880922
Validation band_gap mae = 0.880922
Epoch 91
Validation mae = 0.878055
Validation band_gap mae = 0.878055
Epoch 92
Validation mae = 0.878966
Validation band_gap mae = 0.878966
Epoch 93
Validation mae = 0.870135
Validation band_gap mae = 0.870135
Epoch 94
Validation mae = 0.882411
Validation band_gap mae = 0.882411
Epoch 95
Validation mae = 0.886840
Validation band_gap mae = 0.886840
Epoch 96
Validation mae = 0.891471
Validation band_gap mae = 0.891471
Epoch 97
Validation mae = 0.882642
Validation band_gap mae = 0.882642
Epoch 98
Validation mae = 0.862254
Validation band_gap mae = 0.862254
Epoch 99
Validation mae = 0.861732
Validation band_gap mae = 0.861732
Model 0 best validation mae = 0.926695 on epoch 57
Moving model to cuda
Model 0 test mae = 0.708071
Model 0 test band_gap mae = 0.708071
Ensemble test mae = 0.708071
Ensemble test band_gap mae = 0.708071
10-fold cross validation
Seed 0
Fold 0 ==> valid mae = 1.468933 test mae = 1.519323
Fold 0 ==> valid band_gap mae = 1.468933test band_gap mae = 1.519323
Fold 1 ==> valid mae = 1.238708 test mae = 0.797192
Fold 1 ==> valid band_gap mae = 1.238708test band_gap mae = 0.797192
Fold 2 ==> valid mae = 1.100163 test mae = 1.032439
Fold 2 ==> valid band_gap mae = 1.100163test band_gap mae = 1.032439
Fold 3 ==> valid mae = 1.013012 test mae = 0.708166
Fold 3 ==> valid band_gap mae = 1.013012test band_gap mae = 0.708166
Fold 4 ==> valid mae = 0.809669 test mae = 0.881562
Fold 4 ==> valid band_gap mae = 0.809669test band_gap mae = 0.881562
Fold 5 ==> valid mae = 0.913943 test mae = 0.511758
Fold 5 ==> valid band_gap mae = 0.913943test band_gap mae = 0.511758
Fold 6 ==> valid mae = 0.862631 test mae = 0.779568
Fold 6 ==> valid band_gap mae = 0.862631test band_gap mae = 0.779568
Fold 7 ==> valid mae = 0.832961 test mae = 0.815625
Fold 7 ==> valid band_gap mae = 0.832961test band_gap mae = 0.815625
Fold 8 ==> valid mae = 0.779857 test mae = 0.638213
Fold 8 ==> valid band_gap mae = 0.779857test band_gap mae = 0.638213
Fold 9 ==> valid mae = 0.926695 test mae = 0.708071
Fold 9 ==> valid band_gap mae = 0.926695test band_gap mae = 0.708071
Overall valid mae = 0.994657 +/- 0.207614
Overall test mae = 0.839192 +/- 0.262594
Overall test band_gap mae = 0.839192 +/- 0.262594
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=92, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,667,841
Moving model to cuda
Epoch 0
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.424460
Validation band_gap mae = 1.424460
Epoch 1
Validation mae = 1.248621
Validation band_gap mae = 1.248621
Epoch 2
Validation mae = 1.227091
Validation band_gap mae = 1.227091
Epoch 3
Validation mae = 1.539843
Validation band_gap mae = 1.539843
Epoch 4
Validation mae = 1.299467
Validation band_gap mae = 1.299467
Epoch 5
Validation mae = 1.135792
Validation band_gap mae = 1.135792
Epoch 6
Validation mae = 1.406567
Validation band_gap mae = 1.406567
Epoch 7
Validation mae = 1.496325
Validation band_gap mae = 1.496325
Epoch 8
Validation mae = 1.306274
Validation band_gap mae = 1.306274
Epoch 9
Validation mae = 1.157190
Validation band_gap mae = 1.157190
Epoch 10
Validation mae = 1.089399
Validation band_gap mae = 1.089399
Epoch 11
Validation mae = 1.081846
Validation band_gap mae = 1.081846
Epoch 12
Validation mae = 1.315172
Validation band_gap mae = 1.315172
Epoch 13
Validation mae = 1.170685
Validation band_gap mae = 1.170685
Epoch 14
Validation mae = 1.084907
Validation band_gap mae = 1.084907
Epoch 15
Validation mae = 1.070025
Validation band_gap mae = 1.070025
Epoch 16
Validation mae = 1.013402
Validation band_gap mae = 1.013402
Epoch 17
Validation mae = 1.213998
Validation band_gap mae = 1.213998
Epoch 18
Validation mae = 1.119886
Validation band_gap mae = 1.119886
Epoch 19
Validation mae = 1.111544
Validation band_gap mae = 1.111544
Epoch 20
Validation mae = 1.166872
Validation band_gap mae = 1.166872
Epoch 21
Validation mae = 1.078630
Validation band_gap mae = 1.078630
Epoch 22
Validation mae = 1.045041
Validation band_gap mae = 1.045041
Epoch 23
Validation mae = 1.077361
Validation band_gap mae = 1.077361
Epoch 24
Validation mae = 1.145086
Validation band_gap mae = 1.145086
Epoch 25
Validation mae = 1.040943
Validation band_gap mae = 1.040943
Epoch 26
Validation mae = 1.112839
Validation band_gap mae = 1.112839
Epoch 27
Validation mae = 1.045743
Validation band_gap mae = 1.045743
Epoch 28
Validation mae = 1.025647
Validation band_gap mae = 1.025647
Epoch 29
Validation mae = 1.141667
Validation band_gap mae = 1.141667
Epoch 30
Validation mae = 1.043679
Validation band_gap mae = 1.043679
Epoch 31
Validation mae = 1.080177
Validation band_gap mae = 1.080177
Epoch 32
Validation mae = 1.069668
Validation band_gap mae = 1.069668
Epoch 33
Validation mae = 1.052164
Validation band_gap mae = 1.052164
Epoch 34
Validation mae = 1.132647
Validation band_gap mae = 1.132647
Epoch 35
Validation mae = 1.011975
Validation band_gap mae = 1.011975
Epoch 36
Validation mae = 1.171556
Validation band_gap mae = 1.171556
Epoch 37
Validation mae = 1.017405
Validation band_gap mae = 1.017405
Epoch 38
Validation mae = 1.102258
Validation band_gap mae = 1.102258
Epoch 39
Validation mae = 1.019365
Validation band_gap mae = 1.019365
Epoch 40
Validation mae = 1.077642
Validation band_gap mae = 1.077642
Epoch 41
Validation mae = 1.178983
Validation band_gap mae = 1.178983
Epoch 42
Validation mae = 0.996781
Validation band_gap mae = 0.996781
Epoch 43
Validation mae = 1.185260
Validation band_gap mae = 1.185260
Epoch 44
Validation mae = 1.125286
Validation band_gap mae = 1.125286
Epoch 45
Validation mae = 1.004963
Validation band_gap mae = 1.004963
Epoch 46
Validation mae = 1.167272
Validation band_gap mae = 1.167272
Epoch 47
Validation mae = 1.025189
Validation band_gap mae = 1.025189
Epoch 48
Validation mae = 1.143739
Validation band_gap mae = 1.143739
Epoch 49
Validation mae = 1.073357
Validation band_gap mae = 1.073357
Epoch 50
Validation mae = 1.099745
Validation band_gap mae = 1.099745
Epoch 51
Validation mae = 1.213853
Validation band_gap mae = 1.213853
Epoch 52
Validation mae = 1.084092
Validation band_gap mae = 1.084092
Epoch 53
Validation mae = 0.998321
Validation band_gap mae = 0.998321
Epoch 54
Validation mae = 1.083790
Validation band_gap mae = 1.083790
Epoch 55
Validation mae = 1.069345
Validation band_gap mae = 1.069345
Epoch 56
Validation mae = 1.077022
Validation band_gap mae = 1.077022
Epoch 57
Validation mae = 1.049798
Validation band_gap mae = 1.049798
Epoch 58
Validation mae = 1.048368
Validation band_gap mae = 1.048368
Epoch 59
Validation mae = 1.143173
Validation band_gap mae = 1.143173
Epoch 60
Validation mae = 1.071552
Validation band_gap mae = 1.071552
Epoch 61
Validation mae = 1.040961
Validation band_gap mae = 1.040961
Epoch 62
Validation mae = 1.116538
Validation band_gap mae = 1.116538
Epoch 63
Validation mae = 1.020210
Validation band_gap mae = 1.020210
Epoch 64
Validation mae = 0.993122
Validation band_gap mae = 0.993122
Epoch 65
Validation mae = 1.141746
Validation band_gap mae = 1.141746
Epoch 66
Validation mae = 1.036647
Validation band_gap mae = 1.036647
Epoch 67
Validation mae = 1.032198
Validation band_gap mae = 1.032198
Epoch 68
Validation mae = 1.046312
Validation band_gap mae = 1.046312
Epoch 69
Validation mae = 1.086755
Validation band_gap mae = 1.086755
Epoch 70
Validation mae = 1.029244
Validation band_gap mae = 1.029244
Epoch 71
Validation mae = 0.998607
Validation band_gap mae = 0.998607
Epoch 72
Validation mae = 1.024873
Validation band_gap mae = 1.024873
Epoch 73
Validation mae = 1.119888
Validation band_gap mae = 1.119888
Epoch 74
Validation mae = 1.003905
Validation band_gap mae = 1.003905
Epoch 75
Validation mae = 0.965569
Validation band_gap mae = 0.965569
Epoch 76
Validation mae = 1.040661
Validation band_gap mae = 1.040661
Epoch 77
Validation mae = 1.037324
Validation band_gap mae = 1.037324
Epoch 78
Validation mae = 1.020341
Validation band_gap mae = 1.020341
Epoch 79
Validation mae = 1.048580
Validation band_gap mae = 1.048580
Epoch 80
Validation mae = 0.976361
Validation band_gap mae = 0.976361
Epoch 81
Validation mae = 1.000727
Validation band_gap mae = 1.000727
Epoch 82
Validation mae = 1.084954
Validation band_gap mae = 1.084954
Epoch 83
Validation mae = 0.993807
Validation band_gap mae = 0.993807
Epoch 84
Validation mae = 1.068586
Validation band_gap mae = 1.068586
Epoch 85
Validation mae = 1.043136
Validation band_gap mae = 1.043136
Epoch 86
Validation mae = 1.061662
Validation band_gap mae = 1.061662
Epoch 87
Validation mae = 1.007451
Validation band_gap mae = 1.007451
Epoch 88
Validation mae = 1.043103
Validation band_gap mae = 1.043103
Epoch 89
Validation mae = 1.005006
Validation band_gap mae = 1.005006
Epoch 90
Validation mae = 0.999607
Validation band_gap mae = 0.999607
Epoch 91
Validation mae = 1.020743
Validation band_gap mae = 1.020743
Epoch 92
Validation mae = 1.046935
Validation band_gap mae = 1.046935
Epoch 93
Validation mae = 1.028721
Validation band_gap mae = 1.028721
Epoch 94
Validation mae = 0.985199
Validation band_gap mae = 0.985199
Epoch 95
Validation mae = 1.022599
Validation band_gap mae = 1.022599
Epoch 96
Validation mae = 0.993370
Validation band_gap mae = 0.993370
Epoch 97
Validation mae = 1.038221
Validation band_gap mae = 1.038221
Epoch 98
Validation mae = 1.007233
Validation band_gap mae = 1.007233
Epoch 99
Validation mae = 1.026262
Validation band_gap mae = 1.026262
Model 0 best validation mae = 1.539843 on epoch 3
Moving model to cuda
Model 0 test mae = 1.528940
Model 0 test band_gap mae = 1.528940
Ensemble test mae = 1.528940
Ensemble test band_gap mae = 1.528940
==================== fold 1 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.235649
Validation band_gap mae = 1.235649
Epoch 1
Validation mae = 1.250391
Validation band_gap mae = 1.250391
Epoch 2
Validation mae = 1.194714
Validation band_gap mae = 1.194714
Epoch 3
Validation mae = 1.179139
Validation band_gap mae = 1.179139
Epoch 4
Validation mae = 1.109232
Validation band_gap mae = 1.109232
Epoch 5
Validation mae = 1.182019
Validation band_gap mae = 1.182019
Epoch 6
Validation mae = 1.187027
Validation band_gap mae = 1.187027
Epoch 7
Validation mae = 1.125562
Validation band_gap mae = 1.125562
Epoch 8
Validation mae = 1.084078
Validation band_gap mae = 1.084078
Epoch 9
Validation mae = 1.106189
Validation band_gap mae = 1.106189
Epoch 10
Validation mae = 1.139606
Validation band_gap mae = 1.139606
Epoch 11
Validation mae = 1.146254
Validation band_gap mae = 1.146254
Epoch 12
Validation mae = 1.085228
Validation band_gap mae = 1.085228
Epoch 13
Validation mae = 1.110494
Validation band_gap mae = 1.110494
Epoch 14
Validation mae = 1.089100
Validation band_gap mae = 1.089100
Epoch 15
Validation mae = 1.104051
Validation band_gap mae = 1.104051
Epoch 16
Validation mae = 1.084140
Validation band_gap mae = 1.084140
Epoch 17
Validation mae = 1.081387
Validation band_gap mae = 1.081387
Epoch 18
Validation mae = 1.065904
Validation band_gap mae = 1.065904
Epoch 19
Validation mae = 1.073749
Validation band_gap mae = 1.073749
Epoch 20
Validation mae = 1.099843
Validation band_gap mae = 1.099843
Epoch 21
Validation mae = 1.095238
Validation band_gap mae = 1.095238
Epoch 22
Validation mae = 1.212005
Validation band_gap mae = 1.212005
Epoch 23
Validation mae = 1.128059
Validation band_gap mae = 1.128059
Epoch 24
Validation mae = 1.073414
Validation band_gap mae = 1.073414
Epoch 25
Validation mae = 1.094429
Validation band_gap mae = 1.094429
Epoch 26
Validation mae = 1.094083
Validation band_gap mae = 1.094083
Epoch 27
Validation mae = 1.064506
Validation band_gap mae = 1.064506
Epoch 28
Validation mae = 1.126109
Validation band_gap mae = 1.126109
Epoch 29
Validation mae = 1.099585
Validation band_gap mae = 1.099585
Epoch 30
Validation mae = 1.145331
Validation band_gap mae = 1.145331
Epoch 31
Validation mae = 1.123323
Validation band_gap mae = 1.123323
Epoch 32
Validation mae = 1.106301
Validation band_gap mae = 1.106301
Epoch 33
Validation mae = 1.108154
Validation band_gap mae = 1.108154
Epoch 34
Validation mae = 1.137332
Validation band_gap mae = 1.137332
Epoch 35
Validation mae = 1.174877
Validation band_gap mae = 1.174877
Epoch 36
Validation mae = 1.133201
Validation band_gap mae = 1.133201
Epoch 37
Validation mae = 1.098166
Validation band_gap mae = 1.098166
Epoch 38
Validation mae = 1.172863
Validation band_gap mae = 1.172863
Epoch 39
Validation mae = 1.137588
Validation band_gap mae = 1.137588
Epoch 40
Validation mae = 1.090003
Validation band_gap mae = 1.090003
Epoch 41
Validation mae = 1.145294
Validation band_gap mae = 1.145294
Epoch 42
Validation mae = 1.151379
Validation band_gap mae = 1.151379
Epoch 43
Validation mae = 1.111507
Validation band_gap mae = 1.111507
Epoch 44
Validation mae = 1.112509
Validation band_gap mae = 1.112509
Epoch 45
Validation mae = 1.105763
Validation band_gap mae = 1.105763
Epoch 46
Validation mae = 1.085912
Validation band_gap mae = 1.085912
Epoch 47
Validation mae = 1.134937
Validation band_gap mae = 1.134937
Epoch 48
Validation mae = 1.217830
Validation band_gap mae = 1.217830
Epoch 49
Validation mae = 1.096705
Validation band_gap mae = 1.096705
Epoch 50
Validation mae = 1.116797
Validation band_gap mae = 1.116797
Epoch 51
Validation mae = 1.148576
Validation band_gap mae = 1.148576
Epoch 52
Validation mae = 1.205843
Validation band_gap mae = 1.205843
Epoch 53
Validation mae = 1.130756
Validation band_gap mae = 1.130756
Epoch 54
Validation mae = 1.210616
Validation band_gap mae = 1.210616
Epoch 55
Validation mae = 1.170099
Validation band_gap mae = 1.170099
Epoch 56
Validation mae = 1.223698
Validation band_gap mae = 1.223698
Epoch 57
Validation mae = 1.187539
Validation band_gap mae = 1.187539
Epoch 58
Validation mae = 1.197303
Validation band_gap mae = 1.197303
Epoch 59
Validation mae = 1.204745
Validation band_gap mae = 1.204745
Epoch 60
Validation mae = 1.191186
Validation band_gap mae = 1.191186
Epoch 61
Validation mae = 1.223881
Validation band_gap mae = 1.223881
Epoch 62
Validation mae = 1.199780
Validation band_gap mae = 1.199780
Epoch 63
Validation mae = 1.197893
Validation band_gap mae = 1.197893
Epoch 64
Validation mae = 1.174502
Validation band_gap mae = 1.174502
Epoch 65
Validation mae = 1.230525
Validation band_gap mae = 1.230525
Epoch 66
Validation mae = 1.198465
Validation band_gap mae = 1.198465
Epoch 67
Validation mae = 1.192759
Validation band_gap mae = 1.192759
Epoch 68
Validation mae = 1.184358
Validation band_gap mae = 1.184358
Epoch 69
Validation mae = 1.196614
Validation band_gap mae = 1.196614
Epoch 70
Validation mae = 1.187515
Validation band_gap mae = 1.187515
Epoch 71
Validation mae = 1.163285
Validation band_gap mae = 1.163285
Epoch 72
Validation mae = 1.200907
Validation band_gap mae = 1.200907
Epoch 73
Validation mae = 1.199957
Validation band_gap mae = 1.199957
Epoch 74
Validation mae = 1.187739
Validation band_gap mae = 1.187739
Epoch 75
Validation mae = 1.218558
Validation band_gap mae = 1.218558
Epoch 76
Validation mae = 1.201710
Validation band_gap mae = 1.201710
Epoch 77
Validation mae = 1.201163
Validation band_gap mae = 1.201163
Epoch 78
Validation mae = 1.176441
Validation band_gap mae = 1.176441
Epoch 79
Validation mae = 1.222514
Validation band_gap mae = 1.222514
Epoch 80
Validation mae = 1.201125
Validation band_gap mae = 1.201125
Epoch 81
Validation mae = 1.219063
Validation band_gap mae = 1.219063
Epoch 82
Validation mae = 1.216444
Validation band_gap mae = 1.216444
Epoch 83
Validation mae = 1.226183
Validation band_gap mae = 1.226183
Epoch 84
Validation mae = 1.209153
Validation band_gap mae = 1.209153
Epoch 85
Validation mae = 1.153129
Validation band_gap mae = 1.153129
Epoch 86
Validation mae = 1.213843
Validation band_gap mae = 1.213843
Epoch 87
Validation mae = 1.187313
Validation band_gap mae = 1.187313
Epoch 88
Validation mae = 1.212912
Validation band_gap mae = 1.212912
Epoch 89
Validation mae = 1.199745
Validation band_gap mae = 1.199745
Epoch 90
Validation mae = 1.212977
Validation band_gap mae = 1.212977
Epoch 91
Validation mae = 1.217756
Validation band_gap mae = 1.217756
Epoch 92
Validation mae = 1.192689
Validation band_gap mae = 1.192689
Epoch 93
Validation mae = 1.205081
Validation band_gap mae = 1.205081
Epoch 94
Validation mae = 1.182023
Validation band_gap mae = 1.182023
Epoch 95
Validation mae = 1.201259
Validation band_gap mae = 1.201259
Epoch 96
Validation mae = 1.230187
Validation band_gap mae = 1.230187
Epoch 97
Validation mae = 1.217328
Validation band_gap mae = 1.217328
Epoch 98
Validation mae = 1.219067
Validation band_gap mae = 1.219067
Epoch 99
Validation mae = 1.188829
Validation band_gap mae = 1.188829
Model 0 best validation mae = 1.250391 on epoch 1
Moving model to cuda
Model 0 test mae = 0.910670
Model 0 test band_gap mae = 0.910670
Ensemble test mae = 0.910670
Ensemble test band_gap mae = 0.910670
==================== fold 2 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.993945
Validation band_gap mae = 0.993945
Epoch 1
Validation mae = 1.013150
Validation band_gap mae = 1.013150
Epoch 2
Validation mae = 1.060083
Validation band_gap mae = 1.060083
Epoch 3
Validation mae = 1.006038
Validation band_gap mae = 1.006038
Epoch 4
Validation mae = 1.142645
Validation band_gap mae = 1.142645
Epoch 5
Validation mae = 1.013287
Validation band_gap mae = 1.013287
Epoch 6
Validation mae = 0.967459
Validation band_gap mae = 0.967459
Epoch 7
Validation mae = 1.024139
Validation band_gap mae = 1.024139
Epoch 8
Validation mae = 1.016562
Validation band_gap mae = 1.016562
Epoch 9
Validation mae = 1.013996
Validation band_gap mae = 1.013996
Epoch 10
Validation mae = 1.037714
Validation band_gap mae = 1.037714
Epoch 11
Validation mae = 1.046770
Validation band_gap mae = 1.046770
Epoch 12
Validation mae = 1.028625
Validation band_gap mae = 1.028625
Epoch 13
Validation mae = 0.997480
Validation band_gap mae = 0.997480
Epoch 14
Validation mae = 1.004059
Validation band_gap mae = 1.004059
Epoch 15
Validation mae = 0.975254
Validation band_gap mae = 0.975254
Epoch 16
Validation mae = 1.007325
Validation band_gap mae = 1.007325
Epoch 17
Validation mae = 1.036627
Validation band_gap mae = 1.036627
Epoch 18
Validation mae = 0.992096
Validation band_gap mae = 0.992096
Epoch 19
Validation mae = 0.987434
Validation band_gap mae = 0.987434
Epoch 20
Validation mae = 0.993721
Validation band_gap mae = 0.993721
Epoch 21
Validation mae = 1.022162
Validation band_gap mae = 1.022162
Epoch 22
Validation mae = 1.012274
Validation band_gap mae = 1.012274
Epoch 23
Validation mae = 0.984241
Validation band_gap mae = 0.984241
Epoch 24
Validation mae = 0.984837
Validation band_gap mae = 0.984837
Epoch 25
Validation mae = 1.055298
Validation band_gap mae = 1.055298
Epoch 26
Validation mae = 1.033950
Validation band_gap mae = 1.033950
Epoch 27
Validation mae = 1.013598
Validation band_gap mae = 1.013598
Epoch 28
Validation mae = 1.040220
Validation band_gap mae = 1.040220
Epoch 29
Validation mae = 1.000323
Validation band_gap mae = 1.000323
Epoch 30
Validation mae = 1.036098
Validation band_gap mae = 1.036098
Epoch 31
Validation mae = 1.006145
Validation band_gap mae = 1.006145
Epoch 32
Validation mae = 1.033107
Validation band_gap mae = 1.033107
Epoch 33
Validation mae = 1.073435
Validation band_gap mae = 1.073435
Epoch 34
Validation mae = 1.066857
Validation band_gap mae = 1.066857
Epoch 35
Validation mae = 1.033872
Validation band_gap mae = 1.033872
Epoch 36
Validation mae = 1.036249
Validation band_gap mae = 1.036249
Epoch 37
Validation mae = 1.036681
Validation band_gap mae = 1.036681
Epoch 38
Validation mae = 1.052314
Validation band_gap mae = 1.052314
Epoch 39
Validation mae = 1.035121
Validation band_gap mae = 1.035121
Epoch 40
Validation mae = 1.031805
Validation band_gap mae = 1.031805
Epoch 41
Validation mae = 1.023397
Validation band_gap mae = 1.023397
Epoch 42
Validation mae = 1.027048
Validation band_gap mae = 1.027048
Epoch 43
Validation mae = 1.069729
Validation band_gap mae = 1.069729
Epoch 44
Validation mae = 0.996207
Validation band_gap mae = 0.996207
Epoch 45
Validation mae = 1.049622
Validation band_gap mae = 1.049622
Epoch 46
Validation mae = 1.024988
Validation band_gap mae = 1.024988
Epoch 47
Validation mae = 1.037311
Validation band_gap mae = 1.037311
Epoch 48
Validation mae = 1.026948
Validation band_gap mae = 1.026948
Epoch 49
Validation mae = 1.042286
Validation band_gap mae = 1.042286
Epoch 50
Validation mae = 1.054002
Validation band_gap mae = 1.054002
Epoch 51
Validation mae = 1.062899
Validation band_gap mae = 1.062899
Epoch 52
Validation mae = 1.038293
Validation band_gap mae = 1.038293
Epoch 53
Validation mae = 1.058771
Validation band_gap mae = 1.058771
Epoch 54
Validation mae = 1.051038
Validation band_gap mae = 1.051038
Epoch 55
Validation mae = 1.051100
Validation band_gap mae = 1.051100
Epoch 56
Validation mae = 1.021405
Validation band_gap mae = 1.021405
Epoch 57
Validation mae = 1.024134
Validation band_gap mae = 1.024134
Epoch 58
Validation mae = 1.043970
Validation band_gap mae = 1.043970
Epoch 59
Validation mae = 1.027854
Validation band_gap mae = 1.027854
Epoch 60
Validation mae = 1.044076
Validation band_gap mae = 1.044076
Epoch 61
Validation mae = 1.023144
Validation band_gap mae = 1.023144
Epoch 62
Validation mae = 1.044665
Validation band_gap mae = 1.044665
Epoch 63
Validation mae = 1.015791
Validation band_gap mae = 1.015791
Epoch 64
Validation mae = 1.020858
Validation band_gap mae = 1.020858
Epoch 65
Validation mae = 1.035000
Validation band_gap mae = 1.035000
Epoch 66
Validation mae = 1.024100
Validation band_gap mae = 1.024100
Epoch 67
Validation mae = 1.019911
Validation band_gap mae = 1.019911
Epoch 68
Validation mae = 0.997040
Validation band_gap mae = 0.997040
Epoch 69
Validation mae = 1.032814
Validation band_gap mae = 1.032814
Epoch 70
Validation mae = 1.001624
Validation band_gap mae = 1.001624
Epoch 71
Validation mae = 1.023115
Validation band_gap mae = 1.023115
Epoch 72
Validation mae = 0.993147
Validation band_gap mae = 0.993147
Epoch 73
Validation mae = 1.009545
Validation band_gap mae = 1.009545
Epoch 74
Validation mae = 1.022511
Validation band_gap mae = 1.022511
Epoch 75
Validation mae = 1.004157
Validation band_gap mae = 1.004157
Epoch 76
Validation mae = 1.017380
Validation band_gap mae = 1.017380
Epoch 77
Validation mae = 1.004835
Validation band_gap mae = 1.004835
Epoch 78
Validation mae = 1.028200
Validation band_gap mae = 1.028200
Epoch 79
Validation mae = 0.987626
Validation band_gap mae = 0.987626
Epoch 80
Validation mae = 1.056985
Validation band_gap mae = 1.056985
Epoch 81
Validation mae = 1.014565
Validation band_gap mae = 1.014565
Epoch 82
Validation mae = 1.034981
Validation band_gap mae = 1.034981
Epoch 83
Validation mae = 1.028040
Validation band_gap mae = 1.028040
Epoch 84
Validation mae = 1.005803
Validation band_gap mae = 1.005803
Epoch 85
Validation mae = 1.019974
Validation band_gap mae = 1.019974
Epoch 86
Validation mae = 0.991770
Validation band_gap mae = 0.991770
Epoch 87
Validation mae = 1.007993
Validation band_gap mae = 1.007993
Epoch 88
Validation mae = 1.028428
Validation band_gap mae = 1.028428
Epoch 89
Validation mae = 1.012205
Validation band_gap mae = 1.012205
Epoch 90
Validation mae = 1.024220
Validation band_gap mae = 1.024220
Epoch 91
Validation mae = 1.010167
Validation band_gap mae = 1.010167
Epoch 92
Validation mae = 1.002000
Validation band_gap mae = 1.002000
Epoch 93
Validation mae = 1.026917
Validation band_gap mae = 1.026917
Epoch 94
Validation mae = 1.003424
Validation band_gap mae = 1.003424
Epoch 95
Validation mae = 1.016406
Validation band_gap mae = 1.016406
Epoch 96
Validation mae = 1.017668
Validation band_gap mae = 1.017668
Epoch 97
Validation mae = 1.006090
Validation band_gap mae = 1.006090
Epoch 98
Validation mae = 1.009152
Validation band_gap mae = 1.009152
Epoch 99
Validation mae = 1.006731
Validation band_gap mae = 1.006731
Model 0 best validation mae = 1.142645 on epoch 4
Moving model to cuda
Model 0 test mae = 0.670937
Model 0 test band_gap mae = 0.670937
Ensemble test mae = 0.670937
Ensemble test band_gap mae = 0.670937
==================== fold 3 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.969298
Validation band_gap mae = 0.969298
Epoch 1
Validation mae = 0.977941
Validation band_gap mae = 0.977941
Epoch 2
Validation mae = 0.974205
Validation band_gap mae = 0.974205
Epoch 3
Validation mae = 0.921117
Validation band_gap mae = 0.921117
Epoch 4
Validation mae = 0.919861
Validation band_gap mae = 0.919861
Epoch 5
Validation mae = 0.930783
Validation band_gap mae = 0.930783
Epoch 6
Validation mae = 0.900205
Validation band_gap mae = 0.900205
Epoch 7
Validation mae = 0.915516
Validation band_gap mae = 0.915516
Epoch 8
Validation mae = 0.985244
Validation band_gap mae = 0.985244
Epoch 9
Validation mae = 0.896904
Validation band_gap mae = 0.896904
Epoch 10
Validation mae = 0.908407
Validation band_gap mae = 0.908407
Epoch 11
Validation mae = 0.888110
Validation band_gap mae = 0.888110
Epoch 12
Validation mae = 0.881411
Validation band_gap mae = 0.881411
Epoch 13
Validation mae = 0.911747
Validation band_gap mae = 0.911747
Epoch 14
Validation mae = 0.898225
Validation band_gap mae = 0.898225
Epoch 15
Validation mae = 0.900709
Validation band_gap mae = 0.900709
Epoch 16
Validation mae = 0.880132
Validation band_gap mae = 0.880132
Epoch 17
Validation mae = 0.904700
Validation band_gap mae = 0.904700
Epoch 18
Validation mae = 0.893665
Validation band_gap mae = 0.893665
Epoch 19
Validation mae = 0.917003
Validation band_gap mae = 0.917003
Epoch 20
Validation mae = 0.906645
Validation band_gap mae = 0.906645
Epoch 21
Validation mae = 0.927184
Validation band_gap mae = 0.927184
Epoch 22
Validation mae = 0.921959
Validation band_gap mae = 0.921959
Epoch 23
Validation mae = 0.912906
Validation band_gap mae = 0.912906
Epoch 24
Validation mae = 0.918663
Validation band_gap mae = 0.918663
Epoch 25
Validation mae = 0.942040
Validation band_gap mae = 0.942040
Epoch 26
Validation mae = 0.986276
Validation band_gap mae = 0.986276
Epoch 27
Validation mae = 1.061614
Validation band_gap mae = 1.061614
Epoch 28
Validation mae = 0.902845
Validation band_gap mae = 0.902845
Epoch 29
Validation mae = 0.930898
Validation band_gap mae = 0.930898
Epoch 30
Validation mae = 0.941730
Validation band_gap mae = 0.941730
Epoch 31
Validation mae = 1.008585
Validation band_gap mae = 1.008585
Epoch 32
Validation mae = 0.977889
Validation band_gap mae = 0.977889
Epoch 33
Validation mae = 0.928567
Validation band_gap mae = 0.928567
Epoch 34
Validation mae = 0.915881
Validation band_gap mae = 0.915881
Epoch 35
Validation mae = 0.933596
Validation band_gap mae = 0.933596
Epoch 36
Validation mae = 0.958885
Validation band_gap mae = 0.958885
Epoch 37
Validation mae = 0.918126
Validation band_gap mae = 0.918126
Epoch 38
Validation mae = 0.985001
Validation band_gap mae = 0.985001
Epoch 39
Validation mae = 0.979683
Validation band_gap mae = 0.979683
Epoch 40
Validation mae = 0.977003
Validation band_gap mae = 0.977003
Epoch 41
Validation mae = 0.951456
Validation band_gap mae = 0.951456
Epoch 42
Validation mae = 0.981941
Validation band_gap mae = 0.981941
Epoch 43
Validation mae = 0.960096
Validation band_gap mae = 0.960096
Epoch 44
Validation mae = 0.989389
Validation band_gap mae = 0.989389
Epoch 45
Validation mae = 0.920285
Validation band_gap mae = 0.920285
Epoch 46
Validation mae = 0.996414
Validation band_gap mae = 0.996414
Epoch 47
Validation mae = 0.924588
Validation band_gap mae = 0.924588
Epoch 48
Validation mae = 0.991030
Validation band_gap mae = 0.991030
Epoch 49
Validation mae = 0.960058
Validation band_gap mae = 0.960058
Epoch 50
Validation mae = 0.990826
Validation band_gap mae = 0.990826
Epoch 51
Validation mae = 0.939698
Validation band_gap mae = 0.939698
Epoch 52
Validation mae = 0.975961
Validation band_gap mae = 0.975961
Epoch 53
Validation mae = 0.924053
Validation band_gap mae = 0.924053
Epoch 54
Validation mae = 0.958933
Validation band_gap mae = 0.958933
Epoch 55
Validation mae = 0.954818
Validation band_gap mae = 0.954818
Epoch 56
Validation mae = 0.945485
Validation band_gap mae = 0.945485
Epoch 57
Validation mae = 0.933420
Validation band_gap mae = 0.933420
Epoch 58
Validation mae = 0.971741
Validation band_gap mae = 0.971741
Epoch 59
Validation mae = 0.978475
Validation band_gap mae = 0.978475
Epoch 60
Validation mae = 0.987835
Validation band_gap mae = 0.987835
Epoch 61
Validation mae = 0.941971
Validation band_gap mae = 0.941971
Epoch 62
Validation mae = 1.003437
Validation band_gap mae = 1.003437
Epoch 63
Validation mae = 0.901062
Validation band_gap mae = 0.901062
Epoch 64
Validation mae = 0.966489
Validation band_gap mae = 0.966489
Epoch 65
Validation mae = 0.911779
Validation band_gap mae = 0.911779
Epoch 66
Validation mae = 0.933164
Validation band_gap mae = 0.933164
Epoch 67
Validation mae = 0.915886
Validation band_gap mae = 0.915886
Epoch 68
Validation mae = 0.966012
Validation band_gap mae = 0.966012
Epoch 69
Validation mae = 0.966719
Validation band_gap mae = 0.966719
Epoch 70
Validation mae = 0.938130
Validation band_gap mae = 0.938130
Epoch 71
Validation mae = 0.960002
Validation band_gap mae = 0.960002
Epoch 72
Validation mae = 0.992020
Validation band_gap mae = 0.992020
Epoch 73
Validation mae = 0.929478
Validation band_gap mae = 0.929478
Epoch 74
Validation mae = 0.987486
Validation band_gap mae = 0.987486
Epoch 75
Validation mae = 0.986334
Validation band_gap mae = 0.986334
Epoch 76
Validation mae = 1.013060
Validation band_gap mae = 1.013060
Epoch 77
Validation mae = 0.975114
Validation band_gap mae = 0.975114
Epoch 78
Validation mae = 0.966595
Validation band_gap mae = 0.966595
Epoch 79
Validation mae = 0.995797
Validation band_gap mae = 0.995797
Epoch 80
Validation mae = 0.961578
Validation band_gap mae = 0.961578
Epoch 81
Validation mae = 0.986719
Validation band_gap mae = 0.986719
Epoch 82
Validation mae = 0.987034
Validation band_gap mae = 0.987034
Epoch 83
Validation mae = 0.967224
Validation band_gap mae = 0.967224
Epoch 84
Validation mae = 0.955505
Validation band_gap mae = 0.955505
Epoch 85
Validation mae = 0.952989
Validation band_gap mae = 0.952989
Epoch 86
Validation mae = 0.954250
Validation band_gap mae = 0.954250
Epoch 87
Validation mae = 0.945636
Validation band_gap mae = 0.945636
Epoch 88
Validation mae = 0.987122
Validation band_gap mae = 0.987122
Epoch 89
Validation mae = 0.967431
Validation band_gap mae = 0.967431
Epoch 90
Validation mae = 0.991599
Validation band_gap mae = 0.991599
Epoch 91
Validation mae = 0.976050
Validation band_gap mae = 0.976050
Epoch 92
Validation mae = 0.968676
Validation band_gap mae = 0.968676
Epoch 93
Validation mae = 0.996026
Validation band_gap mae = 0.996026
Epoch 94
Validation mae = 0.992474
Validation band_gap mae = 0.992474
Epoch 95
Validation mae = 0.999879
Validation band_gap mae = 0.999879
Epoch 96
Validation mae = 0.989673
Validation band_gap mae = 0.989673
Epoch 97
Validation mae = 0.962029
Validation band_gap mae = 0.962029
Epoch 98
Validation mae = 0.980275
Validation band_gap mae = 0.980275
Epoch 99
Validation mae = 0.969779
Validation band_gap mae = 0.969779
Model 0 best validation mae = 1.061614 on epoch 27
Moving model to cuda
Model 0 test mae = 0.768339
Model 0 test band_gap mae = 0.768339
Ensemble test mae = 0.768339
Ensemble test band_gap mae = 0.768339
==================== fold 4 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.693809
Validation band_gap mae = 0.693809
Epoch 1
Validation mae = 0.687047
Validation band_gap mae = 0.687047
Epoch 2
Validation mae = 0.716631
Validation band_gap mae = 0.716631
Epoch 3
Validation mae = 0.641371
Validation band_gap mae = 0.641371
Epoch 4
Validation mae = 0.745859
Validation band_gap mae = 0.745859
Epoch 5
Validation mae = 0.676483
Validation band_gap mae = 0.676483
Epoch 6
Validation mae = 0.634115
Validation band_gap mae = 0.634115
Epoch 7
Validation mae = 0.628788
Validation band_gap mae = 0.628788
Epoch 8
Validation mae = 0.662993
Validation band_gap mae = 0.662993
Epoch 9
Validation mae = 0.631291
Validation band_gap mae = 0.631291
Epoch 10
Validation mae = 0.673967
Validation band_gap mae = 0.673967
Epoch 11
Validation mae = 0.635718
Validation band_gap mae = 0.635718
Epoch 12
Validation mae = 0.660540
Validation band_gap mae = 0.660540
Epoch 13
Validation mae = 0.656625
Validation band_gap mae = 0.656625
Epoch 14
Validation mae = 0.637822
Validation band_gap mae = 0.637822
Epoch 15
Validation mae = 0.628219
Validation band_gap mae = 0.628219
Epoch 16
Validation mae = 0.685783
Validation band_gap mae = 0.685783
Epoch 17
Validation mae = 0.775790
Validation band_gap mae = 0.775790
Epoch 18
Validation mae = 0.697355
Validation band_gap mae = 0.697355
Epoch 19
Validation mae = 0.635869
Validation band_gap mae = 0.635869
Epoch 20
Validation mae = 0.674433
Validation band_gap mae = 0.674433
Epoch 21
Validation mae = 0.638326
Validation band_gap mae = 0.638326
Epoch 22
Validation mae = 0.688633
Validation band_gap mae = 0.688633
Epoch 23
Validation mae = 0.693356
Validation band_gap mae = 0.693356
Epoch 24
Validation mae = 0.710012
Validation band_gap mae = 0.710012
Epoch 25
Validation mae = 0.625008
Validation band_gap mae = 0.625008
Epoch 26
Validation mae = 0.640305
Validation band_gap mae = 0.640305
Epoch 27
Validation mae = 0.643374
Validation band_gap mae = 0.643374
Epoch 28
Validation mae = 0.643741
Validation band_gap mae = 0.643741
Epoch 29
Validation mae = 0.688229
Validation band_gap mae = 0.688229
Epoch 30
Validation mae = 0.790295
Validation band_gap mae = 0.790295
Epoch 31
Validation mae = 0.695556
Validation band_gap mae = 0.695556
Epoch 32
Validation mae = 0.649125
Validation band_gap mae = 0.649125
Epoch 33
Validation mae = 0.658322
Validation band_gap mae = 0.658322
Epoch 34
Validation mae = 0.669068
Validation band_gap mae = 0.669068
Epoch 35
Validation mae = 0.680572
Validation band_gap mae = 0.680572
Epoch 36
Validation mae = 0.675329
Validation band_gap mae = 0.675329
Epoch 37
Validation mae = 0.730815
Validation band_gap mae = 0.730815
Epoch 38
Validation mae = 0.659134
Validation band_gap mae = 0.659134
Epoch 39
Validation mae = 0.653515
Validation band_gap mae = 0.653515
Epoch 40
Validation mae = 0.751505
Validation band_gap mae = 0.751505
Epoch 41
Validation mae = 0.712523
Validation band_gap mae = 0.712523
Epoch 42
Validation mae = 0.711182
Validation band_gap mae = 0.711182
Epoch 43
Validation mae = 0.695597
Validation band_gap mae = 0.695597
Epoch 44
Validation mae = 0.694717
Validation band_gap mae = 0.694717
Epoch 45
Validation mae = 0.694880
Validation band_gap mae = 0.694880
Epoch 46
Validation mae = 0.675097
Validation band_gap mae = 0.675097
Epoch 47
Validation mae = 0.692049
Validation band_gap mae = 0.692049
Epoch 48
Validation mae = 0.691209
Validation band_gap mae = 0.691209
Epoch 49
Validation mae = 0.718548
Validation band_gap mae = 0.718548
Epoch 50
Validation mae = 0.748574
Validation band_gap mae = 0.748574
Epoch 51
Validation mae = 0.743550
Validation band_gap mae = 0.743550
Epoch 52
Validation mae = 0.739667
Validation band_gap mae = 0.739667
Epoch 53
Validation mae = 0.702601
Validation band_gap mae = 0.702601
Epoch 54
Validation mae = 0.695979
Validation band_gap mae = 0.695979
Epoch 55
Validation mae = 0.682581
Validation band_gap mae = 0.682581
Epoch 56
Validation mae = 0.752953
Validation band_gap mae = 0.752953
Epoch 57
Validation mae = 0.727903
Validation band_gap mae = 0.727903
Epoch 58
Validation mae = 0.806294
Validation band_gap mae = 0.806294
Epoch 59
Validation mae = 0.726601
Validation band_gap mae = 0.726601
Epoch 60
Validation mae = 0.740947
Validation band_gap mae = 0.740947
Epoch 61
Validation mae = 0.699038
Validation band_gap mae = 0.699038
Epoch 62
Validation mae = 0.713602
Validation band_gap mae = 0.713602
Epoch 63
Validation mae = 0.728278
Validation band_gap mae = 0.728278
Epoch 64
Validation mae = 0.745279
Validation band_gap mae = 0.745279
Epoch 65
Validation mae = 0.830580
Validation band_gap mae = 0.830580
Epoch 66
Validation mae = 0.702000
Validation band_gap mae = 0.702000
Epoch 67
Validation mae = 0.720991
Validation band_gap mae = 0.720991
Epoch 68
Validation mae = 0.723453
Validation band_gap mae = 0.723453
Epoch 69
Validation mae = 0.783970
Validation band_gap mae = 0.783970
Epoch 70
Validation mae = 0.697940
Validation band_gap mae = 0.697940
Epoch 71
Validation mae = 0.760373
Validation band_gap mae = 0.760373
Epoch 72
Validation mae = 0.729528
Validation band_gap mae = 0.729528
Epoch 73
Validation mae = 0.730676
Validation band_gap mae = 0.730676
Epoch 74
Validation mae = 0.734652
Validation band_gap mae = 0.734652
Epoch 75
Validation mae = 0.738287
Validation band_gap mae = 0.738287
Epoch 76
Validation mae = 0.724384
Validation band_gap mae = 0.724384
Epoch 77
Validation mae = 0.729214
Validation band_gap mae = 0.729214
Epoch 78
Validation mae = 0.758017
Validation band_gap mae = 0.758017
Epoch 79
Validation mae = 0.721309
Validation band_gap mae = 0.721309
Epoch 80
Validation mae = 0.744179
Validation band_gap mae = 0.744179
Epoch 81
Validation mae = 0.738352
Validation band_gap mae = 0.738352
Epoch 82
Validation mae = 0.712760
Validation band_gap mae = 0.712760
Epoch 83
Validation mae = 0.748198
Validation band_gap mae = 0.748198
Epoch 84
Validation mae = 0.734370
Validation band_gap mae = 0.734370
Epoch 85
Validation mae = 0.728617
Validation band_gap mae = 0.728617
Epoch 86
Validation mae = 0.761668
Validation band_gap mae = 0.761668
Epoch 87
Validation mae = 0.749403
Validation band_gap mae = 0.749403
Epoch 88
Validation mae = 0.754143
Validation band_gap mae = 0.754143
Epoch 89
Validation mae = 0.720657
Validation band_gap mae = 0.720657
Epoch 90
Validation mae = 0.783594
Validation band_gap mae = 0.783594
Epoch 91
Validation mae = 0.713927
Validation band_gap mae = 0.713927
Epoch 92
Validation mae = 0.735535
Validation band_gap mae = 0.735535
Epoch 93
Validation mae = 0.762955
Validation band_gap mae = 0.762955
Epoch 94
Validation mae = 0.750073
Validation band_gap mae = 0.750073
Epoch 95
Validation mae = 0.767776
Validation band_gap mae = 0.767776
Epoch 96
Validation mae = 0.725838
Validation band_gap mae = 0.725838
Epoch 97
Validation mae = 0.756498
Validation band_gap mae = 0.756498
Epoch 98
Validation mae = 0.747350
Validation band_gap mae = 0.747350
Epoch 99
Validation mae = 0.751960
Validation band_gap mae = 0.751960
Model 0 best validation mae = 0.830580 on epoch 65
Moving model to cuda
Model 0 test mae = 0.823758
Model 0 test band_gap mae = 0.823758
Ensemble test mae = 0.823758
Ensemble test band_gap mae = 0.823758
==================== fold 5 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.880181
Validation band_gap mae = 0.880181
Epoch 1
Validation mae = 0.915158
Validation band_gap mae = 0.915158
Epoch 2
Validation mae = 0.876030
Validation band_gap mae = 0.876030
Epoch 3
Validation mae = 0.862018
Validation band_gap mae = 0.862018
Epoch 4
Validation mae = 0.845448
Validation band_gap mae = 0.845448
Epoch 5
Validation mae = 0.867588
Validation band_gap mae = 0.867588
Epoch 6
Validation mae = 0.802288
Validation band_gap mae = 0.802288
Epoch 7
Validation mae = 0.801130
Validation band_gap mae = 0.801130
Epoch 8
Validation mae = 0.786703
Validation band_gap mae = 0.786703
Epoch 9
Validation mae = 0.826300
Validation band_gap mae = 0.826300
Epoch 10
Validation mae = 0.778940
Validation band_gap mae = 0.778940
Epoch 11
Validation mae = 0.785374
Validation band_gap mae = 0.785374
Epoch 12
Validation mae = 0.814173
Validation band_gap mae = 0.814173
Epoch 13
Validation mae = 0.780719
Validation band_gap mae = 0.780719
Epoch 14
Validation mae = 0.805285
Validation band_gap mae = 0.805285
Epoch 15
Validation mae = 0.778596
Validation band_gap mae = 0.778596
Epoch 16
Validation mae = 0.763859
Validation band_gap mae = 0.763859
Epoch 17
Validation mae = 0.776399
Validation band_gap mae = 0.776399
Epoch 18
Validation mae = 0.785828
Validation band_gap mae = 0.785828
Epoch 19
Validation mae = 0.825372
Validation band_gap mae = 0.825372
Epoch 20
Validation mae = 0.793290
Validation band_gap mae = 0.793290
Epoch 21
Validation mae = 0.795194
Validation band_gap mae = 0.795194
Epoch 22
Validation mae = 0.818692
Validation band_gap mae = 0.818692
Epoch 23
Validation mae = 0.748976
Validation band_gap mae = 0.748976
Epoch 24
Validation mae = 0.744789
Validation band_gap mae = 0.744789
Epoch 25
Validation mae = 0.743365
Validation band_gap mae = 0.743365
Epoch 26
Validation mae = 0.737047
Validation band_gap mae = 0.737047
Epoch 27
Validation mae = 0.756781
Validation band_gap mae = 0.756781
Epoch 28
Validation mae = 0.801844
Validation band_gap mae = 0.801844
Epoch 29
Validation mae = 0.780240
Validation band_gap mae = 0.780240
Epoch 30
Validation mae = 0.762642
Validation band_gap mae = 0.762642
Epoch 31
Validation mae = 0.785110
Validation band_gap mae = 0.785110
Epoch 32
Validation mae = 0.785836
Validation band_gap mae = 0.785836
Epoch 33
Validation mae = 0.755089
Validation band_gap mae = 0.755089
Epoch 34
Validation mae = 0.757884
Validation band_gap mae = 0.757884
Epoch 35
Validation mae = 0.805336
Validation band_gap mae = 0.805336
Epoch 36
Validation mae = 0.768130
Validation band_gap mae = 0.768130
Epoch 37
Validation mae = 0.762090
Validation band_gap mae = 0.762090
Epoch 38
Validation mae = 0.790402
Validation band_gap mae = 0.790402
Epoch 39
Validation mae = 0.775301
Validation band_gap mae = 0.775301
Epoch 40
Validation mae = 0.754541
Validation band_gap mae = 0.754541
Epoch 41
Validation mae = 0.771085
Validation band_gap mae = 0.771085
Epoch 42
Validation mae = 0.781356
Validation band_gap mae = 0.781356
Epoch 43
Validation mae = 0.773033
Validation band_gap mae = 0.773033
Epoch 44
Validation mae = 0.784789
Validation band_gap mae = 0.784789
Epoch 45
Validation mae = 0.816206
Validation band_gap mae = 0.816206
Epoch 46
Validation mae = 0.820093
Validation band_gap mae = 0.820093
Epoch 47
Validation mae = 0.824551
Validation band_gap mae = 0.824551
Epoch 48
Validation mae = 0.799303
Validation band_gap mae = 0.799303
Epoch 49
Validation mae = 0.824828
Validation band_gap mae = 0.824828
Epoch 50
Validation mae = 0.788750
Validation band_gap mae = 0.788750
Epoch 51
Validation mae = 0.802660
Validation band_gap mae = 0.802660
Epoch 52
Validation mae = 0.802875
Validation band_gap mae = 0.802875
Epoch 53
Validation mae = 0.795449
Validation band_gap mae = 0.795449
Epoch 54
Validation mae = 0.765622
Validation band_gap mae = 0.765622
Epoch 55
Validation mae = 0.771379
Validation band_gap mae = 0.771379
Epoch 56
Validation mae = 0.792078
Validation band_gap mae = 0.792078
Epoch 57
Validation mae = 0.774024
Validation band_gap mae = 0.774024
Epoch 58
Validation mae = 0.818194
Validation band_gap mae = 0.818194
Epoch 59
Validation mae = 0.814701
Validation band_gap mae = 0.814701
Epoch 60
Validation mae = 0.854147
Validation band_gap mae = 0.854147
Epoch 61
Validation mae = 0.803886
Validation band_gap mae = 0.803886
Epoch 62
Validation mae = 0.820629
Validation band_gap mae = 0.820629
Epoch 63
Validation mae = 0.829620
Validation band_gap mae = 0.829620
Epoch 64
Validation mae = 0.808639
Validation band_gap mae = 0.808639
Epoch 65
Validation mae = 0.786875
Validation band_gap mae = 0.786875
Epoch 66
Validation mae = 0.852463
Validation band_gap mae = 0.852463
Epoch 67
Validation mae = 0.841657
Validation band_gap mae = 0.841657
Epoch 68
Validation mae = 0.860933
Validation band_gap mae = 0.860933
Epoch 69
Validation mae = 0.787292
Validation band_gap mae = 0.787292
Epoch 70
Validation mae = 0.803305
Validation band_gap mae = 0.803305
Epoch 71
Validation mae = 0.768549
Validation band_gap mae = 0.768549
Epoch 72
Validation mae = 0.760139
Validation band_gap mae = 0.760139
Epoch 73
Validation mae = 0.789680
Validation band_gap mae = 0.789680
Epoch 74
Validation mae = 0.791048
Validation band_gap mae = 0.791048
Epoch 75
Validation mae = 0.803691
Validation band_gap mae = 0.803691
Epoch 76
Validation mae = 0.778100
Validation band_gap mae = 0.778100
Epoch 77
Validation mae = 0.806279
Validation band_gap mae = 0.806279
Epoch 78
Validation mae = 0.780688
Validation band_gap mae = 0.780688
Epoch 79
Validation mae = 0.778056
Validation band_gap mae = 0.778056
Epoch 80
Validation mae = 0.810273
Validation band_gap mae = 0.810273
Epoch 81
Validation mae = 0.796628
Validation band_gap mae = 0.796628
Epoch 82
Validation mae = 0.784656
Validation band_gap mae = 0.784656
Epoch 83
Validation mae = 0.787819
Validation band_gap mae = 0.787819
Epoch 84
Validation mae = 0.791248
Validation band_gap mae = 0.791248
Epoch 85
Validation mae = 0.798267
Validation band_gap mae = 0.798267
Epoch 86
Validation mae = 0.789786
Validation band_gap mae = 0.789786
Epoch 87
Validation mae = 0.786165
Validation band_gap mae = 0.786165
Epoch 88
Validation mae = 0.793701
Validation band_gap mae = 0.793701
Epoch 89
Validation mae = 0.781473
Validation band_gap mae = 0.781473
Epoch 90
Validation mae = 0.800812
Validation band_gap mae = 0.800812
Epoch 91
Validation mae = 0.798054
Validation band_gap mae = 0.798054
Epoch 92
Validation mae = 0.779357
Validation band_gap mae = 0.779357
Epoch 93
Validation mae = 0.796419
Validation band_gap mae = 0.796419
Epoch 94
Validation mae = 0.779758
Validation band_gap mae = 0.779758
Epoch 95
Validation mae = 0.785377
Validation band_gap mae = 0.785377
Epoch 96
Validation mae = 0.817409
Validation band_gap mae = 0.817409
Epoch 97
Validation mae = 0.786300
Validation band_gap mae = 0.786300
Epoch 98
Validation mae = 0.780839
Validation band_gap mae = 0.780839
Epoch 99
Validation mae = 0.785911
Validation band_gap mae = 0.785911
Model 0 best validation mae = 0.915158 on epoch 1
Moving model to cuda
Model 0 test mae = 0.527102
Model 0 test band_gap mae = 0.527102
Ensemble test mae = 0.527102
Ensemble test band_gap mae = 0.527102
==================== fold 6 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.832352
Validation band_gap mae = 0.832352
Epoch 1
Validation mae = 0.810806
Validation band_gap mae = 0.810806
Epoch 2
Validation mae = 0.802554
Validation band_gap mae = 0.802554
Epoch 3
Validation mae = 0.799959
Validation band_gap mae = 0.799959
Epoch 4
Validation mae = 0.780799
Validation band_gap mae = 0.780799
Epoch 5
Validation mae = 0.798640
Validation band_gap mae = 0.798640
Epoch 6
Validation mae = 0.775370
Validation band_gap mae = 0.775370
Epoch 7
Validation mae = 0.789733
Validation band_gap mae = 0.789733
Epoch 8
Validation mae = 0.776869
Validation band_gap mae = 0.776869
Epoch 9
Validation mae = 0.742457
Validation band_gap mae = 0.742457
Epoch 10
Validation mae = 0.719521
Validation band_gap mae = 0.719521
Epoch 11
Validation mae = 0.717345
Validation band_gap mae = 0.717345
Epoch 12
Validation mae = 0.737883
Validation band_gap mae = 0.737883
Epoch 13
Validation mae = 0.763424
Validation band_gap mae = 0.763424
Epoch 14
Validation mae = 0.709057
Validation band_gap mae = 0.709057
Epoch 15
Validation mae = 0.720857
Validation band_gap mae = 0.720857
Epoch 16
Validation mae = 0.773175
Validation band_gap mae = 0.773175
Epoch 17
Validation mae = 0.705134
Validation band_gap mae = 0.705134
Epoch 18
Validation mae = 0.688458
Validation band_gap mae = 0.688458
Epoch 19
Validation mae = 0.714749
Validation band_gap mae = 0.714749
Epoch 20
Validation mae = 0.739146
Validation band_gap mae = 0.739146
Epoch 21
Validation mae = 0.850110
Validation band_gap mae = 0.850110
Epoch 22
Validation mae = 0.741128
Validation band_gap mae = 0.741128
Epoch 23
Validation mae = 0.699599
Validation band_gap mae = 0.699599
Epoch 24
Validation mae = 0.718390
Validation band_gap mae = 0.718390
Epoch 25
Validation mae = 0.766144
Validation band_gap mae = 0.766144
Epoch 26
Validation mae = 0.737393
Validation band_gap mae = 0.737393
Epoch 27
Validation mae = 0.729932
Validation band_gap mae = 0.729932
Epoch 28
Validation mae = 0.753523
Validation band_gap mae = 0.753523
Epoch 29
Validation mae = 0.810107
Validation band_gap mae = 0.810107
Epoch 30
Validation mae = 0.829743
Validation band_gap mae = 0.829743
Epoch 31
Validation mae = 0.776572
Validation band_gap mae = 0.776572
Epoch 32
Validation mae = 0.737798
Validation band_gap mae = 0.737798
Epoch 33
Validation mae = 0.761210
Validation band_gap mae = 0.761210
Epoch 34
Validation mae = 0.762883
Validation band_gap mae = 0.762883
Epoch 35
Validation mae = 0.746774
Validation band_gap mae = 0.746774
Epoch 36
Validation mae = 0.795152
Validation band_gap mae = 0.795152
Epoch 37
Validation mae = 0.754873
Validation band_gap mae = 0.754873
Epoch 38
Validation mae = 0.774821
Validation band_gap mae = 0.774821
Epoch 39
Validation mae = 0.818510
Validation band_gap mae = 0.818510
Epoch 40
Validation mae = 0.834270
Validation band_gap mae = 0.834270
Epoch 41
Validation mae = 0.823468
Validation band_gap mae = 0.823468
Epoch 42
Validation mae = 0.796121
Validation band_gap mae = 0.796121
Epoch 43
Validation mae = 0.867300
Validation band_gap mae = 0.867300
Epoch 44
Validation mae = 0.807485
Validation band_gap mae = 0.807485
Epoch 45
Validation mae = 0.789389
Validation band_gap mae = 0.789389
Epoch 46
Validation mae = 0.807634
Validation band_gap mae = 0.807634
Epoch 47
Validation mae = 0.831713
Validation band_gap mae = 0.831713
Epoch 48
Validation mae = 0.774302
Validation band_gap mae = 0.774302
Epoch 49
Validation mae = 0.834549
Validation band_gap mae = 0.834549
Epoch 50
Validation mae = 0.790090
Validation band_gap mae = 0.790090
Epoch 51
Validation mae = 0.813429
Validation band_gap mae = 0.813429
Epoch 52
Validation mae = 0.814511
Validation band_gap mae = 0.814511
Epoch 53
Validation mae = 0.804735
Validation band_gap mae = 0.804735
Epoch 54
Validation mae = 0.842907
Validation band_gap mae = 0.842907
Epoch 55
Validation mae = 0.844607
Validation band_gap mae = 0.844607
Epoch 56
Validation mae = 0.806562
Validation band_gap mae = 0.806562
Epoch 57
Validation mae = 0.816435
Validation band_gap mae = 0.816435
Epoch 58
Validation mae = 0.827641
Validation band_gap mae = 0.827641
Epoch 59
Validation mae = 0.818629
Validation band_gap mae = 0.818629
Epoch 60
Validation mae = 0.808987
Validation band_gap mae = 0.808987
Epoch 61
Validation mae = 0.806981
Validation band_gap mae = 0.806981
Epoch 62
Validation mae = 0.799290
Validation band_gap mae = 0.799290
Epoch 63
Validation mae = 0.811212
Validation band_gap mae = 0.811212
Epoch 64
Validation mae = 0.827561
Validation band_gap mae = 0.827561
Epoch 65
Validation mae = 0.853959
Validation band_gap mae = 0.853959
Epoch 66
Validation mae = 0.836585
Validation band_gap mae = 0.836585
Epoch 67
Validation mae = 0.800713
Validation band_gap mae = 0.800713
Epoch 68
Validation mae = 0.831035
Validation band_gap mae = 0.831035
Epoch 69
Validation mae = 0.853984
Validation band_gap mae = 0.853984
Epoch 70
Validation mae = 0.799264
Validation band_gap mae = 0.799264
Epoch 71
Validation mae = 0.783414
Validation band_gap mae = 0.783414
Epoch 72
Validation mae = 0.801061
Validation band_gap mae = 0.801061
Epoch 73
Validation mae = 0.830090
Validation band_gap mae = 0.830090
Epoch 74
Validation mae = 0.816226
Validation band_gap mae = 0.816226
Epoch 75
Validation mae = 0.809449
Validation band_gap mae = 0.809449
Epoch 76
Validation mae = 0.811123
Validation band_gap mae = 0.811123
Epoch 77
Validation mae = 0.803034
Validation band_gap mae = 0.803034
Epoch 78
Validation mae = 0.803289
Validation band_gap mae = 0.803289
Epoch 79
Validation mae = 0.824608
Validation band_gap mae = 0.824608
Epoch 80
Validation mae = 0.799981
Validation band_gap mae = 0.799981
Epoch 81
Validation mae = 0.819751
Validation band_gap mae = 0.819751
Epoch 82
Validation mae = 0.834755
Validation band_gap mae = 0.834755
Epoch 83
Validation mae = 0.818723
Validation band_gap mae = 0.818723
Epoch 84
Validation mae = 0.824514
Validation band_gap mae = 0.824514
Epoch 85
Validation mae = 0.819539
Validation band_gap mae = 0.819539
Epoch 86
Validation mae = 0.809026
Validation band_gap mae = 0.809026
Epoch 87
Validation mae = 0.820831
Validation band_gap mae = 0.820831
Epoch 88
Validation mae = 0.811553
Validation band_gap mae = 0.811553
Epoch 89
Validation mae = 0.812847
Validation band_gap mae = 0.812847
Epoch 90
Validation mae = 0.802249
Validation band_gap mae = 0.802249
Epoch 91
Validation mae = 0.817190
Validation band_gap mae = 0.817190
Epoch 92
Validation mae = 0.808007
Validation band_gap mae = 0.808007
Epoch 93
Validation mae = 0.806531
Validation band_gap mae = 0.806531
Epoch 94
Validation mae = 0.814260
Validation band_gap mae = 0.814260
Epoch 95
Validation mae = 0.803846
Validation band_gap mae = 0.803846
Epoch 96
Validation mae = 0.817181
Validation band_gap mae = 0.817181
Epoch 97
Validation mae = 0.817724
Validation band_gap mae = 0.817724
Epoch 98
Validation mae = 0.807947
Validation band_gap mae = 0.807947
Epoch 99
Validation mae = 0.826092
Validation band_gap mae = 0.826092
Model 0 best validation mae = 0.867300 on epoch 43
Moving model to cuda
Model 0 test mae = 0.924350
Model 0 test band_gap mae = 0.924350
Ensemble test mae = 0.924350
Ensemble test band_gap mae = 0.924350
==================== fold 7 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.752765
Validation band_gap mae = 0.752765
Epoch 1
Validation mae = 0.766513
Validation band_gap mae = 0.766513
Epoch 2
Validation mae = 0.891755
Validation band_gap mae = 0.891755
Epoch 3
Validation mae = 0.702768
Validation band_gap mae = 0.702768
Epoch 4
Validation mae = 0.750552
Validation band_gap mae = 0.750552
Epoch 5
Validation mae = 0.778622
Validation band_gap mae = 0.778622
Epoch 6
Validation mae = 0.709773
Validation band_gap mae = 0.709773
Epoch 7
Validation mae = 0.723919
Validation band_gap mae = 0.723919
Epoch 8
Validation mae = 0.687501
Validation band_gap mae = 0.687501
Epoch 9
Validation mae = 0.763763
Validation band_gap mae = 0.763763
Epoch 10
Validation mae = 0.732646
Validation band_gap mae = 0.732646
Epoch 11
Validation mae = 0.774903
Validation band_gap mae = 0.774903
Epoch 12
Validation mae = 0.767791
Validation band_gap mae = 0.767791
Epoch 13
Validation mae = 0.724638
Validation band_gap mae = 0.724638
Epoch 14
Validation mae = 0.697452
Validation band_gap mae = 0.697452
Epoch 15
Validation mae = 0.825281
Validation band_gap mae = 0.825281
Epoch 16
Validation mae = 0.791057
Validation band_gap mae = 0.791057
Epoch 17
Validation mae = 0.721683
Validation band_gap mae = 0.721683
Epoch 18
Validation mae = 0.696010
Validation band_gap mae = 0.696010
Epoch 19
Validation mae = 0.740976
Validation band_gap mae = 0.740976
Epoch 20
Validation mae = 0.725398
Validation band_gap mae = 0.725398
Epoch 21
Validation mae = 0.776422
Validation band_gap mae = 0.776422
Epoch 22
Validation mae = 0.696689
Validation band_gap mae = 0.696689
Epoch 23
Validation mae = 0.735742
Validation band_gap mae = 0.735742
Epoch 24
Validation mae = 0.676949
Validation band_gap mae = 0.676949
Epoch 25
Validation mae = 0.766173
Validation band_gap mae = 0.766173
Epoch 26
Validation mae = 0.697549
Validation band_gap mae = 0.697549
Epoch 27
Validation mae = 0.725698
Validation band_gap mae = 0.725698
Epoch 28
Validation mae = 0.726233
Validation band_gap mae = 0.726233
Epoch 29
Validation mae = 0.729959
Validation band_gap mae = 0.729959
Epoch 30
Validation mae = 0.732041
Validation band_gap mae = 0.732041
Epoch 31
Validation mae = 0.712926
Validation band_gap mae = 0.712926
Epoch 32
Validation mae = 0.762455
Validation band_gap mae = 0.762455
Epoch 33
Validation mae = 0.746513
Validation band_gap mae = 0.746513
Epoch 34
Validation mae = 0.795285
Validation band_gap mae = 0.795285
Epoch 35
Validation mae = 0.829418
Validation band_gap mae = 0.829418
Epoch 36
Validation mae = 0.732496
Validation band_gap mae = 0.732496
Epoch 37
Validation mae = 0.771198
Validation band_gap mae = 0.771198
Epoch 38
Validation mae = 0.773254
Validation band_gap mae = 0.773254
Epoch 39
Validation mae = 0.776675
Validation band_gap mae = 0.776675
Epoch 40
Validation mae = 0.796974
Validation band_gap mae = 0.796974
Epoch 41
Validation mae = 0.741773
Validation band_gap mae = 0.741773
Epoch 42
Validation mae = 0.757960
Validation band_gap mae = 0.757960
Epoch 43
Validation mae = 0.791972
Validation band_gap mae = 0.791972
Epoch 44
Validation mae = 0.727254
Validation band_gap mae = 0.727254
Epoch 45
Validation mae = 0.817519
Validation band_gap mae = 0.817519
Epoch 46
Validation mae = 0.774147
Validation band_gap mae = 0.774147
Epoch 47
Validation mae = 0.816296
Validation band_gap mae = 0.816296
Epoch 48
Validation mae = 0.844021
Validation band_gap mae = 0.844021
Epoch 49
Validation mae = 0.780551
Validation band_gap mae = 0.780551
Epoch 50
Validation mae = 0.833790
Validation band_gap mae = 0.833790
Epoch 51
Validation mae = 0.797736
Validation band_gap mae = 0.797736
Epoch 52
Validation mae = 0.766322
Validation band_gap mae = 0.766322
Epoch 53
Validation mae = 0.803045
Validation band_gap mae = 0.803045
Epoch 54
Validation mae = 0.823869
Validation band_gap mae = 0.823869
Epoch 55
Validation mae = 0.775878
Validation band_gap mae = 0.775878
Epoch 56
Validation mae = 0.796356
Validation band_gap mae = 0.796356
Epoch 57
Validation mae = 0.820837
Validation band_gap mae = 0.820837
Epoch 58
Validation mae = 0.812160
Validation band_gap mae = 0.812160
Epoch 59
Validation mae = 0.737618
Validation band_gap mae = 0.737618
Epoch 60
Validation mae = 0.775815
Validation band_gap mae = 0.775815
Epoch 61
Validation mae = 0.789648
Validation band_gap mae = 0.789648
Epoch 62
Validation mae = 0.803485
Validation band_gap mae = 0.803485
Epoch 63
Validation mae = 0.762201
Validation band_gap mae = 0.762201
Epoch 64
Validation mae = 0.766392
Validation band_gap mae = 0.766392
Epoch 65
Validation mae = 0.768593
Validation band_gap mae = 0.768593
Epoch 66
Validation mae = 0.754204
Validation band_gap mae = 0.754204
Epoch 67
Validation mae = 0.778626
Validation band_gap mae = 0.778626
Epoch 68
Validation mae = 0.765785
Validation band_gap mae = 0.765785
Epoch 69
Validation mae = 0.737080
Validation band_gap mae = 0.737080
Epoch 70
Validation mae = 0.830394
Validation band_gap mae = 0.830394
Epoch 71
Validation mae = 0.760977
Validation band_gap mae = 0.760977
Epoch 72
Validation mae = 0.796756
Validation band_gap mae = 0.796756
Epoch 73
Validation mae = 0.769491
Validation band_gap mae = 0.769491
Epoch 74
Validation mae = 0.781268
Validation band_gap mae = 0.781268
Epoch 75
Validation mae = 0.763045
Validation band_gap mae = 0.763045
Epoch 76
Validation mae = 0.793697
Validation band_gap mae = 0.793697
Epoch 77
Validation mae = 0.781116
Validation band_gap mae = 0.781116
Epoch 78
Validation mae = 0.750813
Validation band_gap mae = 0.750813
Epoch 79
Validation mae = 0.801370
Validation band_gap mae = 0.801370
Epoch 80
Validation mae = 0.784984
Validation band_gap mae = 0.784984
Epoch 81
Validation mae = 0.730279
Validation band_gap mae = 0.730279
Epoch 82
Validation mae = 0.825748
Validation band_gap mae = 0.825748
Epoch 83
Validation mae = 0.753614
Validation band_gap mae = 0.753614
Epoch 84
Validation mae = 0.782791
Validation band_gap mae = 0.782791
Epoch 85
Validation mae = 0.777405
Validation band_gap mae = 0.777405
Epoch 86
Validation mae = 0.800190
Validation band_gap mae = 0.800190
Epoch 87
Validation mae = 0.780603
Validation band_gap mae = 0.780603
Epoch 88
Validation mae = 0.812395
Validation band_gap mae = 0.812395
Epoch 89
Validation mae = 0.759153
Validation band_gap mae = 0.759153
Epoch 90
Validation mae = 0.795573
Validation band_gap mae = 0.795573
Epoch 91
Validation mae = 0.741062
Validation band_gap mae = 0.741062
Epoch 92
Validation mae = 0.811351
Validation band_gap mae = 0.811351
Epoch 93
Validation mae = 0.799856
Validation band_gap mae = 0.799856
Epoch 94
Validation mae = 0.786990
Validation band_gap mae = 0.786990
Epoch 95
Validation mae = 0.786561
Validation band_gap mae = 0.786561
Epoch 96
Validation mae = 0.787592
Validation band_gap mae = 0.787592
Epoch 97
Validation mae = 0.785759
Validation band_gap mae = 0.785759
Epoch 98
Validation mae = 0.776611
Validation band_gap mae = 0.776611
Epoch 99
Validation mae = 0.782506
Validation band_gap mae = 0.782506
Model 0 best validation mae = 0.891755 on epoch 2
Moving model to cuda
Model 0 test mae = 0.689186
Model 0 test band_gap mae = 0.689186
Ensemble test mae = 0.689186
Ensemble test band_gap mae = 0.689186
==================== fold 8 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.728929
Validation band_gap mae = 0.728929
Epoch 1
Validation mae = 0.685363
Validation band_gap mae = 0.685363
Epoch 2
Validation mae = 0.682604
Validation band_gap mae = 0.682604
Epoch 3
Validation mae = 0.724441
Validation band_gap mae = 0.724441
Epoch 4
Validation mae = 0.648407
Validation band_gap mae = 0.648407
Epoch 5
Validation mae = 0.687961
Validation band_gap mae = 0.687961
Epoch 6
Validation mae = 0.623753
Validation band_gap mae = 0.623753
Epoch 7
Validation mae = 0.622033
Validation band_gap mae = 0.622033
Epoch 8
Validation mae = 0.650192
Validation band_gap mae = 0.650192
Epoch 9
Validation mae = 0.675081
Validation band_gap mae = 0.675081
Epoch 10
Validation mae = 0.629165
Validation band_gap mae = 0.629165
Epoch 11
Validation mae = 0.619552
Validation band_gap mae = 0.619552
Epoch 12
Validation mae = 0.682774
Validation band_gap mae = 0.682774
Epoch 13
Validation mae = 0.637042
Validation band_gap mae = 0.637042
Epoch 14
Validation mae = 0.672445
Validation band_gap mae = 0.672445
Epoch 15
Validation mae = 0.621135
Validation band_gap mae = 0.621135
Epoch 16
Validation mae = 0.653499
Validation band_gap mae = 0.653499
Epoch 17
Validation mae = 0.633928
Validation band_gap mae = 0.633928
Epoch 18
Validation mae = 0.619339
Validation band_gap mae = 0.619339
Epoch 19
Validation mae = 0.718062
Validation band_gap mae = 0.718062
Epoch 20
Validation mae = 0.645692
Validation band_gap mae = 0.645692
Epoch 21
Validation mae = 0.649953
Validation band_gap mae = 0.649953
Epoch 22
Validation mae = 0.649070
Validation band_gap mae = 0.649070
Epoch 23
Validation mae = 0.653140
Validation band_gap mae = 0.653140
Epoch 24
Validation mae = 0.659324
Validation band_gap mae = 0.659324
Epoch 25
Validation mae = 0.687033
Validation band_gap mae = 0.687033
Epoch 26
Validation mae = 0.680503
Validation band_gap mae = 0.680503
Epoch 27
Validation mae = 0.669192
Validation band_gap mae = 0.669192
Epoch 28
Validation mae = 0.716005
Validation band_gap mae = 0.716005
Epoch 29
Validation mae = 0.685014
Validation band_gap mae = 0.685014
Epoch 30
Validation mae = 0.716575
Validation band_gap mae = 0.716575
Epoch 31
Validation mae = 0.649433
Validation band_gap mae = 0.649433
Epoch 32
Validation mae = 0.646958
Validation band_gap mae = 0.646958
Epoch 33
Validation mae = 0.701606
Validation band_gap mae = 0.701606
Epoch 34
Validation mae = 0.671153
Validation band_gap mae = 0.671153
Epoch 35
Validation mae = 0.699518
Validation band_gap mae = 0.699518
Epoch 36
Validation mae = 0.719714
Validation band_gap mae = 0.719714
Epoch 37
Validation mae = 0.712497
Validation band_gap mae = 0.712497
Epoch 38
Validation mae = 0.708561
Validation band_gap mae = 0.708561
Epoch 39
Validation mae = 0.724163
Validation band_gap mae = 0.724163
Epoch 40
Validation mae = 0.726232
Validation band_gap mae = 0.726232
Epoch 41
Validation mae = 0.718654
Validation band_gap mae = 0.718654
Epoch 42
Validation mae = 0.729277
Validation band_gap mae = 0.729277
Epoch 43
Validation mae = 0.708592
Validation band_gap mae = 0.708592
Epoch 44
Validation mae = 0.714454
Validation band_gap mae = 0.714454
Epoch 45
Validation mae = 0.730681
Validation band_gap mae = 0.730681
Epoch 46
Validation mae = 0.702747
Validation band_gap mae = 0.702747
Epoch 47
Validation mae = 0.736444
Validation band_gap mae = 0.736444
Epoch 48
Validation mae = 0.729487
Validation band_gap mae = 0.729487
Epoch 49
Validation mae = 0.732285
Validation band_gap mae = 0.732285
Epoch 50
Validation mae = 0.724006
Validation band_gap mae = 0.724006
Epoch 51
Validation mae = 0.725300
Validation band_gap mae = 0.725300
Epoch 52
Validation mae = 0.770912
Validation band_gap mae = 0.770912
Epoch 53
Validation mae = 0.728881
Validation band_gap mae = 0.728881
Epoch 54
Validation mae = 0.668869
Validation band_gap mae = 0.668869
Epoch 55
Validation mae = 0.736965
Validation band_gap mae = 0.736965
Epoch 56
Validation mae = 0.704502
Validation band_gap mae = 0.704502
Epoch 57
Validation mae = 0.717432
Validation band_gap mae = 0.717432
Epoch 58
Validation mae = 0.734796
Validation band_gap mae = 0.734796
Epoch 59
Validation mae = 0.736443
Validation band_gap mae = 0.736443
Epoch 60
Validation mae = 0.730446
Validation band_gap mae = 0.730446
Epoch 61
Validation mae = 0.717535
Validation band_gap mae = 0.717535
Epoch 62
Validation mae = 0.728983
Validation band_gap mae = 0.728983
Epoch 63
Validation mae = 0.746415
Validation band_gap mae = 0.746415
Epoch 64
Validation mae = 0.721483
Validation band_gap mae = 0.721483
Epoch 65
Validation mae = 0.739965
Validation band_gap mae = 0.739965
Epoch 66
Validation mae = 0.728569
Validation band_gap mae = 0.728569
Epoch 67
Validation mae = 0.728457
Validation band_gap mae = 0.728457
Epoch 68
Validation mae = 0.728116
Validation band_gap mae = 0.728116
Epoch 69
Validation mae = 0.709971
Validation band_gap mae = 0.709971
Epoch 70
Validation mae = 0.744436
Validation band_gap mae = 0.744436
Epoch 71
Validation mae = 0.706504
Validation band_gap mae = 0.706504
Epoch 72
Validation mae = 0.723943
Validation band_gap mae = 0.723943
Epoch 73
Validation mae = 0.722137
Validation band_gap mae = 0.722137
Epoch 74
Validation mae = 0.730362
Validation band_gap mae = 0.730362
Epoch 75
Validation mae = 0.723625
Validation band_gap mae = 0.723625
Epoch 76
Validation mae = 0.726464
Validation band_gap mae = 0.726464
Epoch 77
Validation mae = 0.729684
Validation band_gap mae = 0.729684
Epoch 78
Validation mae = 0.720627
Validation band_gap mae = 0.720627
Epoch 79
Validation mae = 0.724329
Validation band_gap mae = 0.724329
Epoch 80
Validation mae = 0.744392
Validation band_gap mae = 0.744392
Epoch 81
Validation mae = 0.732257
Validation band_gap mae = 0.732257
Epoch 82
Validation mae = 0.735414
Validation band_gap mae = 0.735414
Epoch 83
Validation mae = 0.736770
Validation band_gap mae = 0.736770
Epoch 84
Validation mae = 0.715807
Validation band_gap mae = 0.715807
Epoch 85
Validation mae = 0.746331
Validation band_gap mae = 0.746331
Epoch 86
Validation mae = 0.742666
Validation band_gap mae = 0.742666
Epoch 87
Validation mae = 0.734655
Validation band_gap mae = 0.734655
Epoch 88
Validation mae = 0.749866
Validation band_gap mae = 0.749866
Epoch 89
Validation mae = 0.709786
Validation band_gap mae = 0.709786
Epoch 90
Validation mae = 0.755834
Validation band_gap mae = 0.755834
Epoch 91
Validation mae = 0.716945
Validation band_gap mae = 0.716945
Epoch 92
Validation mae = 0.750681
Validation band_gap mae = 0.750681
Epoch 93
Validation mae = 0.718673
Validation band_gap mae = 0.718673
Epoch 94
Validation mae = 0.726453
Validation band_gap mae = 0.726453
Epoch 95
Validation mae = 0.734508
Validation band_gap mae = 0.734508
Epoch 96
Validation mae = 0.730353
Validation band_gap mae = 0.730353
Epoch 97
Validation mae = 0.733023
Validation band_gap mae = 0.733023
Epoch 98
Validation mae = 0.723019
Validation band_gap mae = 0.723019
Epoch 99
Validation mae = 0.739103
Validation band_gap mae = 0.739103
Model 0 best validation mae = 0.770912 on epoch 52
Moving model to cuda
Model 0 test mae = 0.561241
Model 0 test band_gap mae = 0.561241
Ensemble test mae = 0.561241
Ensemble test band_gap mae = 0.561241
==================== fold 9 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.931116
Validation band_gap mae = 0.931116
Epoch 1
Validation mae = 0.898332
Validation band_gap mae = 0.898332
Epoch 2
Validation mae = 0.896506
Validation band_gap mae = 0.896506
Epoch 3
Validation mae = 0.875234
Validation band_gap mae = 0.875234
Epoch 4
Validation mae = 0.874597
Validation band_gap mae = 0.874597
Epoch 5
Validation mae = 0.878188
Validation band_gap mae = 0.878188
Epoch 6
Validation mae = 0.876031
Validation band_gap mae = 0.876031
Epoch 7
Validation mae = 0.893439
Validation band_gap mae = 0.893439
Epoch 8
Validation mae = 0.872956
Validation band_gap mae = 0.872956
Epoch 9
Validation mae = 0.922866
Validation band_gap mae = 0.922866
Epoch 10
Validation mae = 0.900368
Validation band_gap mae = 0.900368
Epoch 11
Validation mae = 0.927705
Validation band_gap mae = 0.927705
Epoch 12
Validation mae = 0.900774
Validation band_gap mae = 0.900774
Epoch 13
Validation mae = 0.867372
Validation band_gap mae = 0.867372
Epoch 14
Validation mae = 0.876916
Validation band_gap mae = 0.876916
Epoch 15
Validation mae = 0.871641
Validation band_gap mae = 0.871641
Epoch 16
Validation mae = 0.846337
Validation band_gap mae = 0.846337
Epoch 17
Validation mae = 0.856399
Validation band_gap mae = 0.856399
Epoch 18
Validation mae = 0.854616
Validation band_gap mae = 0.854616
Epoch 19
Validation mae = 0.860167
Validation band_gap mae = 0.860167
Epoch 20
Validation mae = 0.895606
Validation band_gap mae = 0.895606
Epoch 21
Validation mae = 0.862478
Validation band_gap mae = 0.862478
Epoch 22
Validation mae = 0.870366
Validation band_gap mae = 0.870366
Epoch 23
Validation mae = 0.866968
Validation band_gap mae = 0.866968
Epoch 24
Validation mae = 0.875494
Validation band_gap mae = 0.875494
Epoch 25
Validation mae = 0.905867
Validation band_gap mae = 0.905867
Epoch 26
Validation mae = 0.865902
Validation band_gap mae = 0.865902
Epoch 27
Validation mae = 0.955963
Validation band_gap mae = 0.955963
Epoch 28
Validation mae = 0.936669
Validation band_gap mae = 0.936669
Epoch 29
Validation mae = 0.856253
Validation band_gap mae = 0.856253
Epoch 30
Validation mae = 0.878807
Validation band_gap mae = 0.878807
Epoch 31
Validation mae = 0.882164
Validation band_gap mae = 0.882164
Epoch 32
Validation mae = 0.894799
Validation band_gap mae = 0.894799
Epoch 33
Validation mae = 0.853971
Validation band_gap mae = 0.853971
Epoch 34
Validation mae = 0.901533
Validation band_gap mae = 0.901533
Epoch 35
Validation mae = 0.882612
Validation band_gap mae = 0.882612
Epoch 36
Validation mae = 0.882369
Validation band_gap mae = 0.882369
Epoch 37
Validation mae = 0.904714
Validation band_gap mae = 0.904714
Epoch 38
Validation mae = 0.888500
Validation band_gap mae = 0.888500
Epoch 39
Validation mae = 0.902232
Validation band_gap mae = 0.902232
Epoch 40
Validation mae = 0.894642
Validation band_gap mae = 0.894642
Epoch 41
Validation mae = 0.911863
Validation band_gap mae = 0.911863
Epoch 42
Validation mae = 0.974954
Validation band_gap mae = 0.974954
Epoch 43
Validation mae = 0.931172
Validation band_gap mae = 0.931172
Epoch 44
Validation mae = 0.868711
Validation band_gap mae = 0.868711
Epoch 45
Validation mae = 0.937836
Validation band_gap mae = 0.937836
Epoch 46
Validation mae = 0.902809
Validation band_gap mae = 0.902809
Epoch 47
Validation mae = 0.892656
Validation band_gap mae = 0.892656
Epoch 48
Validation mae = 0.888939
Validation band_gap mae = 0.888939
Epoch 49
Validation mae = 0.918274
Validation band_gap mae = 0.918274
Epoch 50
Validation mae = 0.891843
Validation band_gap mae = 0.891843
Epoch 51
Validation mae = 0.902971
Validation band_gap mae = 0.902971
Epoch 52
Validation mae = 0.880355
Validation band_gap mae = 0.880355
Epoch 53
Validation mae = 0.886762
Validation band_gap mae = 0.886762
Epoch 54
Validation mae = 0.945261
Validation band_gap mae = 0.945261
Epoch 55
Validation mae = 0.960318
Validation band_gap mae = 0.960318
Epoch 56
Validation mae = 0.900480
Validation band_gap mae = 0.900480
Epoch 57
Validation mae = 0.914622
Validation band_gap mae = 0.914622
Epoch 58
Validation mae = 0.903629
Validation band_gap mae = 0.903629
Epoch 59
Validation mae = 0.896992
Validation band_gap mae = 0.896992
Epoch 60
Validation mae = 0.924266
Validation band_gap mae = 0.924266
Epoch 61
Validation mae = 0.910942
Validation band_gap mae = 0.910942
Epoch 62
Validation mae = 0.906218
Validation band_gap mae = 0.906218
Epoch 63
Validation mae = 0.897648
Validation band_gap mae = 0.897648
Epoch 64
Validation mae = 0.914404
Validation band_gap mae = 0.914404
Epoch 65
Validation mae = 0.896639
Validation band_gap mae = 0.896639
Epoch 66
Validation mae = 0.894844
Validation band_gap mae = 0.894844
Epoch 67
Validation mae = 0.929678
Validation band_gap mae = 0.929678
Epoch 68
Validation mae = 0.909605
Validation band_gap mae = 0.909605
Epoch 69
Validation mae = 0.914483
Validation band_gap mae = 0.914483
Epoch 70
Validation mae = 0.905898
Validation band_gap mae = 0.905898
Epoch 71
Validation mae = 0.894448
Validation band_gap mae = 0.894448
Epoch 72
Validation mae = 0.898714
Validation band_gap mae = 0.898714
Epoch 73
Validation mae = 0.909221
Validation band_gap mae = 0.909221
Epoch 74
Validation mae = 0.895359
Validation band_gap mae = 0.895359
Epoch 75
Validation mae = 0.902018
Validation band_gap mae = 0.902018
Epoch 76
Validation mae = 0.904043
Validation band_gap mae = 0.904043
Epoch 77
Validation mae = 0.926276
Validation band_gap mae = 0.926276
Epoch 78
Validation mae = 0.918029
Validation band_gap mae = 0.918029
Epoch 79
Validation mae = 0.900272
Validation band_gap mae = 0.900272
Epoch 80
Validation mae = 0.914969
Validation band_gap mae = 0.914969
Epoch 81
Validation mae = 0.912714
Validation band_gap mae = 0.912714
Epoch 82
Validation mae = 0.915626
Validation band_gap mae = 0.915626
Epoch 83
Validation mae = 0.898194
Validation band_gap mae = 0.898194
Epoch 84
Validation mae = 0.916290
Validation band_gap mae = 0.916290
Epoch 85
Validation mae = 0.903608
Validation band_gap mae = 0.903608
Epoch 86
Validation mae = 0.896633
Validation band_gap mae = 0.896633
Epoch 87
Validation mae = 0.904035
Validation band_gap mae = 0.904035
Epoch 88
Validation mae = 0.909021
Validation band_gap mae = 0.909021
Epoch 89
Validation mae = 0.923246
Validation band_gap mae = 0.923246
Epoch 90
Validation mae = 0.910964
Validation band_gap mae = 0.910964
Epoch 91
Validation mae = 0.924102
Validation band_gap mae = 0.924102
Epoch 92
Validation mae = 0.936018
Validation band_gap mae = 0.936018
Epoch 93
Validation mae = 0.942345
Validation band_gap mae = 0.942345
Epoch 94
Validation mae = 0.908748
Validation band_gap mae = 0.908748
Epoch 95
Validation mae = 0.918758
Validation band_gap mae = 0.918758
Epoch 96
Validation mae = 0.911979
Validation band_gap mae = 0.911979
Epoch 97
Validation mae = 0.900467
Validation band_gap mae = 0.900467
Epoch 98
Validation mae = 0.893031
Validation band_gap mae = 0.893031
Epoch 99
Validation mae = 0.904114
Validation band_gap mae = 0.904114
Model 0 best validation mae = 0.974954 on epoch 42
Moving model to cuda
Model 0 test mae = 0.709984
Model 0 test band_gap mae = 0.709984
Ensemble test mae = 0.709984
Ensemble test band_gap mae = 0.709984
10-fold cross validation
Seed 0
Fold 0 ==> valid mae = 1.539843 test mae = 1.528940
Fold 0 ==> valid band_gap mae = 1.539843test band_gap mae = 1.528940
Fold 1 ==> valid mae = 1.250391 test mae = 0.910670
Fold 1 ==> valid band_gap mae = 1.250391test band_gap mae = 0.910670
Fold 2 ==> valid mae = 1.142645 test mae = 0.670937
Fold 2 ==> valid band_gap mae = 1.142645test band_gap mae = 0.670937
Fold 3 ==> valid mae = 1.061614 test mae = 0.768339
Fold 3 ==> valid band_gap mae = 1.061614test band_gap mae = 0.768339
Fold 4 ==> valid mae = 0.830580 test mae = 0.823758
Fold 4 ==> valid band_gap mae = 0.830580test band_gap mae = 0.823758
Fold 5 ==> valid mae = 0.915158 test mae = 0.527102
Fold 5 ==> valid band_gap mae = 0.915158test band_gap mae = 0.527102
Fold 6 ==> valid mae = 0.867300 test mae = 0.924350
Fold 6 ==> valid band_gap mae = 0.867300test band_gap mae = 0.924350
Fold 7 ==> valid mae = 0.891755 test mae = 0.689186
Fold 7 ==> valid band_gap mae = 0.891755test band_gap mae = 0.689186
Fold 8 ==> valid mae = 0.770912 test mae = 0.561241
Fold 8 ==> valid band_gap mae = 0.770912test band_gap mae = 0.561241
Fold 9 ==> valid mae = 0.974954 test mae = 0.709984
Fold 9 ==> valid band_gap mae = 0.974954test band_gap mae = 0.709984
Overall valid mae = 1.024515 +/- 0.221494
Overall test mae = 0.811451 +/- 0.269785
Overall test band_gap mae = 0.811451 +/- 0.269785
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.306666
Validation band_gap mae = 1.306666
Epoch 1
Validation mae = 1.645069
Validation band_gap mae = 1.645069
Epoch 2
Validation mae = 1.340060
Validation band_gap mae = 1.340060
Epoch 3
Validation mae = 1.180824
Validation band_gap mae = 1.180824
Epoch 4
Validation mae = 1.244326
Validation band_gap mae = 1.244326
Epoch 5
Validation mae = 1.189842
Validation band_gap mae = 1.189842
Epoch 6
Validation mae = 1.139758
Validation band_gap mae = 1.139758
Epoch 7
Validation mae = 1.233901
Validation band_gap mae = 1.233901
Epoch 8
Validation mae = 1.150958
Validation band_gap mae = 1.150958
Epoch 9
Validation mae = 1.105286
Validation band_gap mae = 1.105286
Epoch 10
Validation mae = 1.201130
Validation band_gap mae = 1.201130
Epoch 11
Validation mae = 1.088211
Validation band_gap mae = 1.088211
Epoch 12
Validation mae = 1.118776
Validation band_gap mae = 1.118776
Epoch 13
Validation mae = 1.184187
Validation band_gap mae = 1.184187
Epoch 14
Validation mae = 1.177319
Validation band_gap mae = 1.177319
Epoch 15
Validation mae = 1.046214
Validation band_gap mae = 1.046214
Epoch 16
Validation mae = 1.148303
Validation band_gap mae = 1.148303
Epoch 17
Validation mae = 1.026383
Validation band_gap mae = 1.026383
Epoch 18
Validation mae = 1.198361
Validation band_gap mae = 1.198361
Epoch 19
Validation mae = 1.024981
Validation band_gap mae = 1.024981
Epoch 20
Validation mae = 1.040637
Validation band_gap mae = 1.040637
Epoch 21
Validation mae = 1.050318
Validation band_gap mae = 1.050318
Epoch 22
Validation mae = 1.087810
Validation band_gap mae = 1.087810
Epoch 23
Validation mae = 1.111769
Validation band_gap mae = 1.111769
Epoch 24
Validation mae = 1.108270
Validation band_gap mae = 1.108270
Epoch 25
Validation mae = 1.067146
Validation band_gap mae = 1.067146
Epoch 26
Validation mae = 1.076858
Validation band_gap mae = 1.076858
Epoch 27
Validation mae = 1.146966
Validation band_gap mae = 1.146966
Epoch 28
Validation mae = 1.017581
Validation band_gap mae = 1.017581
Epoch 29
Validation mae = 1.098520
Validation band_gap mae = 1.098520
Epoch 30
Validation mae = 1.145316
Validation band_gap mae = 1.145316
Epoch 31
Validation mae = 1.147304
Validation band_gap mae = 1.147304
Epoch 32
Validation mae = 1.222634
Validation band_gap mae = 1.222634
Epoch 33
Validation mae = 1.398628
Validation band_gap mae = 1.398628
Epoch 34
Validation mae = 1.068330
Validation band_gap mae = 1.068330
Epoch 35
Validation mae = 1.172254
Validation band_gap mae = 1.172254
Epoch 36
Validation mae = 0.985096
Validation band_gap mae = 0.985096
Epoch 37
Validation mae = 1.116267
Validation band_gap mae = 1.116267
Epoch 38
Validation mae = 1.193378
Validation band_gap mae = 1.193378
Epoch 39
Validation mae = 1.082319
Validation band_gap mae = 1.082319
Epoch 40
Validation mae = 1.102894
Validation band_gap mae = 1.102894
Epoch 41
Validation mae = 1.040374
Validation band_gap mae = 1.040374
Epoch 42
Validation mae = 1.049273
Validation band_gap mae = 1.049273
Epoch 43
Validation mae = 1.030207
Validation band_gap mae = 1.030207
Epoch 44
Validation mae = 1.259161
Validation band_gap mae = 1.259161
Epoch 45
Validation mae = 1.016062
Validation band_gap mae = 1.016062
Epoch 46
Validation mae = 1.059559
Validation band_gap mae = 1.059559
Epoch 47
Validation mae = 1.104349
Validation band_gap mae = 1.104349
Epoch 48
Validation mae = 1.011875
Validation band_gap mae = 1.011875
Epoch 49
Validation mae = 1.110802
Validation band_gap mae = 1.110802
Epoch 50
Validation mae = 1.132261
Validation band_gap mae = 1.132261
Epoch 51
Validation mae = 1.006605
Validation band_gap mae = 1.006605
Epoch 52
Validation mae = 1.034696
Validation band_gap mae = 1.034696
Epoch 53
Validation mae = 1.061056
Validation band_gap mae = 1.061056
Epoch 54
Validation mae = 1.098953
Validation band_gap mae = 1.098953
Epoch 55
Validation mae = 1.001712
Validation band_gap mae = 1.001712
Epoch 56
Validation mae = 1.064937
Validation band_gap mae = 1.064937
Epoch 57
Validation mae = 0.998457
Validation band_gap mae = 0.998457
Epoch 58
Validation mae = 1.039721
Validation band_gap mae = 1.039721
Epoch 59
Validation mae = 1.039623
Validation band_gap mae = 1.039623
Epoch 60
Validation mae = 1.050974
Validation band_gap mae = 1.050974
Epoch 61
Validation mae = 0.996521
Validation band_gap mae = 0.996521
Epoch 62
Validation mae = 1.042317
Validation band_gap mae = 1.042317
Epoch 63
Validation mae = 1.013542
Validation band_gap mae = 1.013542
Epoch 64
Validation mae = 0.994796
Validation band_gap mae = 0.994796
Epoch 65
Validation mae = 1.005904
Validation band_gap mae = 1.005904
Epoch 66
Validation mae = 1.019766
Validation band_gap mae = 1.019766
Epoch 67
Validation mae = 0.990412
Validation band_gap mae = 0.990412
Epoch 68
Validation mae = 1.010618
Validation band_gap mae = 1.010618
Epoch 69
Validation mae = 1.014800
Validation band_gap mae = 1.014800
Epoch 70
Validation mae = 1.023731
Validation band_gap mae = 1.023731
Epoch 71
Validation mae = 1.033579
Validation band_gap mae = 1.033579
Epoch 72
Validation mae = 0.977565
Validation band_gap mae = 0.977565
Epoch 73
Validation mae = 1.023731
Validation band_gap mae = 1.023731
Epoch 74
Validation mae = 1.016943
Validation band_gap mae = 1.016943
Epoch 75
Validation mae = 1.015446
Validation band_gap mae = 1.015446
Epoch 76
Validation mae = 1.014541
Validation band_gap mae = 1.014541
Epoch 77
Validation mae = 1.040890
Validation band_gap mae = 1.040890
Epoch 78
Validation mae = 0.997800
Validation band_gap mae = 0.997800
Epoch 79
Validation mae = 1.011134
Validation band_gap mae = 1.011134
Epoch 80
Validation mae = 1.003663
Validation band_gap mae = 1.003663
Epoch 81
Validation mae = 0.996814
Validation band_gap mae = 0.996814
Epoch 82
Validation mae = 1.003744
Validation band_gap mae = 1.003744
Epoch 83
Validation mae = 0.962729
Validation band_gap mae = 0.962729
Epoch 84
Validation mae = 1.000070
Validation band_gap mae = 1.000070
Epoch 85
Validation mae = 0.944691
Validation band_gap mae = 0.944691
Epoch 86
Validation mae = 1.031146
Validation band_gap mae = 1.031146
Epoch 87
Validation mae = 1.009427
Validation band_gap mae = 1.009427
Epoch 88
Validation mae = 0.994093
Validation band_gap mae = 0.994093
Epoch 89
Validation mae = 0.998680
Validation band_gap mae = 0.998680
Epoch 90
Validation mae = 1.009029
Validation band_gap mae = 1.009029
Epoch 91
Validation mae = 1.011434
Validation band_gap mae = 1.011434
Epoch 92
Validation mae = 1.009850
Validation band_gap mae = 1.009850
Epoch 93
Validation mae = 0.994693
Validation band_gap mae = 0.994693
Epoch 94
Validation mae = 0.983048
Validation band_gap mae = 0.983048
Epoch 95
Validation mae = 1.009832
Validation band_gap mae = 1.009832
Epoch 96
Validation mae = 0.981850
Validation band_gap mae = 0.981850
Epoch 97
Validation mae = 1.028712
Validation band_gap mae = 1.028712
Epoch 98
Validation mae = 0.977762
Validation band_gap mae = 0.977762
Epoch 99
Validation mae = 0.983269
Validation band_gap mae = 0.983269
Model 0 best validation mae = 1.645069 on epoch 1
Moving model to cuda
Model 0 test mae = 1.622954
Model 0 test band_gap mae = 1.622954
Ensemble test mae = 1.622954
Ensemble test band_gap mae = 1.622954
==================== fold 1 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.246429
Validation band_gap mae = 1.246429
Epoch 1
Validation mae = 1.197121
Validation band_gap mae = 1.197121
Epoch 2
Validation mae = 1.183991
Validation band_gap mae = 1.183991
Epoch 3
Validation mae = 1.170924
Validation band_gap mae = 1.170924
Epoch 4
Validation mae = 1.178022
Validation band_gap mae = 1.178022
Epoch 5
Validation mae = 1.156941
Validation band_gap mae = 1.156941
Epoch 6
Validation mae = 1.181185
Validation band_gap mae = 1.181185
Epoch 7
Validation mae = 1.146263
Validation band_gap mae = 1.146263
Epoch 8
Validation mae = 1.149404
Validation band_gap mae = 1.149404
Epoch 9
Validation mae = 1.100638
Validation band_gap mae = 1.100638
Epoch 10
Validation mae = 1.122904
Validation band_gap mae = 1.122904
Epoch 11
Validation mae = 1.064206
Validation band_gap mae = 1.064206
Epoch 12
Validation mae = 1.062232
Validation band_gap mae = 1.062232
Epoch 13
Validation mae = 1.080738
Validation band_gap mae = 1.080738
Epoch 14
Validation mae = 1.086588
Validation band_gap mae = 1.086588
Epoch 15
Validation mae = 1.052880
Validation band_gap mae = 1.052880
Epoch 16
Validation mae = 1.060063
Validation band_gap mae = 1.060063
Epoch 17
Validation mae = 1.179052
Validation band_gap mae = 1.179052
Epoch 18
Validation mae = 1.044159
Validation band_gap mae = 1.044159
Epoch 19
Validation mae = 1.062615
Validation band_gap mae = 1.062615
Epoch 20
Validation mae = 1.105402
Validation band_gap mae = 1.105402
Epoch 21
Validation mae = 1.075175
Validation band_gap mae = 1.075175
Epoch 22
Validation mae = 1.057031
Validation band_gap mae = 1.057031
Epoch 23
Validation mae = 1.074830
Validation band_gap mae = 1.074830
Epoch 24
Validation mae = 1.044199
Validation band_gap mae = 1.044199
Epoch 25
Validation mae = 1.070381
Validation band_gap mae = 1.070381
Epoch 26
Validation mae = 1.083236
Validation band_gap mae = 1.083236
Epoch 27
Validation mae = 1.094064
Validation band_gap mae = 1.094064
Epoch 28
Validation mae = 1.121973
Validation band_gap mae = 1.121973
Epoch 29
Validation mae = 1.091446
Validation band_gap mae = 1.091446
Epoch 30
Validation mae = 1.113380
Validation band_gap mae = 1.113380
Epoch 31
Validation mae = 1.096762
Validation band_gap mae = 1.096762
Epoch 32
Validation mae = 1.101966
Validation band_gap mae = 1.101966
Epoch 33
Validation mae = 1.127321
Validation band_gap mae = 1.127321
Epoch 34
Validation mae = 1.096551
Validation band_gap mae = 1.096551
Epoch 35
Validation mae = 1.092859
Validation band_gap mae = 1.092859
Epoch 36
Validation mae = 1.185210
Validation band_gap mae = 1.185210
Epoch 37
Validation mae = 1.090668
Validation band_gap mae = 1.090668
Epoch 38
Validation mae = 1.124445
Validation band_gap mae = 1.124445
Epoch 39
Validation mae = 1.199320
Validation band_gap mae = 1.199320
Epoch 40
Validation mae = 1.117096
Validation band_gap mae = 1.117096
Epoch 41
Validation mae = 1.113899
Validation band_gap mae = 1.113899
Epoch 42
Validation mae = 1.158664
Validation band_gap mae = 1.158664
Epoch 43
Validation mae = 1.125998
Validation band_gap mae = 1.125998
Epoch 44
Validation mae = 1.156876
Validation band_gap mae = 1.156876
Epoch 45
Validation mae = 1.162859
Validation band_gap mae = 1.162859
Epoch 46
Validation mae = 1.097079
Validation band_gap mae = 1.097079
Epoch 47
Validation mae = 1.139675
Validation band_gap mae = 1.139675
Epoch 48
Validation mae = 1.158676
Validation band_gap mae = 1.158676
Epoch 49
Validation mae = 1.122784
Validation band_gap mae = 1.122784
Epoch 50
Validation mae = 1.147070
Validation band_gap mae = 1.147070
Epoch 51
Validation mae = 1.108566
Validation band_gap mae = 1.108566
Epoch 52
Validation mae = 1.104438
Validation band_gap mae = 1.104438
Epoch 53
Validation mae = 1.159381
Validation band_gap mae = 1.159381
Epoch 54
Validation mae = 1.195898
Validation band_gap mae = 1.195898
Epoch 55
Validation mae = 1.143307
Validation band_gap mae = 1.143307
Epoch 56
Validation mae = 1.143081
Validation band_gap mae = 1.143081
Epoch 57
Validation mae = 1.152138
Validation band_gap mae = 1.152138
Epoch 58
Validation mae = 1.158776
Validation band_gap mae = 1.158776
Epoch 59
Validation mae = 1.153370
Validation band_gap mae = 1.153370
Epoch 60
Validation mae = 1.129075
Validation band_gap mae = 1.129075
Epoch 61
Validation mae = 1.163838
Validation band_gap mae = 1.163838
Epoch 62
Validation mae = 1.166371
Validation band_gap mae = 1.166371
Epoch 63
Validation mae = 1.183319
Validation band_gap mae = 1.183319
Epoch 64
Validation mae = 1.145554
Validation band_gap mae = 1.145554
Epoch 65
Validation mae = 1.151349
Validation band_gap mae = 1.151349
Epoch 66
Validation mae = 1.178439
Validation band_gap mae = 1.178439
Epoch 67
Validation mae = 1.156867
Validation band_gap mae = 1.156867
Epoch 68
Validation mae = 1.199478
Validation band_gap mae = 1.199478
Epoch 69
Validation mae = 1.172091
Validation band_gap mae = 1.172091
Epoch 70
Validation mae = 1.224443
Validation band_gap mae = 1.224443
Epoch 71
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 9.601429
Validation band_gap mae = 9.601429
Epoch 1
Validation mae = 10.039740
Validation band_gap mae = 10.039740
Epoch 2
Validation mae = 6.146777
Validation band_gap mae = 6.146777
Epoch 3
Validation mae = 5.575180
Validation band_gap mae = 5.575180
Epoch 4
Validation mae = 5.639754
Validation band_gap mae = 5.639754
Epoch 5
Validation mae = 4.660069
Validation band_gap mae = 4.660069
Epoch 6
Validation mae = 6.157145
Validation band_gap mae = 6.157145
Epoch 7
Validation mae = 4.903044
Validation band_gap mae = 4.903044
Epoch 8
Validation mae = 4.847201
Validation band_gap mae = 4.847201
Epoch 9
Validation mae = 5.295782
Validation band_gap mae = 5.295782
Epoch 10
Validation mae = 5.358854
Validation band_gap mae = 5.358854
Epoch 11
Validation mae = 4.692022
Validation band_gap mae = 4.692022
Epoch 12
Validation mae = 5.002435
Validation band_gap mae = 5.002435
Epoch 13
Validation mae = 4.694817
Validation band_gap mae = 4.694817
Epoch 14
Validation mae = 4.563437
Validation band_gap mae = 4.563437
Epoch 15
Validation mae = 4.681257
Validation band_gap mae = 4.681257
Epoch 16
Validation mae = 5.316162
Validation band_gap mae = 5.316162
Epoch 17
Validation mae = 5.022121
Validation band_gap mae = 5.022121
Epoch 18
Validation mae = 4.770739
Validation band_gap mae = 4.770739
Epoch 19
Validation mae = 4.691179
Validation band_gap mae = 4.691179
Epoch 20
Validation mae = 5.610242
Validation band_gap mae = 5.610242
Epoch 21
Validation mae = 4.799060
Validation band_gap mae = 4.799060
Epoch 22
Validation mae = 4.692219
Validation band_gap mae = 4.692219
Epoch 23
Validation mae = 4.826451
Validation band_gap mae = 4.826451
Epoch 24
Validation mae = 4.950788
Validation band_gap mae = 4.950788
Epoch 25
Validation mae = 4.602410
Validation band_gap mae = 4.602410
Epoch 26
Validation mae = 5.401931
Validation band_gap mae = 5.401931
Epoch 27
Validation mae = 5.224517
Validation band_gap mae = 5.224517
Epoch 28
Validation mae = 4.992812
Validation band_gap mae = 4.992812
Epoch 29
Validation mae = 4.727611
Validation band_gap mae = 4.727611
Epoch 30
Validation mae = 4.559805
Validation band_gap mae = 4.559805
Epoch 31
Validation mae = 4.649945
Validation band_gap mae = 4.649945
Epoch 32
Validation mae = 4.533752
Validation band_gap mae = 4.533752
Epoch 33
Validation mae = 5.168438
Validation band_gap mae = 5.168438
Epoch 34
Validation mae = 5.004970
Validation band_gap mae = 5.004970
Epoch 35
Validation mae = 4.499517
Validation band_gap mae = 4.499517
Epoch 36
Validation mae = 4.508412
Validation band_gap mae = 4.508412
Epoch 37
Validation mae = 4.566177
Validation band_gap mae = 4.566177
Epoch 38
Validation mae = 4.761031
Validation band_gap mae = 4.761031
Epoch 39
Validation mae = 4.662677
Validation band_gap mae = 4.662677
Epoch 40
Validation mae = 4.690211
Validation band_gap mae = 4.690211
Epoch 41
Validation mae = 4.605939
Validation band_gap mae = 4.605939
Epoch 42
Validation mae = 4.539121
Validation band_gap mae = 4.539121
Epoch 43
Validation mae = 4.456378
Validation band_gap mae = 4.456378
Epoch 44
Validation mae = 4.406498
Validation band_gap mae = 4.406498
Epoch 45
Validation mae = 4.550192
Validation band_gap mae = 4.550192
Epoch 46
Validation mae = 4.435296
Validation band_gap mae = 4.435296
Epoch 47
Validation mae = 4.618403
Validation band_gap mae = 4.618403
Epoch 48
Validation mae = 4.576317
Validation band_gap mae = 4.576317
Epoch 49
Validation mae = 4.503923
Validation band_gap mae = 4.503923
Epoch 50
Validation mae = 4.610082
Validation band_gap mae = 4.610082
Epoch 51
Validation mae = 4.413879
Validation band_gap mae = 4.413879
Epoch 52
Validation mae = 4.295207
Validation band_gap mae = 4.295207
Epoch 53
Validation mae = 4.423918
Validation band_gap mae = 4.423918
Epoch 54
Validation mae = 4.486536
Validation band_gap mae = 4.486536
Epoch 55
Validation mae = 4.520625
Validation band_gap mae = 4.520625
Epoch 56
Validation mae = 4.192014
Validation band_gap mae = 4.192014
Epoch 57
Validation mae = 4.498194
Validation band_gap mae = 4.498194
Epoch 58
Validation mae = 4.458271
Validation band_gap mae = 4.458271
Epoch 59
Validation mae = 4.563471
Validation band_gap mae = 4.563471
Epoch 60
Validation mae = 4.558383
Validation band_gap mae = 4.558383
Epoch 61
Validation mae = 4.421927
Validation band_gap mae = 4.421927
Epoch 62
Validation mae = 4.363669
Validation band_gap mae = 4.363669
Epoch 63
Validation mae = 4.311110
Validation band_gap mae = 4.311110
Epoch 64
Validation mae = 4.386117
Validation band_gap mae = 4.386117
Epoch 65
Validation mae = 4.307080
Validation band_gap mae = 4.307080
Epoch 66
Validation mae = 4.460677
Validation band_gap mae = 4.460677
Epoch 67
Validation mae = 4.331306
Validation band_gap mae = 4.331306
Epoch 68
Validation mae = 4.358749
Validation band_gap mae = 4.358749
Epoch 69
Validation mae = 4.295220
Validation band_gap mae = 4.295220
Epoch 70
Validation mae = 4.428585
Validation band_gap mae = 4.428585
Epoch 71
Validation mae = 4.351553
Validation band_gap mae = 4.351553
Epoch 72
Validation mae = 4.338830
Validation band_gap mae = 4.338830
Epoch 73
Validation mae = 4.325908
Validation band_gap mae = 4.325908
Epoch 74
Validation mae = 4.376427
Validation band_gap mae = 4.376427
Epoch 75
Validation mae = 4.325607
Validation band_gap mae = 4.325607
Epoch 76
Validation mae = 4.304467
Validation band_gap mae = 4.304467
Epoch 77
Validation mae = 4.283559
Validation band_gap mae = 4.283559
Epoch 78
Validation mae = 4.375958
Validation band_gap mae = 4.375958
Epoch 79
Validation mae = 4.375027
Validation band_gap mae = 4.375027
Epoch 80
Validation mae = 4.285484
Validation band_gap mae = 4.285484
Epoch 81
Validation mae = 4.280646
Validation band_gap mae = 4.280646
Epoch 82
Validation mae = 4.220920
Validation band_gap mae = 4.220920
Epoch 83
Validation mae = 4.272138
Validation band_gap mae = 4.272138
Epoch 84
Validation mae = 4.404784
Validation band_gap mae = 4.404784
Epoch 85
Validation mae = 4.257180
Validation band_gap mae = 4.257180
Epoch 86
Validation mae = 4.320188
Validation band_gap mae = 4.320188
Epoch 87
Validation mae = 4.386159
Validation band_gap mae = 4.386159
Epoch 88
Validation mae = 4.290943
Validation band_gap mae = 4.290943
Epoch 89
Validation mae = 4.364695
Validation band_gap mae = 4.364695
Epoch 90
Validation mae = 4.290138
Validation band_gap mae = 4.290138
Epoch 91
Validation mae = 4.304465
Validation band_gap mae = 4.304465
Epoch 92
Validation mae = 4.267405
Validation band_gap mae = 4.267405
Epoch 93
Validation mae = 4.282430
Validation band_gap mae = 4.282430
Epoch 94
Validation mae = 4.272020
Validation band_gap mae = 4.272020
Epoch 95
Validation mae = 4.347283
Validation band_gap mae = 4.347283
Epoch 96
Validation mae = 4.381148
Validation band_gap mae = 4.381148
Epoch 97
Validation mae = 4.360497
Validation band_gap mae = 4.360497
Epoch 98
Validation mae = 4.268897
Validation band_gap mae = 4.268897
Epoch 99
Validation mae = 4.399722
Validation band_gap mae = 4.399722
Model 0 best validation mae = 10.039740 on epoch 1
Moving model to cuda
Model 0 test mae = 7.213766
Model 0 test band_gap mae = 7.213766
Ensemble test mae = 7.213766
Ensemble test band_gap mae = 7.213766
==================== fold 1 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 6.684522
Validation band_gap mae = 6.684522
Epoch 1
Validation mae = 6.199095
Validation band_gap mae = 6.199095
Epoch 2
Validation mae = 5.883141
Validation band_gap mae = 5.883141
Epoch 3
Validation mae = 6.662271
Validation band_gap mae = 6.662271
Epoch 4
Validation mae = 5.944288
Validation band_gap mae = 5.944288
Epoch 5
Validation mae = 6.555777
Validation band_gap mae = 6.555777
Epoch 6
Validation mae = 6.058987
Validation band_gap mae = 6.058987
Epoch 7
Validation mae = 5.746429
Validation band_gap mae = 5.746429
Epoch 8
Validation mae = 5.859359
Validation band_gap mae = 5.859359
Epoch 9
Validation mae = 6.095555
Validation band_gap mae = 6.095555
Epoch 10
Validation mae = 6.129357
Validation band_gap mae = 6.129357
Epoch 11
Validation mae = 5.539870
Validation band_gap mae = 5.539870
Epoch 12
Validation mae = 5.733570
Validation band_gap mae = 5.733570
Epoch 13
Validation mae = 5.762058
Validation band_gap mae = 5.762058
Epoch 14
Validation mae = 5.699884
Validation band_gap mae = 5.699884
Epoch 15
Validation mae = 6.008200
Validation band_gap mae = 6.008200
Epoch 16
Validation mae = 6.502858
Validation band_gap mae = 6.502858
Epoch 17
Validation mae = 5.811229
Validation band_gap mae = 5.811229
Epoch 18
Validation mae = 5.948212
Validation band_gap mae = 5.948212
Epoch 19
Validation mae = 5.722630
Validation band_gap mae = 5.722630
Epoch 20
Validation mae = 6.143572
Validation band_gap mae = 6.143572
Epoch 21
Validation mae = 6.060337
Validation band_gap mae = 6.060337
Epoch 22
Validation mae = 5.585748
Validation band_gap mae = 5.585748
Epoch 23
Validation mae = 5.702556
Validation band_gap mae = 5.702556
Epoch 24
Validation mae = 5.822602
Validation band_gap mae = 5.822602
Epoch 25
Validation mae = 5.522183
Validation band_gap mae = 5.522183
Epoch 26
Validation mae = 6.065723
Validation band_gap mae = 6.065723
Epoch 27
Validation mae = 6.160087
Validation band_gap mae = 6.160087
Epoch 28
Validation mae = 6.080387
Validation band_gap mae = 6.080387
Epoch 29
Validation mae = 6.052757
Validation band_gap mae = 6.052757
Epoch 30
Validation mae = 6.106056
Validation band_gap mae = 6.106056
Epoch 31
Validation mae = 6.270919
Validation band_gap mae = 6.270919
Epoch 32
Validation mae = 5.943003
Validation band_gap mae = 5.943003
Epoch 33
Validation mae = 5.673885
Validation band_gap mae = 5.673885
Epoch 34
Validation mae = 5.861623
Validation band_gap mae = 5.861623
Epoch 35
Validation mae = 5.993137
Validation band_gap mae = 5.993137
Epoch 36
Validation mae = 6.080028
Validation band_gap mae = 6.080028
Epoch 37
Validation mae = 6.008996
Validation band_gap mae = 6.008996
Epoch 38
Validation mae = 6.841020
Validation band_gap mae = 6.841020
Epoch 39
Validation mae = 5.962461
Validation band_gap mae = 5.962461
Epoch 40
Validation mae = 5.834624
Validation band_gap mae = 5.834624
Epoch 41
Validation mae = 5.870846
Validation band_gap mae = 5.870846
Epoch 42
Validation mae = 5.600732
Validation band_gap mae = 5.600732
Epoch 43
Validation mae = 5.744675
Validation band_gap mae = 5.744675
Epoch 44
Validation mae = 5.953202
Validation band_gap mae = 5.953202
Epoch 45
Validation mae = 5.707502
Validation band_gap mae = 5.707502
Epoch 46
Validation mae = 6.136857
Validation band_gap mae = 6.136857
Epoch 47
Validation mae = 5.963973
Validation band_gap mae = 5.963973
Epoch 48
Validation mae = 6.072727
Validation band_gap mae = 6.072727
Epoch 49
Validation mae = 6.387747
Validation band_gap mae = 6.387747
Epoch 50
Validation mae = 5.973826
Validation band_gap mae = 5.973826
Epoch 51
Validation mae = 6.340636
Validation band_gap mae = 6.340636
Epoch 52
Validation mae = 6.506629
Validation band_gap mae = 6.506629
Epoch 53
Validation mae = 6.501580
Validation band_gap mae = 6.501580
Epoch 54
Validation mae = 5.805684
Validation band_gap mae = 5.805684
Epoch 55
Validation mae = 6.464437
Validation band_gap mae = 6.464437
Epoch 56
Validation mae = 6.606224
Validation band_gap mae = 6.606224
Epoch 57
Validation mae = 6.340110
Validation band_gap mae = 6.340110
Epoch 58
Validation mae = 6.752825
Validation band_gap mae = 6.752825
Epoch 59
Validation mae = 6.824272
Validation band_gap mae = 6.824272
Epoch 60
Validation mae = 6.606143
Validation band_gap mae = 6.606143
Epoch 61
Validation mae = 6.621176
Validation band_gap mae = 6.621176
Epoch 62
Validation mae = 6.856541
Validation band_gap mae = 6.856541
Epoch 63
Validation mae = 6.502759
Validation band_gap mae = 6.502759
Epoch 64
Validation mae = 6.787262
Validation band_gap mae = 6.787262
Epoch 65
Validation mae = 6.546258
Validation band_gap mae = 6.546258
Epoch 66
Validation mae = 6.829477
Validation band_gap mae = 6.829477
Epoch 67
Validation mae = 6.607439
Validation band_gap mae = 6.607439
Epoch 68
Validation mae = 6.804251
Validation band_gap mae = 6.804251
Epoch 69
Validation mae = 6.637053
Validation band_gap mae = 6.637053
Epoch 70
Validation mae = 6.559059
Validation band_gap mae = 6.559059
Epoch 71
Validation mae = 6.614120
Validation band_gap mae = 6.614120
Epoch 72
Validation mae = 6.636393
Validation band_gap mae = 6.636393
Epoch 73
Validation mae = 6.722839
Validation band_gap mae = 6.722839
Epoch 74
Validation mae = 6.588225
Validation band_gap mae = 6.588225
Epoch 75
Validation mae = 6.688722
Validation band_gap mae = 6.688722
Epoch 76
Validation mae = 6.635328
Validation band_gap mae = 6.635328
Epoch 77
Validation mae = 6.687398
Validation band_gap mae = 6.687398
Epoch 78
Validation mae = 6.633881
Validation band_gap mae = 6.633881
Epoch 79
Validation mae = 6.756610
Validation band_gap mae = 6.756610
Epoch 80
Validation mae = 6.654856
Validation band_gap mae = 6.654856
Epoch 81
Validation mae = 6.715747
Validation band_gap mae = 6.715747
Epoch 82
Validation mae = 6.719703
Validation band_gap mae = 6.719703
Epoch 83
Validation mae = 6.644920
Validation band_gap mae = 6.644920
Epoch 84
Validation mae = 6.702292
Validation band_gap mae = 6.702292
Epoch 85
Validation mae = 6.709855
Validation band_gap mae = 6.709855
Epoch 86
Validation mae = 6.734259
Validation band_gap mae = 6.734259
Epoch 87
Validation mae = 6.698904
Validation band_gap mae = 6.698904
Epoch 88
Validation mae = 6.770674
Validation band_gap mae = 6.770674
Epoch 89
Validation mae = 6.675132
Validation band_gap mae = 6.675132
Epoch 90
Validation mae = 6.679311
Validation band_gap mae = 6.679311
Epoch 91
Validation mae = 6.751039
Validation band_gap mae = 6.751039
Epoch 92
Validation mae = 6.682907
Validation band_gap mae = 6.682907
Epoch 93
Validation mae = 6.846397
Validation band_gap mae = 6.846397
Epoch 94
Validation mae = 6.611702
Validation band_gap mae = 6.611702
Epoch 95
Validation mae = 6.762929
Validation band_gap mae = 6.762929
Epoch 96
Validation mae = 6.638180
Validation band_gap mae = 6.638180
Epoch 97
Validation mae = 6.727393
Validation band_gap mae = 6.727393
Epoch 98
Validation mae = 6.649310
Validation band_gap mae = 6.649310
Epoch 99
Validation mae = 6.660489
Validation band_gap mae = 6.660489
Model 0 best validation mae = 6.856541 on epoch 62
Moving model to cuda
Model 0 test mae = 1.898207
Model 0 test band_gap mae = 1.898207
Ensemble test mae = 1.898207
Ensemble test band_gap mae = 1.898207
==================== fold 2 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 3.377961
Validation band_gap mae = 3.377961
Epoch 1
Validation mae = 3.233672
Validation band_gap mae = 3.233672
Epoch 2
Validation mae = 4.005601
Validation band_gap mae = 4.005601
Epoch 3
Validation mae = 3.199391
Validation band_gap mae = 3.199391
Epoch 4
Validation mae = 3.150797
Validation band_gap mae = 3.150797
Epoch 5
Validation mae = 3.215714
Validation band_gap mae = 3.215714
Epoch 6
Validation mae = 2.990244
Validation band_gap mae = 2.990244
Epoch 7
Validation mae = 2.853344
Validation band_gap mae = 2.853344
Epoch 8
Validation mae = 3.048009
Validation band_gap mae = 3.048009
Epoch 9
Validation mae = 3.029072
Validation band_gap mae = 3.029072
Epoch 10
Validation mae = 3.302441
Validation band_gap mae = 3.302441
Epoch 11
Validation mae = 3.174612
Validation band_gap mae = 3.174612
Epoch 12
Validation mae = 2.934208
Validation band_gap mae = 2.934208
Epoch 13
Validation mae = 3.339098
Validation band_gap mae = 3.339098
Epoch 14
Validation mae = 2.736578
Validation band_gap mae = 2.736578
Epoch 15
Validation mae = 2.798261
Validation band_gap mae = 2.798261
Epoch 16
Validation mae = 3.564776
Validation band_gap mae = 3.564776
Epoch 17
Validation mae = 2.971651
Validation band_gap mae = 2.971651
Epoch 18
Validation mae = 3.244178
Validation band_gap mae = 3.244178
Epoch 19
Validation mae = 3.434900
Validation band_gap mae = 3.434900
Epoch 20
Validation mae = 2.819321
Validation band_gap mae = 2.819321
Epoch 21
Validation mae = 2.707959
Validation band_gap mae = 2.707959
Epoch 22
Validation mae = 2.878672
Validation band_gap mae = 2.878672
Epoch 23
Validation mae = 2.993603
Validation band_gap mae = 2.993603
Epoch 24
Validation mae = 3.551180
Validation band_gap mae = 3.551180
Epoch 25
Validation mae = 2.821891
Validation band_gap mae = 2.821891
Epoch 26
Validation mae = 3.629019
Validation band_gap mae = 3.629019
Epoch 27
Validation mae = 3.265321
Validation band_gap mae = 3.265321
Epoch 28
Validation mae = 3.299861
Validation band_gap mae = 3.299861
Epoch 29
Validation mae = 2.862635
Validation band_gap mae = 2.862635
Epoch 30
Validation mae = 2.792380
Validation band_gap mae = 2.792380
Epoch 31
Validation mae = 2.599633
Validation band_gap mae = 2.599633
Epoch 32
Validation mae = 3.065449
Validation band_gap mae = 3.065449
Epoch 33
Validation mae = 2.950948
Validation band_gap mae = 2.950948
Epoch 34
Validation mae = 3.885165
Validation band_gap mae = 3.885165
Epoch 35
Validation mae = 2.660900
Validation band_gap mae = 2.660900
Epoch 36
Validation mae = 3.492303
Validation band_gap mae = 3.492303
Epoch 37
Validation mae = 3.097078
Validation band_gap mae = 3.097078
Epoch 38
Validation mae = 2.962624
Validation band_gap mae = 2.962624
Epoch 39
Validation mae = 2.889907
Validation band_gap mae = 2.889907
Epoch 40
Validation mae = 3.901934
Validation band_gap mae = 3.901934
Epoch 41
Validation mae = 2.720490
Validation band_gap mae = 2.720490
Epoch 42
Validation mae = 2.637982
Validation band_gap mae = 2.637982
Epoch 43
Validation mae = 2.910583
Validation band_gap mae = 2.910583
Epoch 44
Validation mae = 3.473465
Validation band_gap mae = 3.473465
Epoch 45
Validation mae = 3.195873
Validation band_gap mae = 3.195873
Epoch 46
Validation mae = 3.256590
Validation band_gap mae = 3.256590
Epoch 47
Validation mae = 3.409188
Validation band_gap mae = 3.409188
Epoch 48
Validation mae = 3.035101
Validation band_gap mae = 3.035101
Epoch 49
Validation mae = 2.793419
Validation band_gap mae = 2.793419
Epoch 50
Validation mae = 2.802523
Validation band_gap mae = 2.802523
Epoch 51
Validation mae = 2.917917
Validation band_gap mae = 2.917917
Epoch 52
Validation mae = 2.892083
Validation band_gap mae = 2.892083
Epoch 53
Validation mae = 2.835997
Validation band_gap mae = 2.835997
Epoch 54
Validation mae = 3.538775
Validation band_gap mae = 3.538775
Epoch 55
Validation mae = 2.796793
Validation band_gap mae = 2.796793
Epoch 56
Validation mae = 3.216529
Validation band_gap mae = 3.216529
Epoch 57
Validation mae = 2.889227
Validation band_gap mae = 2.889227
Epoch 58
Validation mae = 4.805439
Validation band_gap mae = 4.805439
Epoch 59
Validation mae = 3.177690
Validation band_gap mae = 3.177690
Epoch 60
Validation mae = 2.848662
Validation band_gap mae = 2.848662
Epoch 61
Validation mae = 2.994915
Validation band_gap mae = 2.994915
Epoch 62
Validation mae = 3.031442
Validation band_gap mae = 3.031442
Epoch 63
Validation mae = 3.331106
Validation band_gap mae = 3.331106
Epoch 64
Validation mae = 2.745059
Validation band_gap mae = 2.745059
Epoch 65
Validation mae = 2.737602
Validation band_gap mae = 2.737602
Epoch 66
Validation mae = 2.805327
Validation band_gap mae = 2.805327
Epoch 67
Validation mae = 3.202622
Validation band_gap mae = 3.202622
Epoch 68
Validation mae = 2.475814
Validation band_gap mae = 2.475814
Epoch 69
Validation mae = 3.630686
Validation band_gap mae = 3.630686
Epoch 70
Validation mae = 2.691470
Validation band_gap mae = 2.691470
Epoch 71
Validation mae = 2.884640
Validation band_gap mae = 2.884640
Epoch 72
Validation mae = 2.828506
Validation band_gap mae = 2.828506
Epoch 73
Validation mae = 3.283639
Validation band_gap mae = 3.283639
Epoch 74
Validation mae = 3.409331
Validation band_gap mae = 3.409331
Epoch 75
Validation mae = 3.072534
Validation band_gap mae = 3.072534
Epoch 76
Validation mae = 3.544917
Validation band_gap mae = 3.544917
Epoch 77
Validation mae = 2.904666
Validation band_gap mae = 2.904666
Epoch 78
Validation mae = 2.819895
Validation band_gap mae = 2.819895
Epoch 79
Validation mae = 3.498146
Validation band_gap mae = 3.498146
Epoch 80
Validation mae = 2.763999
Validation band_gap mae = 2.763999
Epoch 81
Validation mae = 3.230870
Validation band_gap mae = 3.230870
Epoch 82
Validation mae = 3.044844
Validation band_gap mae = 3.044844
Epoch 83
Validation mae = 2.856388
Validation band_gap mae = 2.856388
Epoch 84
Validation mae = 2.500785
Validation band_gap mae = 2.500785
Epoch 85
Validation mae = 3.081123
Validation band_gap mae = 3.081123
Epoch 86
Validation mae = 2.914014
Validation band_gap mae = 2.914014
Epoch 87
Validation mae = 3.554877
Validation band_gap mae = 3.554877
Epoch 88
Validation mae = 3.039667
Validation band_gap mae = 3.039667
Epoch 89
Validation mae = 3.018422
Validation band_gap mae = 3.018422
Epoch 90
Validation mae = 2.813312
Validation band_gap mae = 2.813312
Epoch 91
Validation mae = 3.274001
Validation band_gap mae = 3.274001
Epoch 92
Validation mae = 2.916248
Validation band_gap mae = 2.916248
Epoch 93
Validation mae = 3.091572
Validation band_gap mae = 3.091572
Epoch 94
Validation mae = 2.967293
Validation band_gap mae = 2.967293
Epoch 95
Validation mae = 3.184333
Validation band_gap mae = 3.184333
Epoch 96
Validation mae = 3.328823
Validation band_gap mae = 3.328823
Epoch 97
Validation mae = 2.888937
Validation band_gap mae = 2.888937
Epoch 98
Validation mae = 2.980035
Validation band_gap mae = 2.980035
Epoch 99
Validation mae = 3.708262
Validation band_gap mae = 3.708262
Model 0 best validation mae = 4.805439 on epoch 58
Moving model to cuda
Model 0 test mae = 4.332034
Model 0 test band_gap mae = 4.332034
Ensemble test mae = 4.332034
Ensemble test band_gap mae = 4.332034
==================== fold 3 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 2.616985
Validation band_gap mae = 2.616985
Epoch 1
Validation mae = 2.645046
Validation band_gap mae = 2.645046
Epoch 2
Validation mae = 2.657855
Validation band_gap mae = 2.657855
Epoch 3
Validation mae = 2.580903
Validation band_gap mae = 2.580903
Epoch 4
Validation mae = 2.586372
Validation band_gap mae = 2.586372
Epoch 5
Validation mae = 2.655997
Validation band_gap mae = 2.655997
Epoch 6
Validation mae = 2.691681
Validation band_gap mae = 2.691681
Epoch 7
Validation mae = 2.598832
Validation band_gap mae = 2.598832
Epoch 8
Validation mae = 2.647739
Validation band_gap mae = 2.647739
Epoch 9
Validation mae = 2.654113
Validation band_gap mae = 2.654113
Epoch 10
Validation mae = 2.599720
Validation band_gap mae = 2.599720
Epoch 11
Validation mae = 2.576293
Validation band_gap mae = 2.576293
Epoch 12
Validation mae = 2.612405
Validation band_gap mae = 2.612405
Epoch 13
Validation mae = 2.584029
Validation band_gap mae = 2.584029
Epoch 14
Validation mae = 2.624415
Validation band_gap mae = 2.624415
Epoch 15
Validation mae = 2.722344
Validation band_gap mae = 2.722344
Epoch 16
Validation mae = 2.604157
Validation band_gap mae = 2.604157
Epoch 17
Validation mae = 2.599443
Validation band_gap mae = 2.599443
Epoch 18
Validation mae = 2.661926
Validation band_gap mae = 2.661926
Epoch 19
Validation mae = 2.665535
Validation band_gap mae = 2.665535
Epoch 20
Validation mae = 2.596353
Validation band_gap mae = 2.596353
Epoch 21
Validation mae = 2.599939
Validation band_gap mae = 2.599939
Epoch 22
Validation mae = 2.684985
Validation band_gap mae = 2.684985
Epoch 23
Validation mae = 2.597485
Validation band_gap mae = 2.597485
Epoch 24
Validation mae = 2.663611
Validation band_gap mae = 2.663611
Epoch 25
Validation mae = 2.622104
Validation band_gap mae = 2.622104
Epoch 26
Validation mae = 2.644040
Validation band_gap mae = 2.644040
Epoch 27
Validation mae = 2.606924
Validation band_gap mae = 2.606924
Epoch 28
Validation mae = 2.599269
Validation band_gap mae = 2.599269
Epoch 29
Validation mae = 2.577675
Validation band_gap mae = 2.577675
Epoch 30
Validation mae = 2.609611
Validation band_gap mae = 2.609611
Epoch 31
Validation mae = 2.619334
Validation band_gap mae = 2.619334
Epoch 32
Validation mae = 2.577079
Validation band_gap mae = 2.577079
Epoch 33
Validation mae = 2.595318
Validation band_gap mae = 2.595318
Epoch 34
Validation mae = 2.613858
Validation band_gap mae = 2.613858
Epoch 35
Validation mae = 2.612378
Validation band_gap mae = 2.612378
Epoch 36
Validation mae = 2.610399
Validation band_gap mae = 2.610399
Epoch 37
Validation mae = 2.581659
Validation band_gap mae = 2.581659
Epoch 38
Validation mae = 2.703511
Validation band_gap mae = 2.703511
Epoch 39
Validation mae = 2.628182
Validation band_gap mae = 2.628182
Epoch 40
Validation mae = 2.618416
Validation band_gap mae = 2.618416
Epoch 41
Validation mae = 2.593025
Validation band_gap mae = 2.593025
Epoch 42
Validation mae = 2.610716
Validation band_gap mae = 2.610716
Epoch 43
Validation mae = 2.629250
Validation band_gap mae = 2.629250
Epoch 44
Validation mae = 2.646348
Validation band_gap mae = 2.646348
Epoch 45
Validation mae = 2.742813
Validation band_gap mae = 2.742813
Epoch 46
Validation mae = 2.601950
Validation band_gap mae = 2.601950
Epoch 47
Validation mae = 2.600583
Validation band_gap mae = 2.600583
Epoch 48
Validation mae = 2.693222
Validation band_gap mae = 2.693222
Epoch 49
Validation mae = 2.609416
Validation band_gap mae = 2.609416
Epoch 50
Validation mae = 2.601447
Validation band_gap mae = 2.601447
Epoch 51
Validation mae = 2.571618
Validation band_gap mae = 2.571618
Epoch 52
Validation mae = 2.640649
Validation band_gap mae = 2.640649
Epoch 53
Validation mae = 2.640441
Validation band_gap mae = 2.640441
Epoch 54
Validation mae = 2.612865
Validation band_gap mae = 2.612865
Epoch 55
Validation mae = 2.597486
Validation band_gap mae = 2.597486
Epoch 56
Validation mae = 2.596952
Validation band_gap mae = 2.596952
Epoch 57
Validation mae = 2.599416
Validation band_gap mae = 2.599416
Epoch 58
Validation mae = 2.583415
Validation band_gap mae = 2.583415
Epoch 59
Validation mae = 2.580475
Validation band_gap mae = 2.580475
Epoch 60
Validation mae = 2.639767
Validation band_gap mae = 2.639767
Epoch 61
Validation mae = 2.615814
Validation band_gap mae = 2.615814
Epoch 62
Validation mae = 2.677454
Validation band_gap mae = 2.677454
Epoch 63
Validation mae = 2.634767
Validation band_gap mae = 2.634767
Epoch 64
Validation mae = 2.618392
Validation band_gap mae = 2.618392
Epoch 65
Validation mae = 2.592071
Validation band_gap mae = 2.592071
Epoch 66
Validation mae = 2.671618
Validation band_gap mae = 2.671618
Epoch 67
Validation mae = 2.630566
Validation band_gap mae = 2.630566
Epoch 68
Validation mae = 2.647202
Validation band_gap mae = 2.647202
Epoch 69
Validation mae = 2.641560
Validation band_gap mae = 2.641560
Epoch 70
Validation mae = 2.645459
Validation band_gap mae = 2.645459
Epoch 71
Validation mae = 2.727461
Validation band_gap mae = 2.727461
Epoch 72
Validation mae = 2.627893
Validation band_gap mae = 2.627893
Epoch 73
Validation mae = 2.662438
Validation band_gap mae = 2.662438
Epoch 74
Validation mae = 2.720067
Validation band_gap mae = 2.720067
Epoch 75
Validation mae = 2.615513
Validation band_gap mae = 2.615513
Epoch 76
Validation mae = 2.660332
Validation band_gap mae = 2.660332
Epoch 77
Validation mae = 2.640110
Validation band_gap mae = 2.640110
Epoch 78
Validation mae = 2.700276
Validation band_gap mae = 2.700276
Epoch 79
Validation mae = 2.648236
Validation band_gap mae = 2.648236
Epoch 80
Validation mae = 2.617740
Validation band_gap mae = 2.617740
Epoch 81
Validation mae = 2.722096
Validation band_gap mae = 2.722096
Epoch 82
Validation mae = 2.601855
Validation band_gap mae = 2.601855
Epoch 83
Validation mae = 2.569136
Validation band_gap mae = 2.569136
Epoch 84
Validation mae = 2.638794
Validation band_gap mae = 2.638794
Epoch 85
Validation mae = 2.649149
Validation band_gap mae = 2.649149
Epoch 86
Validation mae = 2.632631
Validation band_gap mae = 2.632631
Epoch 87
Validation mae = 2.645274
Validation band_gap mae = 2.645274
Epoch 88
Validation mae = 2.641461
Validation band_gap mae = 2.641461
Epoch 89
Validation mae = 2.652369
Validation band_gap mae = 2.652369
Epoch 90
Validation mae = 2.648946
Validation band_gap mae = 2.648946
Epoch 91
Validation mae = 2.671383
Validation band_gap mae = 2.671383
Epoch 92
Validation mae = 2.693958
Validation band_gap mae = 2.693958
Epoch 93
Validation mae = 2.658082
Validation band_gap mae = 2.658082
Epoch 94
Validation mae = 2.646394
Validation band_gap mae = 2.646394
Epoch 95
Validation mae = 2.680079
Validation band_gap mae = 2.680079
Epoch 96
Validation mae = 2.695971
Validation band_gap mae = 2.695971
Epoch 97
Validation mae = 2.703387
Validation band_gap mae = 2.703387
Epoch 98
Validation mae = 2.633966
Validation band_gap mae = 2.633966
Epoch 99
Validation mae = 2.741055
Validation band_gap mae = 2.741055
Model 0 best validation mae = 2.742813 on epoch 45
Moving model to cuda
Model 0 test mae = 0.528370
Model 0 test band_gap mae = 0.528370
Ensemble test mae = 0.528370
Ensemble test band_gap mae = 0.528370
==================== fold 4 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.736883
Validation band_gap mae = 1.736883
Epoch 1
Validation mae = 1.737018
Validation band_gap mae = 1.737018
Epoch 2
Validation mae = 0.708380
Validation band_gap mae = 0.708380
Epoch 3
Validation mae = 0.757050
Validation band_gap mae = 0.757050
Epoch 4
Validation mae = 0.686783
Validation band_gap mae = 0.686783
Epoch 5
Validation mae = 0.483808
Validation band_gap mae = 0.483808
Epoch 6
Validation mae = 0.557232
Validation band_gap mae = 0.557232
Epoch 7
Validation mae = 1.112777
Validation band_gap mae = 1.112777
Epoch 8
Validation mae = 0.779374
Validation band_gap mae = 0.779374
Epoch 9
Validation mae = 0.749682
Validation band_gap mae = 0.749682
Epoch 10
Validation mae = 1.160610
Validation band_gap mae = 1.160610
Epoch 11
Validation mae = 0.850044
Validation band_gap mae = 0.850044
Epoch 12
Validation mae = 0.841676
Validation band_gap mae = 0.841676
Epoch 13
Validation mae = 0.633008
Validation band_gap mae = 0.633008
Epoch 14
Validation mae = 0.852922
Validation band_gap mae = 0.852922
Epoch 15
Validation mae = 1.389088
Validation band_gap mae = 1.389088
Epoch 16
Validation mae = 0.902371
Validation band_gap mae = 0.902371
Epoch 17
Validation mae = 0.615420
Validation band_gap mae = 0.615420
Epoch 18
Validation mae = 0.698711
Validation band_gap mae = 0.698711
Epoch 19
Validation mae = 0.842288
Validation band_gap mae = 0.842288
Epoch 20
Validation mae = 1.681024
Validation band_gap mae = 1.681024
Epoch 21
Validation mae = 1.257101
Validation band_gap mae = 1.257101
Epoch 22
Validation mae = 0.543599
Validation band_gap mae = 0.543599
Epoch 23
Validation mae = 1.575801
Validation band_gap mae = 1.575801
Epoch 24
Validation mae = 1.036892
Validation band_gap mae = 1.036892
Epoch 25
Validation mae = 0.734138
Validation band_gap mae = 0.734138
Epoch 26
Validation mae = 0.690696
Validation band_gap mae = 0.690696
Epoch 27
Validation mae = 0.951272
Validation band_gap mae = 0.951272
Epoch 28
Validation mae = 0.432610
Validation band_gap mae = 0.432610
Epoch 29
Validation mae = 0.608401
Validation band_gap mae = 0.608401
Epoch 30
Validation mae = 0.707061
Validation band_gap mae = 0.707061
Epoch 31
Validation mae = 0.445712
Validation band_gap mae = 0.445712
Epoch 32
Validation mae = 0.780409
Validation band_gap mae = 0.780409
Epoch 33
Validation mae = 0.485875
Validation band_gap mae = 0.485875
Epoch 34
Validation mae = 0.868077
Validation band_gap mae = 0.868077
Epoch 35
Validation mae = 0.755193
Validation band_gap mae = 0.755193
Epoch 36
Validation mae = 1.042456
Validation band_gap mae = 1.042456
Epoch 37
Validation mae = 0.629000
Validation band_gap mae = 0.629000
Epoch 38
Validation mae = 0.553856
Validation band_gap mae = 0.553856
Epoch 39
Validation mae = 0.446953
Validation band_gap mae = 0.446953
Epoch 40
Validation mae = 0.520297
Validation band_gap mae = 0.520297
Epoch 41
Validation mae = 0.985998
Validation band_gap mae = 0.985998
Epoch 42
Validation mae = 0.464366
Validation band_gap mae = 0.464366
Epoch 43
Validation mae = 0.481048
Validation band_gap mae = 0.481048
Epoch 44
Validation mae = 0.478979
Validation band_gap mae = 0.478979
Epoch 45
Validation mae = 0.579597
Validation band_gap mae = 0.579597
Epoch 46
Validation mae = 0.471658
Validation band_gap mae = 0.471658
Epoch 47
Validation mae = 0.443330
Validation band_gap mae = 0.443330
Epoch 48
Validation mae = 0.592823
Validation band_gap mae = 0.592823
Epoch 49
Validation mae = 0.469290
Validation band_gap mae = 0.469290
Epoch 50
Validation mae = 0.683677
Validation band_gap mae = 0.683677
Epoch 51
Validation mae = 0.496829
Validation band_gap mae = 0.496829
Epoch 52
Validation mae = 0.469680
Validation band_gap mae = 0.469680
Epoch 53
Validation mae = 0.446916
Validation band_gap mae = 0.446916
Epoch 54
Validation mae = 0.567424
Validation band_gap mae = 0.567424
Epoch 55
Validation mae = 0.440416
Validation band_gap mae = 0.440416
Epoch 56
Validation mae = 0.479780
Validation band_gap mae = 0.479780
Epoch 57
Validation mae = 0.565994
Validation band_gap mae = 0.565994
Epoch 58
Validation mae = 0.468207
Validation band_gap mae = 0.468207
Epoch 59
Validation mae = 0.499692
Validation band_gap mae = 0.499692
Epoch 60
Validation mae = 0.581275
Validation band_gap mae = 0.581275
Epoch 61
Validation mae = 0.582612
Validation band_gap mae = 0.582612
Epoch 62
Validation mae = 0.467739
Validation band_gap mae = 0.467739
Epoch 63
Validation mae = 0.457281
Validation band_gap mae = 0.457281
Epoch 64
Validation mae = 0.467775
Validation band_gap mae = 0.467775
Epoch 65
Validation mae = 0.465010
Validation band_gap mae = 0.465010
Epoch 66
Validation mae = 0.570693
Validation band_gap mae = 0.570693
Epoch 67
Validation mae = 0.468598
Validation band_gap mae = 0.468598
Epoch 68
Validation mae = 0.583409
Validation band_gap mae = 0.583409
Epoch 69
Validation mae = 0.467281
Validation band_gap mae = 0.467281
Epoch 70
Validation mae = 0.560902
Validation band_gap mae = 0.560902
Epoch 71
Validation mae = 0.462214
Validation band_gap mae = 0.462214
Epoch 72
Validation mae = 0.556840
Validation band_gap mae = 0.556840
Epoch 73
Validation mae = 0.469074
Validation band_gap mae = 0.469074
Epoch 74
Validation mae = 0.515820
Validation band_gap mae = 0.515820
Epoch 75
Validation mae = 0.452018
Validation band_gap mae = 0.452018
Epoch 76
Validation mae = 0.575847
Validation band_gap mae = 0.575847
Epoch 77
Validation mae = 0.521613
Validation band_gap mae = 0.521613
Epoch 78
Validation mae = 0.529998
Validation band_gap mae = 0.529998
Epoch 79
Validation mae = 0.493632
Validation band_gap mae = 0.493632
Epoch 80
Validation mae = 0.499084
Validation band_gap mae = 0.499084
Epoch 81
Validation mae = 0.486388
Validation band_gap mae = 0.486388
Epoch 82
Validation mae = 0.569894
Validation band_gap mae = 0.569894
Epoch 83
Validation mae = 0.467683
Validation band_gap mae = 0.467683
Epoch 84
Validation mae = 0.572310
Validation band_gap mae = 0.572310
Epoch 85
Validation mae = 0.481682
Validation band_gap mae = 0.481682
Epoch 86
Validation mae = 0.536340
Validation band_gap mae = 0.536340
Epoch 87
Validation mae = 0.495106
Validation band_gap mae = 0.495106
Epoch 88
Validation mae = 0.474735
Validation band_gap mae = 0.474735
Epoch 89
Validation mae = 0.507849
Validation band_gap mae = 0.507849
Epoch 90
Validation mae = 0.480490
Validation band_gap mae = 0.480490
Epoch 91
Validation mae = 0.520065
Validation band_gap mae = 0.520065
Epoch 92
Validation mae = 0.475906
Validation band_gap mae = 0.475906
Epoch 93
Validation mae = 0.472777
Validation band_gap mae = 0.472777
Epoch 94
Validation mae = 0.545607
Validation band_gap mae = 0.545607
Epoch 95
Validation mae = 0.516862
Validation band_gap mae = 0.516862
Epoch 96
Validation mae = 0.482610
Validation band_gap mae = 0.482610
Epoch 97
Validation mae = 0.522422
Validation band_gap mae = 0.522422
Epoch 98
Validation mae = 0.517434
Validation band_gap mae = 0.517434
Epoch 99
Validation mae = 0.473304
Validation band_gap mae = 0.473304
Model 0 best validation mae = 1.737018 on epoch 1
Moving model to cuda
Model 0 test mae = 1.591983
Model 0 test band_gap mae = 1.591983
Ensemble test mae = 1.591983
Ensemble test band_gap mae = 1.591983
==================== fold 5 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.273575
Validation band_gap mae = 0.273575
Epoch 1
Validation mae = 0.397981
Validation band_gap mae = 0.397981
Epoch 2
Validation mae = 0.316165
Validation band_gap mae = 0.316165
Epoch 3
Validation mae = 0.473402
Validation band_gap mae = 0.473402
Epoch 4
Validation mae = 0.357915
Validation band_gap mae = 0.357915
Epoch 5
Validation mae = 0.298252
Validation band_gap mae = 0.298252
Epoch 6
Validation mae = 0.302022
Validation band_gap mae = 0.302022
Epoch 7
Validation mae = 0.280928
Validation band_gap mae = 0.280928
Epoch 8
Validation mae = 0.379925
Validation band_gap mae = 0.379925
Epoch 9
Validation mae = 0.382829
Validation band_gap mae = 0.382829
Epoch 10
Validation mae = 0.444105
Validation band_gap mae = 0.444105
Epoch 11
Validation mae = 0.310042
Validation band_gap mae = 0.310042
Epoch 12
Validation mae = 0.273961
Validation band_gap mae = 0.273961
Epoch 13
Validation mae = 0.351678
Validation band_gap mae = 0.351678
Epoch 14
Validation mae = 0.340624
Validation band_gap mae = 0.340624
Epoch 15
Validation mae = 0.270027
Validation band_gap mae = 0.270027
Epoch 16
Validation mae = 0.295634
Validation band_gap mae = 0.295634
Epoch 17
Validation mae = 0.322723
Validation band_gap mae = 0.322723
Epoch 18
Validation mae = 0.291732
Validation band_gap mae = 0.291732
Epoch 19
Validation mae = 0.376874
Validation band_gap mae = 0.376874
Epoch 20
Validation mae = 0.269700
Validation band_gap mae = 0.269700
Epoch 21
Validation mae = 0.287998
Validation band_gap mae = 0.287998
Epoch 22
Validation mae = 0.289930
Validation band_gap mae = 0.289930
Epoch 23
Validation mae = 0.315225
Validation band_gap mae = 0.315225
Epoch 24
Validation mae = 0.297690
Validation band_gap mae = 0.297690
Epoch 25
Validation mae = 0.272554
Validation band_gap mae = 0.272554
Epoch 26
Validation mae = 0.280886
Validation band_gap mae = 0.280886
Epoch 27
Validation mae = 0.375661
Validation band_gap mae = 0.375661
Epoch 28
Validation mae = 0.292531
Validation band_gap mae = 0.292531
Epoch 29
Validation mae = 0.362575
Validation band_gap mae = 0.362575
Epoch 30
Validation mae = 0.290075
Validation band_gap mae = 0.290075
Epoch 31
Validation mae = 0.285999
Validation band_gap mae = 0.285999
Epoch 32
Validation mae = 0.281347
Validation band_gap mae = 0.281347
Epoch 33
Validation mae = 0.320233
Validation band_gap mae = 0.320233
Epoch 34
Validation mae = 0.291392
Validation band_gap mae = 0.291392
Epoch 35
Validation mae = 0.396555
Validation band_gap mae = 0.396555
Epoch 36
Validation mae = 0.361036
Validation band_gap mae = 0.361036
Epoch 37
Validation mae = 0.311530
Validation band_gap mae = 0.311530
Epoch 38
Validation mae = 0.276140
Validation band_gap mae = 0.276140
Epoch 39
Validation mae = 0.399914
Validation band_gap mae = 0.399914
Epoch 40
Validation mae = 0.424935
Validation band_gap mae = 0.424935
Epoch 41
Validation mae = 0.434065
Validation band_gap mae = 0.434065
Epoch 42
Validation mae = 0.363311
Validation band_gap mae = 0.363311
Epoch 43
Validation mae = 0.280785
Validation band_gap mae = 0.280785
Epoch 44
Validation mae = 0.296045
Validation band_gap mae = 0.296045
Epoch 45
Validation mae = 0.282730
Validation band_gap mae = 0.282730
Epoch 46
Validation mae = 0.346558
Validation band_gap mae = 0.346558
Epoch 47
Validation mae = 0.339034
Validation band_gap mae = 0.339034
Epoch 48
Validation mae = 0.433560
Validation band_gap mae = 0.433560
Epoch 49
Validation mae = 0.276643
Validation band_gap mae = 0.276643
Epoch 50
Validation mae = 0.299915
Validation band_gap mae = 0.299915
Epoch 51
Validation mae = 0.264629
Validation band_gap mae = 0.264629
Epoch 52
Validation mae = 0.260587
Validation band_gap mae = 0.260587
Epoch 53
Validation mae = 0.273455
Validation band_gap mae = 0.273455
Epoch 54
Validation mae = 0.271677
Validation band_gap mae = 0.271677
Epoch 55
Validation mae = 0.367158
Validation band_gap mae = 0.367158
Epoch 56
Validation mae = 0.360114
Validation band_gap mae = 0.360114
Epoch 57
Validation mae = 0.289086
Validation band_gap mae = 0.289086
Epoch 58
Validation mae = 0.289847
Validation band_gap mae = 0.289847
Epoch 59
Validation mae = 0.275089
Validation band_gap mae = 0.275089
Epoch 60
Validation mae = 0.274821
Validation band_gap mae = 0.274821
Epoch 61
Validation mae = 0.296547
Validation band_gap mae = 0.296547
Epoch 62
Validation mae = 0.367797
Validation band_gap mae = 0.367797
Epoch 63
Validation mae = 0.330655
Validation band_gap mae = 0.330655
Epoch 64
Validation mae = 0.287324
Validation band_gap mae = 0.287324
Epoch 65
Validation mae = 0.426685
Validation band_gap mae = 0.426685
Epoch 66
Validation mae = 0.394045
Validation band_gap mae = 0.394045
Epoch 67
Validation mae = 0.261114
Validation band_gap mae = 0.261114
Epoch 68
Validation mae = 0.387357
Validation band_gap mae = 0.387357
Epoch 69
Validation mae = 0.264142
Validation band_gap mae = 0.264142
Epoch 70
Validation mae = 0.547648
Validation band_gap mae = 0.547648
Epoch 71
Validation mae = 0.348731
Validation band_gap mae = 0.348731
Epoch 72
Validation mae = 0.277117
Validation band_gap mae = 0.277117
Epoch 73
Validation mae = 0.276645
Validation band_gap mae = 0.276645
Epoch 74
Validation mae = 0.305979
Validation band_gap mae = 0.305979
Epoch 75
Validation mae = 0.400428
Validation band_gap mae = 0.400428
Epoch 76
Validation mae = 0.343611
Validation band_gap mae = 0.343611
Epoch 77
Validation mae = 0.286781
Validation band_gap mae = 0.286781
Epoch 78
Validation mae = 0.433207
Validation band_gap mae = 0.433207
Epoch 79
Validation mae = 0.271758
Validation band_gap mae = 0.271758
Epoch 80
Validation mae = 0.363622
Validation band_gap mae = 0.363622
Epoch 81
Validation mae = 0.275781
Validation band_gap mae = 0.275781
Epoch 82
Validation mae = 0.350146
Validation band_gap mae = 0.350146
Epoch 83
Validation mae = 0.404940
Validation band_gap mae = 0.404940
Epoch 84
Validation mae = 0.350601
Validation band_gap mae = 0.350601
Epoch 85
Validation mae = 0.271514
Validation band_gap mae = 0.271514
Epoch 86
Validation mae = 0.293062
Validation band_gap mae = 0.293062
Epoch 87
Validation mae = 0.244758
Validation band_gap mae = 0.244758
Epoch 88
Validation mae = 0.422097
Validation band_gap mae = 0.422097
Epoch 89
Validation mae = 0.283105
Validation band_gap mae = 0.283105
Epoch 90
Validation mae = 0.483111
Validation band_gap mae = 0.483111
Epoch 91
Validation mae = 0.257150
Validation band_gap mae = 0.257150
Epoch 92
Validation mae = 0.440085
Validation band_gap mae = 0.440085
Epoch 93
Validation mae = 0.348219
Validation band_gap mae = 0.348219
Epoch 94
Validation mae = 0.519131
Validation band_gap mae = 0.519131
Epoch 95
Validation mae = 0.474962
Validation band_gap mae = 0.474962
Epoch 96
Validation mae = 0.305007
Validation band_gap mae = 0.305007
Epoch 97
Validation mae = 0.408739
Validation band_gap mae = 0.408739
Epoch 98
Validation mae = 0.382390
Validation band_gap mae = 0.382390
Epoch 99
Validation mae = 0.287062
Validation band_gap mae = 0.287062
Model 0 best validation mae = 0.547648 on epoch 70
Moving model to cuda
Model 0 test mae = 0.316293
Model 0 test band_gap mae = 0.316293
Ensemble test mae = 0.316293
Ensemble test band_gap mae = 0.316293
==================== fold 6 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.380897
Validation band_gap mae = 0.380897
Epoch 1
Validation mae = 0.443733
Validation band_gap mae = 0.443733
Epoch 2
Validation mae = 0.438254
Validation band_gap mae = 0.438254
Epoch 3
Validation mae = 0.369927
Validation band_gap mae = 0.369927
Epoch 4
Validation mae = 0.319292
Validation band_gap mae = 0.319292
Epoch 5
Validation mae = 0.335136
Validation band_gap mae = 0.335136
Epoch 6
Validation mae = 0.325740
Validation band_gap mae = 0.325740
Epoch 7
Validation mae = 0.370358
Validation band_gap mae = 0.370358
Epoch 8
Validation mae = 0.393634
Validation band_gap mae = 0.393634
Epoch 9
Validation mae = 0.465803
Validation band_gap mae = 0.465803
Epoch 10
Validation mae = 0.448830
Validation band_gap mae = 0.448830
Epoch 11
Validation mae = 0.400504
Validation band_gap mae = 0.400504
Epoch 12
Validation mae = 0.328786
Validation band_gap mae = 0.328786
Epoch 13
Validation mae = 0.321984
Validation band_gap mae = 0.321984
Epoch 14
Validation mae = 0.312909
Validation band_gap mae = 0.312909
Epoch 15
Validation mae = 0.379505
Validation band_gap mae = 0.379505
Epoch 16
Validation mae = 0.333368
Validation band_gap mae = 0.333368
Epoch 17
Validation mae = 0.319273
Validation band_gap mae = 0.319273
Epoch 18
Validation mae = 0.301925
Validation band_gap mae = 0.301925
Epoch 19
Validation mae = 0.331764
Validation band_gap mae = 0.331764
Epoch 20
Validation mae = 0.315168
Validation band_gap mae = 0.315168
Epoch 21
Validation mae = 0.447013
Validation band_gap mae = 0.447013
Epoch 22
Validation mae = 0.320599
Validation band_gap mae = 0.320599
Epoch 23
Validation mae = 0.364540
Validation band_gap mae = 0.364540
Epoch 24
Validation mae = 0.343638
Validation band_gap mae = 0.343638
Epoch 25
Validation mae = 0.357278
Validation band_gap mae = 0.357278
Epoch 26
Validation mae = 0.292866
Validation band_gap mae = 0.292866
Epoch 27
Validation mae = 0.392194
Validation band_gap mae = 0.392194
Epoch 28
Validation mae = 0.404401
Validation band_gap mae = 0.404401
Epoch 29
Validation mae = 0.361171
Validation band_gap mae = 0.361171
Epoch 30
Validation mae = 0.337064
Validation band_gap mae = 0.337064
Epoch 31
Validation mae = 0.309072
Validation band_gap mae = 0.309072
Epoch 32
Validation mae = 0.330677
Validation band_gap mae = 0.330677
Epoch 33
Validation mae = 0.365202
Validation band_gap mae = 0.365202
Epoch 34
Validation mae = 0.327920
Validation band_gap mae = 0.327920
Epoch 35
Validation mae = 0.318372
Validation band_gap mae = 0.318372
Epoch 36
Validation mae = 0.309137
Validation band_gap mae = 0.309137
Epoch 37
Validation mae = 0.336699
Validation band_gap mae = 0.336699
Epoch 38
Validation mae = 0.404341
Validation band_gap mae = 0.404341
Epoch 39
Validation mae = 0.311109
Validation band_gap mae = 0.311109
Epoch 40
Validation mae = 0.328532
Validation band_gap mae = 0.328532
Epoch 41
Validation mae = 0.412316
Validation band_gap mae = 0.412316
Epoch 42
Validation mae = 0.302685
Validation band_gap mae = 0.302685
Epoch 43
Validation mae = 0.299823
Validation band_gap mae = 0.299823
Epoch 44
Validation mae = 0.317547
Validation band_gap mae = 0.317547
Epoch 45
Validation mae = 0.376460
Validation band_gap mae = 0.376460
Epoch 46
Validation mae = 0.315153
Validation band_gap mae = 0.315153
Epoch 47
Validation mae = 0.300273
Validation band_gap mae = 0.300273
Epoch 48
Validation mae = 0.320406
Validation band_gap mae = 0.320406
Epoch 49
Validation mae = 0.345894
Validation band_gap mae = 0.345894
Epoch 50
Validation mae = 0.321530
Validation band_gap mae = 0.321530
Epoch 51
Validation mae = 0.333456
Validation band_gap mae = 0.333456
Epoch 52
Validation mae = 0.369719
Validation band_gap mae = 0.369719
Epoch 53
Validation mae = 0.291834
Validation band_gap mae = 0.291834
Epoch 54
Validation mae = 0.321758
Validation band_gap mae = 0.321758
Epoch 55
Validation mae = 0.304984
Validation band_gap mae = 0.304984
Epoch 56
Validation mae = 0.307458
Validation band_gap mae = 0.307458
Epoch 57
Validation mae = 0.293635
Validation band_gap mae = 0.293635
Epoch 58
Validation mae = 0.343953
Validation band_gap mae = 0.343953
Epoch 59
Validation mae = 0.302162
Validation band_gap mae = 0.302162
Epoch 60
Validation mae = 0.313982
Validation band_gap mae = 0.313982
Epoch 61
Validation mae = 0.318430
Validation band_gap mae = 0.318430
Epoch 62
Validation mae = 0.334372
Validation band_gap mae = 0.334372
Epoch 63
Validation mae = 0.324280
Validation band_gap mae = 0.324280
Epoch 64
Validation mae = 0.304317
Validation band_gap mae = 0.304317
Epoch 65
Validation mae = 0.302811
Validation band_gap mae = 0.302811
Epoch 66
Validation mae = 0.323868
Validation band_gap mae = 0.323868
Epoch 67
Validation mae = 0.321795
Validation band_gap mae = 0.321795
Epoch 68
Validation mae = 0.302991
Validation band_gap mae = 0.302991
Epoch 69
Validation mae = 0.298514
Validation band_gap mae = 0.298514
Epoch 70
Validation mae = 0.306782
Validation band_gap mae = 0.306782
Epoch 71
Validation mae = 0.304792
Validation band_gap mae = 0.304792
Epoch 72
Validation mae = 0.312013
Validation band_gap mae = 0.312013
Epoch 73
Validation mae = 0.299175
Validation band_gap mae = 0.299175
Epoch 74
Validation mae = 0.305355
Validation band_gap mae = 0.305355
Epoch 75
Validation mae = 0.309933
Validation band_gap mae = 0.309933
Epoch 76
Validation mae = 0.303774
Validation band_gap mae = 0.303774
Epoch 77
Validation mae = 0.307572
Validation band_gap mae = 0.307572
Epoch 78
Validation mae = 0.303414
Validation band_gap mae = 0.303414
Epoch 79
Validation mae = 0.311117
Validation band_gap mae = 0.311117
Epoch 80
Validation mae = 0.331805
Validation band_gap mae = 0.331805
Epoch 81
Validation mae = 0.320909
Validation band_gap mae = 0.320909
Epoch 82
Validation mae = 0.306980
Validation band_gap mae = 0.306980
Epoch 83
Validation mae = 0.304704
Validation band_gap mae = 0.304704
Epoch 84
Validation mae = 0.309578
Validation band_gap mae = 0.309578
Epoch 85
Validation mae = 0.305432
Validation band_gap mae = 0.305432
Epoch 86
Validation mae = 0.303467
Validation band_gap mae = 0.303467
Epoch 87
Validation mae = 0.307580
Validation band_gap mae = 0.307580
Epoch 88
Validation mae = 0.305561
Validation band_gap mae = 0.305561
Epoch 89
Validation mae = 0.306377
Validation band_gap mae = 0.306377
Epoch 90
Validation mae = 0.309267
Validation band_gap mae = 0.309267
Epoch 91
Validation mae = 0.304752
Validation band_gap mae = 0.304752
Epoch 92
Validation mae = 0.304321
Validation band_gap mae = 0.304321
Epoch 93
Validation mae = 0.316141
Validation band_gap mae = 0.316141
Epoch 94
Validation mae = 0.303372
Validation band_gap mae = 0.303372
Epoch 95
Validation mae = 0.302714
Validation band_gap mae = 0.302714
Epoch 96
Validation mae = 0.305850
Validation band_gap mae = 0.305850
Epoch 97
Validation mae = 0.305017
Validation band_gap mae = 0.305017
Epoch 98
Validation mae = 0.305133
Validation band_gap mae = 0.305133
Epoch 99
Validation mae = 0.309266
Validation band_gap mae = 0.309266
Model 0 best validation mae = 0.465803 on epoch 9
Moving model to cuda
Model 0 test mae = 0.490483
Model 0 test band_gap mae = 0.490483
Ensemble test mae = 0.490483
Ensemble test band_gap mae = 0.490483
==================== fold 7 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.226731
Validation band_gap mae = 0.226731
Epoch 1
Validation mae = 0.210939
Validation band_gap mae = 0.210939
Epoch 2
Validation mae = 0.231708
Validation band_gap mae = 0.231708
Epoch 3
Validation mae = 0.138763
Validation band_gap mae = 0.138763
Epoch 4
Validation mae = 0.203459
Validation band_gap mae = 0.203459
Epoch 5
Validation mae = 0.179871
Validation band_gap mae = 0.179871
Epoch 6
Validation mae = 0.276610
Validation band_gap mae = 0.276610
Epoch 7
Validation mae = 0.421134
Validation band_gap mae = 0.421134
Epoch 8
Validation mae = 0.149639
Validation band_gap mae = 0.149639
Epoch 9
Validation mae = 0.166526
Validation band_gap mae = 0.166526
Epoch 10
Validation mae = 0.374486
Validation band_gap mae = 0.374486
Epoch 11
Validation mae = 0.443543
Validation band_gap mae = 0.443543
Epoch 12
Validation mae = 0.217985
Validation band_gap mae = 0.217985
Epoch 13
Validation mae = 0.263242
Validation band_gap mae = 0.263242
Epoch 14
Validation mae = 0.223153
Validation band_gap mae = 0.223153
Epoch 15
Validation mae = 0.223318
Validation band_gap mae = 0.223318
Epoch 16
Validation mae = 0.150676
Validation band_gap mae = 0.150676
Epoch 17
Validation mae = 0.128752
Validation band_gap mae = 0.128752
Epoch 18
Validation mae = 0.181103
Validation band_gap mae = 0.181103
Epoch 19
Validation mae = 0.227425
Validation band_gap mae = 0.227425
Epoch 20
Validation mae = 0.273335
Validation band_gap mae = 0.273335
Epoch 21
Validation mae = 0.342844
Validation band_gap mae = 0.342844
Epoch 22
Validation mae = 0.121110
Validation band_gap mae = 0.121110
Epoch 23
Validation mae = 0.201875
Validation band_gap mae = 0.201875
Epoch 24
Validation mae = 0.130047
Validation band_gap mae = 0.130047
Epoch 25
Validation mae = 0.144002
Validation band_gap mae = 0.144002
Epoch 26
Validation mae = 0.204467
Validation band_gap mae = 0.204467
Epoch 27
Validation mae = 0.187947
Validation band_gap mae = 0.187947
Epoch 28
Validation mae = 0.239410
Validation band_gap mae = 0.239410
Epoch 29
Validation mae = 0.151518
Validation band_gap mae = 0.151518
Epoch 30
Validation mae = 0.264408
Validation band_gap mae = 0.264408
Epoch 31
Validation mae = 0.194387
Validation band_gap mae = 0.194387
Epoch 32
Validation mae = 0.128583
Validation band_gap mae = 0.128583
Epoch 33
Validation mae = 0.205666
Validation band_gap mae = 0.205666
Epoch 34
Validation mae = 0.107376
Validation band_gap mae = 0.107376
Epoch 35
Validation mae = 0.178334
Validation band_gap mae = 0.178334
Epoch 36
Validation mae = 0.168353
Validation band_gap mae = 0.168353
Epoch 37
Validation mae = 0.215223
Validation band_gap mae = 0.215223
Epoch 38
Validation mae = 0.188518
Validation band_gap mae = 0.188518
Epoch 39
Validation mae = 0.214413
Validation band_gap mae = 0.214413
Epoch 40
Validation mae = 0.209341
Validation band_gap mae = 0.209341
Epoch 41
Validation mae = 0.250273
Validation band_gap mae = 0.250273
Epoch 42
Validation mae = 0.185019
Validation band_gap mae = 0.185019
Epoch 43
Validation mae = 0.119185
Validation band_gap mae = 0.119185
Epoch 44
Validation mae = 0.216346
Validation band_gap mae = 0.216346
Epoch 45
Validation mae = 0.355104
Validation band_gap mae = 0.355104
Epoch 46
Validation mae = 0.113459
Validation band_gap mae = 0.113459
Epoch 47
Validation mae = 0.209438
Validation band_gap mae = 0.209438
Epoch 48
Validation mae = 0.267229
Validation band_gap mae = 0.267229
Epoch 49
Validation mae = 0.201202
Validation band_gap mae = 0.201202
Epoch 50
Validation mae = 0.251848
Validation band_gap mae = 0.251848
Epoch 51
Validation mae = 0.157027
Validation band_gap mae = 0.157027
Epoch 52
Validation mae = 0.212744
Validation band_gap mae = 0.212744
Epoch 53
Validation mae = 0.548481
Validation band_gap mae = 0.548481
Epoch 54
Validation mae = 0.123635
Validation band_gap mae = 0.123635
Epoch 55
Validation mae = 0.425022
Validation band_gap mae = 0.425022
Epoch 56
Validation mae = 0.144336
Validation band_gap mae = 0.144336
Epoch 57
Validation mae = 0.182622
Validation band_gap mae = 0.182622
Epoch 58
Validation mae = 0.210947
Validation band_gap mae = 0.210947
Epoch 59
Validation mae = 0.333855
Validation band_gap mae = 0.333855
Epoch 60
Validation mae = 0.500447
Validation band_gap mae = 0.500447
Epoch 61
Validation mae = 0.438155
Validation band_gap mae = 0.438155
Epoch 62
Validation mae = 0.394319
Validation band_gap mae = 0.394319
Epoch 63
Validation mae = 0.170888
Validation band_gap mae = 0.170888
Epoch 64
Validation mae = 0.167206
Validation band_gap mae = 0.167206
Epoch 65
Validation mae = 0.171474
Validation band_gap mae = 0.171474
Epoch 66
Validation mae = 0.401731
Validation band_gap mae = 0.401731
Epoch 67
Validation mae = 0.143502
Validation band_gap mae = 0.143502
Epoch 68
Validation mae = 0.122166
Validation band_gap mae = 0.122166
Epoch 69
Validation mae = 0.160375
Validation band_gap mae = 0.160375
Epoch 70
Validation mae = 0.148830
Validation band_gap mae = 0.148830
Epoch 71
Validation mae = 0.196553
Validation band_gap mae = 0.196553
Epoch 72
Validation mae = 0.249315
Validation band_gap mae = 0.249315
Epoch 73
Validation mae = 0.308815
Validation band_gap mae = 0.308815
Epoch 74
Validation mae = 0.120300
Validation band_gap mae = 0.120300
Epoch 75
Validation mae = 0.194727
Validation band_gap mae = 0.194727
Epoch 76
Validation mae = 0.132173
Validation band_gap mae = 0.132173
Epoch 77
Validation mae = 0.123407
Validation band_gap mae = 0.123407
Epoch 78
Validation mae = 0.227787
Validation band_gap mae = 0.227787
Epoch 79
Validation mae = 0.160843
Validation band_gap mae = 0.160843
Epoch 80
Validation mae = 0.124099
Validation band_gap mae = 0.124099
Epoch 81
Validation mae = 0.177051
Validation band_gap mae = 0.177051
Epoch 82
Validation mae = 0.138232
Validation band_gap mae = 0.138232
Epoch 83
Validation mae = 0.207682
Validation band_gap mae = 0.207682
Epoch 84
Validation mae = 0.162665
Validation band_gap mae = 0.162665
Epoch 85
Validation mae = 0.166946
Validation band_gap mae = 0.166946
Epoch 86
Validation mae = 0.162571
Validation band_gap mae = 0.162571
Epoch 87
Validation mae = 0.142363
Validation band_gap mae = 0.142363
Epoch 88
Validation mae = 0.153525
Validation band_gap mae = 0.153525
Epoch 89
Validation mae = 0.230458
Validation band_gap mae = 0.230458
Epoch 90
Validation mae = 0.154445
Validation band_gap mae = 0.154445
Epoch 91
Validation mae = 0.161818
Validation band_gap mae = 0.161818
Epoch 92
Validation mae = 0.174997
Validation band_gap mae = 0.174997
Epoch 93
Validation mae = 0.202618
Validation band_gap mae = 0.202618
Epoch 94
Validation mae = 0.130344
Validation band_gap mae = 0.130344
Epoch 95
Validation mae = 0.182000
Validation band_gap mae = 0.182000
Epoch 96
Validation mae = 0.191277
Validation band_gap mae = 0.191277
Epoch 97
Validation mae = 0.176035
Validation band_gap mae = 0.176035
Epoch 98
Validation mae = 0.160732
Validation band_gap mae = 0.160732
Epoch 99
Validation mae = 0.218793
Validation band_gap mae = 0.218793
Model 0 best validation mae = 0.548481 on epoch 53
Moving model to cuda
Model 0 test mae = 0.650434
Model 0 test band_gap mae = 0.650434
Ensemble test mae = 0.650434
Ensemble test band_gap mae = 0.650434
==================== fold 8 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.354023
Validation band_gap mae = 0.354023
Epoch 1
Validation mae = 0.524640
Validation band_gap mae = 0.524640
Epoch 2
Validation mae = 0.320638
Validation band_gap mae = 0.320638
Epoch 3
Validation mae = 0.372125
Validation band_gap mae = 0.372125
Epoch 4
Validation mae = 0.410604
Validation band_gap mae = 0.410604
Epoch 5
Validation mae = 0.347579
Validation band_gap mae = 0.347579
Epoch 6
Validation mae = 0.303452
Validation band_gap mae = 0.303452
Epoch 7
Validation mae = 0.336510
Validation band_gap mae = 0.336510
Epoch 8
Validation mae = 0.321770
Validation band_gap mae = 0.321770
Epoch 9
Validation mae = 0.283046
Validation band_gap mae = 0.283046
Epoch 10
Validation mae = 0.308722
Validation band_gap mae = 0.308722
Epoch 11
Validation mae = 0.279199
Validation band_gap mae = 0.279199
Epoch 12
Validation mae = 0.293694
Validation band_gap mae = 0.293694
Epoch 13
Validation mae = 0.308015
Validation band_gap mae = 0.308015
Epoch 14
Validation mae = 0.372879
Validation band_gap mae = 0.372879
Epoch 15
Validation mae = 0.327485
Validation band_gap mae = 0.327485
Epoch 16
Validation mae = 0.270807
Validation band_gap mae = 0.270807
Epoch 17
Validation mae = 0.285767
Validation band_gap mae = 0.285767
Epoch 18
Validation mae = 0.274759
Validation band_gap mae = 0.274759
Epoch 19
Validation mae = 0.306480
Validation band_gap mae = 0.306480
Epoch 20
Validation mae = 0.323495
Validation band_gap mae = 0.323495
Epoch 21
Validation mae = 0.270307
Validation band_gap mae = 0.270307
Epoch 22
Validation mae = 0.264108
Validation band_gap mae = 0.264108
Epoch 23
Validation mae = 0.267745
Validation band_gap mae = 0.267745
Epoch 24
Validation mae = 0.248700
Validation band_gap mae = 0.248700
Epoch 25
Validation mae = 0.263372
Validation band_gap mae = 0.263372
Epoch 26
Validation mae = 0.262533
Validation band_gap mae = 0.262533
Epoch 27
Validation mae = 0.295664
Validation band_gap mae = 0.295664
Epoch 28
Validation mae = 0.295406
Validation band_gap mae = 0.295406
Epoch 29
Validation mae = 0.287602
Validation band_gap mae = 0.287602
Epoch 30
Validation mae = 0.292209
Validation band_gap mae = 0.292209
Epoch 31
Validation mae = 0.286389
Validation band_gap mae = 0.286389
Epoch 32
Validation mae = 0.377079
Validation band_gap mae = 0.377079
Epoch 33
Validation mae = 0.268620
Validation band_gap mae = 0.268620
Epoch 34
Validation mae = 0.322405
Validation band_gap mae = 0.322405
Epoch 35
Validation mae = 0.288444
Validation band_gap mae = 0.288444
Epoch 36
Validation mae = 0.288011
Validation band_gap mae = 0.288011
Epoch 37
Validation mae = 0.277384
Validation band_gap mae = 0.277384
Epoch 38
Validation mae = 0.301296
Validation band_gap mae = 0.301296
Epoch 39
Validation mae = 0.318311
Validation band_gap mae = 0.318311
Epoch 40
Validation mae = 0.360639
Validation band_gap mae = 0.360639
Epoch 41
Validation mae = 0.456759
Validation band_gap mae = 0.456759
Epoch 42
Validation mae = 0.284707
Validation band_gap mae = 0.284707
Epoch 43
Validation mae = 0.255195
Validation band_gap mae = 0.255195
Epoch 44
Validation mae = 0.322031
Validation band_gap mae = 0.322031
Epoch 45
Validation mae = 0.298266
Validation band_gap mae = 0.298266
Epoch 46
Validation mae = 0.277987
Validation band_gap mae = 0.277987
Epoch 47
Validation mae = 0.389269
Validation band_gap mae = 0.389269
Epoch 48
Validation mae = 0.274531
Validation band_gap mae = 0.274531
Epoch 49
Validation mae = 0.285754
Validation band_gap mae = 0.285754
Epoch 50
Validation mae = 0.292799
Validation band_gap mae = 0.292799
Epoch 51
Validation mae = 0.498941
Validation band_gap mae = 0.498941
Epoch 52
Validation mae = 0.292269
Validation band_gap mae = 0.292269
Epoch 53
Validation mae = 0.278670
Validation band_gap mae = 0.278670
Epoch 54
Validation mae = 0.319359
Validation band_gap mae = 0.319359
Epoch 55
Validation mae = 0.279492
Validation band_gap mae = 0.279492
Epoch 56
Validation mae = 0.271980
Validation band_gap mae = 0.271980
Epoch 57
Validation mae = 0.325705
Validation band_gap mae = 0.325705
Epoch 58
Validation mae = 0.277347
Validation band_gap mae = 0.277347
Epoch 59
Validation mae = 0.270995
Validation band_gap mae = 0.270995
Epoch 60
Validation mae = 0.303528
Validation band_gap mae = 0.303528
Epoch 61
Validation mae = 0.276664
Validation band_gap mae = 0.276664
Epoch 62
Validation mae = 0.301786
Validation band_gap mae = 0.301786
Epoch 63
Validation mae = 0.275642
Validation band_gap mae = 0.275642
Epoch 64
Validation mae = 0.278111
Validation band_gap mae = 0.278111
Epoch 65
Validation mae = 0.305525
Validation band_gap mae = 0.305525
Epoch 66
Validation mae = 0.299572
Validation band_gap mae = 0.299572
Epoch 67
Validation mae = 0.279173
Validation band_gap mae = 0.279173
Epoch 68
Validation mae = 0.331410
Validation band_gap mae = 0.331410
Epoch 69
Validation mae = 0.280690
Validation band_gap mae = 0.280690
Epoch 70
Validation mae = 0.276393
Validation band_gap mae = 0.276393
Epoch 71
Validation mae = 0.276552
Validation band_gap mae = 0.276552
Epoch 72
Validation mae = 0.300619
Validation band_gap mae = 0.300619
Epoch 73
Validation mae = 0.288129
Validation band_gap mae = 0.288129
Epoch 74
Validation mae = 0.278148
Validation band_gap mae = 0.278148
Epoch 75
Validation mae = 0.285259
Validation band_gap mae = 0.285259
Epoch 76
Validation mae = 0.341420
Validation band_gap mae = 0.341420
Epoch 77
Validation mae = 0.273778
Validation band_gap mae = 0.273778
Epoch 78
Validation mae = 0.326313
Validation band_gap mae = 0.326313
Epoch 79
Validation mae = 0.277843
Validation band_gap mae = 0.277843
Epoch 80
Validation mae = 0.279936
Validation band_gap mae = 0.279936
Epoch 81
Validation mae = 0.276711
Validation band_gap mae = 0.276711
Epoch 82
Validation mae = 0.289070
Validation band_gap mae = 0.289070
Epoch 83
Validation mae = 0.292593
Validation band_gap mae = 0.292593
Epoch 84
Validation mae = 0.283469
Validation band_gap mae = 0.283469
Epoch 85
Validation mae = 0.294025
Validation band_gap mae = 0.294025
Epoch 86
Validation mae = 0.278218
Validation band_gap mae = 0.278218
Epoch 87
Validation mae = 0.294170
Validation band_gap mae = 0.294170
Epoch 88
Validation mae = 0.277874
Validation band_gap mae = 0.277874
Epoch 89
Validation mae = 0.293864
Validation band_gap mae = 0.293864
Epoch 90
Validation mae = 0.278745
Validation band_gap mae = 0.278745
Epoch 91
Validation mae = 0.284825
Validation band_gap mae = 0.284825
Epoch 92
Validation mae = 0.286165
Validation band_gap mae = 0.286165
Epoch 93
Validation mae = 0.282960
Validation band_gap mae = 0.282960
Epoch 94
Validation mae = 0.287176
Validation band_gap mae = 0.287176
Epoch 95
Validation mae = 0.281041
Validation band_gap mae = 0.281041
Epoch 96
Validation mae = 0.301474
Validation band_gap mae = 0.301474
Epoch 97
Validation mae = 0.278982
Validation band_gap mae = 0.278982
Epoch 98
Validation mae = 0.282234
Validation band_gap mae = 0.282234
Epoch 99
Validation mae = 0.287779
Validation band_gap mae = 0.287779
Model 0 best validation mae = 0.524640 on epoch 1
Moving model to cuda
Model 0 test mae = 0.324662
Model 0 test band_gap mae = 0.324662
Ensemble test mae = 0.324662
Ensemble test band_gap mae = 0.324662
==================== fold 9 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.443287
Validation band_gap mae = 0.443287
Epoch 1
Validation mae = 0.466636
Validation band_gap mae = 0.466636
Epoch 2
Validation mae = 0.697416
Validation band_gap mae = 0.697416
Epoch 3
Validation mae = 0.471777
Validation band_gap mae = 0.471777
Epoch 4
Validation mae = 0.612223
Validation band_gap mae = 0.612223
Epoch 5
Validation mae = 0.420917
Validation band_gap mae = 0.420917
Epoch 6
Validation mae = 0.603207
Validation band_gap mae = 0.603207
Epoch 7
Validation mae = 0.494882
Validation band_gap mae = 0.494882
Epoch 8
Validation mae = 0.578484
Validation band_gap mae = 0.578484
Epoch 9
Validation mae = 0.525169
Validation band_gap mae = 0.525169
Epoch 10
Validation mae = 0.527513
Validation band_gap mae = 0.527513
Epoch 11
Validation mae = 0.493002
Validation band_gap mae = 0.493002
Epoch 12
Validation mae = 0.451256
Validation band_gap mae = 0.451256
Epoch 13
Validation mae = 0.487634
Validation band_gap mae = 0.487634
Epoch 14
Validation mae = 0.462616
Validation band_gap mae = 0.462616
Epoch 15
Validation mae = 0.482709
Validation band_gap mae = 0.482709
Epoch 16
Validation mae = 0.489332
Validation band_gap mae = 0.489332
Epoch 17
Validation mae = 0.477197
Validation band_gap mae = 0.477197
Epoch 18
Validation mae = 0.413917
Validation band_gap mae = 0.413917
Epoch 19
Validation mae = 0.489386
Validation band_gap mae = 0.489386
Epoch 20
Validation mae = 0.458404
Validation band_gap mae = 0.458404
Epoch 21
Validation mae = 0.421872
Validation band_gap mae = 0.421872
Epoch 22
Validation mae = 0.430042
Validation band_gap mae = 0.430042
Epoch 23
Validation mae = 0.449816
Validation band_gap mae = 0.449816
Epoch 24
Validation mae = 0.485395
Validation band_gap mae = 0.485395
Epoch 25
Validation mae = 0.451771
Validation band_gap mae = 0.451771
Epoch 26
Validation mae = 0.572849
Validation band_gap mae = 0.572849
Epoch 27
Validation mae = 0.517690
Validation band_gap mae = 0.517690
Epoch 28
Validation mae = 0.461749
Validation band_gap mae = 0.461749
Epoch 29
Validation mae = 0.438775
Validation band_gap mae = 0.438775
Epoch 30
Validation mae = 0.520696
Validation band_gap mae = 0.520696
Epoch 31
Validation mae = 0.458539
Validation band_gap mae = 0.458539
Epoch 32
Validation mae = 0.432813
Validation band_gap mae = 0.432813
Epoch 33
Validation mae = 0.488980
Validation band_gap mae = 0.488980
Epoch 34
Validation mae = 0.504707
Validation band_gap mae = 0.504707
Epoch 35
Validation mae = 0.496063
Validation band_gap mae = 0.496063
Epoch 36
Validation mae = 0.513038
Validation band_gap mae = 0.513038
Epoch 37
Validation mae = 0.474658
Validation band_gap mae = 0.474658
Epoch 38
Validation mae = 0.421478
Validation band_gap mae = 0.421478
Epoch 39
Validation mae = 0.434224
Validation band_gap mae = 0.434224
Epoch 40
Validation mae = 0.441369
Validation band_gap mae = 0.441369
Epoch 41
Validation mae = 0.449326
Validation band_gap mae = 0.449326
Epoch 42
Validation mae = 0.439423
Validation band_gap mae = 0.439423
Epoch 43
Validation mae = 0.556072
Validation band_gap mae = 0.556072
Epoch 44
Validation mae = 0.476505
Validation band_gap mae = 0.476505
Epoch 45
Validation mae = 0.414834
Validation band_gap mae = 0.414834
Epoch 46
Validation mae = 0.434822
Validation band_gap mae = 0.434822
Epoch 47
Validation mae = 0.479455
Validation band_gap mae = 0.479455
Epoch 48
Validation mae = 0.614298
Validation band_gap mae = 0.614298
Epoch 49
Validation mae = 0.426840
Validation band_gap mae = 0.426840
Epoch 50
Validation mae = 0.438007
Validation band_gap mae = 0.438007
Epoch 51
Validation mae = 0.472276
Validation band_gap mae = 0.472276
Epoch 52
Validation mae = 0.514880
Validation band_gap mae = 0.514880
Epoch 53
Validation mae = 0.466698
Validation band_gap mae = 0.466698
Epoch 54
Validation mae = 0.499007
Validation band_gap mae = 0.499007
Epoch 55
Validation mae = 0.512289
Validation band_gap mae = 0.512289
Epoch 56
Validation mae = 0.451415
Validation band_gap mae = 0.451415
Epoch 57
Validation mae = 0.456881
Validation band_gap mae = 0.456881
Epoch 58
Validation mae = 0.466526
Validation band_gap mae = 0.466526
Epoch 59
Validation mae = 0.476246
Validation band_gap mae = 0.476246
Epoch 60
Validation mae = 0.429359
Validation band_gap mae = 0.429359
Epoch 61
Validation mae = 0.447938
Validation band_gap mae = 0.447938
Epoch 62
Validation mae = 0.461168
Validation band_gap mae = 0.461168
Epoch 63
Validation mae = 0.475847
Validation band_gap mae = 0.475847
Epoch 64
Validation mae = 0.431669
Validation band_gap mae = 0.431669
Epoch 65
Validation mae = 0.476999
Validation band_gap mae = 0.476999
Epoch 66
Validation mae = 0.434031
Validation band_gap mae = 0.434031
Epoch 67
Validation mae = 0.527611
Validation band_gap mae = 0.527611
Epoch 68
Validation mae = 0.598418
Validation band_gap mae = 0.598418
Epoch 69
Validation mae = 0.466245
Validation band_gap mae = 0.466245
Epoch 70
Validation mae = 0.426661
Validation band_gap mae = 0.426661
Epoch 71
Validation mae = 0.469151
Validation band_gap mae = 0.469151
Epoch 72
Validation mae = 0.430687
Validation band_gap mae = 0.430687
Epoch 73
Validation mae = 0.431935
Validation band_gap mae = 0.431935
Epoch 74
Validation mae = 0.442897
Validation band_gap mae = 0.442897
Epoch 75
Validation mae = 0.526568
Validation band_gap mae = 0.526568
Epoch 76
Validation mae = 0.433740
Validation band_gap mae = 0.433740
Epoch 77
Validation mae = 0.428011
Validation band_gap mae = 0.428011
Epoch 78
Validation mae = 0.484633
Validation band_gap mae = 0.484633
Epoch 79
Validation mae = 0.488251
Validation band_gap mae = 0.488251
Epoch 80
Validation mae = 0.435522
Validation band_gap mae = 0.435522
Epoch 81
Validation mae = 0.498504
Validation band_gap mae = 0.498504
Epoch 82
Validation mae = 0.467751
Validation band_gap mae = 0.467751
Epoch 83
Validation mae = 0.436825
Validation band_gap mae = 0.436825
Epoch 84
Validation mae = 0.426097
Validation band_gap mae = 0.426097
Epoch 85
Validation mae = 0.424959
Validation band_gap mae = 0.424959
Epoch 86
Validation mae = 0.441620
Validation band_gap mae = 0.441620
Epoch 87
Validation mae = 0.470705
Validation band_gap mae = 0.470705
Epoch 88
Validation mae = 0.469467
Validation band_gap mae = 0.469467
Epoch 89
Validation mae = 0.444658
Validation band_gap mae = 0.444658
Epoch 90
Validation mae = 0.465486
Validation band_gap mae = 0.465486
Epoch 91
Validation mae = 0.451663
Validation band_gap mae = 0.451663
Epoch 92
Validation mae = 0.434358
Validation band_gap mae = 0.434358
Epoch 93
Validation mae = 0.455091
Validation band_gap mae = 0.455091
Epoch 94
Validation mae = 0.462467
Validation band_gap mae = 0.462467
Epoch 95
Validation mae = 0.455660
Validation band_gap mae = 0.455660
Epoch 96
Validation mae = 0.434102
Validation band_gap mae = 0.434102
Epoch 97
Validation mae = 0.423391
Validation band_gap mae = 0.423391
Epoch 98
Validation mae = 0.491880
Validation band_gap mae = 0.491880
Epoch 99
Validation mae = 0.482656
Validation band_gap mae = 0.482656
Model 0 best validation mae = 0.697416 on epoch 2
Moving model to cuda
Model 0 test mae = 0.424399
Model 0 test band_gap mae = 0.424399
Ensemble test mae = 0.424399
Ensemble test band_gap mae = 0.424399
10-fold cross validation
Seed 0
Fold 0 ==> valid mae = 10.039740 test mae = 7.213766
Fold 0 ==> valid band_gap mae = 10.039740test band_gap mae = 7.213766
Fold 1 ==> valid mae = 6.856541 test mae = 1.898207
Fold 1 ==> valid band_gap mae = 6.856541test band_gap mae = 1.898207
Fold 2 ==> valid mae = 4.805439 test mae = 4.332034
Fold 2 ==> valid band_gap mae = 4.805439test band_gap mae = 4.332034
Fold 3 ==> valid mae = 2.742813 test mae = 0.528370
Fold 3 ==> valid band_gap mae = 2.742813test band_gap mae = 0.528370
Fold 4 ==> valid mae = 1.737018 test mae = 1.591983
Fold 4 ==> valid band_gap mae = 1.737018test band_gap mae = 1.591983
Fold 5 ==> valid mae = 0.547648 test mae = 0.316293
Fold 5 ==> valid band_gap mae = 0.547648test band_gap mae = 0.316293
Fold 6 ==> valid mae = 0.465803 test mae = 0.490483
Fold 6 ==> valid band_gap mae = 0.465803test band_gap mae = 0.490483
Fold 7 ==> valid mae = 0.548481 test mae = 0.650434
Fold 7 ==> valid band_gap mae = 0.548481test band_gap mae = 0.650434
Fold 8 ==> valid mae = 0.524640 test mae = 0.324662
Fold 8 ==> valid band_gap mae = 0.524640test band_gap mae = 0.324662
Fold 9 ==> valid mae = 0.697416 test mae = 0.424399
Fold 9 ==> valid band_gap mae = 0.697416test band_gap mae = 0.424399
Overall valid mae = 2.896554 +/- 3.148335
Overall test mae = 1.777063 +/- 2.160819
Overall test band_gap mae = 1.777063 +/- 2.160819
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
(array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,
        13,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,
        27,  28,  29,  30,  32,  33,  34,  35,  36,  37,  38,  39,  40,
        41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,
        54,  56,  57,  58,  59,  61,  62,  63,  64,  66,  67,  68,  69,
        70,  71,  72,  73,  74,  75,  76,  78,  79,  80,  81,  82,  83,
        84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,
        98,  99, 100, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111,
       112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 123, 124, 125,
       126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138,
       139, 140, 143, 144, 146, 147, 148, 149, 150, 151, 152, 153, 154,
       155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167,
       168, 169, 170, 171, 172, 173, 174, 176, 177, 178, 179, 180, 181,
       182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194,
       195, 197, 198, 199, 201, 202, 203, 204, 205, 206, 207, 208, 209,
       210, 211, 212, 213, 214, 216, 217, 218, 219, 220, 221, 222, 223,
       224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236,
       237, 238, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251,
       253, 254, 255, 256, 257, 258, 259, 260, 263, 264, 265, 266, 267,
       268, 269, 270, 271, 273, 274, 275, 276, 277, 278, 280, 281, 282,
       283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 296,
       297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309,
       311, 312, 313, 314, 315, 316, 317, 318, 320, 321, 322, 323, 324,
       325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337,
       339, 340, 341, 343, 344, 347, 348, 349, 350, 351, 353, 354, 355,
       356, 357, 358, 359, 360, 361, 365, 366, 367, 368, 369, 370, 371,
       372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 383, 384, 387,
       388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400,
       401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 414,
       417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429,
       430, 431, 432, 433, 435, 437, 438, 439, 440, 441, 442, 443, 444,
       445, 446, 447, 448, 449, 450, 451, 453, 454, 455, 456, 457, 458,
       459, 460, 461, 462, 463, 464, 466, 467, 468, 469, 470, 471, 472,
       473, 474, 475, 476, 477, 479, 480, 481, 482, 484, 486, 487, 488,
       489, 490, 491, 492, 493, 494, 496, 497, 498, 499, 500, 501, 502,
       503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515,
       517, 518, 519, 520, 523, 525, 526, 527, 528, 530, 531, 532, 533,
       534, 536, 537, 538, 539, 540, 541, 542, 543, 544, 546, 547, 548,
       550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562,
       563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575,
       576, 577, 578, 579, 580, 581, 583, 584, 585, 586, 587, 588, 589,
       590, 591, 592, 593, 594, 595, 596, 598, 599, 600, 601, 603, 604,
       605, 606, 607, 609, 610, 611, 613, 614, 615, 616, 617, 619, 620,
       621, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634,
       635, 636, 637, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648,
       649, 650, 651, 652, 653, 655, 657, 658, 659, 660, 661, 662, 663,
       664, 665, 666, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677,
       678, 679, 680, 681, 682, 683, 684, 685, 686, 689, 690, 691, 692,
       693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705,
       706, 707, 709, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720,
       721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733,
       734, 735, 736, 738, 739, 742, 743, 744, 745, 746, 747, 748, 749,
       750, 751, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764,
       765, 766, 767, 768, 770, 771, 772, 774, 775, 776, 777, 778, 779,
       780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792,
       793, 794, 795, 796, 797, 799, 800, 801, 802, 803, 804, 805, 806,
       807, 808, 809, 811, 813, 814, 816, 817, 818, 819, 820, 821, 823,
       824, 825, 826, 827, 828, 830, 831, 832, 833, 834, 835, 836, 838,
       839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851,
       852, 853, 854, 856, 857, 859, 860, 861, 862, 863, 864, 865, 866,
       868, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881,
       882, 883, 884, 886, 887, 888, 889, 890, 892, 893, 894, 895, 896,
       897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909,
       910, 911, 912, 913, 914, 915, 916, 917, 918, 920, 921, 922, 923,
       924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936,
       937, 938, 939, 942]), array([ 14,  31,  55,  60,  65,  77,  97, 101, 122, 141, 142, 145, 175,
       196, 200, 215, 239, 240, 252, 261, 262, 272, 279, 295, 310, 319,
       338, 342, 345, 346, 352, 362, 363, 364, 382, 385, 386, 413, 415,
       416, 434, 436, 452, 465, 478, 483, 485, 495, 516, 521, 522, 524,
       529, 535, 545, 549, 582, 597, 602, 608, 612, 618, 622, 638, 654,
       656, 667, 687, 688, 708, 710, 737, 740, 741, 752, 753, 769, 773,
       798, 810, 812, 815, 822, 829, 837, 855, 858, 867, 869, 885, 891,
       919, 940, 941, 943]))
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 9.210490
Validation band_gap mae = 9.210490
Epoch 1
Validation mae = 11.325145
Validation band_gap mae = 11.325145
Epoch 2
Validation mae = 8.491044
Validation band_gap mae = 8.491044
Epoch 3
Validation mae = 7.061964
Validation band_gap mae = 7.061964
Epoch 4
Validation mae = 9.008528
Validation band_gap mae = 9.008528
Epoch 5
Validation mae = 5.167754
Validation band_gap mae = 5.167754
Epoch 6
Validation mae = 5.087484
Validation band_gap mae = 5.087484
Epoch 7
Validation mae = 5.137842
Validation band_gap mae = 5.137842
Epoch 8
Validation mae = 5.051594
Validation band_gap mae = 5.051594
Epoch 9
Validation mae = 6.319542
Validation band_gap mae = 6.319542
Epoch 10
Validation mae = 7.726969
Validation band_gap mae = 7.726969
Epoch 11
Validation mae = 6.182209
Validation band_gap mae = 6.182209
Epoch 12
Validation mae = 5.743693
Validation band_gap mae = 5.743693
Epoch 13
Validation mae = 5.141938
Validation band_gap mae = 5.141938
Epoch 14
Validation mae = 5.029923
Validation band_gap mae = 5.029923
Epoch 15
Validation mae = 4.747453
Validation band_gap mae = 4.747453
Epoch 16
Validation mae = 5.084525
Validation band_gap mae = 5.084525
Epoch 17
Validation mae = 4.749243
Validation band_gap mae = 4.749243
Epoch 18
Validation mae = 4.701173
Validation band_gap mae = 4.701173
Epoch 19
Validation mae = 5.375962
Validation band_gap mae = 5.375962
Epoch 20
Validation mae = 5.110222
Validation band_gap mae = 5.110222
Epoch 21
Validation mae = 4.830490
Validation band_gap mae = 4.830490
Epoch 22
Validation mae = 4.552508
Validation band_gap mae = 4.552508
Epoch 23
Validation mae = 4.617483
Validation band_gap mae = 4.617483
Epoch 24
Validation mae = 4.569343
Validation band_gap mae = 4.569343
Epoch 25
Validation mae = 4.726665
Validation band_gap mae = 4.726665
Epoch 26
Validation mae = 4.860826
Validation band_gap mae = 4.860826
Epoch 27
Validation mae = 4.693971
Validation band_gap mae = 4.693971
Epoch 28
Validation mae = 5.002445
Validation band_gap mae = 5.002445
Epoch 29
Validation mae = 4.908959
Validation band_gap mae = 4.908959
Epoch 30
Validation mae = 4.841005
Validation band_gap mae = 4.841005
Epoch 31
Validation mae = 4.552758
Validation band_gap mae = 4.552758
Epoch 32
Validation mae = 4.814123
Validation band_gap mae = 4.814123
Epoch 33
Validation mae = 5.004448
Validation band_gap mae = 5.004448
Epoch 34
Validation mae = 4.770025
Validation band_gap mae = 4.770025
Epoch 35
Validation mae = 4.724861
Validation band_gap mae = 4.724861
Epoch 36
Validation mae = 5.105315
Validation band_gap mae = 5.105315
Epoch 37
Validation mae = 4.965620
Validation band_gap mae = 4.965620
Epoch 38
Validation mae = 4.656568
Validation band_gap mae = 4.656568
Epoch 39
Validation mae = 4.788076
Validation band_gap mae = 4.788076
Epoch 40
Validation mae = 4.865892
Validation band_gap mae = 4.865892
Epoch 41
Validation mae = 4.930619
Validation band_gap mae = 4.930619
Epoch 42
Validation mae = 4.892576
Validation band_gap mae = 4.892576
Epoch 43
Validation mae = 4.803434
Validation band_gap mae = 4.803434
Epoch 44
Validation mae = 4.598038
Validation band_gap mae = 4.598038
Epoch 45
Validation mae = 5.154413
Validation band_gap mae = 5.154413
Epoch 46
Validation mae = 4.633276
Validation band_gap mae = 4.633276
Epoch 47
Validation mae = 4.884545
Validation band_gap mae = 4.884545
Epoch 48
Validation mae = 4.671164
Validation band_gap mae = 4.671164
Epoch 49
Validation mae = 4.827343
Validation band_gap mae = 4.827343
Epoch 50
Validation mae = 4.884439
Validation band_gap mae = 4.884439
Epoch 51
Validation mae = 4.818564
Validation band_gap mae = 4.818564
Epoch 52
Validation mae = 4.893762
Validation band_gap mae = 4.893762
Epoch 53
Validation mae = 5.145454
Validation band_gap mae = 5.145454
Epoch 54
Validation mae = 4.643653
Validation band_gap mae = 4.643653
Epoch 55
Validation mae = 4.650089
Validation band_gap mae = 4.650089
Epoch 56
Validation mae = 4.788736
Validation band_gap mae = 4.788736
Epoch 57
Validation mae = 4.669218
Validation band_gap mae = 4.669218
Epoch 58
Validation mae = 4.691028
Validation band_gap mae = 4.691028
Epoch 59
Validation mae = 4.778109
Validation band_gap mae = 4.778109
Epoch 60
Validation mae = 4.616916
Validation band_gap mae = 4.616916
Epoch 61
Validation mae = 4.967034
Validation band_gap mae = 4.967034
Epoch 62
Validation mae = 4.483415
Validation band_gap mae = 4.483415
Epoch 63
Validation mae = 4.826567
Validation band_gap mae = 4.826567
Epoch 64
Validation mae = 4.909789
Validation band_gap mae = 4.909789
Epoch 65
Validation mae = 4.606158
Validation band_gap mae = 4.606158
Epoch 66
Validation mae = 4.686441
Validation band_gap mae = 4.686441
Epoch 67
Validation mae = 4.748497
Validation band_gap mae = 4.748497
Epoch 68
Validation mae = 4.848550
Validation band_gap mae = 4.848550
Epoch 69
Validation mae = 4.843894
Validation band_gap mae = 4.843894
Epoch 70
Validation mae = 4.623535
Validation band_gap mae = 4.623535
Epoch 71
Validation mae = 4.684767
Validation band_gap mae = 4.684767
Epoch 72
Validation mae = 4.538040
Validation band_gap mae = 4.538040
Epoch 73
Validation mae = 4.638062
Validation band_gap mae = 4.638062
Epoch 74
Validation mae = 4.666379
Validation band_gap mae = 4.666379
Epoch 75
Validation mae = 4.672815
Validation band_gap mae = 4.672815
Epoch 76
Validation mae = 4.557375
Validation band_gap mae = 4.557375
Epoch 77
Validation mae = 4.581384
Validation band_gap mae = 4.581384
Epoch 78
Validation mae = 4.826536
Validation band_gap mae = 4.826536
Epoch 79
Validation mae = 4.591898
Validation band_gap mae = 4.591898
Epoch 80
Validation mae = 4.666060
Validation band_gap mae = 4.666060
Epoch 81
Validation mae = 4.593883
Validation band_gap mae = 4.593883
Epoch 82
Validation mae = 4.521155
Validation band_gap mae = 4.521155
Epoch 83
Validation mae = 4.612748
Validation band_gap mae = 4.612748
Epoch 84
Validation mae = 4.631741
Validation band_gap mae = 4.631741
Epoch 85
Validation mae = 4.628202
Validation band_gap mae = 4.628202
Epoch 86
Validation mae = 4.626148
Validation band_gap mae = 4.626148
Epoch 87
Validation mae = 4.509828
Validation band_gap mae = 4.509828
Epoch 88
Validation mae = 4.569794
Validation band_gap mae = 4.569794
Epoch 89
Validation mae = 4.617961
Validation band_gap mae = 4.617961
Epoch 90
Validation mae = 4.633570
Validation band_gap mae = 4.633570
Epoch 91
Validation mae = 4.696391
Validation band_gap mae = 4.696391
Epoch 92
Validation mae = 4.535266
Validation band_gap mae = 4.535266
Epoch 93
Validation mae = 4.594982
Validation band_gap mae = 4.594982
Epoch 94
Validation mae = 4.608017
Validation band_gap mae = 4.608017
Epoch 95
Validation mae = 4.509573
Validation band_gap mae = 4.509573
Epoch 96
Validation mae = 4.573783
Validation band_gap mae = 4.573783
Epoch 97
Validation mae = 4.500441
Validation band_gap mae = 4.500441
Epoch 98
Validation mae = 4.567706
Validation band_gap mae = 4.567706
Epoch 99
Validation mae = 4.465533
Validation band_gap mae = 4.465533
Model 0 best validation mae = 11.325145 on epoch 1
Moving model to cuda
Model 0 test mae = 11.889321
Model 0 test band_gap mae = 11.889321
Ensemble test mae = 11.889321
Ensemble test band_gap mae = 11.889321
==================== fold 1 ====================
(array([  0,   1,   2,   3,   4,   6,   7,   9,  10,  11,  12,  13,  14,
        15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  28,
        29,  31,  32,  33,  35,  36,  38,  39,  41,  42,  43,  44,  45,
        46,  47,  48,  49,  50,  51,  52,  53,  54,  55,  56,  57,  58,
        59,  60,  61,  63,  64,  65,  66,  67,  68,  69,  70,  71,  72,
        73,  74,  75,  76,  77,  78,  80,  81,  82,  83,  84,  85,  86,
        87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  97,  98,  99,
       100, 101, 102, 104, 105, 106, 107, 108, 109, 110, 111, 112, 114,
       115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127,
       128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140,
       141, 142, 143, 145, 146, 147, 148, 149, 151, 152, 153, 155, 156,
       157, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170,
       171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 182, 183, 184,
       185, 186, 187, 188, 189, 190, 191, 192, 194, 195, 196, 197, 198,
       199, 200, 201, 202, 203, 205, 206, 207, 208, 209, 210, 211, 212,
       213, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226,
       227, 228, 229, 232, 233, 234, 235, 237, 238, 239, 240, 241, 242,
       243, 244, 245, 246, 248, 249, 250, 252, 254, 255, 256, 257, 258,
       259, 260, 261, 262, 263, 264, 265, 268, 269, 271, 272, 273, 274,
       275, 276, 277, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288,
       289, 290, 291, 292, 295, 296, 297, 299, 300, 301, 302, 303, 304,
       305, 307, 309, 310, 312, 313, 314, 315, 316, 317, 318, 319, 321,
       322, 323, 324, 325, 326, 327, 328, 329, 330, 333, 334, 335, 336,
       337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349,
       351, 352, 353, 354, 355, 356, 357, 359, 360, 361, 362, 363, 364,
       365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377,
       378, 380, 381, 382, 383, 384, 385, 386, 387, 388, 390, 391, 392,
       393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 404, 405, 407,
       408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 421,
       422, 423, 424, 426, 428, 429, 430, 431, 432, 433, 434, 435, 436,
       437, 438, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451,
       452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 463, 464, 465,
       467, 468, 469, 470, 472, 473, 474, 475, 476, 477, 478, 479, 480,
       482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494,
       495, 496, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508,
       509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521,
       522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534,
       535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547,
       548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560,
       561, 562, 563, 564, 565, 566, 567, 570, 571, 573, 574, 575, 577,
       579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591,
       592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604,
       605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617,
       618, 619, 620, 621, 622, 623, 625, 626, 627, 628, 629, 630, 631,
       632, 633, 634, 636, 637, 638, 639, 640, 641, 642, 644, 645, 646,
       647, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661,
       662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 673, 675, 676,
       677, 679, 680, 681, 682, 684, 685, 686, 687, 688, 689, 690, 691,
       692, 693, 694, 695, 696, 697, 698, 699, 701, 702, 703, 704, 705,
       706, 707, 708, 709, 710, 711, 712, 714, 715, 716, 718, 719, 720,
       721, 722, 723, 724, 726, 727, 729, 732, 733, 734, 735, 736, 737,
       738, 739, 740, 741, 742, 743, 744, 746, 747, 748, 749, 750, 752,
       753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765,
       766, 767, 768, 769, 770, 773, 774, 775, 776, 777, 778, 779, 780,
       781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793,
       794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806,
       807, 808, 809, 810, 811, 812, 815, 816, 817, 819, 820, 821, 822,
       823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835,
       837, 838, 840, 842, 844, 845, 846, 847, 848, 849, 850, 851, 852,
       853, 854, 855, 856, 857, 858, 859, 861, 862, 863, 864, 865, 866,
       867, 868, 869, 870, 872, 873, 874, 876, 877, 878, 879, 880, 881,
       882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 895,
       896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908,
       910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922,
       923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 934, 935, 937,
       938, 940, 941, 943]), array([  5,   8,  27,  30,  34,  37,  40,  62,  79, 103, 113, 144, 150,
       154, 158, 181, 193, 204, 214, 230, 231, 236, 247, 251, 253, 266,
       267, 270, 278, 293, 294, 298, 306, 308, 311, 320, 331, 332, 350,
       358, 379, 389, 403, 406, 420, 425, 427, 439, 440, 462, 466, 471,
       481, 497, 568, 569, 572, 576, 578, 624, 635, 643, 648, 649, 672,
       674, 678, 683, 700, 713, 717, 725, 728, 730, 731, 745, 751, 771,
       772, 813, 814, 818, 836, 839, 841, 843, 860, 871, 875, 894, 909,
       933, 936, 939, 942]))
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 6.198249
Validation band_gap mae = 6.198249
Epoch 1
Validation mae = 6.432526
Validation band_gap mae = 6.432526
Epoch 2
Validation mae = 6.250498
Validation band_gap mae = 6.250498
Epoch 3
Validation mae = 5.802020
Validation band_gap mae = 5.802020
Epoch 4
Validation mae = 6.057551
Validation band_gap mae = 6.057551
Epoch 5
Validation mae = 6.735496
Validation band_gap mae = 6.735496
Epoch 6
Validation mae = 5.694667
Validation band_gap mae = 5.694667
Epoch 7
Validation mae = 5.770349
Validation band_gap mae = 5.770349
Epoch 8
Validation mae = 5.812697
Validation band_gap mae = 5.812697
Epoch 9
Validation mae = 5.762465
Validation band_gap mae = 5.762465
Epoch 10
Validation mae = 5.605807
Validation band_gap mae = 5.605807
Epoch 11
Validation mae = 6.252097
Validation band_gap mae = 6.252097
Epoch 12
Validation mae = 6.965872
Validation band_gap mae = 6.965872
Epoch 13
Validation mae = 6.360243
Validation band_gap mae = 6.360243
Epoch 14
Validation mae = 6.480859
Validation band_gap mae = 6.480859
Epoch 15
Validation mae = 6.165013
Validation band_gap mae = 6.165013
Epoch 16
Validation mae = 6.142354
Validation band_gap mae = 6.142354
Epoch 17
Validation mae = 5.603305
Validation band_gap mae = 5.603305
Epoch 18
Validation mae = 6.215151
Validation band_gap mae = 6.215151
Epoch 19
Validation mae = 5.915025
Validation band_gap mae = 5.915025
Epoch 20
Validation mae = 5.629199
Validation band_gap mae = 5.629199
Epoch 21
Validation mae = 5.815501
Validation band_gap mae = 5.815501
Epoch 22
Validation mae = 5.597098
Validation band_gap mae = 5.597098
Epoch 23
Validation mae = 6.172980
Validation band_gap mae = 6.172980
Epoch 24
Validation mae = 6.762255
Validation band_gap mae = 6.762255
Epoch 25
Validation mae = 6.002399
Validation band_gap mae = 6.002399
Epoch 26
Validation mae = 6.482085
Validation band_gap mae = 6.482085
Epoch 27
Validation mae = 5.947414
Validation band_gap mae = 5.947414
Epoch 28
Validation mae = 5.929155
Validation band_gap mae = 5.929155
Epoch 29
Validation mae = 5.998909
Validation band_gap mae = 5.998909
Epoch 30
Validation mae = 5.899417
Validation band_gap mae = 5.899417
Epoch 31
Validation mae = 5.792297
Validation band_gap mae = 5.792297
Epoch 32
Validation mae = 5.758075
Validation band_gap mae = 5.758075
Epoch 33
Validation mae = 5.753401
Validation band_gap mae = 5.753401
Epoch 34
Validation mae = 5.729131
Validation band_gap mae = 5.729131
Epoch 35
Validation mae = 5.908564
Validation band_gap mae = 5.908564
Epoch 36
Validation mae = 5.786695
Validation band_gap mae = 5.786695
Epoch 37
Validation mae = 5.585814
Validation band_gap mae = 5.585814
Epoch 38
Validation mae = 5.617937
Validation band_gap mae = 5.617937
Epoch 39
Validation mae = 5.811275
Validation band_gap mae = 5.811275
Epoch 40
Validation mae = 5.762704
Validation band_gap mae = 5.762704
Epoch 41
Validation mae = 6.158127
Validation band_gap mae = 6.158127
Epoch 42
Validation mae = 5.836993
Validation band_gap mae = 5.836993
Epoch 43
Validation mae = 5.928646
Validation band_gap mae = 5.928646
Epoch 44
Validation mae = 6.080974
Validation band_gap mae = 6.080974
Epoch 45
Validation mae = 6.352248
Validation band_gap mae = 6.352248
Epoch 46
Validation mae = 6.022117
Validation band_gap mae = 6.022117
Epoch 47
Validation mae = 5.833473
Validation band_gap mae = 5.833473
Epoch 48
Validation mae = 6.035729
Validation band_gap mae = 6.035729
Epoch 49
Validation mae = 6.493500
Validation band_gap mae = 6.493500
Epoch 50
Validation mae = 6.015266
Validation band_gap mae = 6.015266
Epoch 51
Validation mae = 6.130442
Validation band_gap mae = 6.130442
Epoch 52
Validation mae = 6.079244
Validation band_gap mae = 6.079244
Epoch 53
Validation mae = 6.103070
Validation band_gap mae = 6.103070
Epoch 54
Validation mae = 6.341987
Validation band_gap mae = 6.341987
Epoch 55
Validation mae = 6.071689
Validation band_gap mae = 6.071689
Epoch 56
Validation mae = 6.022501
Validation band_gap mae = 6.022501
Epoch 57
Validation mae = 6.293672
Validation band_gap mae = 6.293672
Epoch 58
Validation mae = 6.432198
Validation band_gap mae = 6.432198
Epoch 59
Validation mae = 5.968929
Validation band_gap mae = 5.968929
Epoch 60
Validation mae = 6.730130
Validation band_gap mae = 6.730130
Epoch 61
Validation mae = 6.478905
Validation band_gap mae = 6.478905
Epoch 62
Validation mae = 6.617272
Validation band_gap mae = 6.617272
Epoch 63
Validation mae = 6.634755
Validation band_gap mae = 6.634755
Epoch 64
Validation mae = 6.435821
Validation band_gap mae = 6.435821
Epoch 65
Validation mae = 6.405291
Validation band_gap mae = 6.405291
Epoch 66
Validation mae = 6.559578
Validation band_gap mae = 6.559578
Epoch 67
Validation mae = 6.376638
Validation band_gap mae = 6.376638
Epoch 68
Validation mae = 6.495643
Validation band_gap mae = 6.495643
Epoch 69
Validation mae = 6.438291
Validation band_gap mae = 6.438291
Epoch 70
Validation mae = 6.498516
Validation band_gap mae = 6.498516
Epoch 71
Validation mae = 6.447212
Validation band_gap mae = 6.447212
Epoch 72
Validation mae = 6.488452
Validation band_gap mae = 6.488452
Epoch 73
Validation mae = 6.512024
Validation band_gap mae = 6.512024
Epoch 74
Validation mae = 6.453050
Validation band_gap mae = 6.453050
Epoch 75
Validation mae = 6.472831
Validation band_gap mae = 6.472831
Epoch 76
Validation mae = 6.563699
Validation band_gap mae = 6.563699
Epoch 77
Validation mae = 6.493696
Validation band_gap mae = 6.493696
Epoch 78
Validation mae = 6.502948
Validation band_gap mae = 6.502948
Epoch 79
Validation mae = 6.493403
Validation band_gap mae = 6.493403
Epoch 80
Validation mae = 6.504962
Validation band_gap mae = 6.504962
Epoch 81
Validation mae = 6.514566
Validation band_gap mae = 6.514566
Epoch 82
Validation mae = 6.584208
Validation band_gap mae = 6.584208
Epoch 83
Validation mae = 6.453208
Validation band_gap mae = 6.453208
Epoch 84
Validation mae = 6.552199
Validation band_gap mae = 6.552199
Epoch 85
Validation mae = 6.501470
Validation band_gap mae = 6.501470
Epoch 86
Validation mae = 6.635782
Validation band_gap mae = 6.635782
Epoch 87
Validation mae = 6.415430
Validation band_gap mae = 6.415430
Epoch 88
Validation mae = 6.563185
Validation band_gap mae = 6.563185
Epoch 89
Validation mae = 6.447950
Validation band_gap mae = 6.447950
Epoch 90
Validation mae = 6.527044
Validation band_gap mae = 6.527044
Epoch 91
Validation mae = 6.568138
Validation band_gap mae = 6.568138
Epoch 92
Validation mae = 6.520041
Validation band_gap mae = 6.520041
Epoch 93
Validation mae = 6.636579
Validation band_gap mae = 6.636579
Epoch 94
Validation mae = 6.534628
Validation band_gap mae = 6.534628
Epoch 95
Validation mae = 6.450479
Validation band_gap mae = 6.450479
Epoch 96
Validation mae = 6.634772
Validation band_gap mae = 6.634772
Epoch 97
Validation mae = 6.469177
Validation band_gap mae = 6.469177
Epoch 98
Validation mae = 6.672636
Validation band_gap mae = 6.672636
Epoch 99
Validation mae = 6.437441
Validation band_gap mae = 6.437441
Model 0 best validation mae = 6.965872 on epoch 12
Moving model to cuda
Model 0 test mae = 4.050971
Model 0 test band_gap mae = 4.050971
Ensemble test mae = 4.050971
Ensemble test band_gap mae = 4.050971
==================== fold 2 ====================
(array([  0,   3,   4,   5,   6,   7,   8,   9,  11,  12,  13,  14,  15,
        16,  17,  19,  21,  22,  23,  24,  25,  26,  27,  28,  29,  30,
        31,  32,  33,  34,  35,  36,  37,  38,  40,  41,  42,  43,  44,
        46,  47,  48,  51,  52,  53,  55,  56,  57,  58,  59,  60,  61,
        62,  63,  64,  65,  66,  67,  69,  70,  72,  73,  74,  76,  77,
        78,  79,  80,  81,  82,  83,  84,  86,  87,  88,  89,  90,  91,
        92,  93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103, 104,
       106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118,
       119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131,
       132, 133, 134, 135, 136, 137, 138, 139, 141, 142, 143, 144, 145,
       146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 157, 158, 159,
       160, 161, 163, 164, 165, 166, 168, 169, 170, 171, 173, 174, 175,
       176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188,
       189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201,
       203, 204, 205, 206, 207, 208, 209, 211, 212, 213, 214, 215, 216,
       217, 218, 219, 220, 221, 223, 224, 225, 226, 227, 228, 229, 230,
       231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243,
       244, 245, 246, 247, 248, 250, 251, 252, 253, 254, 256, 257, 259,
       260, 261, 262, 263, 265, 266, 267, 268, 269, 270, 272, 273, 274,
       275, 276, 277, 278, 279, 280, 281, 282, 284, 286, 287, 288, 289,
       290, 291, 292, 293, 294, 295, 296, 297, 298, 300, 301, 302, 303,
       305, 306, 307, 308, 309, 310, 311, 313, 314, 315, 316, 317, 318,
       319, 320, 321, 322, 323, 324, 326, 327, 328, 329, 331, 332, 333,
       334, 335, 336, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347,
       348, 349, 350, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361,
       362, 363, 364, 365, 367, 368, 369, 370, 371, 372, 373, 374, 375,
       376, 377, 379, 380, 381, 382, 383, 385, 386, 387, 388, 389, 390,
       391, 392, 393, 394, 396, 397, 398, 399, 400, 401, 402, 403, 404,
       405, 406, 407, 408, 410, 411, 413, 414, 415, 416, 417, 419, 420,
       421, 422, 423, 425, 426, 427, 428, 429, 430, 431, 433, 434, 435,
       436, 437, 438, 439, 440, 441, 442, 444, 445, 446, 447, 448, 449,
       450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462,
       463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475,
       476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488,
       490, 491, 493, 495, 497, 498, 499, 500, 501, 502, 503, 504, 505,
       507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 521,
       522, 523, 524, 525, 527, 528, 529, 530, 531, 532, 534, 535, 536,
       537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549,
       550, 551, 552, 553, 554, 555, 556, 558, 559, 560, 561, 562, 563,
       564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576,
       577, 578, 579, 581, 582, 583, 584, 585, 586, 587, 589, 590, 591,
       593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 606,
       607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619,
       620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 632, 633,
       634, 635, 637, 638, 639, 640, 641, 642, 643, 644, 645, 647, 648,
       649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 662,
       663, 664, 665, 666, 667, 668, 669, 670, 672, 673, 674, 675, 676,
       677, 678, 679, 680, 681, 683, 684, 685, 687, 688, 689, 690, 691,
       692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704,
       705, 707, 708, 709, 710, 711, 713, 714, 716, 717, 718, 719, 720,
       722, 723, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 736,
       737, 738, 739, 740, 741, 743, 744, 745, 746, 747, 748, 749, 751,
       752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764,
       765, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778,
       779, 780, 782, 783, 784, 785, 786, 787, 788, 790, 791, 792, 793,
       794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 807,
       808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 820, 822,
       823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835,
       836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848,
       849, 850, 851, 852, 854, 855, 857, 858, 859, 860, 861, 862, 863,
       864, 865, 866, 867, 868, 869, 870, 871, 873, 875, 876, 877, 878,
       879, 880, 881, 882, 883, 885, 886, 887, 889, 891, 892, 893, 894,
       895, 896, 897, 898, 899, 900, 902, 903, 904, 906, 907, 908, 909,
       910, 911, 912, 913, 914, 915, 916, 918, 919, 920, 921, 922, 923,
       924, 925, 926, 927, 929, 930, 931, 932, 933, 936, 937, 938, 939,
       940, 941, 942, 943]), array([  1,   2,  10,  18,  20,  39,  45,  49,  50,  54,  68,  71,  75,
        85, 105, 140, 156, 162, 167, 172, 202, 210, 222, 249, 255, 258,
       264, 271, 283, 285, 299, 304, 312, 325, 330, 337, 351, 366, 378,
       384, 395, 409, 412, 418, 424, 432, 443, 489, 492, 494, 496, 506,
       519, 520, 526, 533, 557, 580, 588, 592, 605, 631, 636, 646, 661,
       671, 682, 686, 706, 712, 715, 721, 724, 735, 742, 750, 766, 781,
       789, 806, 819, 821, 853, 856, 872, 874, 884, 888, 890, 901, 905,
       917, 928, 934, 935]))
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 3.805305
Validation band_gap mae = 3.805305
Epoch 1
Validation mae = 2.967531
Validation band_gap mae = 2.967531
Epoch 2
Validation mae = 3.473352
Validation band_gap mae = 3.473352
Epoch 3
Validation mae = 3.385104
Validation band_gap mae = 3.385104
Epoch 4
Validation mae = 2.941102
Validation band_gap mae = 2.941102
Epoch 5
Validation mae = 3.135876
Validation band_gap mae = 3.135876
Epoch 6
Validation mae = 3.429634
Validation band_gap mae = 3.429634
Epoch 7
Validation mae = 3.428818
Validation band_gap mae = 3.428818
Epoch 8
Validation mae = 2.970191
Validation band_gap mae = 2.970191
Epoch 9
Validation mae = 2.983065
Validation band_gap mae = 2.983065
Epoch 10
Validation mae = 3.626962
Validation band_gap mae = 3.626962
Epoch 11
Validation mae = 3.231036
Validation band_gap mae = 3.231036
Epoch 12
Validation mae = 2.888901
Validation band_gap mae = 2.888901
Epoch 13
Validation mae = 3.043492
Validation band_gap mae = 3.043492
Epoch 14
Validation mae = 2.883379
Validation band_gap mae = 2.883379
Epoch 15
Validation mae = 2.711967
Validation band_gap mae = 2.711967
Epoch 16
Validation mae = 2.898050
Validation band_gap mae = 2.898050
Epoch 17
Validation mae = 3.097488
Validation band_gap mae = 3.097488
Epoch 18
Validation mae = 3.119180
Validation band_gap mae = 3.119180
Epoch 19
Validation mae = 3.205431
Validation band_gap mae = 3.205431
Epoch 20
Validation mae = 2.827617
Validation band_gap mae = 2.827617
Epoch 21
Validation mae = 2.712976
Validation band_gap mae = 2.712976
Epoch 22
Validation mae = 2.590239
Validation band_gap mae = 2.590239
Epoch 23
Validation mae = 2.457691
Validation band_gap mae = 2.457691
Epoch 24
Validation mae = 2.341062
Validation band_gap mae = 2.341062
Epoch 25
Validation mae = 2.789495
Validation band_gap mae = 2.789495
Epoch 26
Validation mae = 2.820039
Validation band_gap mae = 2.820039
Epoch 27
Validation mae = 2.929578
Validation band_gap mae = 2.929578
Epoch 28
Validation mae = 2.999527
Validation band_gap mae = 2.999527
Epoch 29
Validation mae = 2.794257
Validation band_gap mae = 2.794257
Epoch 30
Validation mae = 3.153384
Validation band_gap mae = 3.153384
Epoch 31
Validation mae = 2.587039
Validation band_gap mae = 2.587039
Epoch 32
Validation mae = 2.576984
Validation band_gap mae = 2.576984
Epoch 33
Validation mae = 2.834930
Validation band_gap mae = 2.834930
Epoch 34
Validation mae = 2.464967
Validation band_gap mae = 2.464967
Epoch 35
Validation mae = 2.845098
Validation band_gap mae = 2.845098
Epoch 36
Validation mae = 2.383252
Validation band_gap mae = 2.383252
Epoch 37
Validation mae = 3.063226
Validation band_gap mae = 3.063226
Epoch 38
Validation mae = 2.902067
Validation band_gap mae = 2.902067
Epoch 39
Validation mae = 2.828973
Validation band_gap mae = 2.828973
Epoch 40
Validation mae = 3.264066
Validation band_gap mae = 3.264066
Epoch 41
Validation mae = 2.752597
Validation band_gap mae = 2.752597
Epoch 42
Validation mae = 2.765454
Validation band_gap mae = 2.765454
Epoch 43
Validation mae = 3.168369
Validation band_gap mae = 3.168369
Epoch 44
Validation mae = 3.029651
Validation band_gap mae = 3.029651
Epoch 45
Validation mae = 2.870688
Validation band_gap mae = 2.870688
Epoch 46
Validation mae = 2.600186
Validation band_gap mae = 2.600186
Epoch 47
Validation mae = 2.368306
Validation band_gap mae = 2.368306
Epoch 48
Validation mae = 2.928391
Validation band_gap mae = 2.928391
Epoch 49
Validation mae = 2.618355
Validation band_gap mae = 2.618355
Epoch 50
Validation mae = 3.250107
Validation band_gap mae = 3.250107
Epoch 51
Validation mae = 2.780617
Validation band_gap mae = 2.780617
Epoch 52
Validation mae = 2.621754
Validation band_gap mae = 2.621754
Epoch 53
Validation mae = 2.805217
Validation band_gap mae = 2.805217
Epoch 54
Validation mae = 3.122375
Validation band_gap mae = 3.122375
Epoch 55
Validation mae = 2.837278
Validation band_gap mae = 2.837278
Epoch 56
Validation mae = 2.746148
Validation band_gap mae = 2.746148
Epoch 57
Validation mae = 2.956165
Validation band_gap mae = 2.956165
Epoch 58
Validation mae = 2.680098
Validation band_gap mae = 2.680098
Epoch 59
Validation mae = 2.770921
Validation band_gap mae = 2.770921
Epoch 60
Validation mae = 2.814156
Validation band_gap mae = 2.814156
Epoch 61
Validation mae = 2.759841
Validation band_gap mae = 2.759841
Epoch 62
Validation mae = 2.807957
Validation band_gap mae = 2.807957
Epoch 63
Validation mae = 2.987869
Validation band_gap mae = 2.987869
Epoch 64
Validation mae = 2.562492
Validation band_gap mae = 2.562492
Epoch 65
Validation mae = 3.011950
Validation band_gap mae = 3.011950
Epoch 66
Validation mae = 2.978090
Validation band_gap mae = 2.978090
Epoch 67
Validation mae = 2.606479
Validation band_gap mae = 2.606479
Epoch 68
Validation mae = 2.776380
Validation band_gap mae = 2.776380
Epoch 69
Validation mae = 2.807402
Validation band_gap mae = 2.807402
Epoch 70
Validation mae = 2.732613
Validation band_gap mae = 2.732613
Epoch 71
Validation mae = 2.734625
Validation band_gap mae = 2.734625
Epoch 72
Validation mae = 2.740666
Validation band_gap mae = 2.740666
Epoch 73
Validation mae = 2.725247
Validation band_gap mae = 2.725247
Epoch 74
Validation mae = 2.753222
Validation band_gap mae = 2.753222
Epoch 75
Validation mae = 2.747094
Validation band_gap mae = 2.747094
Epoch 76
Validation mae = 2.773980
Validation band_gap mae = 2.773980
Epoch 77
Validation mae = 2.755222
Validation band_gap mae = 2.755222
Epoch 78
Validation mae = 2.771750
Validation band_gap mae = 2.771750
Epoch 79
Validation mae = 2.773203
Validation band_gap mae = 2.773203
Epoch 80
Validation mae = 2.791480
Validation band_gap mae = 2.791480
Epoch 81
Validation mae = 2.793799
Validation band_gap mae = 2.793799
Epoch 82
Validation mae = 2.801503
Validation band_gap mae = 2.801503
Epoch 83
Validation mae = 2.805493
Validation band_gap mae = 2.805493
Epoch 84
Validation mae = 2.822569
Validation band_gap mae = 2.822569
Epoch 85
Validation mae = 2.793059
Validation band_gap mae = 2.793059
Epoch 86
Validation mae = 2.787399
Validation band_gap mae = 2.787399
Epoch 87
Validation mae = 2.782066
Validation band_gap mae = 2.782066
Epoch 88
Validation mae = 2.794587
Validation band_gap mae = 2.794587
Epoch 89
Validation mae = 2.788927
Validation band_gap mae = 2.788927
Epoch 90
Validation mae = 2.777408
Validation band_gap mae = 2.777408
Epoch 91
Validation mae = 2.794798
Validation band_gap mae = 2.794798
Epoch 92
Validation mae = 2.804430
Validation band_gap mae = 2.804430
Epoch 93
Validation mae = 2.794809
Validation band_gap mae = 2.794809
Epoch 94
Validation mae = 2.795538
Validation band_gap mae = 2.795538
Epoch 95
Validation mae = 2.802812
Validation band_gap mae = 2.802812
Epoch 96
Validation mae = 2.821852
Validation band_gap mae = 2.821852
Epoch 97
Validation mae = 2.793145
Validation band_gap mae = 2.793145
Epoch 98
Validation mae = 2.813804
Validation band_gap mae = 2.813804
Epoch 99
Validation mae = 2.795374
Validation band_gap mae = 2.795374
Model 0 best validation mae = 3.805305 on epoch 0
Moving model to cuda
Model 0 test mae = 1.941437
Model 0 test band_gap mae = 1.941437
Ensemble test mae = 1.941437
Ensemble test band_gap mae = 1.941437
==================== fold 3 ====================
(array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  13,
        14,  15,  16,  18,  19,  20,  22,  23,  24,  25,  26,  27,  28,
        29,  30,  31,  32,  33,  34,  36,  37,  38,  39,  40,  41,  42,
        43,  44,  45,  46,  47,  49,  50,  51,  53,  54,  55,  56,  57,
        58,  59,  60,  61,  62,  63,  65,  66,  67,  68,  69,  70,  71,
        72,  73,  74,  75,  77,  79,  80,  82,  83,  84,  85,  86,  87,
        88,  89,  90,  91,  93,  94,  95,  96,  97,  98,  99, 100, 101,
       102, 103, 104, 105, 106, 107, 108, 110, 111, 112, 113, 114, 115,
       117, 119, 120, 121, 122, 123, 125, 126, 128, 129, 130, 131, 132,
       133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145,
       146, 147, 148, 149, 150, 151, 152, 153, 154, 156, 158, 160, 161,
       162, 163, 164, 166, 167, 168, 169, 171, 172, 173, 174, 175, 176,
       177, 178, 179, 180, 181, 182, 183, 184, 185, 189, 190, 191, 192,
       193, 194, 195, 196, 197, 199, 200, 201, 202, 203, 204, 205, 206,
       207, 208, 209, 210, 212, 213, 214, 215, 216, 217, 218, 219, 220,
       221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233,
       234, 236, 237, 239, 240, 244, 245, 246, 247, 248, 249, 251, 252,
       253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 264, 265, 266,
       267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279,
       280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292,
       293, 294, 295, 296, 297, 298, 299, 300, 302, 303, 304, 305, 306,
       307, 308, 309, 310, 311, 312, 313, 314, 315, 319, 320, 321, 322,
       323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 334, 335, 336,
       337, 338, 339, 340, 341, 342, 343, 345, 346, 347, 348, 349, 350,
       351, 352, 353, 354, 355, 357, 358, 359, 360, 361, 362, 363, 364,
       365, 366, 368, 369, 370, 371, 373, 374, 375, 376, 377, 378, 379,
       381, 382, 383, 384, 385, 386, 387, 388, 389, 391, 392, 393, 394,
       395, 396, 397, 398, 399, 400, 401, 403, 404, 405, 406, 407, 408,
       409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421,
       423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435,
       436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448,
       449, 450, 452, 453, 454, 455, 457, 459, 460, 461, 462, 463, 464,
       465, 466, 467, 468, 469, 470, 471, 472, 473, 475, 476, 478, 480,
       481, 482, 483, 484, 485, 486, 488, 489, 490, 491, 492, 494, 495,
       496, 497, 498, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509,
       510, 511, 512, 513, 514, 515, 516, 517, 519, 520, 521, 522, 523,
       524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536,
       537, 539, 540, 541, 542, 543, 544, 545, 546, 547, 549, 550, 551,
       552, 553, 554, 555, 556, 557, 558, 559, 560, 562, 563, 564, 565,
       566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578,
       579, 580, 581, 582, 583, 584, 586, 587, 588, 589, 590, 591, 592,
       593, 594, 595, 596, 597, 598, 599, 600, 602, 603, 604, 605, 606,
       607, 608, 610, 611, 612, 613, 615, 616, 617, 618, 619, 620, 621,
       622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 635,
       636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648,
       649, 650, 651, 652, 653, 654, 656, 657, 658, 659, 660, 661, 662,
       663, 664, 665, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676,
       677, 678, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690,
       691, 693, 694, 695, 696, 697, 699, 700, 701, 702, 703, 704, 705,
       706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718,
       719, 720, 721, 722, 723, 724, 725, 726, 728, 729, 730, 731, 732,
       733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745,
       747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759,
       761, 762, 763, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774,
       775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 786, 788, 789,
       790, 791, 792, 793, 794, 795, 796, 797, 798, 800, 801, 802, 803,
       804, 805, 806, 807, 808, 810, 811, 812, 813, 814, 815, 816, 818,
       819, 820, 821, 822, 823, 824, 825, 826, 829, 830, 831, 832, 833,
       834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 845, 846, 847,
       849, 850, 851, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862,
       864, 866, 867, 868, 869, 871, 872, 873, 874, 875, 876, 877, 878,
       879, 880, 881, 882, 884, 885, 886, 887, 888, 889, 890, 891, 892,
       893, 894, 895, 896, 897, 899, 900, 901, 902, 903, 905, 907, 909,
       910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922,
       923, 924, 925, 927, 928, 930, 933, 934, 935, 936, 937, 938, 939,
       940, 941, 942, 943]), array([ 12,  17,  21,  35,  48,  52,  64,  76,  78,  81,  92, 109, 116,
       118, 124, 127, 155, 157, 159, 165, 170, 186, 187, 188, 198, 211,
       235, 238, 241, 242, 243, 250, 263, 301, 316, 317, 318, 333, 344,
       356, 367, 372, 380, 390, 402, 422, 451, 456, 458, 474, 477, 479,
       487, 493, 499, 518, 538, 548, 561, 585, 601, 609, 614, 634, 655,
       666, 679, 692, 698, 727, 746, 760, 764, 785, 787, 799, 809, 817,
       827, 828, 844, 848, 852, 863, 865, 870, 883, 898, 904, 906, 908,
       926, 929, 931, 932]))
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 2.588968
Validation band_gap mae = 2.588968
Epoch 1
Validation mae = 2.647647
Validation band_gap mae = 2.647647
Epoch 2
Validation mae = 2.629671
Validation band_gap mae = 2.629671
Epoch 3
Validation mae = 2.624415
Validation band_gap mae = 2.624415
Epoch 4
Validation mae = 2.647966
Validation band_gap mae = 2.647966
Epoch 5
Validation mae = 2.568025
Validation band_gap mae = 2.568025
Epoch 6
Validation mae = 2.627650
Validation band_gap mae = 2.627650
Epoch 7
Validation mae = 2.603348
Validation band_gap mae = 2.603348
Epoch 8
Validation mae = 2.643579
Validation band_gap mae = 2.643579
Epoch 9
Validation mae = 2.643453
Validation band_gap mae = 2.643453
Epoch 10
Validation mae = 2.620172
Validation band_gap mae = 2.620172
Epoch 11
Validation mae = 2.583252
Validation band_gap mae = 2.583252
Epoch 12
Validation mae = 2.586314
Validation band_gap mae = 2.586314
Epoch 13
Validation mae = 2.587028
Validation band_gap mae = 2.587028
Epoch 14
Validation mae = 2.602447
Validation band_gap mae = 2.602447
Epoch 15
Validation mae = 2.604172
Validation band_gap mae = 2.604172
Epoch 16
Validation mae = 2.590829
Validation band_gap mae = 2.590829
Epoch 17
Validation mae = 2.572275
Validation band_gap mae = 2.572275
Epoch 18
Validation mae = 2.637423
Validation band_gap mae = 2.637423
Epoch 19
Validation mae = 2.582719
Validation band_gap mae = 2.582719
Epoch 20
Validation mae = 2.700959
Validation band_gap mae = 2.700959
Epoch 21
Validation mae = 2.678793
Validation band_gap mae = 2.678793
Epoch 22
Validation mae = 2.669110
Validation band_gap mae = 2.669110
Epoch 23
Validation mae = 2.602848
Validation band_gap mae = 2.602848
Epoch 24
Validation mae = 2.589848
Validation band_gap mae = 2.589848
Epoch 25
Validation mae = 2.601928
Validation band_gap mae = 2.601928
Epoch 26
Validation mae = 2.594761
Validation band_gap mae = 2.594761
Epoch 27
Validation mae = 2.594829
Validation band_gap mae = 2.594829
Epoch 28
Validation mae = 2.649430
Validation band_gap mae = 2.649430
Epoch 29
Validation mae = 2.656893
Validation band_gap mae = 2.656893
Epoch 30
Validation mae = 2.607603
Validation band_gap mae = 2.607603
Epoch 31
Validation mae = 2.649010
Validation band_gap mae = 2.649010
Epoch 32
Validation mae = 2.620742
Validation band_gap mae = 2.620742
Epoch 33
Validation mae = 2.590980
Validation band_gap mae = 2.590980
Epoch 34
Validation mae = 2.600823
Validation band_gap mae = 2.600823
Epoch 35
Validation mae = 2.599447
Validation band_gap mae = 2.599447
Epoch 36
Validation mae = 2.615040
Validation band_gap mae = 2.615040
Epoch 37
Validation mae = 2.740370
Validation band_gap mae = 2.740370
Epoch 38
Validation mae = 2.629414
Validation band_gap mae = 2.629414
Epoch 39
Validation mae = 2.656558
Validation band_gap mae = 2.656558
Epoch 40
Validation mae = 2.597592
Validation band_gap mae = 2.597592
Epoch 41
Validation mae = 2.579626
Validation band_gap mae = 2.579626
Epoch 42
Validation mae = 2.588814
Validation band_gap mae = 2.588814
Epoch 43
Validation mae = 2.582588
Validation band_gap mae = 2.582588
Epoch 44
Validation mae = 2.591658
Validation band_gap mae = 2.591658
Epoch 45
Validation mae = 2.649685
Validation band_gap mae = 2.649685
Epoch 46
Validation mae = 2.634261
Validation band_gap mae = 2.634261
Epoch 47
Validation mae = 2.721654
Validation band_gap mae = 2.721654
Epoch 48
Validation mae = 2.659338
Validation band_gap mae = 2.659338
Epoch 49
Validation mae = 2.612478
Validation band_gap mae = 2.612478
Epoch 50
Validation mae = 2.580002
Validation band_gap mae = 2.580002
Epoch 51
Validation mae = 2.628476
Validation band_gap mae = 2.628476
Epoch 52
Validation mae = 2.604502
Validation band_gap mae = 2.604502
Epoch 53
Validation mae = 2.645081
Validation band_gap mae = 2.645081
Epoch 54
Validation mae = 2.609246
Validation band_gap mae = 2.609246
Epoch 55
Validation mae = 2.609182
Validation band_gap mae = 2.609182
Epoch 56
Validation mae = 2.606751
Validation band_gap mae = 2.606751
Epoch 57
Validation mae = 2.621364
Validation band_gap mae = 2.621364
Epoch 58
Validation mae = 2.675093
Validation band_gap mae = 2.675093
Epoch 59
Validation mae = 2.606996
Validation band_gap mae = 2.606996
Epoch 60
Validation mae = 2.634802
Validation band_gap mae = 2.634802
Epoch 61
Validation mae = 2.615662
Validation band_gap mae = 2.615662
Epoch 62
Validation mae = 2.723577
Validation band_gap mae = 2.723577
Epoch 63
Validation mae = 2.597884
Validation band_gap mae = 2.597884
Epoch 64
Validation mae = 2.577773
Validation band_gap mae = 2.577773
Epoch 65
Validation mae = 2.630134
Validation band_gap mae = 2.630134
Epoch 66
Validation mae = 2.628736
Validation band_gap mae = 2.628736
Epoch 67
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
(array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,
        13,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,
        27,  28,  29,  30,  32,  33,  34,  35,  36,  37,  38,  39,  40,
        41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,
        54,  56,  57,  58,  59,  61,  62,  63,  64,  66,  67,  68,  69,
        70,  71,  72,  73,  74,  75,  76,  78,  79,  80,  81,  82,  83,
        84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,
        98,  99, 100, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111,
       112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 123, 124, 125,
       126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138,
       139, 140, 143, 144, 146, 147, 148, 149, 150, 151, 152, 153, 154,
       155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167,
       168, 169, 170, 171, 172, 173, 174, 176, 177, 178, 179, 180, 181,
       182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194,
       195, 197, 198, 199, 201, 202, 203, 204, 205, 206, 207, 208, 209,
       210, 211, 212, 213, 214, 216, 217, 218, 219, 220, 221, 222, 223,
       224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236,
       237, 238, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251,
       253, 254, 255, 256, 257, 258, 259, 260, 263, 264, 265, 266, 267,
       268, 269, 270, 271, 273, 274, 275, 276, 277, 278, 280, 281, 282,
       283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 296,
       297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309,
       311, 312, 313, 314, 315, 316, 317, 318, 320, 321, 322, 323, 324,
       325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337,
       339, 340, 341, 343, 344, 347, 348, 349, 350, 351, 353, 354, 355,
       356, 357, 358, 359, 360, 361, 365, 366, 367, 368, 369, 370, 371,
       372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 383, 384, 387,
       388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400,
       401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 414,
       417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429,
       430, 431, 432, 433, 435, 437, 438, 439, 440, 441, 442, 443, 444,
       445, 446, 447, 448, 449, 450, 451, 453, 454, 455, 456, 457, 458,
       459, 460, 461, 462, 463, 464, 466, 467, 468, 469, 470, 471, 472,
       473, 474, 475, 476, 477, 479, 480, 481, 482, 484, 486, 487, 488,
       489, 490, 491, 492, 493, 494, 496, 497, 498, 499, 500, 501, 502,
       503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515,
       517, 518, 519, 520, 523, 525, 526, 527, 528, 530, 531, 532, 533,
       534, 536, 537, 538, 539, 540, 541, 542, 543, 544, 546, 547, 548,
       550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562,
       563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575,
       576, 577, 578, 579, 580, 581, 583, 584, 585, 586, 587, 588, 589,
       590, 591, 592, 593, 594, 595, 596, 598, 599, 600, 601, 603, 604,
       605, 606, 607, 609, 610, 611, 613, 614, 615, 616, 617, 619, 620,
       621, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634,
       635, 636, 637, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648,
       649, 650, 651, 652, 653, 655, 657, 658, 659, 660, 661, 662, 663,
       664, 665, 666, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677,
       678, 679, 680, 681, 682, 683, 684, 685, 686, 689, 690, 691, 692,
       693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705,
       706, 707, 709, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720,
       721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733,
       734, 735, 736, 738, 739, 742, 743, 744, 745, 746, 747, 748, 749,
       750, 751, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764,
       765, 766, 767, 768, 770, 771, 772, 774, 775, 776, 777, 778, 779,
       780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792,
       793, 794, 795, 796, 797, 799, 800, 801, 802, 803, 804, 805, 806,
       807, 808, 809, 811, 813, 814, 816, 817, 818, 819, 820, 821, 823,
       824, 825, 826, 827, 828, 830, 831, 832, 833, 834, 835, 836, 838,
       839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851,
       852, 853, 854, 856, 857, 859, 860, 861, 862, 863, 864, 865, 866,
       868, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881,
       882, 883, 884, 886, 887, 888, 889, 890, 892, 893, 894, 895, 896,
       897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909,
       910, 911, 912, 913, 914, 915, 916, 917, 918, 920, 921, 922, 923,
       924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936,
       937, 938, 939, 942]), array([ 14,  31,  55,  60,  65,  77,  97, 101, 122, 141, 142, 145, 175,
       196, 200, 215, 239, 240, 252, 261, 262, 272, 279, 295, 310, 319,
       338, 342, 345, 346, 352, 362, 363, 364, 382, 385, 386, 413, 415,
       416, 434, 436, 452, 465, 478, 483, 485, 495, 516, 521, 522, 524,
       529, 535, 545, 549, 582, 597, 602, 608, 612, 618, 622, 638, 654,
       656, 667, 687, 688, 708, 710, 737, 740, 741, 752, 753, 769, 773,
       798, 810, 812, 815, 822, 829, 837, 855, 858, 867, 869, 885, 891,
       919, 940, 941, 943]))
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 8.410856
Validation band_gap mae = 8.410856
Epoch 1
Validation mae = 10.227607
Validation band_gap mae = 10.227607
Epoch 2
Validation mae = 7.828312
Validation band_gap mae = 7.828312
Epoch 3
Validation mae = 6.730628
Validation band_gap mae = 6.730628
Epoch 4
Validation mae = 7.512634
Validation band_gap mae = 7.512634
Epoch 5
Validation mae = 5.229483
Validation band_gap mae = 5.229483
Epoch 6
Validation mae = 6.224441
Validation band_gap mae = 6.224441
Epoch 7
Validation mae = 4.652502
Validation band_gap mae = 4.652502
Epoch 8
Validation mae = 4.922224
Validation band_gap mae = 4.922224
Epoch 9
Validation mae = 7.912606
Validation band_gap mae = 7.912606
Epoch 10
Validation mae = 5.916683
Validation band_gap mae = 5.916683
Epoch 11
Validation mae = 5.941894
Validation band_gap mae = 5.941894
Epoch 12
Validation mae = 6.035297
Validation band_gap mae = 6.035297
Epoch 13
Validation mae = 6.426341
Validation band_gap mae = 6.426341
Epoch 14
Validation mae = 5.454811
Validation band_gap mae = 5.454811
Epoch 15
Loading data
Number of tasks = 1
Splitting data with seed 0
==================== fold 0 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 8.487501
Validation band_gap mae = 8.487501
Epoch 1
Validation mae = 8.586991
Validation band_gap mae = 8.586991
Epoch 2
Validation mae = 5.802084
Validation band_gap mae = 5.802084
Epoch 3
Validation mae = 4.705036
Validation band_gap mae = 4.705036
Epoch 4
Validation mae = 3.740771
Validation band_gap mae = 3.740771
Epoch 5
Validation mae = 4.537836
Validation band_gap mae = 4.537836
Epoch 6
Validation mae = 4.839203
Validation band_gap mae = 4.839203
Epoch 7
Validation mae = 4.694822
Validation band_gap mae = 4.694822
Epoch 8
Validation mae = 4.096123
Validation band_gap mae = 4.096123
Epoch 9
Validation mae = 4.018055
Validation band_gap mae = 4.018055
Epoch 10
Validation mae = 5.084150
Validation band_gap mae = 5.084150
Epoch 11
Validation mae = 4.607025
Validation band_gap mae = 4.607025
Epoch 12
Validation mae = 4.144330
Validation band_gap mae = 4.144330
Epoch 13
Validation mae = 5.715162
Validation band_gap mae = 5.715162
Epoch 14
Validation mae = 5.253428
Validation band_gap mae = 5.253428
Epoch 15
Validation mae = 4.236785
Validation band_gap mae = 4.236785
Epoch 16
Validation mae = 4.088872
Validation band_gap mae = 4.088872
Epoch 17
Validation mae = 4.056258
Validation band_gap mae = 4.056258
Epoch 18
Validation mae = 3.803684
Validation band_gap mae = 3.803684
Epoch 19
Validation mae = 4.262343
Validation band_gap mae = 4.262343
Epoch 20
Validation mae = 4.592511
Validation band_gap mae = 4.592511
Epoch 21
Validation mae = 5.165266
Validation band_gap mae = 5.165266
Epoch 22
Loading data
Number of tasks = 1
Splitting data with seed 1
==================== fold 0 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 8.844806
Validation band_gap mae = 8.844806
Epoch 1
Validation mae = 7.022217
Validation band_gap mae = 7.022217
Epoch 2
Validation mae = 7.038258
Validation band_gap mae = 7.038258
Epoch 3
Validation mae = 5.371762
Validation band_gap mae = 5.371762
Epoch 4
Validation mae = 4.794957
Validation band_gap mae = 4.794957
Epoch 5
Validation mae = 4.391496
Validation band_gap mae = 4.391496
Epoch 6
Validation mae = 5.167942
Validation band_gap mae = 5.167942
Epoch 7
Validation mae = 4.242573
Validation band_gap mae = 4.242573
Epoch 8
Validation mae = 3.510026
Validation band_gap mae = 3.510026
Epoch 9
Validation mae = 4.437951
Validation band_gap mae = 4.437951
Epoch 10
Validation mae = 5.197348
Validation band_gap mae = 5.197348
Epoch 11
Validation mae = 5.468074
Validation band_gap mae = 5.468074
Epoch 12
Validation mae = 3.735607
Validation band_gap mae = 3.735607
Epoch 13
Validation mae = 4.348027
Validation band_gap mae = 4.348027
Epoch 14
Validation mae = 4.065316
Validation band_gap mae = 4.065316
Epoch 15
Validation mae = 3.868633
Validation band_gap mae = 3.868633
Epoch 16
Validation mae = 4.556395
Validation band_gap mae = 4.556395
Epoch 17
Validation mae = 3.583880
Validation band_gap mae = 3.583880
Epoch 18
Validation mae = 3.649533
Validation band_gap mae = 3.649533
Epoch 19
Validation mae = 4.197287
Validation band_gap mae = 4.197287
Epoch 20
Validation mae = 3.683905
Validation band_gap mae = 3.683905
Epoch 21
Validation mae = 3.688421
Validation band_gap mae = 3.688421
Epoch 22
Validation mae = 4.031616
Validation band_gap mae = 4.031616
Epoch 23
Validation mae = 3.632900
Validation band_gap mae = 3.632900
Epoch 24
Validation mae = 3.340662
Validation band_gap mae = 3.340662
Epoch 25
Validation mae = 3.482933
Validation band_gap mae = 3.482933
Epoch 26
Validation mae = 3.976538
Validation band_gap mae = 3.976538
Epoch 27
Validation mae = 3.594638
Validation band_gap mae = 3.594638
Epoch 28
Validation mae = 3.647011
Validation band_gap mae = 3.647011
Epoch 29
Validation mae = 3.571244
Validation band_gap mae = 3.571244
Epoch 30
Validation mae = 3.383212
Validation band_gap mae = 3.383212
Epoch 31
Validation mae = 3.444903
Validation band_gap mae = 3.444903
Epoch 32
Validation mae = 3.295676
Validation band_gap mae = 3.295676
Epoch 33
Validation mae = 3.522638
Validation band_gap mae = 3.522638
Epoch 34
Validation mae = 3.321946
Validation band_gap mae = 3.321946
Epoch 35
Validation mae = 3.298339
Validation band_gap mae = 3.298339
Epoch 36
Validation mae = 3.209530
Validation band_gap mae = 3.209530
Epoch 37
Validation mae = 3.368225
Validation band_gap mae = 3.368225
Epoch 38
Validation mae = 2.931392
Validation band_gap mae = 2.931392
Epoch 39
Validation mae = 3.119526
Validation band_gap mae = 3.119526
Epoch 40
Validation mae = 2.891222
Validation band_gap mae = 2.891222
Epoch 41
Validation mae = 3.228718
Validation band_gap mae = 3.228718
Epoch 42
Validation mae = 3.204355
Validation band_gap mae = 3.204355
Epoch 43
Validation mae = 3.288801
Validation band_gap mae = 3.288801
Epoch 44
Validation mae = 3.238405
Validation band_gap mae = 3.238405
Epoch 45
Validation mae = 3.283897
Validation band_gap mae = 3.283897
Epoch 46
Validation mae = 3.141907
Validation band_gap mae = 3.141907
Epoch 47
Validation mae = 3.109373
Validation band_gap mae = 3.109373
Epoch 48
Validation mae = 2.941472
Validation band_gap mae = 2.941472
Epoch 49
Validation mae = 3.681771
Validation band_gap mae = 3.681771
Epoch 50
Validation mae = 3.321274
Validation band_gap mae = 3.321274
Epoch 51
Validation mae = 3.186580
Validation band_gap mae = 3.186580
Epoch 52
Validation mae = 3.326978
Validation band_gap mae = 3.326978
Epoch 53
Validation mae = 3.065315
Validation band_gap mae = 3.065315
Epoch 54
Validation mae = 3.073553
Validation band_gap mae = 3.073553
Epoch 55
Validation mae = 3.018226
Validation band_gap mae = 3.018226
Epoch 56
Validation mae = 3.197618
Validation band_gap mae = 3.197618
Epoch 57
Validation mae = 3.179371
Validation band_gap mae = 3.179371
Epoch 58
Validation mae = 3.064287
Validation band_gap mae = 3.064287
Epoch 59
Validation mae = 3.139190
Validation band_gap mae = 3.139190
Epoch 60
Validation mae = 3.252721
Validation band_gap mae = 3.252721
Epoch 61
Validation mae = 3.246248
Validation band_gap mae = 3.246248
Epoch 62
Validation mae = 3.005420
Validation band_gap mae = 3.005420
Epoch 63
Validation mae = 3.149148
Validation band_gap mae = 3.149148
Epoch 64
Validation mae = 3.265705
Validation band_gap mae = 3.265705
Epoch 65
Validation mae = 3.215170
Validation band_gap mae = 3.215170
Epoch 66
Validation mae = 3.287849
Validation band_gap mae = 3.287849
Epoch 67
Validation mae = 3.212786
Validation band_gap mae = 3.212786
Epoch 68
Validation mae = 3.128678
Validation band_gap mae = 3.128678
Epoch 69
Validation mae = 3.531765
Validation band_gap mae = 3.531765
Epoch 70
Validation mae = 3.368180
Validation band_gap mae = 3.368180
Epoch 71
Validation mae = 3.477344
Validation band_gap mae = 3.477344
Epoch 72
Validation mae = 3.115994
Validation band_gap mae = 3.115994
Epoch 73
Validation mae = 3.242001
Validation band_gap mae = 3.242001
Epoch 74
Validation mae = 3.020810
Validation band_gap mae = 3.020810
Epoch 75
Validation mae = 3.080739
Validation band_gap mae = 3.080739
Epoch 76
Validation mae = 3.081464
Validation band_gap mae = 3.081464
Epoch 77
Validation mae = 3.247395
Validation band_gap mae = 3.247395
Epoch 78
Validation mae = 3.108301
Validation band_gap mae = 3.108301
Epoch 79
Validation mae = 3.201906
Validation band_gap mae = 3.201906
Epoch 80
Validation mae = 3.025440
Validation band_gap mae = 3.025440
Epoch 81
Validation mae = 3.538562
Validation band_gap mae = 3.538562
Epoch 82
Validation mae = 3.222348
Validation band_gap mae = 3.222348
Epoch 83
Validation mae = 3.181490
Validation band_gap mae = 3.181490
Epoch 84
Validation mae = 3.139729
Validation band_gap mae = 3.139729
Epoch 85
Validation mae = 3.085358
Validation band_gap mae = 3.085358
Epoch 86
Validation mae = 3.166738
Validation band_gap mae = 3.166738
Epoch 87
Validation mae = 3.141533
Validation band_gap mae = 3.141533
Epoch 88
Validation mae = 3.220196
Validation band_gap mae = 3.220196
Epoch 89
Validation mae = 3.258156
Validation band_gap mae = 3.258156
Epoch 90
Validation mae = 3.136627
Validation band_gap mae = 3.136627
Epoch 91
Validation mae = 3.167926
Validation band_gap mae = 3.167926
Epoch 92
Validation mae = 3.213344
Validation band_gap mae = 3.213344
Epoch 93
Validation mae = 3.227583
Validation band_gap mae = 3.227583
Epoch 94
Validation mae = 3.273889
Validation band_gap mae = 3.273889
Epoch 95
Validation mae = 3.185333
Validation band_gap mae = 3.185333
Epoch 96
Validation mae = 3.324338
Validation band_gap mae = 3.324338
Epoch 97
Validation mae = 3.361436
Validation band_gap mae = 3.361436
Epoch 98
Validation mae = 3.182012
Validation band_gap mae = 3.182012
Epoch 99
Validation mae = 3.188683
Validation band_gap mae = 3.188683
Model 0 best validation mae = 8.844806 on epoch 0
Moving model to cuda
Model 0 test mae = 10.685177
Model 0 test band_gap mae = 10.685177
Ensemble test mae = 10.685177
Ensemble test band_gap mae = 10.685177
==================== fold 1 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 5.537660
Validation band_gap mae = 5.537660
Epoch 1
Validation mae = 6.113205
Validation band_gap mae = 6.113205
Epoch 2
Validation mae = 5.349712
Validation band_gap mae = 5.349712
Epoch 3
Validation mae = 5.345385
Validation band_gap mae = 5.345385
Epoch 4
Validation mae = 5.258065
Validation band_gap mae = 5.258065
Epoch 5
Validation mae = 6.006332
Validation band_gap mae = 6.006332
Epoch 6
Validation mae = 5.744996
Validation band_gap mae = 5.744996
Epoch 7
Validation mae = 5.065832
Validation band_gap mae = 5.065832
Epoch 8
Validation mae = 5.448891
Validation band_gap mae = 5.448891
Epoch 9
Validation mae = 5.599673
Validation band_gap mae = 5.599673
Epoch 10
Validation mae = 5.917313
Validation band_gap mae = 5.917313
Epoch 11
Validation mae = 5.249937
Validation band_gap mae = 5.249937
Epoch 12
Validation mae = 5.492988
Validation band_gap mae = 5.492988
Epoch 13
Validation mae = 5.123137
Validation band_gap mae = 5.123137
Epoch 14
Validation mae = 5.244662
Validation band_gap mae = 5.244662
Epoch 15
Validation mae = 5.400838
Validation band_gap mae = 5.400838
Epoch 16
Validation mae = 6.067450
Validation band_gap mae = 6.067450
Epoch 17
Validation mae = 5.981310
Validation band_gap mae = 5.981310
Epoch 18
Validation mae = 5.814932
Validation band_gap mae = 5.814932
Epoch 19
Validation mae = 5.255113
Validation band_gap mae = 5.255113
Epoch 20
Validation mae = 5.652045
Validation band_gap mae = 5.652045
Epoch 21
Validation mae = 5.622634
Validation band_gap mae = 5.622634
Epoch 22
Validation mae = 5.498079
Validation band_gap mae = 5.498079
Epoch 23
Validation mae = 5.156862
Validation band_gap mae = 5.156862
Epoch 24
Validation mae = 5.437196
Validation band_gap mae = 5.437196
Epoch 25
Validation mae = 5.248517
Validation band_gap mae = 5.248517
Epoch 26
Validation mae = 5.412846
Validation band_gap mae = 5.412846
Epoch 27
Validation mae = 5.681083
Validation band_gap mae = 5.681083
Epoch 28
Validation mae = 5.888881
Validation band_gap mae = 5.888881
Epoch 29
Validation mae = 5.764461
Validation band_gap mae = 5.764461
Epoch 30
Validation mae = 5.242200
Validation band_gap mae = 5.242200
Epoch 31
Validation mae = 5.409272
Validation band_gap mae = 5.409272
Epoch 32
Validation mae = 5.561346
Validation band_gap mae = 5.561346
Epoch 33
Validation mae = 5.895256
Validation band_gap mae = 5.895256
Epoch 34
Validation mae = 5.456680
Validation band_gap mae = 5.456680
Epoch 35
Validation mae = 5.492640
Validation band_gap mae = 5.492640
Epoch 36
Validation mae = 5.384039
Validation band_gap mae = 5.384039
Epoch 37
Validation mae = 5.438049
Validation band_gap mae = 5.438049
Epoch 38
Validation mae = 6.393276
Validation band_gap mae = 6.393276
Epoch 39
Validation mae = 5.219223
Validation band_gap mae = 5.219223
Epoch 40
Validation mae = 5.120539
Validation band_gap mae = 5.120539
Epoch 41
Validation mae = 5.373913
Validation band_gap mae = 5.373913
Epoch 42
Validation mae = 5.675193
Validation band_gap mae = 5.675193
Epoch 43
Validation mae = 5.392434
Validation band_gap mae = 5.392434
Epoch 44
Validation mae = 5.257757
Validation band_gap mae = 5.257757
Epoch 45
Validation mae = 5.266656
Validation band_gap mae = 5.266656
Epoch 46
Validation mae = 6.224673
Validation band_gap mae = 6.224673
Epoch 47
Validation mae = 5.862710
Validation band_gap mae = 5.862710
Epoch 48
Validation mae = 5.753746
Validation band_gap mae = 5.753746
Epoch 49
Validation mae = 5.484511
Validation band_gap mae = 5.484511
Epoch 50
Validation mae = 5.326793
Validation band_gap mae = 5.326793
Epoch 51
Validation mae = 5.974968
Validation band_gap mae = 5.974968
Epoch 52
Validation mae = 5.448458
Validation band_gap mae = 5.448458
Epoch 53
Validation mae = 5.277877
Validation band_gap mae = 5.277877
Epoch 54
Validation mae = 5.815822
Validation band_gap mae = 5.815822
Epoch 55
Validation mae = 5.722018
Validation band_gap mae = 5.722018
Epoch 56
Validation mae = 5.425684
Validation band_gap mae = 5.425684
Epoch 57
Validation mae = 5.291834
Validation band_gap mae = 5.291834
Epoch 58
Validation mae = 5.367248
Validation band_gap mae = 5.367248
Epoch 59
Validation mae = 6.915160
Validation band_gap mae = 6.915160
Epoch 60
Validation mae = 6.168855
Validation band_gap mae = 6.168855
Epoch 61
Validation mae = 6.215032
Validation band_gap mae = 6.215032
Epoch 62
Validation mae = 6.296898
Validation band_gap mae = 6.296898
Epoch 63
Validation mae = 5.585643
Validation band_gap mae = 5.585643
Epoch 64
Validation mae = 6.128208
Validation band_gap mae = 6.128208
Epoch 65
Validation mae = 5.720573
Validation band_gap mae = 5.720573
Epoch 66
Validation mae = 7.476311
Validation band_gap mae = 7.476311
Epoch 67
Validation mae = 5.855931
Validation band_gap mae = 5.855931
Epoch 68
Validation mae = 5.929617
Validation band_gap mae = 5.929617
Epoch 69
Validation mae = 5.573897
Validation band_gap mae = 5.573897
Epoch 70
Validation mae = 7.394931
Validation band_gap mae = 7.394931
Epoch 71
Validation mae = 6.708053
Validation band_gap mae = 6.708053
Epoch 72
Validation mae = 6.993937
Validation band_gap mae = 6.993937
Epoch 73
Validation mae = 6.582707
Validation band_gap mae = 6.582707
Epoch 74
Validation mae = 6.950075
Validation band_gap mae = 6.950075
Epoch 75
Validation mae = 6.218704
Validation band_gap mae = 6.218704
Epoch 76
Validation mae = 7.486570
Validation band_gap mae = 7.486570
Epoch 77
Validation mae = 7.498137
Validation band_gap mae = 7.498137
Epoch 78
Validation mae = 7.021707
Validation band_gap mae = 7.021707
Epoch 79
Validation mae = 7.084899
Validation band_gap mae = 7.084899
Epoch 80
Validation mae = 6.841837
Validation band_gap mae = 6.841837
Epoch 81
Validation mae = 7.116678
Validation band_gap mae = 7.116678
Epoch 82
Validation mae = 6.942544
Validation band_gap mae = 6.942544
Epoch 83
Validation mae = 7.167395
Validation band_gap mae = 7.167395
Epoch 84
Validation mae = 7.077840
Validation band_gap mae = 7.077840
Epoch 85
Validation mae = 6.971697
Validation band_gap mae = 6.971697
Epoch 86
Validation mae = 6.993674
Validation band_gap mae = 6.993674
Epoch 87
Validation mae = 6.983542
Validation band_gap mae = 6.983542
Epoch 88
Validation mae = 7.007254
Validation band_gap mae = 7.007254
Epoch 89
Validation mae = 6.881646
Validation band_gap mae = 6.881646
Epoch 90
Validation mae = 6.961338
Validation band_gap mae = 6.961338
Epoch 91
Validation mae = 6.895562
Validation band_gap mae = 6.895562
Epoch 92
Validation mae = 6.852981
Validation band_gap mae = 6.852981
Epoch 93
Validation mae = 6.909537
Validation band_gap mae = 6.909537
Epoch 94
Validation mae = 6.914593
Validation band_gap mae = 6.914593
Epoch 95
Validation mae = 6.839376
Validation band_gap mae = 6.839376
Epoch 96
Validation mae = 7.002333
Validation band_gap mae = 7.002333
Epoch 97
Validation mae = 6.896875
Validation band_gap mae = 6.896875
Epoch 98
Validation mae = 6.921341
Validation band_gap mae = 6.921341
Epoch 99
Validation mae = 6.837878
Validation band_gap mae = 6.837878
Model 0 best validation mae = 7.498137 on epoch 77
Moving model to cuda
Model 0 test mae = 1.545142
Model 0 test band_gap mae = 1.545142
Ensemble test mae = 1.545142
Ensemble test band_gap mae = 1.545142
==================== fold 2 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 3.510354
Validation band_gap mae = 3.510354
Epoch 1
Validation mae = 2.970637
Validation band_gap mae = 2.970637
Epoch 2
Validation mae = 3.359636
Validation band_gap mae = 3.359636
Epoch 3
Validation mae = 3.015261
Validation band_gap mae = 3.015261
Epoch 4
Validation mae = 3.036945
Validation band_gap mae = 3.036945
Epoch 5
Validation mae = 3.319503
Validation band_gap mae = 3.319503
Epoch 6
Validation mae = 2.874073
Validation band_gap mae = 2.874073
Epoch 7
Validation mae = 2.957438
Validation band_gap mae = 2.957438
Epoch 8
Validation mae = 2.963689
Validation band_gap mae = 2.963689
Epoch 9
Validation mae = 2.957814
Validation band_gap mae = 2.957814
Epoch 10
Validation mae = 3.200748
Validation band_gap mae = 3.200748
Epoch 11
Validation mae = 3.105520
Validation band_gap mae = 3.105520
Epoch 12
Validation mae = 2.900798
Validation band_gap mae = 2.900798
Epoch 13
Validation mae = 2.903188
Validation band_gap mae = 2.903188
Epoch 14
Validation mae = 3.207293
Validation band_gap mae = 3.207293
Epoch 15
Validation mae = 2.971587
Validation band_gap mae = 2.971587
Epoch 16
Validation mae = 2.941928
Validation band_gap mae = 2.941928
Epoch 17
Validation mae = 2.904833
Validation band_gap mae = 2.904833
Epoch 18
Validation mae = 3.074660
Validation band_gap mae = 3.074660
Epoch 19
Validation mae = 3.204979
Validation band_gap mae = 3.204979
Epoch 20
Validation mae = 3.089949
Validation band_gap mae = 3.089949
Epoch 21
Validation mae = 3.106555
Validation band_gap mae = 3.106555
Epoch 22
Validation mae = 2.827139
Validation band_gap mae = 2.827139
Epoch 23
Validation mae = 2.943242
Validation band_gap mae = 2.943242
Epoch 24
Validation mae = 3.495308
Validation band_gap mae = 3.495308
Epoch 25
Validation mae = 2.913657
Validation band_gap mae = 2.913657
Epoch 26
Validation mae = 3.342300
Validation band_gap mae = 3.342300
Epoch 27
Validation mae = 3.474932
Validation band_gap mae = 3.474932
Epoch 28
Validation mae = 2.896093
Validation band_gap mae = 2.896093
Epoch 29
Validation mae = 2.972452
Validation band_gap mae = 2.972452
Epoch 30
Validation mae = 2.851133
Validation band_gap mae = 2.851133
Epoch 31
Validation mae = 3.048322
Validation band_gap mae = 3.048322
Epoch 32
Validation mae = 3.075389
Validation band_gap mae = 3.075389
Epoch 33
Validation mae = 3.310806
Validation band_gap mae = 3.310806
Epoch 34
Validation mae = 3.164638
Validation band_gap mae = 3.164638
Epoch 35
Validation mae = 2.790213
Validation band_gap mae = 2.790213
Epoch 36
Validation mae = 2.895379
Validation band_gap mae = 2.895379
Epoch 37
Validation mae = 2.999217
Validation band_gap mae = 2.999217
Epoch 38
Validation mae = 2.758861
Validation band_gap mae = 2.758861
Epoch 39
Validation mae = 2.852104
Validation band_gap mae = 2.852104
Epoch 40
Validation mae = 2.818569
Validation band_gap mae = 2.818569
Epoch 41
Validation mae = 2.869622
Validation band_gap mae = 2.869622
Epoch 42
Validation mae = 2.952854
Validation band_gap mae = 2.952854
Epoch 43
Validation mae = 2.850426
Validation band_gap mae = 2.850426
Epoch 44
Validation mae = 2.996689
Validation band_gap mae = 2.996689
Epoch 45
Validation mae = 2.800200
Validation band_gap mae = 2.800200
Epoch 46
Validation mae = 2.985370
Validation band_gap mae = 2.985370
Epoch 47
Validation mae = 2.870082
Validation band_gap mae = 2.870082
Epoch 48
Validation mae = 2.792979
Validation band_gap mae = 2.792979
Epoch 49
Validation mae = 2.871567
Validation band_gap mae = 2.871567
Epoch 50
Validation mae = 3.018427
Validation band_gap mae = 3.018427
Epoch 51
Validation mae = 3.015316
Validation band_gap mae = 3.015316
Epoch 52
Validation mae = 2.938772
Validation band_gap mae = 2.938772
Epoch 53
Validation mae = 2.951207
Validation band_gap mae = 2.951207
Epoch 54
Validation mae = 2.770009
Validation band_gap mae = 2.770009
Epoch 55
Validation mae = 2.975944
Validation band_gap mae = 2.975944
Epoch 56
Validation mae = 2.771223
Validation band_gap mae = 2.771223
Epoch 57
Validation mae = 2.931653
Validation band_gap mae = 2.931653
Epoch 58
Validation mae = 2.778999
Validation band_gap mae = 2.778999
Epoch 59
Validation mae = 2.738211
Validation band_gap mae = 2.738211
Epoch 60
Validation mae = 2.762557
Validation band_gap mae = 2.762557
Epoch 61
Validation mae = 2.469373
Validation band_gap mae = 2.469373
Epoch 62
Validation mae = 2.517626
Validation band_gap mae = 2.517626
Epoch 63
Validation mae = 2.588633
Validation band_gap mae = 2.588633
Epoch 64
Validation mae = 2.488078
Validation band_gap mae = 2.488078
Epoch 65
Validation mae = 2.656725
Validation band_gap mae = 2.656725
Epoch 66
Validation mae = 2.541365
Validation band_gap mae = 2.541365
Epoch 67
Validation mae = 2.566377
Validation band_gap mae = 2.566377
Epoch 68
Validation mae = 2.548311
Validation band_gap mae = 2.548311
Epoch 69
Validation mae = 2.556776
Validation band_gap mae = 2.556776
Epoch 70
Validation mae = 2.575296
Validation band_gap mae = 2.575296
Epoch 71
Validation mae = 2.600215
Validation band_gap mae = 2.600215
Epoch 72
Validation mae = 2.580566
Validation band_gap mae = 2.580566
Epoch 73
Validation mae = 2.573542
Validation band_gap mae = 2.573542
Epoch 74
Validation mae = 2.578674
Validation band_gap mae = 2.578674
Epoch 75
Validation mae = 2.580994
Validation band_gap mae = 2.580994
Epoch 76
Validation mae = 2.560047
Validation band_gap mae = 2.560047
Epoch 77
Validation mae = 2.572958
Validation band_gap mae = 2.572958
Epoch 78
Validation mae = 2.566814
Validation band_gap mae = 2.566814
Epoch 79
Validation mae = 2.588679
Validation band_gap mae = 2.588679
Epoch 80
Validation mae = 2.578887
Validation band_gap mae = 2.578887
Epoch 81
Validation mae = 2.582117
Validation band_gap mae = 2.582117
Epoch 82
Validation mae = 2.585313
Validation band_gap mae = 2.585313
Epoch 83
Validation mae = 2.590871
Validation band_gap mae = 2.590871
Epoch 84
Validation mae = 2.588308
Validation band_gap mae = 2.588308
Epoch 85
Validation mae = 2.590886
Validation band_gap mae = 2.590886
Epoch 86
Validation mae = 2.566910
Validation band_gap mae = 2.566910
Epoch 87
Validation mae = 2.621364
Validation band_gap mae = 2.621364
Epoch 88
Validation mae = 2.572489
Validation band_gap mae = 2.572489
Epoch 89
Validation mae = 2.607322
Validation band_gap mae = 2.607322
Epoch 90
Validation mae = 2.606575
Validation band_gap mae = 2.606575
Epoch 91
Validation mae = 2.580799
Validation band_gap mae = 2.580799
Epoch 92
Validation mae = 2.617574
Validation band_gap mae = 2.617574
Epoch 93
Validation mae = 2.601625
Validation band_gap mae = 2.601625
Epoch 94
Validation mae = 2.589317
Validation band_gap mae = 2.589317
Epoch 95
Validation mae = 2.630163
Validation band_gap mae = 2.630163
Epoch 96
Validation mae = 2.594964
Validation band_gap mae = 2.594964
Epoch 97
Validation mae = 2.635912
Validation band_gap mae = 2.635912
Epoch 98
Validation mae = 2.597540
Validation band_gap mae = 2.597540
Epoch 99
Validation mae = 2.620111
Validation band_gap mae = 2.620111
Model 0 best validation mae = 3.510354 on epoch 0
Moving model to cuda
Model 0 test mae = 2.168659
Model 0 test band_gap mae = 2.168659
Ensemble test mae = 2.168659
Ensemble test band_gap mae = 2.168659
==================== fold 3 ====================
Total size = 944 | train size = 755 | val size = 94 | test size = 95
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 2.820711
Validation band_gap mae = 2.820711
Epoch 1
Validation mae = 2.678129
Validation band_gap mae = 2.678129
Epoch 2
Validation mae = 2.613457
Validation band_gap mae = 2.613457
Epoch 3
Validation mae = 2.309054
Validation band_gap mae = 2.309054
Epoch 4
Validation mae = 2.552332
Validation band_gap mae = 2.552332
Epoch 5
Validation mae = 2.355953
Validation band_gap mae = 2.355953
Epoch 6
Validation mae = 2.467693
Validation band_gap mae = 2.467693
Epoch 7
Validation mae = 2.366706
Validation band_gap mae = 2.366706
Epoch 8
Validation mae = 2.622456
Validation band_gap mae = 2.622456
Epoch 9
Validation mae = 2.403884
Validation band_gap mae = 2.403884
Epoch 10
Validation mae = 2.406380
Validation band_gap mae = 2.406380
Epoch 11
Validation mae = 2.338877
Validation band_gap mae = 2.338877
Epoch 12
Validation mae = 2.761542
Validation band_gap mae = 2.761542
Epoch 13
Validation mae = 2.444828
Validation band_gap mae = 2.444828
Epoch 14
Validation mae = 2.932611
Validation band_gap mae = 2.932611
Epoch 15
Validation mae = 2.426128
Validation band_gap mae = 2.426128
Epoch 16
Validation mae = 2.605045
Validation band_gap mae = 2.605045
Epoch 17
Validation mae = 2.475666
Validation band_gap mae = 2.475666
Epoch 18
Validation mae = 2.291471
Validation band_gap mae = 2.291471
Epoch 19
Validation mae = 2.325615
Validation band_gap mae = 2.325615
Epoch 20
Validation mae = 2.323872
Validation band_gap mae = 2.323872
Epoch 21
Validation mae = 2.506815
Validation band_gap mae = 2.506815
Epoch 22
Validation mae = 2.404468
Validation band_gap mae = 2.404468
Epoch 23
Validation mae = 2.348675
Validation band_gap mae = 2.348675
Epoch 24
Validation mae = 2.614965
Validation band_gap mae = 2.614965
Epoch 25
Validation mae = 2.397565
Validation band_gap mae = 2.397565
Epoch 26
Validation mae = 2.491999
Validation band_gap mae = 2.491999
Epoch 27
Validation mae = 2.334677
Validation band_gap mae = 2.334677
Epoch 28
Validation mae = 2.680313
Validation band_gap mae = 2.680313
Epoch 29
Validation mae = 2.341122
Validation band_gap mae = 2.341122
Epoch 30
Validation mae = 2.411145
Validation band_gap mae = 2.411145
Epoch 31
Validation mae = 2.393920
Validation band_gap mae = 2.393920
Epoch 32
Validation mae = 2.234162
Validation band_gap mae = 2.234162
Epoch 33
Validation mae = 2.487683
Validation band_gap mae = 2.487683
Epoch 34
Validation mae = 2.261059
Validation band_gap mae = 2.261059
Epoch 35
Validation mae = 2.281952
Validation band_gap mae = 2.281952
Epoch 36
Validation mae = 2.267496
Validation band_gap mae = 2.267496
Epoch 37
Validation mae = 2.633973
Validation band_gap mae = 2.633973
Epoch 38
Validation mae = 2.400108
Validation band_gap mae = 2.400108
Epoch 39
Validation mae = 2.355234
Validation band_gap mae = 2.355234
Epoch 40
Validation mae = 3.173196
Validation band_gap mae = 3.173196
Epoch 41
Validation mae = 2.392378
Validation band_gap mae = 2.392378
Epoch 42
Validation mae = 2.275671
Validation band_gap mae = 2.275671
Epoch 43
Validation mae = 2.520399
Validation band_gap mae = 2.520399
Epoch 44
Validation mae = 2.387547
Validation band_gap mae = 2.387547
Epoch 45
Validation mae = 2.291007
Validation band_gap mae = 2.291007
Epoch 46
Validation mae = 2.877459
Validation band_gap mae = 2.877459
Epoch 47
Validation mae = 2.399421
Validation band_gap mae = 2.399421
Epoch 48
Validation mae = 2.700881
Validation band_gap mae = 2.700881
Epoch 49
Validation mae = 2.309168
Validation band_gap mae = 2.309168
Epoch 50
Validation mae = 2.325865
Validation band_gap mae = 2.325865
Epoch 51
Validation mae = 2.458347
Validation band_gap mae = 2.458347
Epoch 52
Validation mae = 2.436849
Validation band_gap mae = 2.436849
Epoch 53
Validation mae = 2.990150
Validation band_gap mae = 2.990150
Epoch 54
Validation mae = 2.492757
Validation band_gap mae = 2.492757
Epoch 55
Validation mae = 2.645621
Validation band_gap mae = 2.645621
Epoch 56
Validation mae = 2.321529
Validation band_gap mae = 2.321529
Epoch 57
Validation mae = 2.398365
Validation band_gap mae = 2.398365
Epoch 58
Validation mae = 2.311759
Validation band_gap mae = 2.311759
Epoch 59
Validation mae = 2.480755
Validation band_gap mae = 2.480755
Epoch 60
Validation mae = 2.377708
Validation band_gap mae = 2.377708
Epoch 61
Validation mae = 2.705274
Validation band_gap mae = 2.705274
Epoch 62
Validation mae = 2.419159
Validation band_gap mae = 2.419159
Epoch 63
Validation mae = 2.824079
Validation band_gap mae = 2.824079
Epoch 64
Validation mae = 2.541329
Validation band_gap mae = 2.541329
Epoch 65
Validation mae = 2.749532
Validation band_gap mae = 2.749532
Epoch 66
Validation mae = 2.349211
Validation band_gap mae = 2.349211
Epoch 67
Validation mae = 2.769578
Validation band_gap mae = 2.769578
Epoch 68
Validation mae = 2.366991
Validation band_gap mae = 2.366991
Epoch 69
Validation mae = 3.238974
Validation band_gap mae = 3.238974
Epoch 70
Validation mae = 2.859193
Validation band_gap mae = 2.859193
Epoch 71
Validation mae = 2.722603
Validation band_gap mae = 2.722603
Epoch 72
Validation mae = 2.876731
Validation band_gap mae = 2.876731
Epoch 73
Validation mae = 2.441453
Validation band_gap mae = 2.441453
Epoch 74
Validation mae = 2.323776
Validation band_gap mae = 2.323776
Epoch 75
Validation mae = 2.341914
Validation band_gap mae = 2.341914
Epoch 76
Validation mae = 2.512410
Validation band_gap mae = 2.512410
Epoch 77
Validation mae = 2.522080
Validation band_gap mae = 2.522080
Epoch 78
Validation mae = 2.648786
Validation band_gap mae = 2.648786
Epoch 79
Validation mae = 3.017892
Validation band_gap mae = 3.017892
Epoch 80
Validation mae = 2.513792
Validation band_gap mae = 2.513792
Epoch 81
Validation mae = 3.569477
Validation band_gap mae = 3.569477
Epoch 82
Validation mae = 2.626758
Validation band_gap mae = 2.626758
Epoch 83
Validation mae = 3.654641
Validation band_gap mae = 3.654641
Epoch 84
Validation mae = 2.668497
Validation band_gap mae = 2.668497
Epoch 85
Validation mae = 3.098268
Validation band_gap mae = 3.098268
Epoch 86
Validation mae = 2.733446
Validation band_gap mae = 2.733446
Epoch 87
Validation mae = 2.937923
Validation band_gap mae = 2.937923
Epoch 88
Validation mae = 2.539142
Validation band_gap mae = 2.539142
Epoch 89
Validation mae = 2.766629
Validation band_gap mae = 2.766629
Epoch 90
Validation mae = 2.234841
Validation band_gap mae = 2.234841
Epoch 91
Validation mae = 2.385192
Validation band_gap mae = 2.385192
Epoch 92
Validation mae = 2.652750
Validation band_gap mae = 2.652750
Epoch 93
Validation mae = 2.807604
Validation band_gap mae = 2.807604
Epoch 94
Validation mae = 2.387730
Validation band_gap mae = 2.387730
Epoch 95
Validation mae = 2.579715
Validation band_gap mae = 2.579715
Epoch 96
Validation mae = 2.414484
Validation band_gap mae = 2.414484
Epoch 97
Validation mae = 2.674498
Validation band_gap mae = 2.674498
Epoch 98
Validation mae = 2.412726
Validation band_gap mae = 2.412726
Epoch 99
Validation mae = 3.231550
Validation band_gap mae = 3.231550
Model 0 best validation mae = 3.654641 on epoch 83
Moving model to cuda
Model 0 test mae = 1.834312
Model 0 test band_gap mae = 1.834312
Ensemble test mae = 1.834312
Ensemble test band_gap mae = 1.834312
==================== fold 4 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 2.456087
Validation band_gap mae = 2.456087
Epoch 1
Validation mae = 2.448086
Validation band_gap mae = 2.448086
Epoch 2
Validation mae = 2.447870
Validation band_gap mae = 2.447870
Epoch 3
Validation mae = 2.509098
Validation band_gap mae = 2.509098
Epoch 4
Validation mae = 2.441192
Validation band_gap mae = 2.441192
Epoch 5
Validation mae = 2.457123
Validation band_gap mae = 2.457123
Epoch 6
Validation mae = 2.444061
Validation band_gap mae = 2.444061
Epoch 7
Validation mae = 2.429686
Validation band_gap mae = 2.429686
Epoch 8
Validation mae = 2.452429
Validation band_gap mae = 2.452429
Epoch 9
Validation mae = 2.461133
Validation band_gap mae = 2.461133
Epoch 10
Validation mae = 2.442369
Validation band_gap mae = 2.442369
Epoch 11
Validation mae = 2.458969
Validation band_gap mae = 2.458969
Epoch 12
Validation mae = 2.438830
Validation band_gap mae = 2.438830
Epoch 13
Validation mae = 2.456438
Validation band_gap mae = 2.456438
Epoch 14
Validation mae = 2.429585
Validation band_gap mae = 2.429585
Epoch 15
Validation mae = 2.461582
Validation band_gap mae = 2.461582
Epoch 16
Validation mae = 2.496345
Validation band_gap mae = 2.496345
Epoch 17
Validation mae = 2.446060
Validation band_gap mae = 2.446060
Epoch 18
Validation mae = 2.437144
Validation band_gap mae = 2.437144
Epoch 19
Validation mae = 2.440606
Validation band_gap mae = 2.440606
Epoch 20
Validation mae = 2.434961
Validation band_gap mae = 2.434961
Epoch 21
Validation mae = 2.441766
Validation band_gap mae = 2.441766
Epoch 22
Validation mae = 2.438995
Validation band_gap mae = 2.438995
Epoch 23
Validation mae = 2.512005
Validation band_gap mae = 2.512005
Epoch 24
Validation mae = 2.440732
Validation band_gap mae = 2.440732
Epoch 25
Validation mae = 2.436321
Validation band_gap mae = 2.436321
Epoch 26
Validation mae = 2.458232
Validation band_gap mae = 2.458232
Epoch 27
Validation mae = 2.465107
Validation band_gap mae = 2.465107
Epoch 28
Validation mae = 2.419486
Validation band_gap mae = 2.419486
Epoch 29
Validation mae = 2.451974
Validation band_gap mae = 2.451974
Epoch 30
Validation mae = 2.431488
Validation band_gap mae = 2.431488
Epoch 31
Validation mae = 2.433848
Validation band_gap mae = 2.433848
Epoch 32
Validation mae = 2.437656
Validation band_gap mae = 2.437656
Epoch 33
Validation mae = 2.442686
Validation band_gap mae = 2.442686
Epoch 34
Validation mae = 2.469534
Validation band_gap mae = 2.469534
Epoch 35
Validation mae = 2.445412
Validation band_gap mae = 2.445412
Epoch 36
Validation mae = 2.437214
Validation band_gap mae = 2.437214
Epoch 37
Validation mae = 2.470882
Validation band_gap mae = 2.470882
Epoch 38
Validation mae = 2.456159
Validation band_gap mae = 2.456159
Epoch 39
Validation mae = 2.435115
Validation band_gap mae = 2.435115
Epoch 40
Validation mae = 2.425842
Validation band_gap mae = 2.425842
Epoch 41
Validation mae = 2.444133
Validation band_gap mae = 2.444133
Epoch 42
Validation mae = 2.429647
Validation band_gap mae = 2.429647
Epoch 43
Validation mae = 2.428787
Validation band_gap mae = 2.428787
Epoch 44
Validation mae = 2.438805
Validation band_gap mae = 2.438805
Epoch 45
Validation mae = 2.423152
Validation band_gap mae = 2.423152
Epoch 46
Validation mae = 2.444955
Validation band_gap mae = 2.444955
Epoch 47
Validation mae = 2.440126
Validation band_gap mae = 2.440126
Epoch 48
Validation mae = 2.447464
Validation band_gap mae = 2.447464
Epoch 49
Validation mae = 2.450279
Validation band_gap mae = 2.450279
Epoch 50
Validation mae = 2.471379
Validation band_gap mae = 2.471379
Epoch 51
Validation mae = 2.446215
Validation band_gap mae = 2.446215
Epoch 52
Validation mae = 2.443168
Validation band_gap mae = 2.443168
Epoch 53
Validation mae = 2.446421
Validation band_gap mae = 2.446421
Epoch 54
Validation mae = 2.475245
Validation band_gap mae = 2.475245
Epoch 55
Validation mae = 2.447487
Validation band_gap mae = 2.447487
Epoch 56
Validation mae = 2.452720
Validation band_gap mae = 2.452720
Epoch 57
Validation mae = 2.439982
Validation band_gap mae = 2.439982
Epoch 58
Validation mae = 2.435593
Validation band_gap mae = 2.435593
Epoch 59
Validation mae = 2.453780
Validation band_gap mae = 2.453780
Epoch 60
Validation mae = 2.461369
Validation band_gap mae = 2.461369
Epoch 61
Validation mae = 2.457442
Validation band_gap mae = 2.457442
Epoch 62
Validation mae = 2.470699
Validation band_gap mae = 2.470699
Epoch 63
Validation mae = 2.441922
Validation band_gap mae = 2.441922
Epoch 64
Validation mae = 2.444326
Validation band_gap mae = 2.444326
Epoch 65
Validation mae = 2.476601
Validation band_gap mae = 2.476601
Epoch 66
Validation mae = 2.427396
Validation band_gap mae = 2.427396
Epoch 67
Validation mae = 2.457035
Validation band_gap mae = 2.457035
Epoch 68
Validation mae = 2.444007
Validation band_gap mae = 2.444007
Epoch 69
Validation mae = 2.450661
Validation band_gap mae = 2.450661
Epoch 70
Validation mae = 2.447687
Validation band_gap mae = 2.447687
Epoch 71
Validation mae = 2.440129
Validation band_gap mae = 2.440129
Epoch 72
Validation mae = 2.427252
Validation band_gap mae = 2.427252
Epoch 73
Validation mae = 2.417001
Validation band_gap mae = 2.417001
Epoch 74
Validation mae = 2.413592
Validation band_gap mae = 2.413592
Epoch 75
Validation mae = 2.389791
Validation band_gap mae = 2.389791
Epoch 76
Validation mae = 2.439526
Validation band_gap mae = 2.439526
Epoch 77
Validation mae = 2.423120
Validation band_gap mae = 2.423120
Epoch 78
Validation mae = 2.469304
Validation band_gap mae = 2.469304
Epoch 79
Validation mae = 2.406882
Validation band_gap mae = 2.406882
Epoch 80
Validation mae = 2.441549
Validation band_gap mae = 2.441549
Epoch 81
Validation mae = 2.437588
Validation band_gap mae = 2.437588
Epoch 82
Validation mae = 2.435434
Validation band_gap mae = 2.435434
Epoch 83
Validation mae = 2.374983
Validation band_gap mae = 2.374983
Epoch 84
Validation mae = 2.440226
Validation band_gap mae = 2.440226
Epoch 85
Validation mae = 2.452321
Validation band_gap mae = 2.452321
Epoch 86
Validation mae = 2.442410
Validation band_gap mae = 2.442410
Epoch 87
Validation mae = 2.430402
Validation band_gap mae = 2.430402
Epoch 88
Validation mae = 2.414643
Validation band_gap mae = 2.414643
Epoch 89
Validation mae = 2.425100
Validation band_gap mae = 2.425100
Epoch 90
Validation mae = 2.441269
Validation band_gap mae = 2.441269
Epoch 91
Validation mae = 2.439297
Validation band_gap mae = 2.439297
Epoch 92
Validation mae = 2.417592
Validation band_gap mae = 2.417592
Epoch 93
Validation mae = 2.424176
Validation band_gap mae = 2.424176
Epoch 94
Validation mae = 2.424496
Validation band_gap mae = 2.424496
Epoch 95
Validation mae = 2.412572
Validation band_gap mae = 2.412572
Epoch 96
Validation mae = 2.418169
Validation band_gap mae = 2.418169
Epoch 97
Validation mae = 2.437397
Validation band_gap mae = 2.437397
Epoch 98
Validation mae = 2.401112
Validation band_gap mae = 2.401112
Epoch 99
Validation mae = 2.435716
Validation band_gap mae = 2.435716
Model 0 best validation mae = 2.512005 on epoch 23
Moving model to cuda
Model 0 test mae = 0.154461
Model 0 test band_gap mae = 0.154461
Ensemble test mae = 0.154461
Ensemble test band_gap mae = 0.154461
==================== fold 5 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.430997
Validation band_gap mae = 1.430997
Epoch 1
Validation mae = 2.026813
Validation band_gap mae = 2.026813
Epoch 2
Validation mae = 2.046009
Validation band_gap mae = 2.046009
Epoch 3
Validation mae = 1.544907
Validation band_gap mae = 1.544907
Epoch 4
Validation mae = 1.357780
Validation band_gap mae = 1.357780
Epoch 5
Validation mae = 1.310081
Validation band_gap mae = 1.310081
Epoch 6
Validation mae = 1.746359
Validation band_gap mae = 1.746359
Epoch 7
Validation mae = 1.402756
Validation band_gap mae = 1.402756
Epoch 8
Validation mae = 1.528495
Validation band_gap mae = 1.528495
Epoch 9
Validation mae = 1.550326
Validation band_gap mae = 1.550326
Epoch 10
Validation mae = 1.376196
Validation band_gap mae = 1.376196
Epoch 11
Validation mae = 1.809493
Validation band_gap mae = 1.809493
Epoch 12
Validation mae = 1.606822
Validation band_gap mae = 1.606822
Epoch 13
Validation mae = 1.503109
Validation band_gap mae = 1.503109
Epoch 14
Validation mae = 1.569210
Validation band_gap mae = 1.569210
Epoch 15
Validation mae = 1.360074
Validation band_gap mae = 1.360074
Epoch 16
Validation mae = 1.451226
Validation band_gap mae = 1.451226
Epoch 17
Validation mae = 1.704916
Validation band_gap mae = 1.704916
Epoch 18
Validation mae = 1.687779
Validation band_gap mae = 1.687779
Epoch 19
Validation mae = 1.317333
Validation band_gap mae = 1.317333
Epoch 20
Validation mae = 1.262531
Validation band_gap mae = 1.262531
Epoch 21
Validation mae = 1.408274
Validation band_gap mae = 1.408274
Epoch 22
Validation mae = 1.325107
Validation band_gap mae = 1.325107
Epoch 23
Validation mae = 1.490808
Validation band_gap mae = 1.490808
Epoch 24
Validation mae = 1.525248
Validation band_gap mae = 1.525248
Epoch 25
Validation mae = 1.301561
Validation band_gap mae = 1.301561
Epoch 26
Validation mae = 1.327423
Validation band_gap mae = 1.327423
Epoch 27
Validation mae = 1.690014
Validation band_gap mae = 1.690014
Epoch 28
Validation mae = 1.450106
Validation band_gap mae = 1.450106
Epoch 29
Validation mae = 1.256689
Validation band_gap mae = 1.256689
Epoch 30
Validation mae = 1.708193
Validation band_gap mae = 1.708193
Epoch 31
Validation mae = 1.285812
Validation band_gap mae = 1.285812
Epoch 32
Validation mae = 1.555133
Validation band_gap mae = 1.555133
Epoch 33
Validation mae = 1.461048
Validation band_gap mae = 1.461048
Epoch 34
Validation mae = 1.374013
Validation band_gap mae = 1.374013
Epoch 35
Validation mae = 1.397168
Validation band_gap mae = 1.397168
Epoch 36
Validation mae = 1.481765
Validation band_gap mae = 1.481765
Epoch 37
Validation mae = 1.284499
Validation band_gap mae = 1.284499
Epoch 38
Validation mae = 3.359724
Validation band_gap mae = 3.359724
Epoch 39
Validation mae = 1.268495
Validation band_gap mae = 1.268495
Epoch 40
Validation mae = 1.244805
Validation band_gap mae = 1.244805
Epoch 41
Validation mae = 1.369509
Validation band_gap mae = 1.369509
Epoch 42
Validation mae = 1.361185
Validation band_gap mae = 1.361185
Epoch 43
Validation mae = 1.289407
Validation band_gap mae = 1.289407
Epoch 44
Validation mae = 1.332653
Validation band_gap mae = 1.332653
Epoch 45
Validation mae = 1.289925
Validation band_gap mae = 1.289925
Epoch 46
Validation mae = 1.318890
Validation band_gap mae = 1.318890
Epoch 47
Validation mae = 1.233548
Validation band_gap mae = 1.233548
Epoch 48
Validation mae = 1.237508
Validation band_gap mae = 1.237508
Epoch 49
Validation mae = 1.239573
Validation band_gap mae = 1.239573
Epoch 50
Validation mae = 1.509849
Validation band_gap mae = 1.509849
Epoch 51
Validation mae = 1.420930
Validation band_gap mae = 1.420930
Epoch 52
Validation mae = 1.275366
Validation band_gap mae = 1.275366
Epoch 53
Validation mae = 1.253012
Validation band_gap mae = 1.253012
Epoch 54
Validation mae = 1.286919
Validation band_gap mae = 1.286919
Epoch 55
Validation mae = 1.308525
Validation band_gap mae = 1.308525
Epoch 56
Validation mae = 1.266437
Validation band_gap mae = 1.266437
Epoch 57
Validation mae = 1.175175
Validation band_gap mae = 1.175175
Epoch 58
Validation mae = 1.433754
Validation band_gap mae = 1.433754
Epoch 59
Validation mae = 1.467091
Validation band_gap mae = 1.467091
Epoch 60
Validation mae = 1.266276
Validation band_gap mae = 1.266276
Epoch 61
Validation mae = 1.187758
Validation band_gap mae = 1.187758
Epoch 62
Validation mae = 1.387183
Validation band_gap mae = 1.387183
Epoch 63
Validation mae = 1.178266
Validation band_gap mae = 1.178266
Epoch 64
Validation mae = 1.205353
Validation band_gap mae = 1.205353
Epoch 65
Validation mae = 1.174741
Validation band_gap mae = 1.174741
Epoch 66
Validation mae = 1.190116
Validation band_gap mae = 1.190116
Epoch 67
Validation mae = 1.196279
Validation band_gap mae = 1.196279
Epoch 68
Validation mae = 1.227029
Validation band_gap mae = 1.227029
Epoch 69
Validation mae = 1.334276
Validation band_gap mae = 1.334276
Epoch 70
Validation mae = 1.338699
Validation band_gap mae = 1.338699
Epoch 71
Validation mae = 1.234339
Validation band_gap mae = 1.234339
Epoch 72
Validation mae = 1.222853
Validation band_gap mae = 1.222853
Epoch 73
Validation mae = 1.237516
Validation band_gap mae = 1.237516
Epoch 74
Validation mae = 1.303552
Validation band_gap mae = 1.303552
Epoch 75
Validation mae = 1.300219
Validation band_gap mae = 1.300219
Epoch 76
Validation mae = 1.323205
Validation band_gap mae = 1.323205
Epoch 77
Validation mae = 1.268233
Validation band_gap mae = 1.268233
Epoch 78
Validation mae = 1.223944
Validation band_gap mae = 1.223944
Epoch 79
Validation mae = 1.259904
Validation band_gap mae = 1.259904
Epoch 80
Validation mae = 1.202889
Validation band_gap mae = 1.202889
Epoch 81
Validation mae = 1.187685
Validation band_gap mae = 1.187685
Epoch 82
Validation mae = 1.195503
Validation band_gap mae = 1.195503
Epoch 83
Validation mae = 1.148402
Validation band_gap mae = 1.148402
Epoch 84
Validation mae = 1.226077
Validation band_gap mae = 1.226077
Epoch 85
Validation mae = 1.184029
Validation band_gap mae = 1.184029
Epoch 86
Validation mae = 1.235722
Validation band_gap mae = 1.235722
Epoch 87
Validation mae = 1.229579
Validation band_gap mae = 1.229579
Epoch 88
Validation mae = 1.175785
Validation band_gap mae = 1.175785
Epoch 89
Validation mae = 1.212276
Validation band_gap mae = 1.212276
Epoch 90
Validation mae = 1.139935
Validation band_gap mae = 1.139935
Epoch 91
Validation mae = 1.222780
Validation band_gap mae = 1.222780
Epoch 92
Validation mae = 1.136964
Validation band_gap mae = 1.136964
Epoch 93
Validation mae = 1.218878
Validation band_gap mae = 1.218878
Epoch 94
Validation mae = 1.133378
Validation band_gap mae = 1.133378
Epoch 95
Validation mae = 1.230839
Validation band_gap mae = 1.230839
Epoch 96
Validation mae = 1.197570
Validation band_gap mae = 1.197570
Epoch 97
Validation mae = 1.208115
Validation band_gap mae = 1.208115
Epoch 98
Validation mae = 1.234328
Validation band_gap mae = 1.234328
Epoch 99
Validation mae = 1.152611
Validation band_gap mae = 1.152611
Model 0 best validation mae = 3.359724 on epoch 38
Moving model to cuda
Model 0 test mae = 2.254949
Model 0 test band_gap mae = 2.254949
Ensemble test mae = 2.254949
Ensemble test band_gap mae = 2.254949
==================== fold 6 ====================
Total size = 944 | train size = 756 | val size = 94 | test size = 94
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.593152
Validation band_gap mae = 0.593152
Epoch 1
Validation mae = 0.698639
Validation band_gap mae = 0.698639
Epoch 2
Validation mae = 0.726507
Validation band_gap mae = 0.726507
Epoch 3
Validation mae = 0.755766
Validation band_gap mae = 0.755766
Epoch 4
Validation mae = 0.463538
Validation band_gap mae = 0.463538
Epoch 5
Validation mae = 0.841725
Validation band_gap mae = 0.841725
Epoch 6
Validation mae = 0.701499
Validation band_gap mae = 0.701499
Epoch 7
Validation mae = 0.783284
Validation band_gap mae = 0.783284
Epoch 8
Validation mae = 0.749306
Validation band_gap mae = 0.749306
Epoch 9
Validation mae = 0.561330
Validation band_gap mae = 0.561330
Epoch 10
Validation mae = 1.101479
Validation band_gap mae = 1.101479
Epoch 11
Validation mae = 0.940230
Validation band_gap mae = 0.940230
Epoch 12
Validation mae = 0.806407
Validation band_gap mae = 0.806407
Epoch 13
Validation mae = 0.493684
Validation band_gap mae = 0.493684
Epoch 14
Validation mae = 0.705220
Validation band_gap mae = 0.705220
Epoch 15
Validation mae = 0.733985
Validation band_gap mae = 0.733985
Epoch 16
Validation mae = 0.467946
Validation band_gap mae = 0.467946
Epoch 17
Validation mae = 0.691678
Validation band_gap mae = 0.691678
Epoch 18
Validation mae = 0.787954
Validation band_gap mae = 0.787954
Epoch 19
Validation mae = 0.610910
Validation band_gap mae = 0.610910
Epoch 20
Validation mae = 0.612144
Validation band_gap mae = 0.612144
Epoch 21
Validation mae = 0.749661
Validation band_gap mae = 0.749661
Epoch 22
Validation mae = 0.559796
Validation band_gap mae = 0.559796
Epoch 23
Validation mae = 0.574864
Validation band_gap mae = 0.574864
Epoch 24
Validation mae = 0.450170
Validation band_gap mae = 0.450170
Epoch 25
Validation mae = 0.785281
Validation band_gap mae = 0.785281
Epoch 26
Validation mae = 0.444595
Validation band_gap mae = 0.444595
Epoch 27
Validation mae = 0.483398
Validation band_gap mae = 0.483398
Epoch 28
Validation mae = 0.668510
Validation band_gap mae = 0.668510
Epoch 29
Validation mae = 1.027448
Validation band_gap mae = 1.027448
Epoch 30
Validation mae = 0.487553
Validation band_gap mae = 0.487553
Epoch 31
Validation mae = 0.727588
Validation band_gap mae = 0.727588
Epoch 32
Validation mae = 0.491884
Validation band_gap mae = 0.491884
Epoch 33
Validation mae = 0.592944
Validation band_gap mae = 0.592944
Epoch 34
Validation mae = 0.436969
Validation band_gap mae = 0.436969
Epoch 35
Validation mae = 0.898818
Validation band_gap mae = 0.898818
Epoch 36
Validation mae = 0.553748
Validation band_gap mae = 0.553748
Epoch 37
Validation mae = 0.488908
Validation band_gap mae = 0.488908
Epoch 38
Validation mae = 0.989513
Validation band_gap mae = 0.989513
Epoch 39
Validation mae = 0.551641
Validation band_gap mae = 0.551641
Epoch 40
Validation mae = 0.731967
Validation band_gap mae = 0.731967
Epoch 41
Validation mae = 0.896437
Validation band_gap mae = 0.896437
Epoch 42
Validation mae = 0.476702
Validation band_gap mae = 0.476702
Epoch 43
Validation mae = 0.625451
Validation band_gap mae = 0.625451
Epoch 44
Validation mae = 0.674878
Validation band_gap mae = 0.674878
Epoch 45
Validation mae = 0.733345
Validation band_gap mae = 0.733345
Epoch 46
Validation mae = 0.696422
Validation band_gap mae = 0.696422
Epoch 47
Validation mae = 0.479093
Validation band_gap mae = 0.479093
Epoch 48
Validation mae = 0.783167
Validation band_gap mae = 0.783167
Epoch 49
Validation mae = 0.631854
Validation band_gap mae = 0.631854
Epoch 50
Validation mae = 0.628422
Validation band_gap mae = 0.628422
Epoch 51
Validation mae = 0.718135
Validation band_gap mae = 0.718135
Epoch 52
Validation mae = 0.418582
Validation band_gap mae = 0.418582
Epoch 53
Validation mae = 0.534604
Validation band_gap mae = 0.534604
Epoch 54
Validation mae = 0.660133
Validation band_gap mae = 0.660133
Epoch 55
Validation mae = 0.504370
Validation band_gap mae = 0.504370
Epoch 56
Validation mae = 0.676204
Validation band_gap mae = 0.676204
Epoch 57
Validation mae = 0.602195
Validation band_gap mae = 0.602195
Epoch 58
Validation mae = 0.454408
Validation band_gap mae = 0.454408
Epoch 59
Validation mae = 0.415769
Validation band_gap mae = 0.415769
Epoch 60
Validation mae = 0.538907
Validation band_gap mae = 0.538907
Epoch 61
Validation mae = 0.611919
Validation band_gap mae = 0.611919
Epoch 62
Validation mae = 0.670909
Validation band_gap mae = 0.670909
Epoch 63
Validation mae = 0.784901
Validation band_gap mae = 0.784901
Epoch 64
Loading data
Number of tasks = 1
Splitting data with seed 1
==================== fold 0 ====================
Total size = 944 | train size = 825 | val size = 94 | test size = 25
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 7.062241
Validation band_gap mae = 7.062241
Epoch 1
Validation mae = 7.308744
Validation band_gap mae = 7.308744
Epoch 2
Validation mae = 7.435422
Validation band_gap mae = 7.435422
Epoch 3
Validation mae = 5.285308
Validation band_gap mae = 5.285308
Epoch 4
Loading data
Number of tasks = 1
Splitting data with seed 1
==================== fold 0 ====================
Total size = 944 | train size = 825 | val size = 94 | test size = 25
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 7.383855
Validation band_gap mae = 7.383855
Epoch 1
Validation mae = 6.465581
Validation band_gap mae = 6.465581
Epoch 2
Validation mae = 4.696947
Validation band_gap mae = 4.696947
Epoch 3
Validation mae = 7.391243
Validation band_gap mae = 7.391243
Epoch 4
Validation mae = 4.158136
Validation band_gap mae = 4.158136
Epoch 5
Validation mae = 5.758991
Validation band_gap mae = 5.758991
Epoch 6
Validation mae = 6.361248
Validation band_gap mae = 6.361248
Epoch 7
Validation mae = 3.648277
Validation band_gap mae = 3.648277
Epoch 8
Validation mae = 3.960798
Validation band_gap mae = 3.960798
Epoch 9
Validation mae = 4.534240
Validation band_gap mae = 4.534240
Epoch 10
Validation mae = 4.197350
Validation band_gap mae = 4.197350
Epoch 11
Validation mae = 3.725952
Validation band_gap mae = 3.725952
Epoch 12
Validation mae = 3.805465
Validation band_gap mae = 3.805465
Epoch 13
Validation mae = 3.889446
Validation band_gap mae = 3.889446
Epoch 14
Validation mae = 3.503784
Validation band_gap mae = 3.503784
Epoch 15
Validation mae = 3.950450
Validation band_gap mae = 3.950450
Epoch 16
Validation mae = 3.955530
Validation band_gap mae = 3.955530
Epoch 17
Validation mae = 4.194146
Validation band_gap mae = 4.194146
Epoch 18
Validation mae = 3.630735
Validation band_gap mae = 3.630735
Epoch 19
Validation mae = 3.776410
Validation band_gap mae = 3.776410
Epoch 20
Validation mae = 3.539555
Validation band_gap mae = 3.539555
Epoch 21
Validation mae = 3.730354
Validation band_gap mae = 3.730354
Epoch 22
Validation mae = 3.997319
Validation band_gap mae = 3.997319
Epoch 23
Validation mae = 3.649642
Validation band_gap mae = 3.649642
Epoch 24
Validation mae = 3.943395
Validation band_gap mae = 3.943395
Epoch 25
Validation mae = 3.815488
Validation band_gap mae = 3.815488
Epoch 26
Validation mae = 3.603157
Validation band_gap mae = 3.603157
Epoch 27
Validation mae = 3.665727
Validation band_gap mae = 3.665727
Epoch 28
Validation mae = 3.664875
Validation band_gap mae = 3.664875
Epoch 29
Validation mae = 3.804934
Validation band_gap mae = 3.804934
Epoch 30
Validation mae = 3.823400
Validation band_gap mae = 3.823400
Epoch 31
Validation mae = 3.633751
Validation band_gap mae = 3.633751
Epoch 32
Validation mae = 3.645543
Validation band_gap mae = 3.645543
Epoch 33
Validation mae = 3.716867
Validation band_gap mae = 3.716867
Epoch 34
Validation mae = 3.719688
Validation band_gap mae = 3.719688
Epoch 35
Validation mae = 3.794823
Validation band_gap mae = 3.794823
Epoch 36
Validation mae = 3.667210
Validation band_gap mae = 3.667210
Epoch 37
Validation mae = 3.822765
Validation band_gap mae = 3.822765
Epoch 38
Validation mae = 3.631547
Validation band_gap mae = 3.631547
Epoch 39
Validation mae = 3.877091
Validation band_gap mae = 3.877091
Epoch 40
Validation mae = 3.758016
Validation band_gap mae = 3.758016
Epoch 41
Validation mae = 3.883950
Validation band_gap mae = 3.883950
Epoch 42
Validation mae = 3.693528
Validation band_gap mae = 3.693528
Epoch 43
Validation mae = 3.810234
Validation band_gap mae = 3.810234
Epoch 44
Validation mae = 3.756457
Validation band_gap mae = 3.756457
Epoch 45
Validation mae = 3.800213
Validation band_gap mae = 3.800213
Epoch 46
Validation mae = 3.682434
Validation band_gap mae = 3.682434
Epoch 47
Validation mae = 3.981500
Validation band_gap mae = 3.981500
Epoch 48
Validation mae = 3.800698
Validation band_gap mae = 3.800698
Epoch 49
Validation mae = 3.721136
Validation band_gap mae = 3.721136
Epoch 50
Validation mae = 3.768955
Validation band_gap mae = 3.768955
Epoch 51
Validation mae = 3.750334
Validation band_gap mae = 3.750334
Epoch 52
Validation mae = 3.948182
Validation band_gap mae = 3.948182
Epoch 53
Validation mae = 3.831513
Validation band_gap mae = 3.831513
Epoch 54
Validation mae = 3.764446
Validation band_gap mae = 3.764446
Epoch 55
Validation mae = 3.782799
Validation band_gap mae = 3.782799
Epoch 56
Validation mae = 3.811259
Validation band_gap mae = 3.811259
Epoch 57
Validation mae = 3.820250
Validation band_gap mae = 3.820250
Epoch 58
Validation mae = 3.729747
Validation band_gap mae = 3.729747
Epoch 59
Validation mae = 3.826188
Validation band_gap mae = 3.826188
Epoch 60
Validation mae = 3.690280
Validation band_gap mae = 3.690280
Epoch 61
Validation mae = 3.750866
Validation band_gap mae = 3.750866
Epoch 62
Validation mae = 3.787239
Validation band_gap mae = 3.787239
Epoch 63
Validation mae = 3.931283
Validation band_gap mae = 3.931283
Epoch 64
Validation mae = 3.699397
Validation band_gap mae = 3.699397
Epoch 65
Validation mae = 3.839104
Validation band_gap mae = 3.839104
Epoch 66
Validation mae = 3.807765
Validation band_gap mae = 3.807765
Epoch 67
Validation mae = 3.802374
Validation band_gap mae = 3.802374
Epoch 68
Validation mae = 3.766151
Validation band_gap mae = 3.766151
Epoch 69
Validation mae = 3.782842
Validation band_gap mae = 3.782842
Epoch 70
Validation mae = 3.822045
Validation band_gap mae = 3.822045
Epoch 71
Validation mae = 3.914070
Validation band_gap mae = 3.914070
Epoch 72
Validation mae = 3.792607
Validation band_gap mae = 3.792607
Epoch 73
Validation mae = 4.052883
Validation band_gap mae = 4.052883
Epoch 74
Validation mae = 3.765537
Validation band_gap mae = 3.765537
Epoch 75
Validation mae = 3.777693
Validation band_gap mae = 3.777693
Epoch 76
Validation mae = 3.785940
Validation band_gap mae = 3.785940
Epoch 77
Validation mae = 3.862246
Validation band_gap mae = 3.862246
Epoch 78
Validation mae = 3.789941
Validation band_gap mae = 3.789941
Epoch 79
Validation mae = 3.812608
Validation band_gap mae = 3.812608
Epoch 80
Validation mae = 3.876917
Validation band_gap mae = 3.876917
Epoch 81
Validation mae = 3.869153
Validation band_gap mae = 3.869153
Epoch 82
Validation mae = 3.815978
Validation band_gap mae = 3.815978
Epoch 83
Validation mae = 3.930655
Validation band_gap mae = 3.930655
Epoch 84
Validation mae = 3.812446
Validation band_gap mae = 3.812446
Epoch 85
Validation mae = 3.757516
Validation band_gap mae = 3.757516
Epoch 86
Validation mae = 3.829234
Validation band_gap mae = 3.829234
Epoch 87
Validation mae = 3.935902
Validation band_gap mae = 3.935902
Epoch 88
Validation mae = 3.809351
Validation band_gap mae = 3.809351
Epoch 89
Validation mae = 3.846736
Validation band_gap mae = 3.846736
Epoch 90
Validation mae = 3.863310
Validation band_gap mae = 3.863310
Epoch 91
Validation mae = 3.882862
Validation band_gap mae = 3.882862
Epoch 92
Validation mae = 3.861778
Validation band_gap mae = 3.861778
Epoch 93
Validation mae = 3.856538
Validation band_gap mae = 3.856538
Epoch 94
Validation mae = 3.839284
Validation band_gap mae = 3.839284
Epoch 95
Validation mae = 3.798077
Validation band_gap mae = 3.798077
Epoch 96
Validation mae = 3.903846
Validation band_gap mae = 3.903846
Epoch 97
Validation mae = 3.889176
Validation band_gap mae = 3.889176
Epoch 98
Validation mae = 3.784998
Validation band_gap mae = 3.784998
Epoch 99
Validation mae = 3.853320
Validation band_gap mae = 3.853320
Model 0 best validation mae = 7.391243 on epoch 3
Moving model to cuda
Model 0 test mae = 17.492221
Model 0 test band_gap mae = 17.492221
Ensemble test mae = 17.492221
Ensemble test band_gap mae = 17.492221
10-fold cross validation
Seed 1
Fold 0 ==> valid mae = 7.391243 test mae = 17.492221
Fold 0 ==> valid band_gap mae = 7.391243test band_gap mae = 17.492221
Overall valid mae = 7.391243 +/- 0.000000
Overall test mae = 17.492221 +/- 0.000000
Overall test band_gap mae = 17.492221 +/- 0.000000
Loading data
Loading data
Number of tasks = 1
Splitting data with seed 1
==================== fold 0 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 7.535779
Validation band_gap mae = 7.535779
Epoch 1
Validation mae = 7.647833
Validation band_gap mae = 7.647833
Epoch 2
Validation mae = 4.753921
Validation band_gap mae = 4.753921
Epoch 3
Validation mae = 7.278366
Validation band_gap mae = 7.278366
Epoch 4
Validation mae = 5.382837
Validation band_gap mae = 5.382837
Epoch 5
Validation mae = 4.870498
Validation band_gap mae = 4.870498
Epoch 6
Validation mae = 5.940726
Validation band_gap mae = 5.940726
Epoch 7
Validation mae = 5.591345
Validation band_gap mae = 5.591345
Epoch 8
Validation mae = 5.173102
Validation band_gap mae = 5.173102
Epoch 9
Validation mae = 5.133097
Validation band_gap mae = 5.133097
Epoch 10
Validation mae = 4.642326
Validation band_gap mae = 4.642326
Epoch 11
Validation mae = 3.914856
Validation band_gap mae = 3.914856
Epoch 12
Validation mae = 4.242784
Validation band_gap mae = 4.242784
Epoch 13
Validation mae = 3.674959
Validation band_gap mae = 3.674959
Epoch 14
Validation mae = 3.989193
Validation band_gap mae = 3.989193
Epoch 15
Validation mae = 3.984091
Validation band_gap mae = 3.984091
Epoch 16
Validation mae = 4.499972
Validation band_gap mae = 4.499972
Epoch 17
Validation mae = 3.895062
Validation band_gap mae = 3.895062
Epoch 18
Validation mae = 3.924087
Validation band_gap mae = 3.924087
Epoch 19
Validation mae = 4.081553
Validation band_gap mae = 4.081553
Epoch 20
Validation mae = 3.809901
Validation band_gap mae = 3.809901
Epoch 21
Validation mae = 3.861985
Validation band_gap mae = 3.861985
Epoch 22
Validation mae = 3.923213
Validation band_gap mae = 3.923213
Epoch 23
Validation mae = 3.957442
Validation band_gap mae = 3.957442
Epoch 24
Validation mae = 3.792935
Validation band_gap mae = 3.792935
Epoch 25
Validation mae = 3.782932
Validation band_gap mae = 3.782932
Epoch 26
Validation mae = 3.905747
Validation band_gap mae = 3.905747
Epoch 27
Validation mae = 3.947310
Validation band_gap mae = 3.947310
Epoch 28
Validation mae = 3.776574
Validation band_gap mae = 3.776574
Epoch 29
Validation mae = 3.938551
Validation band_gap mae = 3.938551
Epoch 30
Validation mae = 3.906505
Validation band_gap mae = 3.906505
Epoch 31
Validation mae = 3.856590
Validation band_gap mae = 3.856590
Epoch 32
Validation mae = 3.762683
Validation band_gap mae = 3.762683
Epoch 33
Validation mae = 3.864985
Validation band_gap mae = 3.864985
Epoch 34
Validation mae = 3.979328
Validation band_gap mae = 3.979328
Epoch 35
Validation mae = 3.911710
Validation band_gap mae = 3.911710
Epoch 36
Validation mae = 3.855383
Validation band_gap mae = 3.855383
Epoch 37
Validation mae = 3.867174
Validation band_gap mae = 3.867174
Epoch 38
Validation mae = 3.715893
Validation band_gap mae = 3.715893
Epoch 39
Validation mae = 3.904073
Validation band_gap mae = 3.904073
Epoch 40
Validation mae = 3.780312
Validation band_gap mae = 3.780312
Epoch 41
Validation mae = 4.029039
Validation band_gap mae = 4.029039
Epoch 42
Validation mae = 3.809756
Validation band_gap mae = 3.809756
Epoch 43
Validation mae = 3.906335
Validation band_gap mae = 3.906335
Epoch 44
Validation mae = 3.750767
Validation band_gap mae = 3.750767
Epoch 45
Validation mae = 3.863972
Validation band_gap mae = 3.863972
Epoch 46
Validation mae = 3.893458
Validation band_gap mae = 3.893458
Epoch 47
Validation mae = 3.801475
Validation band_gap mae = 3.801475
Epoch 48
Validation mae = 3.887617
Validation band_gap mae = 3.887617
Epoch 49
Validation mae = 3.680498
Validation band_gap mae = 3.680498
Epoch 50
Validation mae = 4.035384
Validation band_gap mae = 4.035384
Epoch 51
Validation mae = 4.134878
Validation band_gap mae = 4.134878
Epoch 52
Validation mae = 3.930932
Validation band_gap mae = 3.930932
Epoch 53
Validation mae = 3.736956
Validation band_gap mae = 3.736956
Epoch 54
Validation mae = 3.681231
Validation band_gap mae = 3.681231
Epoch 55
Validation mae = 3.908291
Validation band_gap mae = 3.908291
Epoch 56
Validation mae = 3.973576
Validation band_gap mae = 3.973576
Epoch 57
Validation mae = 4.128127
Validation band_gap mae = 4.128127
Epoch 58
Validation mae = 3.970239
Validation band_gap mae = 3.970239
Epoch 59
Validation mae = 3.729488
Validation band_gap mae = 3.729488
Epoch 60
Validation mae = 3.838564
Validation band_gap mae = 3.838564
Epoch 61
Validation mae = 3.774166
Validation band_gap mae = 3.774166
Epoch 62
Validation mae = 3.873060
Validation band_gap mae = 3.873060
Epoch 63
Validation mae = 3.907722
Validation band_gap mae = 3.907722
Epoch 64
Validation mae = 3.753041
Validation band_gap mae = 3.753041
Epoch 65
Validation mae = 3.852642
Validation band_gap mae = 3.852642
Epoch 66
Validation mae = 3.877030
Validation band_gap mae = 3.877030
Epoch 67
Validation mae = 3.715239
Validation band_gap mae = 3.715239
Epoch 68
Validation mae = 3.770169
Validation band_gap mae = 3.770169
Epoch 69
Validation mae = 3.934421
Validation band_gap mae = 3.934421
Epoch 70
Validation mae = 3.843838
Validation band_gap mae = 3.843838
Epoch 71
Validation mae = 3.822565
Validation band_gap mae = 3.822565
Epoch 72
Validation mae = 3.968843
Validation band_gap mae = 3.968843
Epoch 73
Validation mae = 3.881097
Validation band_gap mae = 3.881097
Epoch 74
Validation mae = 3.786488
Validation band_gap mae = 3.786488
Epoch 75
Validation mae = 3.822792
Validation band_gap mae = 3.822792
Epoch 76
Validation mae = 3.732024
Validation band_gap mae = 3.732024
Epoch 77
Validation mae = 3.745967
Validation band_gap mae = 3.745967
Epoch 78
Validation mae = 3.835151
Validation band_gap mae = 3.835151
Epoch 79
Validation mae = 3.888590
Validation band_gap mae = 3.888590
Epoch 80
Validation mae = 3.798705
Validation band_gap mae = 3.798705
Epoch 81
Validation mae = 3.763980
Validation band_gap mae = 3.763980
Epoch 82
Validation mae = 3.755562
Validation band_gap mae = 3.755562
Epoch 83
Validation mae = 3.739446
Validation band_gap mae = 3.739446
Epoch 84
Validation mae = 3.907865
Validation band_gap mae = 3.907865
Epoch 85
Validation mae = 3.829486
Validation band_gap mae = 3.829486
Epoch 86
Validation mae = 3.788685
Validation band_gap mae = 3.788685
Epoch 87
Validation mae = 3.800668
Validation band_gap mae = 3.800668
Epoch 88
Validation mae = 3.894819
Validation band_gap mae = 3.894819
Epoch 89
Validation mae = 3.768682
Validation band_gap mae = 3.768682
Epoch 90
Validation mae = 3.867516
Validation band_gap mae = 3.867516
Epoch 91
Validation mae = 3.925657
Validation band_gap mae = 3.925657
Epoch 92
Validation mae = 3.689283
Validation band_gap mae = 3.689283
Epoch 93
Validation mae = 3.787823
Validation band_gap mae = 3.787823
Epoch 94
Validation mae = 3.863839
Validation band_gap mae = 3.863839
Epoch 95
Validation mae = 3.763562
Validation band_gap mae = 3.763562
Epoch 96
Validation mae = 3.939323
Validation band_gap mae = 3.939323
Epoch 97
Validation mae = 4.021043
Validation band_gap mae = 4.021043
Epoch 98
Validation mae = 3.707618
Validation band_gap mae = 3.707618
Epoch 99
Validation mae = 3.892734
Validation band_gap mae = 3.892734
Model 0 best validation mae = 7.647833 on epoch 1
Moving model to cuda
Model 0 test mae = 6.690854
Model 0 test band_gap mae = 6.690854
Ensemble test mae = 6.690854
Ensemble test band_gap mae = 6.690854
==================== fold 1 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 3.002529
Validation band_gap mae = 3.002529
Epoch 1
Validation mae = 2.650296
Validation band_gap mae = 2.650296
Epoch 2
Validation mae = 2.473288
Validation band_gap mae = 2.473288
Epoch 3
Validation mae = 2.977391
Validation band_gap mae = 2.977391
Epoch 4
Validation mae = 2.565589
Validation band_gap mae = 2.565589
Epoch 5
Validation mae = 2.927237
Validation band_gap mae = 2.927237
Epoch 6
Validation mae = 2.675927
Validation band_gap mae = 2.675927
Epoch 7
Validation mae = 4.315156
Validation band_gap mae = 4.315156
Epoch 8
Validation mae = 4.834434
Validation band_gap mae = 4.834434
Epoch 9
Validation mae = 2.492165
Validation band_gap mae = 2.492165
Epoch 10
Validation mae = 2.510111
Validation band_gap mae = 2.510111
Epoch 11
Validation mae = 3.467130
Validation band_gap mae = 3.467130
Epoch 12
Validation mae = 2.577763
Validation band_gap mae = 2.577763
Epoch 13
Validation mae = 4.228658
Validation band_gap mae = 4.228658
Epoch 14
Validation mae = 3.122312
Validation band_gap mae = 3.122312
Epoch 15
Validation mae = 3.922986
Validation band_gap mae = 3.922986
Epoch 16
Validation mae = 4.255867
Validation band_gap mae = 4.255867
Epoch 17
Validation mae = 4.292065
Validation band_gap mae = 4.292065
Epoch 18
Validation mae = 3.195427
Validation band_gap mae = 3.195427
Epoch 19
Validation mae = 5.196585
Validation band_gap mae = 5.196585
Epoch 20
Validation mae = 2.964541
Validation band_gap mae = 2.964541
Epoch 21
Validation mae = 2.670381
Validation band_gap mae = 2.670381
Epoch 22
Validation mae = 2.240583
Validation band_gap mae = 2.240583
Epoch 23
Validation mae = 3.559128
Validation band_gap mae = 3.559128
Epoch 24
Validation mae = 3.021400
Validation band_gap mae = 3.021400
Epoch 25
Validation mae = 2.962960
Validation band_gap mae = 2.962960
Epoch 26
Validation mae = 2.916534
Validation band_gap mae = 2.916534
Epoch 27
Validation mae = 2.571999
Validation band_gap mae = 2.571999
Epoch 28
Validation mae = 2.164637
Validation band_gap mae = 2.164637
Epoch 29
Validation mae = 2.317661
Validation band_gap mae = 2.317661
Epoch 30
Validation mae = 3.015541
Validation band_gap mae = 3.015541
Epoch 31
Validation mae = 3.118977
Validation band_gap mae = 3.118977
Epoch 32
Validation mae = 2.616309
Validation band_gap mae = 2.616309
Epoch 33
Validation mae = 2.784901
Validation band_gap mae = 2.784901
Epoch 34
Validation mae = 4.064377
Validation band_gap mae = 4.064377
Epoch 35
Validation mae = 2.488563
Validation band_gap mae = 2.488563
Epoch 36
Validation mae = 2.322991
Validation band_gap mae = 2.322991
Epoch 37
Validation mae = 2.991246
Validation band_gap mae = 2.991246
Epoch 38
Validation mae = 2.608906
Validation band_gap mae = 2.608906
Epoch 39
Validation mae = 3.430933
Validation band_gap mae = 3.430933
Epoch 40
Validation mae = 3.094592
Validation band_gap mae = 3.094592
Epoch 41
Validation mae = 3.665502
Validation band_gap mae = 3.665502
Epoch 42
Validation mae = 3.694495
Validation band_gap mae = 3.694495
Epoch 43
Validation mae = 3.436101
Validation band_gap mae = 3.436101
Epoch 44
Validation mae = 2.390253
Validation band_gap mae = 2.390253
Epoch 45
Validation mae = 2.456134
Validation band_gap mae = 2.456134
Epoch 46
Validation mae = 3.218177
Validation band_gap mae = 3.218177
Epoch 47
Validation mae = 3.245532
Validation band_gap mae = 3.245532
Epoch 48
Validation mae = 3.812313
Validation band_gap mae = 3.812313
Epoch 49
Validation mae = 3.134744
Validation band_gap mae = 3.134744
Epoch 50
Validation mae = 3.511686
Validation band_gap mae = 3.511686
Epoch 51
Validation mae = 2.934239
Validation band_gap mae = 2.934239
Epoch 52
Validation mae = 3.772116
Validation band_gap mae = 3.772116
Epoch 53
Validation mae = 2.669132
Validation band_gap mae = 2.669132
Epoch 54
Validation mae = 2.400860
Validation band_gap mae = 2.400860
Epoch 55
Validation mae = 2.410021
Validation band_gap mae = 2.410021
Epoch 56
Validation mae = 2.273593
Validation band_gap mae = 2.273593
Epoch 57
Validation mae = 2.369218
Validation band_gap mae = 2.369218
Epoch 58
Validation mae = 3.442584
Validation band_gap mae = 3.442584
Epoch 59
Validation mae = 2.965605
Validation band_gap mae = 2.965605
Epoch 60
Validation mae = 3.124329
Validation band_gap mae = 3.124329
Epoch 61
Validation mae = 5.117327
Validation band_gap mae = 5.117327
Epoch 62
Validation mae = 2.872714
Validation band_gap mae = 2.872714
Epoch 63
Validation mae = 3.561435
Validation band_gap mae = 3.561435
Epoch 64
Validation mae = 2.253272
Validation band_gap mae = 2.253272
Epoch 65
Validation mae = 4.604250
Validation band_gap mae = 4.604250
Epoch 66
Validation mae = 2.270178
Validation band_gap mae = 2.270178
Epoch 67
Validation mae = 2.980523
Validation band_gap mae = 2.980523
Epoch 68
Validation mae = 3.598387
Validation band_gap mae = 3.598387
Epoch 69
Validation mae = 2.717133
Validation band_gap mae = 2.717133
Epoch 70
Validation mae = 2.930314
Validation band_gap mae = 2.930314
Epoch 71
Validation mae = 4.192056
Validation band_gap mae = 4.192056
Epoch 72
Validation mae = 2.755351
Validation band_gap mae = 2.755351
Epoch 73
Validation mae = 2.733358
Validation band_gap mae = 2.733358
Epoch 74
Validation mae = 3.002939
Validation band_gap mae = 3.002939
Epoch 75
Validation mae = 2.840967
Validation band_gap mae = 2.840967
Epoch 76
Validation mae = 2.949821
Validation band_gap mae = 2.949821
Epoch 77
Validation mae = 3.093531
Validation band_gap mae = 3.093531
Epoch 78
Validation mae = 2.639418
Validation band_gap mae = 2.639418
Epoch 79
Validation mae = 3.116850
Validation band_gap mae = 3.116850
Epoch 80
Validation mae = 3.194526
Validation band_gap mae = 3.194526
Epoch 81
Validation mae = 2.586312
Validation band_gap mae = 2.586312
Epoch 82
Validation mae = 4.276181
Validation band_gap mae = 4.276181
Epoch 83
Validation mae = 2.776869
Validation band_gap mae = 2.776869
Epoch 84
Validation mae = 3.165890
Validation band_gap mae = 3.165890
Epoch 85
Validation mae = 3.569446
Validation band_gap mae = 3.569446
Epoch 86
Validation mae = 3.128376
Validation band_gap mae = 3.128376
Epoch 87
Validation mae = 3.316293
Validation band_gap mae = 3.316293
Epoch 88
Validation mae = 3.315711
Validation band_gap mae = 3.315711
Epoch 89
Validation mae = 3.078630
Validation band_gap mae = 3.078630
Epoch 90
Validation mae = 4.048520
Validation band_gap mae = 4.048520
Epoch 91
Validation mae = 2.729040
Validation band_gap mae = 2.729040
Epoch 92
Validation mae = 3.571704
Validation band_gap mae = 3.571704
Epoch 93
Validation mae = 3.363690
Validation band_gap mae = 3.363690
Epoch 94
Validation mae = 3.026158
Validation band_gap mae = 3.026158
Epoch 95
Validation mae = 4.449938
Validation band_gap mae = 4.449938
Epoch 96
Validation mae = 2.885809
Validation band_gap mae = 2.885809
Epoch 97
Validation mae = 3.394488
Validation band_gap mae = 3.394488
Epoch 98
Validation mae = 3.220826
Validation band_gap mae = 3.220826
Epoch 99
Validation mae = 3.626989
Validation band_gap mae = 3.626989
Model 0 best validation mae = 5.196585 on epoch 19
Moving model to cuda
Model 0 test mae = 3.177570
Model 0 test band_gap mae = 3.177570
Ensemble test mae = 3.177570
Ensemble test band_gap mae = 3.177570
==================== fold 2 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.956140
Validation band_gap mae = 1.956140
Epoch 1
Validation mae = 2.254811
Validation band_gap mae = 2.254811
Epoch 2
Validation mae = 1.869839
Validation band_gap mae = 1.869839
Epoch 3
Validation mae = 1.984863
Validation band_gap mae = 1.984863
Epoch 4
Validation mae = 2.000238
Validation band_gap mae = 2.000238
Epoch 5
Validation mae = 1.912964
Validation band_gap mae = 1.912964
Epoch 6
Validation mae = 1.988886
Validation band_gap mae = 1.988886
Epoch 7
Validation mae = 2.376824
Validation band_gap mae = 2.376824
Epoch 8
Validation mae = 1.944022
Validation band_gap mae = 1.944022
Epoch 9
Validation mae = 1.946495
Validation band_gap mae = 1.946495
Epoch 10
Validation mae = 1.983150
Validation band_gap mae = 1.983150
Epoch 11
Validation mae = 2.238333
Validation band_gap mae = 2.238333
Epoch 12
Validation mae = 2.255331
Validation band_gap mae = 2.255331
Epoch 13
Validation mae = 2.046916
Validation band_gap mae = 2.046916
Epoch 14
Validation mae = 2.060739
Validation band_gap mae = 2.060739
Epoch 15
Validation mae = 1.953393
Validation band_gap mae = 1.953393
Epoch 16
Validation mae = 1.902136
Validation band_gap mae = 1.902136
Epoch 17
Validation mae = 1.895312
Validation band_gap mae = 1.895312
Epoch 18
Validation mae = 1.946974
Validation band_gap mae = 1.946974
Epoch 19
Validation mae = 2.039828
Validation band_gap mae = 2.039828
Epoch 20
Validation mae = 2.239369
Validation band_gap mae = 2.239369
Epoch 21
Validation mae = 1.917840
Validation band_gap mae = 1.917840
Epoch 22
Validation mae = 1.931198
Validation band_gap mae = 1.931198
Epoch 23
Validation mae = 1.988886
Validation band_gap mae = 1.988886
Epoch 24
Validation mae = 1.988872
Validation band_gap mae = 1.988872
Epoch 25
Validation mae = 2.242676
Validation band_gap mae = 2.242676
Epoch 26
Validation mae = 1.962887
Validation band_gap mae = 1.962887
Epoch 27
Validation mae = 1.983921
Validation band_gap mae = 1.983921
Epoch 28
Validation mae = 1.967435
Validation band_gap mae = 1.967435
Epoch 29
Validation mae = 1.963270
Validation band_gap mae = 1.963270
Epoch 30
Validation mae = 2.000488
Validation band_gap mae = 2.000488
Epoch 31
Validation mae = 1.944033
Validation band_gap mae = 1.944033
Epoch 32
Validation mae = 2.067294
Validation band_gap mae = 2.067294
Epoch 33
Validation mae = 1.957015
Validation band_gap mae = 1.957015
Epoch 34
Validation mae = 1.907945
Validation band_gap mae = 1.907945
Epoch 35
Validation mae = 1.942913
Validation band_gap mae = 1.942913
Epoch 36
Validation mae = 2.294006
Validation band_gap mae = 2.294006
Epoch 37
Validation mae = 2.065837
Validation band_gap mae = 2.065837
Epoch 38
Validation mae = 1.918980
Validation band_gap mae = 1.918980
Epoch 39
Validation mae = 1.955918
Validation band_gap mae = 1.955918
Epoch 40
Validation mae = 2.081280
Validation band_gap mae = 2.081280
Epoch 41
Validation mae = 2.084054
Validation band_gap mae = 2.084054
Epoch 42
Validation mae = 2.091621
Validation band_gap mae = 2.091621
Epoch 43
Validation mae = 1.930341
Validation band_gap mae = 1.930341
Epoch 44
Validation mae = 1.879145
Validation band_gap mae = 1.879145
Epoch 45
Validation mae = 2.082456
Validation band_gap mae = 2.082456
Epoch 46
Validation mae = 1.988462
Validation band_gap mae = 1.988462
Epoch 47
Validation mae = 1.983017
Validation band_gap mae = 1.983017
Epoch 48
Validation mae = 1.942100
Validation band_gap mae = 1.942100
Epoch 49
Validation mae = 1.894162
Validation band_gap mae = 1.894162
Epoch 50
Validation mae = 2.134445
Validation band_gap mae = 2.134445
Epoch 51
Validation mae = 1.877685
Validation band_gap mae = 1.877685
Epoch 52
Validation mae = 2.011344
Validation band_gap mae = 2.011344
Epoch 53
Validation mae = 2.141699
Validation band_gap mae = 2.141699
Epoch 54
Validation mae = 2.039955
Validation band_gap mae = 2.039955
Epoch 55
Validation mae = 2.206597
Validation band_gap mae = 2.206597
Epoch 56
Validation mae = 2.077094
Validation band_gap mae = 2.077094
Epoch 57
Validation mae = 1.955957
Validation band_gap mae = 1.955957
Epoch 58
Validation mae = 2.188138
Validation band_gap mae = 2.188138
Epoch 59
Validation mae = 2.168896
Validation band_gap mae = 2.168896
Epoch 60
Validation mae = 1.960332
Validation band_gap mae = 1.960332
Epoch 61
Validation mae = 2.162182
Validation band_gap mae = 2.162182
Epoch 62
Validation mae = 2.199102
Validation band_gap mae = 2.199102
Epoch 63
Validation mae = 2.158190
Validation band_gap mae = 2.158190
Epoch 64
Validation mae = 2.176216
Validation band_gap mae = 2.176216
Epoch 65
Validation mae = 2.134005
Validation band_gap mae = 2.134005
Epoch 66
Validation mae = 2.088976
Validation band_gap mae = 2.088976
Epoch 67
Validation mae = 2.239742
Validation band_gap mae = 2.239742
Epoch 68
Validation mae = 2.114770
Validation band_gap mae = 2.114770
Epoch 69
Validation mae = 2.279638
Validation band_gap mae = 2.279638
Epoch 70
Validation mae = 2.218217
Validation band_gap mae = 2.218217
Epoch 71
Validation mae = 2.090172
Validation band_gap mae = 2.090172
Epoch 72
Validation mae = 2.354752
Validation band_gap mae = 2.354752
Epoch 73
Validation mae = 2.280741
Validation band_gap mae = 2.280741
Epoch 74
Validation mae = 2.211828
Validation band_gap mae = 2.211828
Epoch 75
Validation mae = 2.152225
Validation band_gap mae = 2.152225
Epoch 76
Validation mae = 2.272948
Validation band_gap mae = 2.272948
Epoch 77
Validation mae = 2.112655
Validation band_gap mae = 2.112655
Epoch 78
Validation mae = 2.263331
Validation band_gap mae = 2.263331
Epoch 79
Validation mae = 2.203821
Validation band_gap mae = 2.203821
Epoch 80
Validation mae = 2.249590
Validation band_gap mae = 2.249590
Epoch 81
Validation mae = 2.096745
Validation band_gap mae = 2.096745
Epoch 82
Validation mae = 2.275621
Validation band_gap mae = 2.275621
Epoch 83
Validation mae = 2.225331
Validation band_gap mae = 2.225331
Epoch 84
Validation mae = 2.357262
Validation band_gap mae = 2.357262
Epoch 85
Validation mae = 2.138660
Validation band_gap mae = 2.138660
Epoch 86
Validation mae = 2.134278
Validation band_gap mae = 2.134278
Epoch 87
Validation mae = 2.361722
Validation band_gap mae = 2.361722
Epoch 88
Validation mae = 2.139497
Validation band_gap mae = 2.139497
Epoch 89
Validation mae = 2.280386
Validation band_gap mae = 2.280386
Epoch 90
Validation mae = 2.191753
Validation band_gap mae = 2.191753
Epoch 91
Validation mae = 2.247503
Validation band_gap mae = 2.247503
Epoch 92
Validation mae = 2.217295
Validation band_gap mae = 2.217295
Epoch 93
Validation mae = 2.335337
Validation band_gap mae = 2.335337
Epoch 94
Validation mae = 2.207051
Validation band_gap mae = 2.207051
Epoch 95
Validation mae = 2.349662
Validation band_gap mae = 2.349662
Epoch 96
Validation mae = 2.225797
Validation band_gap mae = 2.225797
Epoch 97
Validation mae = 2.245410
Validation band_gap mae = 2.245410
Epoch 98
Validation mae = 2.080283
Validation band_gap mae = 2.080283
Epoch 99
Validation mae = 2.339100
Validation band_gap mae = 2.339100
Model 0 best validation mae = 2.376824 on epoch 7
Moving model to cuda
Model 0 test mae = 0.889665
Model 0 test band_gap mae = 0.889665
Ensemble test mae = 0.889665
Ensemble test band_gap mae = 0.889665
==================== fold 3 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 2.032745
Validation band_gap mae = 2.032745
Epoch 1
Validation mae = 2.030027
Validation band_gap mae = 2.030027
Epoch 2
Validation mae = 2.015531
Validation band_gap mae = 2.015531
Epoch 3
Validation mae = 2.083704
Validation band_gap mae = 2.083704
Epoch 4
Validation mae = 1.992870
Validation band_gap mae = 1.992870
Epoch 5
Validation mae = 2.012037
Validation band_gap mae = 2.012037
Epoch 6
Validation mae = 1.998818
Validation band_gap mae = 1.998818
Epoch 7
Validation mae = 2.010861
Validation band_gap mae = 2.010861
Epoch 8
Validation mae = 1.971556
Validation band_gap mae = 1.971556
Epoch 9
Validation mae = 2.001268
Validation band_gap mae = 2.001268
Epoch 10
Validation mae = 1.989426
Validation band_gap mae = 1.989426
Epoch 11
Validation mae = 1.993542
Validation band_gap mae = 1.993542
Epoch 12
Validation mae = 1.993964
Validation band_gap mae = 1.993964
Epoch 13
Validation mae = 2.010307
Validation band_gap mae = 2.010307
Epoch 14
Validation mae = 2.108326
Validation band_gap mae = 2.108326
Epoch 15
Validation mae = 1.992716
Validation band_gap mae = 1.992716
Epoch 16
Validation mae = 2.063160
Validation band_gap mae = 2.063160
Epoch 17
Validation mae = 1.983626
Validation band_gap mae = 1.983626
Epoch 18
Validation mae = 2.008210
Validation band_gap mae = 2.008210
Epoch 19
Validation mae = 1.984020
Validation band_gap mae = 1.984020
Epoch 20
Validation mae = 2.030045
Validation band_gap mae = 2.030045
Epoch 21
Validation mae = 2.015625
Validation band_gap mae = 2.015625
Epoch 22
Validation mae = 1.972877
Validation band_gap mae = 1.972877
Epoch 23
Validation mae = 2.017644
Validation band_gap mae = 2.017644
Epoch 24
Validation mae = 1.983057
Validation band_gap mae = 1.983057
Epoch 25
Validation mae = 1.997610
Validation band_gap mae = 1.997610
Epoch 26
Validation mae = 2.014770
Validation band_gap mae = 2.014770
Epoch 27
Validation mae = 1.974638
Validation band_gap mae = 1.974638
Epoch 28
Validation mae = 1.989134
Validation band_gap mae = 1.989134
Epoch 29
Validation mae = 1.991679
Validation band_gap mae = 1.991679
Epoch 30
Validation mae = 2.010339
Validation band_gap mae = 2.010339
Epoch 31
Validation mae = 2.007021
Validation band_gap mae = 2.007021
Epoch 32
Validation mae = 2.014901
Validation band_gap mae = 2.014901
Epoch 33
Validation mae = 2.003303
Validation band_gap mae = 2.003303
Epoch 34
Validation mae = 2.112403
Validation band_gap mae = 2.112403
Epoch 35
Validation mae = 2.017034
Validation band_gap mae = 2.017034
Epoch 36
Validation mae = 2.005372
Validation band_gap mae = 2.005372
Epoch 37
Validation mae = 2.073435
Validation band_gap mae = 2.073435
Epoch 38
Validation mae = 1.987646
Validation band_gap mae = 1.987646
Epoch 39
Validation mae = 1.984030
Validation band_gap mae = 1.984030
Epoch 40
Validation mae = 2.049956
Validation band_gap mae = 2.049956
Epoch 41
Validation mae = 2.030241
Validation band_gap mae = 2.030241
Epoch 42
Validation mae = 2.026014
Validation band_gap mae = 2.026014
Epoch 43
Validation mae = 2.006377
Validation band_gap mae = 2.006377
Epoch 44
Validation mae = 2.089388
Validation band_gap mae = 2.089388
Epoch 45
Validation mae = 2.000940
Validation band_gap mae = 2.000940
Epoch 46
Validation mae = 2.011379
Validation band_gap mae = 2.011379
Epoch 47
Validation mae = 2.026220
Validation band_gap mae = 2.026220
Epoch 48
Validation mae = 2.018997
Validation band_gap mae = 2.018997
Epoch 49
Validation mae = 2.056682
Validation band_gap mae = 2.056682
Epoch 50
Validation mae = 2.053176
Validation band_gap mae = 2.053176
Epoch 51
Validation mae = 2.015672
Validation band_gap mae = 2.015672
Epoch 52
Validation mae = 2.038785
Validation band_gap mae = 2.038785
Epoch 53
Validation mae = 2.010805
Validation band_gap mae = 2.010805
Epoch 54
Validation mae = 2.023275
Validation band_gap mae = 2.023275
Epoch 55
Validation mae = 2.045075
Validation band_gap mae = 2.045075
Epoch 56
Validation mae = 2.012989
Validation band_gap mae = 2.012989
Epoch 57
Validation mae = 2.055298
Validation band_gap mae = 2.055298
Epoch 58
Validation mae = 2.039473
Validation band_gap mae = 2.039473
Epoch 59
Validation mae = 2.095594
Validation band_gap mae = 2.095594
Epoch 60
Validation mae = 2.098089
Validation band_gap mae = 2.098089
Epoch 61
Validation mae = 2.012181
Validation band_gap mae = 2.012181
Epoch 62
Validation mae = 2.117446
Validation band_gap mae = 2.117446
Epoch 63
Validation mae = 2.066997
Validation band_gap mae = 2.066997
Epoch 64
Validation mae = 2.079078
Validation band_gap mae = 2.079078
Epoch 65
Validation mae = 2.115420
Validation band_gap mae = 2.115420
Epoch 66
Validation mae = 2.020888
Validation band_gap mae = 2.020888
Epoch 67
Validation mae = 2.029294
Validation band_gap mae = 2.029294
Epoch 68
Validation mae = 2.142953
Validation band_gap mae = 2.142953
Epoch 69
Validation mae = 2.053916
Validation band_gap mae = 2.053916
Epoch 70
Validation mae = 2.057891
Validation band_gap mae = 2.057891
Epoch 71
Validation mae = 2.136982
Validation band_gap mae = 2.136982
Epoch 72
Validation mae = 2.050438
Validation band_gap mae = 2.050438
Epoch 73
Validation mae = 2.077503
Validation band_gap mae = 2.077503
Epoch 74
Validation mae = 2.077966
Validation band_gap mae = 2.077966
Epoch 75
Validation mae = 2.157620
Validation band_gap mae = 2.157620
Epoch 76
Validation mae = 2.083029
Validation band_gap mae = 2.083029
Epoch 77
Validation mae = 2.117946
Validation band_gap mae = 2.117946
Epoch 78
Validation mae = 2.118186
Validation band_gap mae = 2.118186
Epoch 79
Validation mae = 2.088761
Validation band_gap mae = 2.088761
Epoch 80
Validation mae = 2.134789
Validation band_gap mae = 2.134789
Epoch 81
Validation mae = 2.105607
Validation band_gap mae = 2.105607
Epoch 82
Validation mae = 2.063547
Validation band_gap mae = 2.063547
Epoch 83
Validation mae = 2.099386
Validation band_gap mae = 2.099386
Epoch 84
Validation mae = 2.122206
Validation band_gap mae = 2.122206
Epoch 85
Validation mae = 2.141015
Validation band_gap mae = 2.141015
Epoch 86
Validation mae = 2.054947
Validation band_gap mae = 2.054947
Epoch 87
Validation mae = 2.136502
Validation band_gap mae = 2.136502
Epoch 88
Validation mae = 2.102234
Validation band_gap mae = 2.102234
Epoch 89
Validation mae = 2.113604
Validation band_gap mae = 2.113604
Epoch 90
Validation mae = 2.114132
Validation band_gap mae = 2.114132
Epoch 91
Validation mae = 2.115448
Validation band_gap mae = 2.115448
Epoch 92
Validation mae = 2.147691
Validation band_gap mae = 2.147691
Epoch 93
Validation mae = 2.121971
Validation band_gap mae = 2.121971
Epoch 94
Validation mae = 2.150053
Validation band_gap mae = 2.150053
Epoch 95
Validation mae = 2.105009
Validation band_gap mae = 2.105009
Epoch 96
Validation mae = 2.115797
Validation band_gap mae = 2.115797
Epoch 97
Validation mae = 2.118278
Validation band_gap mae = 2.118278
Epoch 98
Validation mae = 2.148337
Validation band_gap mae = 2.148337
Epoch 99
Validation mae = 2.080436
Validation band_gap mae = 2.080436
Model 0 best validation mae = 2.157620 on epoch 75
Moving model to cuda
Model 0 test mae = 0.452712
Model 0 test band_gap mae = 0.452712
Ensemble test mae = 0.452712
Ensemble test band_gap mae = 0.452712
==================== fold 4 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.832070
Validation band_gap mae = 1.832070
Epoch 1
Validation mae = 2.037475
Validation band_gap mae = 2.037475
Epoch 2
Validation mae = 1.730669
Validation band_gap mae = 1.730669
Epoch 3
Validation mae = 1.682476
Validation band_gap mae = 1.682476
Epoch 4
Validation mae = 1.736750
Validation band_gap mae = 1.736750
Epoch 5
Validation mae = 1.864047
Validation band_gap mae = 1.864047
Epoch 6
Validation mae = 1.795385
Validation band_gap mae = 1.795385
Epoch 7
Validation mae = 1.989155
Validation band_gap mae = 1.989155
Epoch 8
Validation mae = 1.786657
Validation band_gap mae = 1.786657
Epoch 9
Validation mae = 1.916059
Validation band_gap mae = 1.916059
Epoch 10
Validation mae = 1.750138
Validation band_gap mae = 1.750138
Epoch 11
Validation mae = 1.793448
Validation band_gap mae = 1.793448
Epoch 12
Validation mae = 1.751097
Validation band_gap mae = 1.751097
Epoch 13
Validation mae = 1.723169
Validation band_gap mae = 1.723169
Epoch 14
Validation mae = 1.825606
Validation band_gap mae = 1.825606
Epoch 15
Validation mae = 1.791376
Validation band_gap mae = 1.791376
Epoch 16
Validation mae = 1.700009
Validation band_gap mae = 1.700009
Epoch 17
Validation mae = 1.689535
Validation band_gap mae = 1.689535
Epoch 18
Validation mae = 1.758837
Validation band_gap mae = 1.758837
Epoch 19
Validation mae = 1.759872
Validation band_gap mae = 1.759872
Epoch 20
Validation mae = 1.765325
Validation band_gap mae = 1.765325
Epoch 21
Validation mae = 1.820329
Validation band_gap mae = 1.820329
Epoch 22
Validation mae = 1.952736
Validation band_gap mae = 1.952736
Epoch 23
Validation mae = 1.774285
Validation band_gap mae = 1.774285
Epoch 24
Validation mae = 1.742044
Validation band_gap mae = 1.742044
Epoch 25
Validation mae = 1.724341
Validation band_gap mae = 1.724341
Epoch 26
Validation mae = 1.748473
Validation band_gap mae = 1.748473
Epoch 27
Validation mae = 1.813842
Validation band_gap mae = 1.813842
Epoch 28
Validation mae = 1.711771
Validation band_gap mae = 1.711771
Epoch 29
Validation mae = 1.754290
Validation band_gap mae = 1.754290
Epoch 30
Validation mae = 1.680660
Validation band_gap mae = 1.680660
Epoch 31
Validation mae = 1.687917
Validation band_gap mae = 1.687917
Epoch 32
Validation mae = 1.763255
Validation band_gap mae = 1.763255
Epoch 33
Validation mae = 1.733525
Validation band_gap mae = 1.733525
Epoch 34
Validation mae = 1.711290
Validation band_gap mae = 1.711290
Epoch 35
Validation mae = 1.772738
Validation band_gap mae = 1.772738
Epoch 36
Validation mae = 1.839923
Validation band_gap mae = 1.839923
Epoch 37
Validation mae = 1.751049
Validation band_gap mae = 1.751049
Epoch 38
Validation mae = 1.716440
Validation band_gap mae = 1.716440
Epoch 39
Validation mae = 1.701497
Validation band_gap mae = 1.701497
Epoch 40
Validation mae = 1.737161
Validation band_gap mae = 1.737161
Epoch 41
Validation mae = 1.695322
Validation band_gap mae = 1.695322
Epoch 42
Validation mae = 1.739310
Validation band_gap mae = 1.739310
Epoch 43
Validation mae = 1.769800
Validation band_gap mae = 1.769800
Epoch 44
Validation mae = 1.751874
Validation band_gap mae = 1.751874
Epoch 45
Validation mae = 1.716173
Validation band_gap mae = 1.716173
Epoch 46
Validation mae = 1.805439
Validation band_gap mae = 1.805439
Epoch 47
Validation mae = 1.802251
Validation band_gap mae = 1.802251
Epoch 48
Validation mae = 1.846068
Validation band_gap mae = 1.846068
Epoch 49
Validation mae = 1.777594
Validation band_gap mae = 1.777594
Epoch 50
Validation mae = 1.745625
Validation band_gap mae = 1.745625
Epoch 51
Validation mae = 1.811941
Validation band_gap mae = 1.811941
Epoch 52
Validation mae = 1.705768
Validation band_gap mae = 1.705768
Epoch 53
Validation mae = 1.696789
Validation band_gap mae = 1.696789
Epoch 54
Validation mae = 1.718005
Validation band_gap mae = 1.718005
Epoch 55
Validation mae = 1.752120
Validation band_gap mae = 1.752120
Epoch 56
Validation mae = 1.713325
Validation band_gap mae = 1.713325
Epoch 57
Validation mae = 1.734357
Validation band_gap mae = 1.734357
Epoch 58
Validation mae = 1.847526
Validation band_gap mae = 1.847526
Epoch 59
Validation mae = 1.830608
Validation band_gap mae = 1.830608
Epoch 60
Validation mae = 1.761847
Validation band_gap mae = 1.761847
Epoch 61
Validation mae = 1.747983
Validation band_gap mae = 1.747983
Epoch 62
Validation mae = 1.738174
Validation band_gap mae = 1.738174
Epoch 63
Validation mae = 1.719646
Validation band_gap mae = 1.719646
Epoch 64
Validation mae = 1.743945
Validation band_gap mae = 1.743945
Epoch 65
Validation mae = 1.799460
Validation band_gap mae = 1.799460
Epoch 66
Validation mae = 1.840015
Validation band_gap mae = 1.840015
Epoch 67
Validation mae = 1.809898
Validation band_gap mae = 1.809898
Epoch 68
Validation mae = 1.821509
Validation band_gap mae = 1.821509
Epoch 69
Validation mae = 1.801421
Validation band_gap mae = 1.801421
Epoch 70
Validation mae = 1.741190
Validation band_gap mae = 1.741190
Epoch 71
Validation mae = 1.758717
Validation band_gap mae = 1.758717
Epoch 72
Validation mae = 1.709386
Validation band_gap mae = 1.709386
Epoch 73
Validation mae = 1.752788
Validation band_gap mae = 1.752788
Epoch 74
Validation mae = 1.816481
Validation band_gap mae = 1.816481
Epoch 75
Validation mae = 1.806901
Validation band_gap mae = 1.806901
Epoch 76
Validation mae = 1.744712
Validation band_gap mae = 1.744712
Epoch 77
Validation mae = 1.785691
Validation band_gap mae = 1.785691
Epoch 78
Validation mae = 1.724009
Validation band_gap mae = 1.724009
Epoch 79
Validation mae = 1.756628
Validation band_gap mae = 1.756628
Epoch 80
Validation mae = 1.961554
Validation band_gap mae = 1.961554
Epoch 81
Validation mae = 1.773898
Validation band_gap mae = 1.773898
Epoch 82
Validation mae = 1.839544
Validation band_gap mae = 1.839544
Epoch 83
Validation mae = 1.833680
Validation band_gap mae = 1.833680
Epoch 84
Validation mae = 1.739727
Validation band_gap mae = 1.739727
Epoch 85
Validation mae = 1.814857
Validation band_gap mae = 1.814857
Epoch 86
Validation mae = 1.855543
Validation band_gap mae = 1.855543
Epoch 87
Validation mae = 1.812482
Validation band_gap mae = 1.812482
Epoch 88
Validation mae = 1.894504
Validation band_gap mae = 1.894504
Epoch 89
Validation mae = 1.772303
Validation band_gap mae = 1.772303
Epoch 90
Validation mae = 1.874605
Validation band_gap mae = 1.874605
Epoch 91
Validation mae = 1.709612
Validation band_gap mae = 1.709612
Epoch 92
Validation mae = 1.795624
Validation band_gap mae = 1.795624
Epoch 93
Validation mae = 1.778216
Validation band_gap mae = 1.778216
Epoch 94
Validation mae = 1.744523
Validation band_gap mae = 1.744523
Epoch 95
Validation mae = 1.782588
Validation band_gap mae = 1.782588
Epoch 96
Validation mae = 1.771693
Validation band_gap mae = 1.771693
Epoch 97
Validation mae = 1.783814
Validation band_gap mae = 1.783814
Epoch 98
Validation mae = 1.803356
Validation band_gap mae = 1.803356
Epoch 99
Validation mae = 1.736443
Validation band_gap mae = 1.736443
Model 0 best validation mae = 2.037475 on epoch 1
Moving model to cuda
Model 0 test mae = 0.727681
Model 0 test band_gap mae = 0.727681
Ensemble test mae = 0.727681
Ensemble test band_gap mae = 0.727681
==================== fold 5 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.966010
Validation band_gap mae = 1.966010
Epoch 1
Validation mae = 1.876501
Validation band_gap mae = 1.876501
Epoch 2
Validation mae = 2.090835
Validation band_gap mae = 2.090835
Epoch 3
Validation mae = 1.881717
Validation band_gap mae = 1.881717
Epoch 4
Validation mae = 1.845788
Validation band_gap mae = 1.845788
Epoch 5
Validation mae = 1.878458
Validation band_gap mae = 1.878458
Epoch 6
Validation mae = 1.896167
Validation band_gap mae = 1.896167
Epoch 7
Validation mae = 1.836398
Validation band_gap mae = 1.836398
Epoch 8
Validation mae = 1.973086
Validation band_gap mae = 1.973086
Epoch 9
Validation mae = 1.860130
Validation band_gap mae = 1.860130
Epoch 10
Validation mae = 1.871009
Validation band_gap mae = 1.871009
Epoch 11
Validation mae = 1.986765
Validation band_gap mae = 1.986765
Epoch 12
Validation mae = 1.886947
Validation band_gap mae = 1.886947
Epoch 13
Validation mae = 1.840903
Validation band_gap mae = 1.840903
Epoch 14
Validation mae = 1.836952
Validation band_gap mae = 1.836952
Epoch 15
Validation mae = 1.879088
Validation band_gap mae = 1.879088
Epoch 16
Validation mae = 1.879371
Validation band_gap mae = 1.879371
Epoch 17
Validation mae = 1.861939
Validation band_gap mae = 1.861939
Epoch 18
Validation mae = 1.955231
Validation band_gap mae = 1.955231
Epoch 19
Validation mae = 1.962326
Validation band_gap mae = 1.962326
Epoch 20
Validation mae = 1.831682
Validation band_gap mae = 1.831682
Epoch 21
Validation mae = 1.838338
Validation band_gap mae = 1.838338
Epoch 22
Validation mae = 1.861484
Validation band_gap mae = 1.861484
Epoch 23
Validation mae = 1.879832
Validation band_gap mae = 1.879832
Epoch 24
Validation mae = 1.947627
Validation band_gap mae = 1.947627
Epoch 25
Validation mae = 1.838674
Validation band_gap mae = 1.838674
Epoch 26
Validation mae = 1.901312
Validation band_gap mae = 1.901312
Epoch 27
Validation mae = 1.857356
Validation band_gap mae = 1.857356
Epoch 28
Validation mae = 1.871085
Validation band_gap mae = 1.871085
Epoch 29
Validation mae = 1.851706
Validation band_gap mae = 1.851706
Epoch 30
Validation mae = 1.882348
Validation band_gap mae = 1.882348
Epoch 31
Validation mae = 1.844986
Validation band_gap mae = 1.844986
Epoch 32
Validation mae = 1.927650
Validation band_gap mae = 1.927650
Epoch 33
Validation mae = 1.852938
Validation band_gap mae = 1.852938
Epoch 34
Validation mae = 1.897208
Validation band_gap mae = 1.897208
Epoch 35
Validation mae = 1.882979
Validation band_gap mae = 1.882979
Epoch 36
Validation mae = 1.881052
Validation band_gap mae = 1.881052
Epoch 37
Validation mae = 1.908143
Validation band_gap mae = 1.908143
Epoch 38
Validation mae = 1.856804
Validation band_gap mae = 1.856804
Epoch 39
Validation mae = 1.887018
Validation band_gap mae = 1.887018
Epoch 40
Validation mae = 1.842449
Validation band_gap mae = 1.842449
Epoch 41
Validation mae = 1.897959
Validation band_gap mae = 1.897959
Epoch 42
Validation mae = 1.865127
Validation band_gap mae = 1.865127
Epoch 43
Validation mae = 1.856604
Validation band_gap mae = 1.856604
Epoch 44
Validation mae = 1.922101
Validation band_gap mae = 1.922101
Epoch 45
Validation mae = 1.858595
Validation band_gap mae = 1.858595
Epoch 46
Validation mae = 1.870815
Validation band_gap mae = 1.870815
Epoch 47
Validation mae = 1.908877
Validation band_gap mae = 1.908877
Epoch 48
Validation mae = 1.896598
Validation band_gap mae = 1.896598
Epoch 49
Validation mae = 1.889396
Validation band_gap mae = 1.889396
Epoch 50
Validation mae = 1.890493
Validation band_gap mae = 1.890493
Epoch 51
Validation mae = 1.860257
Validation band_gap mae = 1.860257
Epoch 52
Validation mae = 1.856325
Validation band_gap mae = 1.856325
Epoch 53
Validation mae = 1.886894
Validation band_gap mae = 1.886894
Epoch 54
Validation mae = 1.895045
Validation band_gap mae = 1.895045
Epoch 55
Validation mae = 1.893582
Validation band_gap mae = 1.893582
Epoch 56
Validation mae = 1.876779
Validation band_gap mae = 1.876779
Epoch 57
Validation mae = 1.877898
Validation band_gap mae = 1.877898
Epoch 58
Validation mae = 1.858824
Validation band_gap mae = 1.858824
Epoch 59
Validation mae = 1.872849
Validation band_gap mae = 1.872849
Epoch 60
Validation mae = 1.835357
Validation band_gap mae = 1.835357
Epoch 61
Validation mae = 1.865908
Validation band_gap mae = 1.865908
Epoch 62
Validation mae = 1.942395
Validation band_gap mae = 1.942395
Epoch 63
Validation mae = 1.852714
Validation band_gap mae = 1.852714
Epoch 64
Validation mae = 1.858795
Validation band_gap mae = 1.858795
Epoch 65
Validation mae = 1.873419
Validation band_gap mae = 1.873419
Epoch 66
Validation mae = 1.884419
Validation band_gap mae = 1.884419
Epoch 67
Validation mae = 1.899542
Validation band_gap mae = 1.899542
Epoch 68
Validation mae = 1.857907
Validation band_gap mae = 1.857907
Epoch 69
Validation mae = 1.866129
Validation band_gap mae = 1.866129
Epoch 70
Validation mae = 1.900124
Validation band_gap mae = 1.900124
Epoch 71
Validation mae = 1.874342
Validation band_gap mae = 1.874342
Epoch 72
Validation mae = 1.879332
Validation band_gap mae = 1.879332
Epoch 73
Validation mae = 1.914796
Validation band_gap mae = 1.914796
Epoch 74
Validation mae = 1.850689
Validation band_gap mae = 1.850689
Epoch 75
Validation mae = 1.965377
Validation band_gap mae = 1.965377
Epoch 76
Validation mae = 1.953650
Validation band_gap mae = 1.953650
Epoch 77
Validation mae = 1.872478
Validation band_gap mae = 1.872478
Epoch 78
Validation mae = 1.927531
Validation band_gap mae = 1.927531
Epoch 79
Validation mae = 1.873188
Validation band_gap mae = 1.873188
Epoch 80
Validation mae = 1.915578
Validation band_gap mae = 1.915578
Epoch 81
Validation mae = 1.867299
Validation band_gap mae = 1.867299
Epoch 82
Validation mae = 1.900891
Validation band_gap mae = 1.900891
Epoch 83
Validation mae = 1.878962
Validation band_gap mae = 1.878962
Epoch 84
Validation mae = 1.871888
Validation band_gap mae = 1.871888
Epoch 85
Validation mae = 1.895647
Validation band_gap mae = 1.895647
Epoch 86
Validation mae = 1.868651
Validation band_gap mae = 1.868651
Epoch 87
Validation mae = 1.888506
Validation band_gap mae = 1.888506
Epoch 88
Validation mae = 1.869009
Validation band_gap mae = 1.869009
Epoch 89
Validation mae = 1.895749
Validation band_gap mae = 1.895749
Epoch 90
Validation mae = 1.870123
Validation band_gap mae = 1.870123
Epoch 91
Validation mae = 1.883189
Validation band_gap mae = 1.883189
Epoch 92
Validation mae = 1.881261
Validation band_gap mae = 1.881261
Epoch 93
Validation mae = 1.880524
Validation band_gap mae = 1.880524
Epoch 94
Validation mae = 1.881320
Validation band_gap mae = 1.881320
Epoch 95
Validation mae = 1.849387
Validation band_gap mae = 1.849387
Epoch 96
Validation mae = 1.906995
Validation band_gap mae = 1.906995
Epoch 97
Validation mae = 1.903490
Validation band_gap mae = 1.903490
Epoch 98
Validation mae = 1.849988
Validation band_gap mae = 1.849988
Epoch 99
Validation mae = 1.879199
Validation band_gap mae = 1.879199
Model 0 best validation mae = 2.090835 on epoch 2
Moving model to cuda
Model 0 test mae = 0.524841
Model 0 test band_gap mae = 0.524841
Ensemble test mae = 0.524841
Ensemble test band_gap mae = 0.524841
==================== fold 6 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.150379
Validation band_gap mae = 1.150379
Epoch 1
Validation mae = 1.061179
Validation band_gap mae = 1.061179
Epoch 2
Validation mae = 0.763912
Validation band_gap mae = 0.763912
Epoch 3
Validation mae = 0.762075
Validation band_gap mae = 0.762075
Epoch 4
Validation mae = 0.822348
Validation band_gap mae = 0.822348
Epoch 5
Validation mae = 0.876416
Validation band_gap mae = 0.876416
Epoch 6
Validation mae = 0.651439
Validation band_gap mae = 0.651439
Epoch 7
Validation mae = 0.876462
Validation band_gap mae = 0.876462
Epoch 8
Validation mae = 0.757105
Validation band_gap mae = 0.757105
Epoch 9
Validation mae = 0.904546
Validation band_gap mae = 0.904546
Epoch 10
Validation mae = 1.049657
Validation band_gap mae = 1.049657
Epoch 11
Validation mae = 0.918228
Validation band_gap mae = 0.918228
Epoch 12
Validation mae = 0.921819
Validation band_gap mae = 0.921819
Epoch 13
Validation mae = 1.045701
Validation band_gap mae = 1.045701
Epoch 14
Validation mae = 0.873444
Validation band_gap mae = 0.873444
Epoch 15
Validation mae = 0.920094
Validation band_gap mae = 0.920094
Epoch 16
Validation mae = 0.728515
Validation band_gap mae = 0.728515
Epoch 17
Validation mae = 0.600880
Validation band_gap mae = 0.600880
Epoch 18
Validation mae = 0.790048
Validation band_gap mae = 0.790048
Epoch 19
Validation mae = 1.315987
Validation band_gap mae = 1.315987
Epoch 20
Validation mae = 0.623122
Validation band_gap mae = 0.623122
Epoch 21
Validation mae = 0.817286
Validation band_gap mae = 0.817286
Epoch 22
Validation mae = 0.636268
Validation band_gap mae = 0.636268
Epoch 23
Validation mae = 0.673233
Validation band_gap mae = 0.673233
Epoch 24
Validation mae = 0.896540
Validation band_gap mae = 0.896540
Epoch 25
Validation mae = 0.576806
Validation band_gap mae = 0.576806
Epoch 26
Validation mae = 0.938426
Validation band_gap mae = 0.938426
Epoch 27
Validation mae = 1.215667
Validation band_gap mae = 1.215667
Epoch 28
Validation mae = 0.782475
Validation band_gap mae = 0.782475
Epoch 29
Validation mae = 0.859578
Validation band_gap mae = 0.859578
Epoch 30
Validation mae = 0.906606
Validation band_gap mae = 0.906606
Epoch 31
Validation mae = 0.987444
Validation band_gap mae = 0.987444
Epoch 32
Validation mae = 0.675029
Validation band_gap mae = 0.675029
Epoch 33
Validation mae = 0.627150
Validation band_gap mae = 0.627150
Epoch 34
Validation mae = 0.784331
Validation band_gap mae = 0.784331
Epoch 35
Validation mae = 0.706425
Validation band_gap mae = 0.706425
Epoch 36
Validation mae = 0.666832
Validation band_gap mae = 0.666832
Epoch 37
Validation mae = 0.768458
Validation band_gap mae = 0.768458
Epoch 38
Validation mae = 0.983841
Validation band_gap mae = 0.983841
Epoch 39
Validation mae = 0.806067
Validation band_gap mae = 0.806067
Epoch 40
Validation mae = 0.889921
Validation band_gap mae = 0.889921
Epoch 41
Validation mae = 0.674766
Validation band_gap mae = 0.674766
Epoch 42
Validation mae = 0.689469
Validation band_gap mae = 0.689469
Epoch 43
Validation mae = 1.159440
Validation band_gap mae = 1.159440
Epoch 44
Validation mae = 0.774367
Validation band_gap mae = 0.774367
Epoch 45
Validation mae = 0.981173
Validation band_gap mae = 0.981173
Epoch 46
Validation mae = 0.993724
Validation band_gap mae = 0.993724
Epoch 47
Validation mae = 0.682385
Validation band_gap mae = 0.682385
Epoch 48
Validation mae = 1.204862
Validation band_gap mae = 1.204862
Epoch 49
Validation mae = 0.790446
Validation band_gap mae = 0.790446
Epoch 50
Validation mae = 0.678160
Validation band_gap mae = 0.678160
Epoch 51
Validation mae = 0.900956
Validation band_gap mae = 0.900956
Epoch 52
Validation mae = 0.601562
Validation band_gap mae = 0.601562
Epoch 53
Validation mae = 0.627837
Validation band_gap mae = 0.627837
Epoch 54
Validation mae = 0.607271
Validation band_gap mae = 0.607271
Epoch 55
Validation mae = 0.794065
Validation band_gap mae = 0.794065
Epoch 56
Validation mae = 0.795600
Validation band_gap mae = 0.795600
Epoch 57
Validation mae = 0.628087
Validation band_gap mae = 0.628087
Epoch 58
Validation mae = 0.796060
Validation band_gap mae = 0.796060
Epoch 59
Validation mae = 0.793568
Validation band_gap mae = 0.793568
Epoch 60
Validation mae = 0.902210
Validation band_gap mae = 0.902210
Epoch 61
Validation mae = 0.791655
Validation band_gap mae = 0.791655
Epoch 62
Validation mae = 0.971378
Validation band_gap mae = 0.971378
Epoch 63
Validation mae = 0.731016
Validation band_gap mae = 0.731016
Epoch 64
Validation mae = 0.627532
Validation band_gap mae = 0.627532
Epoch 65
Validation mae = 0.651562
Validation band_gap mae = 0.651562
Epoch 66
Validation mae = 0.926429
Validation band_gap mae = 0.926429
Epoch 67
Validation mae = 0.996577
Validation band_gap mae = 0.996577
Epoch 68
Validation mae = 1.297576
Validation band_gap mae = 1.297576
Epoch 69
Validation mae = 0.584147
Validation band_gap mae = 0.584147
Epoch 70
Validation mae = 1.157156
Validation band_gap mae = 1.157156
Epoch 71
Validation mae = 0.620069
Validation band_gap mae = 0.620069
Epoch 72
Validation mae = 0.626825
Validation band_gap mae = 0.626825
Epoch 73
Validation mae = 1.080326
Validation band_gap mae = 1.080326
Epoch 74
Validation mae = 0.767923
Validation band_gap mae = 0.767923
Epoch 75
Validation mae = 0.601193
Validation band_gap mae = 0.601193
Epoch 76
Validation mae = 1.060423
Validation band_gap mae = 1.060423
Epoch 77
Validation mae = 0.739258
Validation band_gap mae = 0.739258
Epoch 78
Validation mae = 1.076825
Validation band_gap mae = 1.076825
Epoch 79
Validation mae = 0.721753
Validation band_gap mae = 0.721753
Epoch 80
Validation mae = 1.199069
Validation band_gap mae = 1.199069
Epoch 81
Validation mae = 0.916501
Validation band_gap mae = 0.916501
Epoch 82
Validation mae = 2.691513
Validation band_gap mae = 2.691513
Epoch 83
Validation mae = 0.841721
Validation band_gap mae = 0.841721
Epoch 84
Validation mae = 1.221599
Validation band_gap mae = 1.221599
Epoch 85
Validation mae = 1.064329
Validation band_gap mae = 1.064329
Epoch 86
Validation mae = 1.040509
Validation band_gap mae = 1.040509
Epoch 87
Validation mae = 1.507881
Validation band_gap mae = 1.507881
Epoch 88
Validation mae = 1.816918
Validation band_gap mae = 1.816918
Epoch 89
Validation mae = 0.917929
Validation band_gap mae = 0.917929
Epoch 90
Validation mae = 0.615770
Validation band_gap mae = 0.615770
Epoch 91
Validation mae = 1.393781
Validation band_gap mae = 1.393781
Epoch 92
Validation mae = 1.004303
Validation band_gap mae = 1.004303
Epoch 93
Validation mae = 1.006876
Validation band_gap mae = 1.006876
Epoch 94
Validation mae = 1.001363
Validation band_gap mae = 1.001363
Epoch 95
Validation mae = 0.900487
Validation band_gap mae = 0.900487
Epoch 96
Validation mae = 0.988860
Validation band_gap mae = 0.988860
Epoch 97
Validation mae = 0.865521
Validation band_gap mae = 0.865521
Epoch 98
Validation mae = 0.812168
Validation band_gap mae = 0.812168
Epoch 99
Validation mae = 0.892136
Validation band_gap mae = 0.892136
Model 0 best validation mae = 2.691513 on epoch 82
Moving model to cuda
Model 0 test mae = 1.684244
Model 0 test band_gap mae = 1.684244
Ensemble test mae = 1.684244
Ensemble test band_gap mae = 1.684244
==================== fold 7 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.589301
Validation band_gap mae = 0.589301
Epoch 1
Validation mae = 0.633892
Validation band_gap mae = 0.633892
Epoch 2
Validation mae = 0.355308
Validation band_gap mae = 0.355308
Epoch 3
Validation mae = 0.311648
Validation band_gap mae = 0.311648
Epoch 4
Validation mae = 0.411462
Validation band_gap mae = 0.411462
Epoch 5
Validation mae = 0.328263
Validation band_gap mae = 0.328263
Epoch 6
Validation mae = 0.344827
Validation band_gap mae = 0.344827
Epoch 7
Validation mae = 0.406765
Validation band_gap mae = 0.406765
Epoch 8
Validation mae = 0.354483
Validation band_gap mae = 0.354483
Epoch 9
Validation mae = 0.392339
Validation band_gap mae = 0.392339
Epoch 10
Validation mae = 0.341336
Validation band_gap mae = 0.341336
Epoch 11
Validation mae = 0.307393
Validation band_gap mae = 0.307393
Epoch 12
Validation mae = 0.600013
Validation band_gap mae = 0.600013
Epoch 13
Validation mae = 0.489717
Validation band_gap mae = 0.489717
Epoch 14
Validation mae = 0.530425
Validation band_gap mae = 0.530425
Epoch 15
Validation mae = 0.440312
Validation band_gap mae = 0.440312
Epoch 16
Validation mae = 0.297288
Validation band_gap mae = 0.297288
Epoch 17
Validation mae = 0.326144
Validation band_gap mae = 0.326144
Epoch 18
Validation mae = 0.292586
Validation band_gap mae = 0.292586
Epoch 19
Validation mae = 0.323421
Validation band_gap mae = 0.323421
Epoch 20
Validation mae = 0.432258
Validation band_gap mae = 0.432258
Epoch 21
Validation mae = 0.333342
Validation band_gap mae = 0.333342
Epoch 22
Validation mae = 0.471521
Validation band_gap mae = 0.471521
Epoch 23
Validation mae = 0.410982
Validation band_gap mae = 0.410982
Epoch 24
Validation mae = 0.352729
Validation band_gap mae = 0.352729
Epoch 25
Validation mae = 0.398940
Validation band_gap mae = 0.398940
Epoch 26
Validation mae = 0.342487
Validation band_gap mae = 0.342487
Epoch 27
Validation mae = 0.348147
Validation band_gap mae = 0.348147
Epoch 28
Validation mae = 0.498111
Validation band_gap mae = 0.498111
Epoch 29
Validation mae = 0.391586
Validation band_gap mae = 0.391586
Epoch 30
Validation mae = 0.407123
Validation band_gap mae = 0.407123
Epoch 31
Validation mae = 0.344444
Validation band_gap mae = 0.344444
Epoch 32
Validation mae = 0.338362
Validation band_gap mae = 0.338362
Epoch 33
Validation mae = 0.283918
Validation band_gap mae = 0.283918
Epoch 34
Validation mae = 0.331965
Validation band_gap mae = 0.331965
Epoch 35
Validation mae = 0.529951
Validation band_gap mae = 0.529951
Epoch 36
Validation mae = 0.386010
Validation band_gap mae = 0.386010
Epoch 37
Validation mae = 0.366254
Validation band_gap mae = 0.366254
Epoch 38
Validation mae = 0.315817
Validation band_gap mae = 0.315817
Epoch 39
Validation mae = 0.321077
Validation band_gap mae = 0.321077
Epoch 40
Validation mae = 0.292911
Validation band_gap mae = 0.292911
Epoch 41
Validation mae = 0.346171
Validation band_gap mae = 0.346171
Epoch 42
Validation mae = 0.342149
Validation band_gap mae = 0.342149
Epoch 43
Validation mae = 0.389707
Validation band_gap mae = 0.389707
Epoch 44
Validation mae = 0.318825
Validation band_gap mae = 0.318825
Epoch 45
Validation mae = 0.367686
Validation band_gap mae = 0.367686
Epoch 46
Validation mae = 0.375015
Validation band_gap mae = 0.375015
Epoch 47
Validation mae = 0.332358
Validation band_gap mae = 0.332358
Epoch 48
Validation mae = 0.295466
Validation band_gap mae = 0.295466
Epoch 49
Validation mae = 0.404351
Validation band_gap mae = 0.404351
Epoch 50
Validation mae = 0.292859
Validation band_gap mae = 0.292859
Epoch 51
Validation mae = 0.571572
Validation band_gap mae = 0.571572
Epoch 52
Validation mae = 0.343354
Validation band_gap mae = 0.343354
Epoch 53
Validation mae = 0.328153
Validation band_gap mae = 0.328153
Epoch 54
Validation mae = 0.340677
Validation band_gap mae = 0.340677
Epoch 55
Validation mae = 0.338621
Validation band_gap mae = 0.338621
Epoch 56
Validation mae = 0.311043
Validation band_gap mae = 0.311043
Epoch 57
Validation mae = 0.399379
Validation band_gap mae = 0.399379
Epoch 58
Validation mae = 0.427640
Validation band_gap mae = 0.427640
Epoch 59
Validation mae = 0.309147
Validation band_gap mae = 0.309147
Epoch 60
Validation mae = 0.410399
Validation band_gap mae = 0.410399
Epoch 61
Validation mae = 0.326471
Validation band_gap mae = 0.326471
Epoch 62
Validation mae = 0.348832
Validation band_gap mae = 0.348832
Epoch 63
Validation mae = 0.445532
Validation band_gap mae = 0.445532
Epoch 64
Validation mae = 0.404386
Validation band_gap mae = 0.404386
Epoch 65
Validation mae = 0.346296
Validation band_gap mae = 0.346296
Epoch 66
Validation mae = 0.293057
Validation band_gap mae = 0.293057
Epoch 67
Validation mae = 0.323081
Validation band_gap mae = 0.323081
Epoch 68
Validation mae = 0.575930
Validation band_gap mae = 0.575930
Epoch 69
Validation mae = 0.293237
Validation band_gap mae = 0.293237
Epoch 70
Validation mae = 0.312025
Validation band_gap mae = 0.312025
Epoch 71
Validation mae = 0.280643
Validation band_gap mae = 0.280643
Epoch 72
Validation mae = 0.257052
Validation band_gap mae = 0.257052
Epoch 73
Validation mae = 0.232027
Validation band_gap mae = 0.232027
Epoch 74
Validation mae = 0.196674
Validation band_gap mae = 0.196674
Epoch 75
Validation mae = 0.299106
Validation band_gap mae = 0.299106
Epoch 76
Validation mae = 0.241867
Validation band_gap mae = 0.241867
Epoch 77
Validation mae = 0.266571
Validation band_gap mae = 0.266571
Epoch 78
Validation mae = 0.303366
Validation band_gap mae = 0.303366
Epoch 79
Validation mae = 0.242957
Validation band_gap mae = 0.242957
Epoch 80
Validation mae = 0.214482
Validation band_gap mae = 0.214482
Epoch 81
Validation mae = 0.335380
Validation band_gap mae = 0.335380
Epoch 82
Validation mae = 0.214943
Validation band_gap mae = 0.214943
Epoch 83
Validation mae = 0.301735
Validation band_gap mae = 0.301735
Epoch 84
Validation mae = 0.231301
Validation band_gap mae = 0.231301
Epoch 85
Validation mae = 0.271617
Validation band_gap mae = 0.271617
Epoch 86
Validation mae = 0.260153
Validation band_gap mae = 0.260153
Epoch 87
Validation mae = 0.258065
Validation band_gap mae = 0.258065
Epoch 88
Validation mae = 0.279038
Validation band_gap mae = 0.279038
Epoch 89
Validation mae = 0.241280
Validation band_gap mae = 0.241280
Epoch 90
Validation mae = 0.258387
Validation band_gap mae = 0.258387
Epoch 91
Validation mae = 0.259615
Validation band_gap mae = 0.259615
Epoch 92
Validation mae = 0.253327
Validation band_gap mae = 0.253327
Epoch 93
Validation mae = 0.252952
Validation band_gap mae = 0.252952
Epoch 94
Validation mae = 0.243648
Validation band_gap mae = 0.243648
Epoch 95
Validation mae = 0.248620
Validation band_gap mae = 0.248620
Epoch 96
Validation mae = 0.224644
Validation band_gap mae = 0.224644
Epoch 97
Validation mae = 0.273947
Validation band_gap mae = 0.273947
Epoch 98
Validation mae = 0.217359
Validation band_gap mae = 0.217359
Epoch 99
Validation mae = 0.244521
Validation band_gap mae = 0.244521
Model 0 best validation mae = 0.633892 on epoch 1
Moving model to cuda
Model 0 test mae = 0.564287
Model 0 test band_gap mae = 0.564287
Ensemble test mae = 0.564287
Ensemble test band_gap mae = 0.564287
==================== fold 8 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.378921
Validation band_gap mae = 0.378921
Epoch 1
Validation mae = 0.406894
Validation band_gap mae = 0.406894
Epoch 2
Validation mae = 0.395109
Validation band_gap mae = 0.395109
Epoch 3
Validation mae = 0.357655
Validation band_gap mae = 0.357655
Epoch 4
Validation mae = 0.419650
Validation band_gap mae = 0.419650
Epoch 5
Validation mae = 0.404436
Validation band_gap mae = 0.404436
Epoch 6
Validation mae = 0.556223
Validation band_gap mae = 0.556223
Epoch 7
Validation mae = 0.355407
Validation band_gap mae = 0.355407
Epoch 8
Validation mae = 0.356308
Validation band_gap mae = 0.356308
Epoch 9
Validation mae = 0.391990
Validation band_gap mae = 0.391990
Epoch 10
Validation mae = 0.353261
Validation band_gap mae = 0.353261
Epoch 11
Validation mae = 0.407748
Validation band_gap mae = 0.407748
Epoch 12
Validation mae = 0.380759
Validation band_gap mae = 0.380759
Epoch 13
Validation mae = 0.361564
Validation band_gap mae = 0.361564
Epoch 14
Validation mae = 0.370955
Validation band_gap mae = 0.370955
Epoch 15
Validation mae = 0.341726
Validation band_gap mae = 0.341726
Epoch 16
Validation mae = 0.362050
Validation band_gap mae = 0.362050
Epoch 17
Validation mae = 0.382983
Validation band_gap mae = 0.382983
Epoch 18
Validation mae = 0.432894
Validation band_gap mae = 0.432894
Epoch 19
Validation mae = 0.368215
Validation band_gap mae = 0.368215
Epoch 20
Validation mae = 0.386071
Validation band_gap mae = 0.386071
Epoch 21
Validation mae = 0.379016
Validation band_gap mae = 0.379016
Epoch 22
Validation mae = 0.361631
Validation band_gap mae = 0.361631
Epoch 23
Validation mae = 0.386306
Validation band_gap mae = 0.386306
Epoch 24
Validation mae = 0.351401
Validation band_gap mae = 0.351401
Epoch 25
Validation mae = 0.428201
Validation band_gap mae = 0.428201
Epoch 26
Validation mae = 0.415258
Validation band_gap mae = 0.415258
Epoch 27
Validation mae = 0.455605
Validation band_gap mae = 0.455605
Epoch 28
Validation mae = 0.396958
Validation band_gap mae = 0.396958
Epoch 29
Validation mae = 0.359894
Validation band_gap mae = 0.359894
Epoch 30
Validation mae = 0.349585
Validation band_gap mae = 0.349585
Epoch 31
Validation mae = 0.385902
Validation band_gap mae = 0.385902
Epoch 32
Validation mae = 0.444246
Validation band_gap mae = 0.444246
Epoch 33
Validation mae = 0.438290
Validation band_gap mae = 0.438290
Epoch 34
Validation mae = 0.425281
Validation band_gap mae = 0.425281
Epoch 35
Validation mae = 0.437685
Validation band_gap mae = 0.437685
Epoch 36
Validation mae = 0.448126
Validation band_gap mae = 0.448126
Epoch 37
Validation mae = 0.408607
Validation band_gap mae = 0.408607
Epoch 38
Validation mae = 0.396437
Validation band_gap mae = 0.396437
Epoch 39
Validation mae = 0.406432
Validation band_gap mae = 0.406432
Epoch 40
Validation mae = 0.363960
Validation band_gap mae = 0.363960
Epoch 41
Validation mae = 0.368908
Validation band_gap mae = 0.368908
Epoch 42
Validation mae = 0.368377
Validation band_gap mae = 0.368377
Epoch 43
Validation mae = 0.398315
Validation band_gap mae = 0.398315
Epoch 44
Validation mae = 0.662705
Validation band_gap mae = 0.662705
Epoch 45
Validation mae = 0.466663
Validation band_gap mae = 0.466663
Epoch 46
Validation mae = 0.370721
Validation band_gap mae = 0.370721
Epoch 47
Validation mae = 0.350606
Validation band_gap mae = 0.350606
Epoch 48
Validation mae = 0.425167
Validation band_gap mae = 0.425167
Epoch 49
Validation mae = 0.379190
Validation band_gap mae = 0.379190
Epoch 50
Validation mae = 0.394548
Validation band_gap mae = 0.394548
Epoch 51
Validation mae = 0.455096
Validation band_gap mae = 0.455096
Epoch 52
Validation mae = 0.448187
Validation band_gap mae = 0.448187
Epoch 53
Validation mae = 0.357367
Validation band_gap mae = 0.357367
Epoch 54
Validation mae = 0.440805
Validation band_gap mae = 0.440805
Epoch 55
Validation mae = 0.379980
Validation band_gap mae = 0.379980
Epoch 56
Validation mae = 0.398688
Validation band_gap mae = 0.398688
Epoch 57
Validation mae = 0.392247
Validation band_gap mae = 0.392247
Epoch 58
Validation mae = 0.389425
Validation band_gap mae = 0.389425
Epoch 59
Validation mae = 0.394486
Validation band_gap mae = 0.394486
Epoch 60
Validation mae = 0.401205
Validation band_gap mae = 0.401205
Epoch 61
Validation mae = 0.401155
Validation band_gap mae = 0.401155
Epoch 62
Validation mae = 0.382853
Validation band_gap mae = 0.382853
Epoch 63
Validation mae = 0.391785
Validation band_gap mae = 0.391785
Epoch 64
Validation mae = 0.398612
Validation band_gap mae = 0.398612
Epoch 65
Validation mae = 0.437103
Validation band_gap mae = 0.437103
Epoch 66
Validation mae = 0.413182
Validation band_gap mae = 0.413182
Epoch 67
Validation mae = 0.412618
Validation band_gap mae = 0.412618
Epoch 68
Validation mae = 0.409281
Validation band_gap mae = 0.409281
Epoch 69
Validation mae = 0.400162
Validation band_gap mae = 0.400162
Epoch 70
Validation mae = 0.406212
Validation band_gap mae = 0.406212
Epoch 71
Validation mae = 0.407869
Validation band_gap mae = 0.407869
Epoch 72
Validation mae = 0.403341
Validation band_gap mae = 0.403341
Epoch 73
Validation mae = 0.410208
Validation band_gap mae = 0.410208
Epoch 74
Validation mae = 0.402989
Validation band_gap mae = 0.402989
Epoch 75
Validation mae = 0.403836
Validation band_gap mae = 0.403836
Epoch 76
Validation mae = 0.409011
Validation band_gap mae = 0.409011
Epoch 77
Validation mae = 0.403313
Validation band_gap mae = 0.403313
Epoch 78
Validation mae = 0.400556
Validation band_gap mae = 0.400556
Epoch 79
Validation mae = 0.404334
Validation band_gap mae = 0.404334
Epoch 80
Validation mae = 0.399249
Validation band_gap mae = 0.399249
Epoch 81
Validation mae = 0.424225
Validation band_gap mae = 0.424225
Epoch 82
Validation mae = 0.420317
Validation band_gap mae = 0.420317
Epoch 83
Validation mae = 0.415636
Validation band_gap mae = 0.415636
Epoch 84
Validation mae = 0.407011
Validation band_gap mae = 0.407011
Epoch 85
Validation mae = 0.408201
Validation band_gap mae = 0.408201
Epoch 86
Validation mae = 0.398692
Validation band_gap mae = 0.398692
Epoch 87
Validation mae = 0.410840
Validation band_gap mae = 0.410840
Epoch 88
Validation mae = 0.386567
Validation band_gap mae = 0.386567
Epoch 89
Validation mae = 0.404050
Validation band_gap mae = 0.404050
Epoch 90
Validation mae = 0.398001
Validation band_gap mae = 0.398001
Epoch 91
Validation mae = 0.396707
Validation band_gap mae = 0.396707
Epoch 92
Validation mae = 0.410297
Validation band_gap mae = 0.410297
Epoch 93
Validation mae = 0.417869
Validation band_gap mae = 0.417869
Epoch 94
Validation mae = 0.387818
Validation band_gap mae = 0.387818
Epoch 95
Validation mae = 0.398874
Validation band_gap mae = 0.398874
Epoch 96
Validation mae = 0.398281
Validation band_gap mae = 0.398281
Epoch 97
Validation mae = 0.390658
Validation band_gap mae = 0.390658
Epoch 98
Validation mae = 0.400984
Validation band_gap mae = 0.400984
Epoch 99
Validation mae = 0.401455
Validation band_gap mae = 0.401455
Model 0 best validation mae = 0.662705 on epoch 44
Moving model to cuda
Model 0 test mae = 0.473685
Model 0 test band_gap mae = 0.473685
Ensemble test mae = 0.473685
Ensemble test band_gap mae = 0.473685
==================== fold 9 ====================
Total size = 919 | train size = 737 | val size = 91 | test size = 91
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.346754
Validation band_gap mae = 0.346754
Epoch 1
Validation mae = 0.449495
Validation band_gap mae = 0.449495
Epoch 2
Validation mae = 0.399187
Validation band_gap mae = 0.399187
Epoch 3
Validation mae = 0.523161
Validation band_gap mae = 0.523161
Epoch 4
Validation mae = 0.405307
Validation band_gap mae = 0.405307
Epoch 5
Validation mae = 0.552826
Validation band_gap mae = 0.552826
Epoch 6
Validation mae = 0.651389
Validation band_gap mae = 0.651389
Epoch 7
Validation mae = 0.351991
Validation band_gap mae = 0.351991
Epoch 8
Validation mae = 0.367459
Validation band_gap mae = 0.367459
Epoch 9
Validation mae = 0.347089
Validation band_gap mae = 0.347089
Epoch 10
Validation mae = 0.475043
Validation band_gap mae = 0.475043
Epoch 11
Validation mae = 0.354521
Validation band_gap mae = 0.354521
Epoch 12
Validation mae = 0.422391
Validation band_gap mae = 0.422391
Epoch 13
Validation mae = 0.369995
Validation band_gap mae = 0.369995
Epoch 14
Validation mae = 0.605989
Validation band_gap mae = 0.605989
Epoch 15
Validation mae = 0.337076
Validation band_gap mae = 0.337076
Epoch 16
Validation mae = 0.513976
Validation band_gap mae = 0.513976
Epoch 17
Validation mae = 0.359636
Validation band_gap mae = 0.359636
Epoch 18
Validation mae = 0.461709
Validation band_gap mae = 0.461709
Epoch 19
Validation mae = 0.361885
Validation band_gap mae = 0.361885
Epoch 20
Validation mae = 0.454098
Validation band_gap mae = 0.454098
Epoch 21
Validation mae = 0.335394
Validation band_gap mae = 0.335394
Epoch 22
Validation mae = 0.370802
Validation band_gap mae = 0.370802
Epoch 23
Validation mae = 0.394544
Validation band_gap mae = 0.394544
Epoch 24
Validation mae = 0.570886
Validation band_gap mae = 0.570886
Epoch 25
Validation mae = 0.442002
Validation band_gap mae = 0.442002
Epoch 26
Validation mae = 0.722529
Validation band_gap mae = 0.722529
Epoch 27
Validation mae = 0.334245
Validation band_gap mae = 0.334245
Epoch 28
Validation mae = 0.599348
Validation band_gap mae = 0.599348
Epoch 29
Validation mae = 0.421297
Validation band_gap mae = 0.421297
Epoch 30
Validation mae = 0.333491
Validation band_gap mae = 0.333491
Epoch 31
Validation mae = 0.440307
Validation band_gap mae = 0.440307
Epoch 32
Validation mae = 0.340665
Validation band_gap mae = 0.340665
Epoch 33
Validation mae = 0.576577
Validation band_gap mae = 0.576577
Epoch 34
Validation mae = 0.481012
Validation band_gap mae = 0.481012
Epoch 35
Validation mae = 0.762144
Validation band_gap mae = 0.762144
Epoch 36
Validation mae = 0.368487
Validation band_gap mae = 0.368487
Epoch 37
Validation mae = 0.415613
Validation band_gap mae = 0.415613
Epoch 38
Validation mae = 0.421394
Validation band_gap mae = 0.421394
Epoch 39
Validation mae = 0.405402
Validation band_gap mae = 0.405402
Epoch 40
Validation mae = 0.567625
Validation band_gap mae = 0.567625
Epoch 41
Validation mae = 0.349447
Validation band_gap mae = 0.349447
Epoch 42
Validation mae = 0.341525
Validation band_gap mae = 0.341525
Epoch 43
Validation mae = 0.534034
Validation band_gap mae = 0.534034
Epoch 44
Validation mae = 0.641963
Validation band_gap mae = 0.641963
Epoch 45
Validation mae = 0.368373
Validation band_gap mae = 0.368373
Epoch 46
Validation mae = 0.454607
Validation band_gap mae = 0.454607
Epoch 47
Validation mae = 0.561954
Validation band_gap mae = 0.561954
Epoch 48
Validation mae = 0.444503
Validation band_gap mae = 0.444503
Epoch 49
Validation mae = 0.403358
Validation band_gap mae = 0.403358
Epoch 50
Validation mae = 0.622431
Validation band_gap mae = 0.622431
Epoch 51
Validation mae = 0.364032
Validation band_gap mae = 0.364032
Epoch 52
Validation mae = 0.441840
Validation band_gap mae = 0.441840
Epoch 53
Validation mae = 0.386682
Validation band_gap mae = 0.386682
Epoch 54
Validation mae = 0.400732
Validation band_gap mae = 0.400732
Epoch 55
Validation mae = 0.367151
Validation band_gap mae = 0.367151
Epoch 56
Validation mae = 0.410144
Validation band_gap mae = 0.410144
Epoch 57
Validation mae = 0.456006
Validation band_gap mae = 0.456006
Epoch 58
Validation mae = 0.416129
Validation band_gap mae = 0.416129
Epoch 59
Validation mae = 0.413854
Validation band_gap mae = 0.413854
Epoch 60
Validation mae = 0.539761
Validation band_gap mae = 0.539761
Epoch 61
Validation mae = 0.447595
Validation band_gap mae = 0.447595
Epoch 62
Validation mae = 0.366599
Validation band_gap mae = 0.366599
Epoch 63
Validation mae = 0.479928
Validation band_gap mae = 0.479928
Epoch 64
Validation mae = 0.397608
Validation band_gap mae = 0.397608
Epoch 65
Validation mae = 0.486315
Validation band_gap mae = 0.486315
Epoch 66
Validation mae = 0.608553
Validation band_gap mae = 0.608553
Epoch 67
Validation mae = 0.372598
Validation band_gap mae = 0.372598
Epoch 68
Validation mae = 0.347842
Validation band_gap mae = 0.347842
Epoch 69
Validation mae = 0.415802
Validation band_gap mae = 0.415802
Epoch 70
Validation mae = 0.548587
Validation band_gap mae = 0.548587
Epoch 71
Validation mae = 0.440525
Validation band_gap mae = 0.440525
Epoch 72
Validation mae = 0.591189
Validation band_gap mae = 0.591189
Epoch 73
Validation mae = 0.499370
Validation band_gap mae = 0.499370
Epoch 74
Validation mae = 0.497134
Validation band_gap mae = 0.497134
Epoch 75
Validation mae = 0.456258
Validation band_gap mae = 0.456258
Epoch 76
Validation mae = 0.576441
Validation band_gap mae = 0.576441
Epoch 77
Validation mae = 0.460784
Validation band_gap mae = 0.460784
Epoch 78
Validation mae = 0.496237
Validation band_gap mae = 0.496237
Epoch 79
Validation mae = 0.438109
Validation band_gap mae = 0.438109
Epoch 80
Validation mae = 0.570997
Validation band_gap mae = 0.570997
Epoch 81
Validation mae = 0.398191
Validation band_gap mae = 0.398191
Epoch 82
Validation mae = 0.581269
Validation band_gap mae = 0.581269
Epoch 83
Validation mae = 0.462719
Validation band_gap mae = 0.462719
Epoch 84
Validation mae = 0.537403
Validation band_gap mae = 0.537403
Epoch 85
Validation mae = 0.444288
Validation band_gap mae = 0.444288
Epoch 86
Validation mae = 0.469895
Validation band_gap mae = 0.469895
Epoch 87
Validation mae = 0.358945
Validation band_gap mae = 0.358945
Epoch 88
Validation mae = 0.398635
Validation band_gap mae = 0.398635
Epoch 89
Validation mae = 0.623839
Validation band_gap mae = 0.623839
Epoch 90
Validation mae = 0.311891
Validation band_gap mae = 0.311891
Epoch 91
Validation mae = 0.347602
Validation band_gap mae = 0.347602
Epoch 92
Validation mae = 0.387220
Validation band_gap mae = 0.387220
Epoch 93
Validation mae = 0.352841
Validation band_gap mae = 0.352841
Epoch 94
Validation mae = 0.344568
Validation band_gap mae = 0.344568
Epoch 95
Validation mae = 0.350056
Validation band_gap mae = 0.350056
Epoch 96
Validation mae = 0.367965
Validation band_gap mae = 0.367965
Epoch 97
Validation mae = 0.384092
Validation band_gap mae = 0.384092
Epoch 98
Validation mae = 0.351037
Validation band_gap mae = 0.351037
Epoch 99
Validation mae = 0.348456
Validation band_gap mae = 0.348456
Model 0 best validation mae = 0.762144 on epoch 35
Moving model to cuda
Model 0 test mae = 0.474849
Model 0 test band_gap mae = 0.474849
Ensemble test mae = 0.474849
Ensemble test band_gap mae = 0.474849
10-fold cross validation
Seed 1
Fold 0 ==> valid mae = 7.647833 test mae = 6.690854
Fold 0 ==> valid band_gap mae = 7.647833test band_gap mae = 6.690854
Fold 1 ==> valid mae = 5.196585 test mae = 3.177570
Fold 1 ==> valid band_gap mae = 5.196585test band_gap mae = 3.177570
Fold 2 ==> valid mae = 2.376824 test mae = 0.889665
Fold 2 ==> valid band_gap mae = 2.376824test band_gap mae = 0.889665
Fold 3 ==> valid mae = 2.157620 test mae = 0.452712
Fold 3 ==> valid band_gap mae = 2.157620test band_gap mae = 0.452712
Fold 4 ==> valid mae = 2.037475 test mae = 0.727681
Fold 4 ==> valid band_gap mae = 2.037475test band_gap mae = 0.727681
Fold 5 ==> valid mae = 2.090835 test mae = 0.524841
Fold 5 ==> valid band_gap mae = 2.090835test band_gap mae = 0.524841
Fold 6 ==> valid mae = 2.691513 test mae = 1.684244
Fold 6 ==> valid band_gap mae = 2.691513test band_gap mae = 1.684244
Fold 7 ==> valid mae = 0.633892 test mae = 0.564287
Fold 7 ==> valid band_gap mae = 0.633892test band_gap mae = 0.564287
Fold 8 ==> valid mae = 0.662705 test mae = 0.473685
Fold 8 ==> valid band_gap mae = 0.662705test band_gap mae = 0.473685
Fold 9 ==> valid mae = 0.762144 test mae = 0.474849
Fold 9 ==> valid band_gap mae = 0.762144test band_gap mae = 0.474849
Overall valid mae = 2.625742 +/- 2.098624
Overall test mae = 1.566039 +/- 1.890664
Overall test band_gap mae = 1.566039 +/- 1.890664
Loading data
Number of tasks = 1
Splitting data with seed 1
==================== fold 0 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 9.788796
Validation band_gap mae = 9.788796
Epoch 1
Validation mae = 8.944936
Validation band_gap mae = 8.944936
Epoch 2
Validation mae = 6.101202
Validation band_gap mae = 6.101202
Epoch 3
Validation mae = 4.495072
Validation band_gap mae = 4.495072
Epoch 4
Validation mae = 5.724254
Validation band_gap mae = 5.724254
Epoch 5
Validation mae = 4.504634
Validation band_gap mae = 4.504634
Epoch 6
Validation mae = 4.515033
Validation band_gap mae = 4.515033
Epoch 7
Validation mae = 4.129620
Validation band_gap mae = 4.129620
Epoch 8
Validation mae = 4.065550
Validation band_gap mae = 4.065550
Epoch 9
Validation mae = 4.206817
Validation band_gap mae = 4.206817
Epoch 10
Validation mae = 3.795715
Validation band_gap mae = 3.795715
Epoch 11
Validation mae = 3.907656
Validation band_gap mae = 3.907656
Epoch 12
Validation mae = 4.280801
Validation band_gap mae = 4.280801
Epoch 13
Validation mae = 3.991387
Validation band_gap mae = 3.991387
Epoch 14
Validation mae = 4.475164
Validation band_gap mae = 4.475164
Epoch 15
Validation mae = 4.295475
Validation band_gap mae = 4.295475
Epoch 16
Validation mae = 4.014945
Validation band_gap mae = 4.014945
Epoch 17
Validation mae = 3.650556
Validation band_gap mae = 3.650556
Epoch 18
Validation mae = 4.060011
Validation band_gap mae = 4.060011
Epoch 19
Validation mae = 4.084809
Validation band_gap mae = 4.084809
Epoch 20
Validation mae = 4.265609
Validation band_gap mae = 4.265609
Epoch 21
Validation mae = 3.917059
Validation band_gap mae = 3.917059
Epoch 22
Validation mae = 4.028052
Validation band_gap mae = 4.028052
Epoch 23
Validation mae = 3.843664
Validation band_gap mae = 3.843664
Epoch 24
Validation mae = 4.009209
Validation band_gap mae = 4.009209
Epoch 25
Validation mae = 3.933326
Validation band_gap mae = 3.933326
Epoch 26
Validation mae = 4.080897
Validation band_gap mae = 4.080897
Epoch 27
Validation mae = 3.639331
Validation band_gap mae = 3.639331
Epoch 28
Validation mae = 3.804598
Validation band_gap mae = 3.804598
Epoch 29
Validation mae = 3.627474
Validation band_gap mae = 3.627474
Epoch 30
Validation mae = 3.646009
Validation band_gap mae = 3.646009
Epoch 31
Validation mae = 3.642344
Validation band_gap mae = 3.642344
Epoch 32
Validation mae = 3.782359
Validation band_gap mae = 3.782359
Epoch 33
Validation mae = 4.002986
Validation band_gap mae = 4.002986
Epoch 34
Validation mae = 3.728695
Validation band_gap mae = 3.728695
Epoch 35
Validation mae = 3.748405
Validation band_gap mae = 3.748405
Epoch 36
Validation mae = 3.823486
Validation band_gap mae = 3.823486
Epoch 37
Validation mae = 3.522435
Validation band_gap mae = 3.522435
Epoch 38
Validation mae = 3.589648
Validation band_gap mae = 3.589648
Epoch 39
Validation mae = 3.757018
Validation band_gap mae = 3.757018
Epoch 40
Validation mae = 3.452568
Validation band_gap mae = 3.452568
Epoch 41
Validation mae = 3.577972
Validation band_gap mae = 3.577972
Epoch 42
Validation mae = 3.789532
Validation band_gap mae = 3.789532
Epoch 43
Validation mae = 3.767367
Validation band_gap mae = 3.767367
Epoch 44
Validation mae = 3.603547
Validation band_gap mae = 3.603547
Epoch 45
Validation mae = 3.592574
Validation band_gap mae = 3.592574
Epoch 46
Validation mae = 3.727929
Validation band_gap mae = 3.727929
Epoch 47
Validation mae = 3.709170
Validation band_gap mae = 3.709170
Epoch 48
Validation mae = 3.572190
Validation band_gap mae = 3.572190
Epoch 49
Validation mae = 3.725897
Validation band_gap mae = 3.725897
Epoch 50
Validation mae = 3.803306
Validation band_gap mae = 3.803306
Epoch 51
Validation mae = 3.820086
Validation band_gap mae = 3.820086
Epoch 52
Validation mae = 3.802909
Validation band_gap mae = 3.802909
Epoch 53
Validation mae = 3.820340
Validation band_gap mae = 3.820340
Epoch 54
Validation mae = 3.522829
Validation band_gap mae = 3.522829
Epoch 55
Validation mae = 3.563933
Validation band_gap mae = 3.563933
Epoch 56
Validation mae = 3.553144
Validation band_gap mae = 3.553144
Epoch 57
Validation mae = 3.653970
Validation band_gap mae = 3.653970
Epoch 58
Validation mae = 3.724671
Validation band_gap mae = 3.724671
Epoch 59
Validation mae = 3.650176
Validation band_gap mae = 3.650176
Epoch 60
Validation mae = 3.484890
Validation band_gap mae = 3.484890
Epoch 61
Validation mae = 3.670097
Validation band_gap mae = 3.670097
Epoch 62
Validation mae = 3.565647
Validation band_gap mae = 3.565647
Epoch 63
Validation mae = 3.513005
Validation band_gap mae = 3.513005
Epoch 64
Validation mae = 3.655415
Validation band_gap mae = 3.655415
Epoch 65
Validation mae = 3.474449
Validation band_gap mae = 3.474449
Epoch 66
Validation mae = 3.764078
Validation band_gap mae = 3.764078
Epoch 67
Validation mae = 3.521749
Validation band_gap mae = 3.521749
Epoch 68
Validation mae = 3.497337
Validation band_gap mae = 3.497337
Epoch 69
Validation mae = 3.622931
Validation band_gap mae = 3.622931
Epoch 70
Validation mae = 3.590543
Validation band_gap mae = 3.590543
Epoch 71
Validation mae = 3.570154
Validation band_gap mae = 3.570154
Epoch 72
Validation mae = 3.596910
Validation band_gap mae = 3.596910
Epoch 73
Validation mae = 3.503384
Validation band_gap mae = 3.503384
Epoch 74
Validation mae = 3.592931
Validation band_gap mae = 3.592931
Epoch 75
Validation mae = 3.655634
Validation band_gap mae = 3.655634
Epoch 76
Validation mae = 3.635355
Validation band_gap mae = 3.635355
Epoch 77
Validation mae = 3.514295
Validation band_gap mae = 3.514295
Epoch 78
Validation mae = 3.638387
Validation band_gap mae = 3.638387
Epoch 79
Validation mae = 3.642930
Validation band_gap mae = 3.642930
Epoch 80
Validation mae = 3.645666
Validation band_gap mae = 3.645666
Epoch 81
Validation mae = 3.530005
Validation band_gap mae = 3.530005
Epoch 82
Validation mae = 3.465125
Validation band_gap mae = 3.465125
Epoch 83
Validation mae = 3.461296
Validation band_gap mae = 3.461296
Epoch 84
Validation mae = 3.496299
Validation band_gap mae = 3.496299
Epoch 85
Validation mae = 3.493092
Validation band_gap mae = 3.493092
Epoch 86
Validation mae = 3.517341
Validation band_gap mae = 3.517341
Epoch 87
Validation mae = 3.501589
Validation band_gap mae = 3.501589
Epoch 88
Validation mae = 3.533271
Validation band_gap mae = 3.533271
Epoch 89
Validation mae = 3.569340
Validation band_gap mae = 3.569340
Epoch 90
Validation mae = 3.590250
Validation band_gap mae = 3.590250
Epoch 91
Validation mae = 3.482619
Validation band_gap mae = 3.482619
Epoch 92
Validation mae = 3.507211
Validation band_gap mae = 3.507211
Epoch 93
Validation mae = 3.542474
Validation band_gap mae = 3.542474
Epoch 94
Validation mae = 3.514483
Validation band_gap mae = 3.514483
Epoch 95
Validation mae = 3.391528
Validation band_gap mae = 3.391528
Epoch 96
Validation mae = 3.559872
Validation band_gap mae = 3.559872
Epoch 97
Validation mae = 3.565281
Validation band_gap mae = 3.565281
Epoch 98
Validation mae = 3.528858
Validation band_gap mae = 3.528858
Epoch 99
Validation mae = 3.365832
Validation band_gap mae = 3.365832
Model 0 best validation mae = 9.788796 on epoch 0
Moving model to cuda
Model 0 test mae = 9.917665
Model 0 test band_gap mae = 9.917665
Ensemble test mae = 9.917665
Ensemble test band_gap mae = 9.917665
==================== fold 1 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 2.518661
Validation band_gap mae = 2.518661
Epoch 1
Validation mae = 3.710345
Validation band_gap mae = 3.710345
Epoch 2
Validation mae = 2.153153
Validation band_gap mae = 2.153153
Epoch 3
Validation mae = 2.207877
Validation band_gap mae = 2.207877
Epoch 4
Validation mae = 2.946768
Validation band_gap mae = 2.946768
Epoch 5
Validation mae = 2.587868
Validation band_gap mae = 2.587868
Epoch 6
Validation mae = 3.233407
Validation band_gap mae = 3.233407
Epoch 7
Validation mae = 3.503458
Validation band_gap mae = 3.503458
Epoch 8
Validation mae = 3.888082
Validation band_gap mae = 3.888082
Epoch 9
Validation mae = 4.157159
Validation band_gap mae = 4.157159
Epoch 10
Validation mae = 2.830913
Validation band_gap mae = 2.830913
Epoch 11
Validation mae = 2.745867
Validation band_gap mae = 2.745867
Epoch 12
Validation mae = 1.931824
Validation band_gap mae = 1.931824
Epoch 13
Validation mae = 3.522522
Validation band_gap mae = 3.522522
Epoch 14
Validation mae = 3.036361
Validation band_gap mae = 3.036361
Epoch 15
Validation mae = 2.275054
Validation band_gap mae = 2.275054
Epoch 16
Validation mae = 2.325684
Validation band_gap mae = 2.325684
Epoch 17
Validation mae = 2.756427
Validation band_gap mae = 2.756427
Epoch 18
Validation mae = 3.509598
Validation band_gap mae = 3.509598
Epoch 19
Validation mae = 2.530684
Validation band_gap mae = 2.530684
Epoch 20
Validation mae = 3.502235
Validation band_gap mae = 3.502235
Epoch 21
Validation mae = 4.543805
Validation band_gap mae = 4.543805
Epoch 22
Validation mae = 2.867570
Validation band_gap mae = 2.867570
Epoch 23
Validation mae = 3.525001
Validation band_gap mae = 3.525001
Epoch 24
Validation mae = 3.406292
Validation band_gap mae = 3.406292
Epoch 25
Validation mae = 2.977195
Validation band_gap mae = 2.977195
Epoch 26
Validation mae = 3.260410
Validation band_gap mae = 3.260410
Epoch 27
Validation mae = 4.076911
Validation band_gap mae = 4.076911
Epoch 28
Validation mae = 2.406071
Validation band_gap mae = 2.406071
Epoch 29
Validation mae = 2.264569
Validation band_gap mae = 2.264569
Epoch 30
Validation mae = 2.585759
Validation band_gap mae = 2.585759
Epoch 31
Validation mae = 2.251050
Validation band_gap mae = 2.251050
Epoch 32
Validation mae = 3.220272
Validation band_gap mae = 3.220272
Epoch 33
Validation mae = 3.636942
Validation band_gap mae = 3.636942
Epoch 34
Validation mae = 2.970010
Validation band_gap mae = 2.970010
Epoch 35
Validation mae = 2.763321
Validation band_gap mae = 2.763321
Epoch 36
Validation mae = 3.273022
Validation band_gap mae = 3.273022
Epoch 37
Validation mae = 3.418988
Validation band_gap mae = 3.418988
Epoch 38
Validation mae = 3.142062
Validation band_gap mae = 3.142062
Epoch 39
Validation mae = 2.310982
Validation band_gap mae = 2.310982
Epoch 40
Validation mae = 3.216337
Validation band_gap mae = 3.216337
Epoch 41
Validation mae = 2.713948
Validation band_gap mae = 2.713948
Epoch 42
Validation mae = 3.969633
Validation band_gap mae = 3.969633
Epoch 43
Validation mae = 2.780063
Validation band_gap mae = 2.780063
Epoch 44
Validation mae = 3.722701
Validation band_gap mae = 3.722701
Epoch 45
Validation mae = 2.245094
Validation band_gap mae = 2.245094
Epoch 46
Validation mae = 2.273496
Validation band_gap mae = 2.273496
Epoch 47
Validation mae = 2.258823
Validation band_gap mae = 2.258823
Epoch 48
Validation mae = 3.427073
Validation band_gap mae = 3.427073
Epoch 49
Validation mae = 2.857303
Validation band_gap mae = 2.857303
Epoch 50
Validation mae = 2.626176
Validation band_gap mae = 2.626176
Epoch 51
Validation mae = 4.416616
Validation band_gap mae = 4.416616
Epoch 52
Validation mae = 3.035375
Validation band_gap mae = 3.035375
Epoch 53
Validation mae = 4.258241
Validation band_gap mae = 4.258241
Epoch 54
Validation mae = 2.821034
Validation band_gap mae = 2.821034
Epoch 55
Validation mae = 2.658036
Validation band_gap mae = 2.658036
Epoch 56
Validation mae = 2.850893
Validation band_gap mae = 2.850893
Epoch 57
Validation mae = 2.845521
Validation band_gap mae = 2.845521
Epoch 58
Validation mae = 3.235610
Validation band_gap mae = 3.235610
Epoch 59
Validation mae = 3.184564
Validation band_gap mae = 3.184564
Epoch 60
Validation mae = 4.031714
Validation band_gap mae = 4.031714
Epoch 61
Validation mae = 2.893781
Validation band_gap mae = 2.893781
Epoch 62
Validation mae = 3.359074
Validation band_gap mae = 3.359074
Epoch 63
Validation mae = 4.399899
Validation band_gap mae = 4.399899
Epoch 64
Validation mae = 2.696090
Validation band_gap mae = 2.696090
Epoch 65
Validation mae = 3.229811
Validation band_gap mae = 3.229811
Epoch 66
Validation mae = 3.277884
Validation band_gap mae = 3.277884
Epoch 67
Validation mae = 3.421641
Validation band_gap mae = 3.421641
Epoch 68
Validation mae = 3.106292
Validation band_gap mae = 3.106292
Epoch 69
Validation mae = 4.204328
Validation band_gap mae = 4.204328
Epoch 70
Validation mae = 2.685577
Validation band_gap mae = 2.685577
Epoch 71
Validation mae = 3.056658
Validation band_gap mae = 3.056658
Epoch 72
Validation mae = 3.563554
Validation band_gap mae = 3.563554
Epoch 73
Validation mae = 3.561602
Validation band_gap mae = 3.561602
Epoch 74
Validation mae = 2.993943
Validation band_gap mae = 2.993943
Epoch 75
Validation mae = 4.046830
Validation band_gap mae = 4.046830
Epoch 76
Validation mae = 3.112454
Validation band_gap mae = 3.112454
Epoch 77
Validation mae = 3.466288
Validation band_gap mae = 3.466288
Epoch 78
Validation mae = 3.451671
Validation band_gap mae = 3.451671
Epoch 79
Validation mae = 3.287596
Validation band_gap mae = 3.287596
Epoch 80
Validation mae = 3.462959
Validation band_gap mae = 3.462959
Epoch 81
Validation mae = 3.196717
Validation band_gap mae = 3.196717
Epoch 82
Validation mae = 3.262499
Validation band_gap mae = 3.262499
Epoch 83
Validation mae = 3.280456
Validation band_gap mae = 3.280456
Epoch 84
Validation mae = 3.388189
Validation band_gap mae = 3.388189
Epoch 85
Validation mae = 3.233381
Validation band_gap mae = 3.233381
Epoch 86
Validation mae = 3.469561
Validation band_gap mae = 3.469561
Epoch 87
Validation mae = 3.384365
Validation band_gap mae = 3.384365
Epoch 88
Validation mae = 3.447909
Validation band_gap mae = 3.447909
Epoch 89
Validation mae = 3.524543
Validation band_gap mae = 3.524543
Epoch 90
Validation mae = 3.125136
Validation band_gap mae = 3.125136
Epoch 91
Validation mae = 3.774219
Validation band_gap mae = 3.774219
Epoch 92
Validation mae = 3.002177
Validation band_gap mae = 3.002177
Epoch 93
Validation mae = 3.519297
Validation band_gap mae = 3.519297
Epoch 94
Validation mae = 3.230682
Validation band_gap mae = 3.230682
Epoch 95
Validation mae = 3.466560
Validation band_gap mae = 3.466560
Epoch 96
Validation mae = 3.220313
Validation band_gap mae = 3.220313
Epoch 97
Validation mae = 3.695768
Validation band_gap mae = 3.695768
Epoch 98
Validation mae = 3.427657
Validation band_gap mae = 3.427657
Epoch 99
Validation mae = 3.255413
Validation band_gap mae = 3.255413
Model 0 best validation mae = 4.543805 on epoch 21
Moving model to cuda
Model 0 test mae = 3.864657
Model 0 test band_gap mae = 3.864657
Ensemble test mae = 3.864657
Ensemble test band_gap mae = 3.864657
==================== fold 2 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.851078
Validation band_gap mae = 1.851078
Epoch 1
Validation mae = 2.186618
Validation band_gap mae = 2.186618
Epoch 2
Validation mae = 1.848239
Validation band_gap mae = 1.848239
Epoch 3
Validation mae = 1.950409
Validation band_gap mae = 1.950409
Epoch 4
Validation mae = 2.047374
Validation band_gap mae = 2.047374
Epoch 5
Validation mae = 1.954179
Validation band_gap mae = 1.954179
Epoch 6
Validation mae = 1.886717
Validation band_gap mae = 1.886717
Epoch 7
Validation mae = 1.907204
Validation band_gap mae = 1.907204
Epoch 8
Validation mae = 1.931064
Validation band_gap mae = 1.931064
Epoch 9
Validation mae = 1.982325
Validation band_gap mae = 1.982325
Epoch 10
Validation mae = 2.041614
Validation band_gap mae = 2.041614
Epoch 11
Validation mae = 2.126417
Validation band_gap mae = 2.126417
Epoch 12
Validation mae = 1.899517
Validation band_gap mae = 1.899517
Epoch 13
Validation mae = 1.961196
Validation band_gap mae = 1.961196
Epoch 14
Validation mae = 1.874168
Validation band_gap mae = 1.874168
Epoch 15
Validation mae = 1.869321
Validation band_gap mae = 1.869321
Epoch 16
Validation mae = 1.949600
Validation band_gap mae = 1.949600
Epoch 17
Validation mae = 2.043871
Validation band_gap mae = 2.043871
Epoch 18
Validation mae = 2.000381
Validation band_gap mae = 2.000381
Epoch 19
Validation mae = 2.214936
Validation band_gap mae = 2.214936
Epoch 20
Validation mae = 2.089378
Validation band_gap mae = 2.089378
Epoch 21
Validation mae = 1.902234
Validation band_gap mae = 1.902234
Epoch 22
Validation mae = 1.949885
Validation band_gap mae = 1.949885
Epoch 23
Validation mae = 2.017113
Validation band_gap mae = 2.017113
Epoch 24
Validation mae = 1.885209
Validation band_gap mae = 1.885209
Epoch 25
Validation mae = 1.904130
Validation band_gap mae = 1.904130
Epoch 26
Validation mae = 1.986858
Validation band_gap mae = 1.986858
Epoch 27
Validation mae = 1.921890
Validation band_gap mae = 1.921890
Epoch 28
Validation mae = 1.962260
Validation band_gap mae = 1.962260
Epoch 29
Validation mae = 1.932423
Validation band_gap mae = 1.932423
Epoch 30
Validation mae = 2.016445
Validation band_gap mae = 2.016445
Epoch 31
Validation mae = 2.181691
Validation band_gap mae = 2.181691
Epoch 32
Validation mae = 2.022765
Validation band_gap mae = 2.022765
Epoch 33
Validation mae = 1.972805
Validation band_gap mae = 1.972805
Epoch 34
Validation mae = 1.894700
Validation band_gap mae = 1.894700
Epoch 35
Validation mae = 2.041113
Validation band_gap mae = 2.041113
Epoch 36
Validation mae = 1.955220
Validation band_gap mae = 1.955220
Epoch 37
Validation mae = 2.064380
Validation band_gap mae = 2.064380
Epoch 38
Validation mae = 1.971462
Validation band_gap mae = 1.971462
Epoch 39
Validation mae = 2.050932
Validation band_gap mae = 2.050932
Epoch 40
Validation mae = 1.876307
Validation band_gap mae = 1.876307
Epoch 41
Validation mae = 1.853619
Validation band_gap mae = 1.853619
Epoch 42
Validation mae = 1.897509
Validation band_gap mae = 1.897509
Epoch 43
Validation mae = 1.937844
Validation band_gap mae = 1.937844
Epoch 44
Validation mae = 1.923389
Validation band_gap mae = 1.923389
Epoch 45
Validation mae = 1.845128
Validation band_gap mae = 1.845128
Epoch 46
Validation mae = 1.978520
Validation band_gap mae = 1.978520
Epoch 47
Validation mae = 2.028341
Validation band_gap mae = 2.028341
Epoch 48
Validation mae = 1.969453
Validation band_gap mae = 1.969453
Epoch 49
Validation mae = 1.928769
Validation band_gap mae = 1.928769
Epoch 50
Validation mae = 2.019342
Validation band_gap mae = 2.019342
Epoch 51
Validation mae = 2.282739
Validation band_gap mae = 2.282739
Epoch 52
Validation mae = 2.037188
Validation band_gap mae = 2.037188
Epoch 53
Validation mae = 1.835495
Validation band_gap mae = 1.835495
Epoch 54
Validation mae = 1.969100
Validation band_gap mae = 1.969100
Epoch 55
Validation mae = 2.008529
Validation band_gap mae = 2.008529
Epoch 56
Validation mae = 2.192774
Validation band_gap mae = 2.192774
Epoch 57
Validation mae = 2.041562
Validation band_gap mae = 2.041562
Epoch 58
Validation mae = 2.215190
Validation band_gap mae = 2.215190
Epoch 59
Validation mae = 2.067511
Validation band_gap mae = 2.067511
Epoch 60
Validation mae = 1.953456
Validation band_gap mae = 1.953456
Epoch 61
Validation mae = 2.112166
Validation band_gap mae = 2.112166
Epoch 62
Validation mae = 2.310407
Validation band_gap mae = 2.310407
Epoch 63
Validation mae = 2.132558
Validation band_gap mae = 2.132558
Epoch 64
Validation mae = 2.021300
Validation band_gap mae = 2.021300
Epoch 65
Validation mae = 2.246629
Validation band_gap mae = 2.246629
Epoch 66
Validation mae = 1.994954
Validation band_gap mae = 1.994954
Epoch 67
Validation mae = 2.123483
Validation band_gap mae = 2.123483
Epoch 68
Validation mae = 2.155077
Validation band_gap mae = 2.155077
Epoch 69
Validation mae = 2.048471
Validation band_gap mae = 2.048471
Epoch 70
Validation mae = 2.107402
Validation band_gap mae = 2.107402
Epoch 71
Validation mae = 2.019177
Validation band_gap mae = 2.019177
Epoch 72
Validation mae = 2.186360
Validation band_gap mae = 2.186360
Epoch 73
Validation mae = 2.107473
Validation band_gap mae = 2.107473
Epoch 74
Validation mae = 2.169873
Validation band_gap mae = 2.169873
Epoch 75
Validation mae = 2.262249
Validation band_gap mae = 2.262249
Epoch 76
Validation mae = 2.102204
Validation band_gap mae = 2.102204
Epoch 77
Validation mae = 2.216469
Validation band_gap mae = 2.216469
Epoch 78
Validation mae = 2.185202
Validation band_gap mae = 2.185202
Epoch 79
Validation mae = 2.125748
Validation band_gap mae = 2.125748
Epoch 80
Validation mae = 2.230845
Validation band_gap mae = 2.230845
Epoch 81
Validation mae = 2.193750
Validation band_gap mae = 2.193750
Epoch 82
Validation mae = 2.275840
Validation band_gap mae = 2.275840
Epoch 83
Validation mae = 2.077340
Validation band_gap mae = 2.077340
Epoch 84
Validation mae = 2.303564
Validation band_gap mae = 2.303564
Epoch 85
Validation mae = 2.233322
Validation band_gap mae = 2.233322
Epoch 86
Validation mae = 2.172492
Validation band_gap mae = 2.172492
Epoch 87
Validation mae = 2.240085
Validation band_gap mae = 2.240085
Epoch 88
Validation mae = 2.159131
Validation band_gap mae = 2.159131
Epoch 89
Validation mae = 2.248208
Validation band_gap mae = 2.248208
Epoch 90
Validation mae = 2.136382
Validation band_gap mae = 2.136382
Epoch 91
Validation mae = 2.318837
Validation band_gap mae = 2.318837
Epoch 92
Validation mae = 2.196355
Validation band_gap mae = 2.196355
Epoch 93
Validation mae = 2.252539
Validation band_gap mae = 2.252539
Epoch 94
Validation mae = 2.314417
Validation band_gap mae = 2.314417
Epoch 95
Validation mae = 2.189430
Validation band_gap mae = 2.189430
Epoch 96
Validation mae = 2.231177
Validation band_gap mae = 2.231177
Epoch 97
Validation mae = 2.203092
Validation band_gap mae = 2.203092
Epoch 98
Validation mae = 2.245157
Validation band_gap mae = 2.245157
Epoch 99
Validation mae = 2.165454
Validation band_gap mae = 2.165454
Model 0 best validation mae = 2.318837 on epoch 91
Moving model to cuda
Model 0 test mae = 0.683085
Model 0 test band_gap mae = 0.683085
Ensemble test mae = 0.683085
Ensemble test band_gap mae = 0.683085
==================== fold 3 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 2.001105
Validation band_gap mae = 2.001105
Epoch 1
Validation mae = 2.009960
Validation band_gap mae = 2.009960
Epoch 2
Validation mae = 2.020375
Validation band_gap mae = 2.020375
Epoch 3
Validation mae = 1.995663
Validation band_gap mae = 1.995663
Epoch 4
Validation mae = 2.060992
Validation band_gap mae = 2.060992
Epoch 5
Validation mae = 2.046925
Validation band_gap mae = 2.046925
Epoch 6
Validation mae = 2.020505
Validation band_gap mae = 2.020505
Epoch 7
Validation mae = 2.019638
Validation band_gap mae = 2.019638
Epoch 8
Validation mae = 2.148313
Validation band_gap mae = 2.148313
Epoch 9
Validation mae = 2.058933
Validation band_gap mae = 2.058933
Epoch 10
Validation mae = 2.069430
Validation band_gap mae = 2.069430
Epoch 11
Validation mae = 2.061792
Validation band_gap mae = 2.061792
Epoch 12
Validation mae = 2.051463
Validation band_gap mae = 2.051463
Epoch 13
Validation mae = 2.002166
Validation band_gap mae = 2.002166
Epoch 14
Validation mae = 1.986836
Validation band_gap mae = 1.986836
Epoch 15
Validation mae = 1.972616
Validation band_gap mae = 1.972616
Epoch 16
Validation mae = 2.052910
Validation band_gap mae = 2.052910
Epoch 17
Validation mae = 1.977475
Validation band_gap mae = 1.977475
Epoch 18
Validation mae = 2.009927
Validation band_gap mae = 2.009927
Epoch 19
Validation mae = 2.010278
Validation band_gap mae = 2.010278
Epoch 20
Validation mae = 2.007419
Validation band_gap mae = 2.007419
Epoch 21
Validation mae = 2.049047
Validation band_gap mae = 2.049047
Epoch 22
Validation mae = 2.000958
Validation band_gap mae = 2.000958
Epoch 23
Validation mae = 1.992406
Validation band_gap mae = 1.992406
Epoch 24
Validation mae = 2.047908
Validation band_gap mae = 2.047908
Epoch 25
Validation mae = 2.010763
Validation band_gap mae = 2.010763
Epoch 26
Validation mae = 2.040440
Validation band_gap mae = 2.040440
Epoch 27
Validation mae = 1.992887
Validation band_gap mae = 1.992887
Epoch 28
Validation mae = 2.025691
Validation band_gap mae = 2.025691
Epoch 29
Validation mae = 2.056474
Validation band_gap mae = 2.056474
Epoch 30
Validation mae = 1.994773
Validation band_gap mae = 1.994773
Epoch 31
Validation mae = 2.029475
Validation band_gap mae = 2.029475
Epoch 32
Validation mae = 2.065431
Validation band_gap mae = 2.065431
Epoch 33
Validation mae = 2.050415
Validation band_gap mae = 2.050415
Epoch 34
Validation mae = 1.977876
Validation band_gap mae = 1.977876
Epoch 35
Validation mae = 2.001557
Validation band_gap mae = 2.001557
Epoch 36
Validation mae = 2.062840
Validation band_gap mae = 2.062840
Epoch 37
Validation mae = 2.003869
Validation band_gap mae = 2.003869
Epoch 38
Validation mae = 2.028921
Validation band_gap mae = 2.028921
Epoch 39
Validation mae = 2.072764
Validation band_gap mae = 2.072764
Epoch 40
Validation mae = 2.026583
Validation band_gap mae = 2.026583
Epoch 41
Validation mae = 2.013535
Validation band_gap mae = 2.013535
Epoch 42
Validation mae = 2.035521
Validation band_gap mae = 2.035521
Epoch 43
Validation mae = 2.015604
Validation band_gap mae = 2.015604
Epoch 44
Validation mae = 2.069787
Validation band_gap mae = 2.069787
Epoch 45
Validation mae = 2.029095
Validation band_gap mae = 2.029095
Epoch 46
Validation mae = 2.047311
Validation band_gap mae = 2.047311
Epoch 47
Validation mae = 1.998031
Validation band_gap mae = 1.998031
Epoch 48
Validation mae = 2.039609
Validation band_gap mae = 2.039609
Epoch 49
Validation mae = 2.022007
Validation band_gap mae = 2.022007
Epoch 50
Validation mae = 2.060903
Validation band_gap mae = 2.060903
Epoch 51
Validation mae = 2.066410
Validation band_gap mae = 2.066410
Epoch 52
Validation mae = 2.022112
Validation band_gap mae = 2.022112
Epoch 53
Validation mae = 2.029335
Validation band_gap mae = 2.029335
Epoch 54
Validation mae = 2.012365
Validation band_gap mae = 2.012365
Epoch 55
Validation mae = 2.026093
Validation band_gap mae = 2.026093
Epoch 56
Validation mae = 2.069131
Validation band_gap mae = 2.069131
Epoch 57
Validation mae = 2.044287
Validation band_gap mae = 2.044287
Epoch 58
Validation mae = 2.073447
Validation band_gap mae = 2.073447
Epoch 59
Validation mae = 2.009692
Validation band_gap mae = 2.009692
Epoch 60
Validation mae = 2.132543
Validation band_gap mae = 2.132543
Epoch 61
Validation mae = 2.067774
Validation band_gap mae = 2.067774
Epoch 62
Validation mae = 2.006535
Validation band_gap mae = 2.006535
Epoch 63
Validation mae = 2.052028
Validation band_gap mae = 2.052028
Epoch 64
Validation mae = 2.019735
Validation band_gap mae = 2.019735
Epoch 65
Validation mae = 2.059378
Validation band_gap mae = 2.059378
Epoch 66
Validation mae = 2.050841
Validation band_gap mae = 2.050841
Epoch 67
Validation mae = 2.077389
Validation band_gap mae = 2.077389
Epoch 68
Validation mae = 2.073381
Validation band_gap mae = 2.073381
Epoch 69
Validation mae = 2.097394
Validation band_gap mae = 2.097394
Epoch 70
Validation mae = 2.088151
Validation band_gap mae = 2.088151
Epoch 71
Validation mae = 2.078702
Validation band_gap mae = 2.078702
Epoch 72
Validation mae = 2.072622
Validation band_gap mae = 2.072622
Epoch 73
Validation mae = 2.080157
Validation band_gap mae = 2.080157
Epoch 74
Validation mae = 2.124454
Validation band_gap mae = 2.124454
Epoch 75
Validation mae = 2.071370
Validation band_gap mae = 2.071370
Epoch 76
Validation mae = 2.103782
Validation band_gap mae = 2.103782
Epoch 77
Validation mae = 2.095556
Validation band_gap mae = 2.095556
Epoch 78
Validation mae = 2.125775
Validation band_gap mae = 2.125775
Epoch 79
Validation mae = 2.103258
Validation band_gap mae = 2.103258
Epoch 80
Validation mae = 2.105001
Validation band_gap mae = 2.105001
Epoch 81
Validation mae = 2.123639
Validation band_gap mae = 2.123639
Epoch 82
Validation mae = 2.163771
Validation band_gap mae = 2.163771
Epoch 83
Validation mae = 2.020767
Validation band_gap mae = 2.020767
Epoch 84
Validation mae = 2.113398
Validation band_gap mae = 2.113398
Epoch 85
Validation mae = 2.119066
Validation band_gap mae = 2.119066
Epoch 86
Validation mae = 2.119254
Validation band_gap mae = 2.119254
Epoch 87
Validation mae = 2.052598
Validation band_gap mae = 2.052598
Epoch 88
Validation mae = 2.094530
Validation band_gap mae = 2.094530
Epoch 89
Validation mae = 2.119815
Validation band_gap mae = 2.119815
Epoch 90
Validation mae = 2.062543
Validation band_gap mae = 2.062543
Epoch 91
Validation mae = 2.109307
Validation band_gap mae = 2.109307
Epoch 92
Validation mae = 2.096904
Validation band_gap mae = 2.096904
Epoch 93
Validation mae = 2.161847
Validation band_gap mae = 2.161847
Epoch 94
Validation mae = 2.134765
Validation band_gap mae = 2.134765
Epoch 95
Validation mae = 2.107281
Validation band_gap mae = 2.107281
Epoch 96
Validation mae = 2.116429
Validation band_gap mae = 2.116429
Epoch 97
Validation mae = 2.120008
Validation band_gap mae = 2.120008
Epoch 98
Validation mae = 2.147115
Validation band_gap mae = 2.147115
Epoch 99
Validation mae = 2.092270
Validation band_gap mae = 2.092270
Model 0 best validation mae = 2.163771 on epoch 82
Moving model to cuda
Model 0 test mae = 0.430437
Model 0 test band_gap mae = 0.430437
Ensemble test mae = 0.430437
Ensemble test band_gap mae = 0.430437
==================== fold 4 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.982287
Validation band_gap mae = 1.982287
Epoch 1
Validation mae = 1.769948
Validation band_gap mae = 1.769948
Epoch 2
Validation mae = 1.960565
Validation band_gap mae = 1.960565
Epoch 3
Validation mae = 1.701686
Validation band_gap mae = 1.701686
Epoch 4
Validation mae = 1.687497
Validation band_gap mae = 1.687497
Epoch 5
Validation mae = 1.710401
Validation band_gap mae = 1.710401
Epoch 6
Validation mae = 1.835037
Validation band_gap mae = 1.835037
Epoch 7
Validation mae = 1.799244
Validation band_gap mae = 1.799244
Epoch 8
Validation mae = 1.692859
Validation band_gap mae = 1.692859
Epoch 9
Validation mae = 1.684184
Validation band_gap mae = 1.684184
Epoch 10
Validation mae = 1.737665
Validation band_gap mae = 1.737665
Epoch 11
Validation mae = 1.791426
Validation band_gap mae = 1.791426
Epoch 12
Validation mae = 2.176274
Validation band_gap mae = 2.176274
Epoch 13
Validation mae = 1.775448
Validation band_gap mae = 1.775448
Epoch 14
Validation mae = 1.769868
Validation band_gap mae = 1.769868
Epoch 15
Validation mae = 1.910769
Validation band_gap mae = 1.910769
Epoch 16
Validation mae = 1.859650
Validation band_gap mae = 1.859650
Epoch 17
Validation mae = 1.696356
Validation band_gap mae = 1.696356
Epoch 18
Validation mae = 1.799982
Validation band_gap mae = 1.799982
Epoch 19
Validation mae = 1.712965
Validation band_gap mae = 1.712965
Epoch 20
Validation mae = 1.822521
Validation band_gap mae = 1.822521
Epoch 21
Validation mae = 1.736691
Validation band_gap mae = 1.736691
Epoch 22
Validation mae = 1.782244
Validation band_gap mae = 1.782244
Epoch 23
Validation mae = 1.812568
Validation band_gap mae = 1.812568
Epoch 24
Validation mae = 1.728867
Validation band_gap mae = 1.728867
Epoch 25
Validation mae = 1.733030
Validation band_gap mae = 1.733030
Epoch 26
Validation mae = 1.726423
Validation band_gap mae = 1.726423
Epoch 27
Validation mae = 1.735546
Validation band_gap mae = 1.735546
Epoch 28
Validation mae = 1.723762
Validation band_gap mae = 1.723762
Epoch 29
Validation mae = 1.722042
Validation band_gap mae = 1.722042
Epoch 30
Validation mae = 1.808833
Validation band_gap mae = 1.808833
Epoch 31
Validation mae = 1.696584
Validation band_gap mae = 1.696584
Epoch 32
Validation mae = 1.863577
Validation band_gap mae = 1.863577
Epoch 33
Validation mae = 1.759444
Validation band_gap mae = 1.759444
Epoch 34
Validation mae = 1.695505
Validation band_gap mae = 1.695505
Epoch 35
Validation mae = 1.807761
Validation band_gap mae = 1.807761
Epoch 36
Validation mae = 1.754875
Validation band_gap mae = 1.754875
Epoch 37
Validation mae = 1.758229
Validation band_gap mae = 1.758229
Epoch 38
Validation mae = 1.705976
Validation band_gap mae = 1.705976
Epoch 39
Validation mae = 2.085567
Validation band_gap mae = 2.085567
Epoch 40
Validation mae = 1.782857
Validation band_gap mae = 1.782857
Epoch 41
Validation mae = 1.746355
Validation band_gap mae = 1.746355
Epoch 42
Validation mae = 1.728028
Validation band_gap mae = 1.728028
Epoch 43
Validation mae = 1.853924
Validation band_gap mae = 1.853924
Epoch 44
Validation mae = 1.694456
Validation band_gap mae = 1.694456
Epoch 45
Validation mae = 1.709419
Validation band_gap mae = 1.709419
Epoch 46
Validation mae = 1.714435
Validation band_gap mae = 1.714435
Epoch 47
Validation mae = 1.818171
Validation band_gap mae = 1.818171
Epoch 48
Validation mae = 1.756508
Validation band_gap mae = 1.756508
Epoch 49
Validation mae = 1.769217
Validation band_gap mae = 1.769217
Epoch 50
Validation mae = 1.762038
Validation band_gap mae = 1.762038
Epoch 51
Validation mae = 1.718497
Validation band_gap mae = 1.718497
Epoch 52
Validation mae = 1.820960
Validation band_gap mae = 1.820960
Epoch 53
Validation mae = 1.753400
Validation band_gap mae = 1.753400
Epoch 54
Validation mae = 1.726461
Validation band_gap mae = 1.726461
Epoch 55
Validation mae = 1.724581
Validation band_gap mae = 1.724581
Epoch 56
Validation mae = 1.766542
Validation band_gap mae = 1.766542
Epoch 57
Validation mae = 1.743869
Validation band_gap mae = 1.743869
Epoch 58
Validation mae = 1.797028
Validation band_gap mae = 1.797028
Epoch 59
Validation mae = 1.741049
Validation band_gap mae = 1.741049
Epoch 60
Validation mae = 1.746619
Validation band_gap mae = 1.746619
Epoch 61
Validation mae = 1.720295
Validation band_gap mae = 1.720295
Epoch 62
Validation mae = 1.738744
Validation band_gap mae = 1.738744
Epoch 63
Validation mae = 1.743839
Validation band_gap mae = 1.743839
Epoch 64
Validation mae = 1.762076
Validation band_gap mae = 1.762076
Epoch 65
Validation mae = 1.694400
Validation band_gap mae = 1.694400
Epoch 66
Validation mae = 1.756384
Validation band_gap mae = 1.756384
Epoch 67
Validation mae = 1.726846
Validation band_gap mae = 1.726846
Epoch 68
Validation mae = 1.717994
Validation band_gap mae = 1.717994
Epoch 69
Validation mae = 1.735454
Validation band_gap mae = 1.735454
Epoch 70
Validation mae = 1.728205
Validation band_gap mae = 1.728205
Epoch 71
Validation mae = 1.773283
Validation band_gap mae = 1.773283
Epoch 72
Validation mae = 1.739420
Validation band_gap mae = 1.739420
Epoch 73
Validation mae = 1.710993
Validation band_gap mae = 1.710993
Epoch 74
Validation mae = 1.756666
Validation band_gap mae = 1.756666
Epoch 75
Validation mae = 1.760238
Validation band_gap mae = 1.760238
Epoch 76
Validation mae = 1.721608
Validation band_gap mae = 1.721608
Epoch 77
Validation mae = 1.683075
Validation band_gap mae = 1.683075
Epoch 78
Validation mae = 1.755369
Validation band_gap mae = 1.755369
Epoch 79
Validation mae = 1.746190
Validation band_gap mae = 1.746190
Epoch 80
Validation mae = 1.730118
Validation band_gap mae = 1.730118
Epoch 81
Validation mae = 1.771694
Validation band_gap mae = 1.771694
Epoch 82
Validation mae = 1.741472
Validation band_gap mae = 1.741472
Epoch 83
Validation mae = 1.698437
Validation band_gap mae = 1.698437
Epoch 84
Validation mae = 1.749606
Validation band_gap mae = 1.749606
Epoch 85
Validation mae = 1.733394
Validation band_gap mae = 1.733394
Epoch 86
Validation mae = 1.709797
Validation band_gap mae = 1.709797
Epoch 87
Validation mae = 1.769328
Validation band_gap mae = 1.769328
Epoch 88
Validation mae = 1.736995
Validation band_gap mae = 1.736995
Epoch 89
Validation mae = 1.712859
Validation band_gap mae = 1.712859
Epoch 90
Validation mae = 1.737262
Validation band_gap mae = 1.737262
Epoch 91
Validation mae = 1.756886
Validation band_gap mae = 1.756886
Epoch 92
Validation mae = 1.754374
Validation band_gap mae = 1.754374
Epoch 93
Validation mae = 1.736690
Validation band_gap mae = 1.736690
Epoch 94
Validation mae = 1.807548
Validation band_gap mae = 1.807548
Epoch 95
Validation mae = 1.687245
Validation band_gap mae = 1.687245
Epoch 96
Validation mae = 1.802982
Validation band_gap mae = 1.802982
Epoch 97
Validation mae = 1.732872
Validation band_gap mae = 1.732872
Epoch 98
Validation mae = 1.723818
Validation band_gap mae = 1.723818
Epoch 99
Validation mae = 1.720613
Validation band_gap mae = 1.720613
Model 0 best validation mae = 2.176274 on epoch 12
Moving model to cuda
Model 0 test mae = 0.792708
Model 0 test band_gap mae = 0.792708
Ensemble test mae = 0.792708
Ensemble test band_gap mae = 0.792708
==================== fold 5 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.891766
Validation band_gap mae = 1.891766
Epoch 1
Validation mae = 1.913164
Validation band_gap mae = 1.913164
Epoch 2
Validation mae = 1.873188
Validation band_gap mae = 1.873188
Epoch 3
Validation mae = 1.874387
Validation band_gap mae = 1.874387
Epoch 4
Validation mae = 1.863689
Validation band_gap mae = 1.863689
Epoch 5
Validation mae = 1.964730
Validation band_gap mae = 1.964730
Epoch 6
Validation mae = 1.883641
Validation band_gap mae = 1.883641
Epoch 7
Validation mae = 1.882843
Validation band_gap mae = 1.882843
Epoch 8
Validation mae = 1.866934
Validation band_gap mae = 1.866934
Epoch 9
Validation mae = 1.871912
Validation band_gap mae = 1.871912
Epoch 10
Validation mae = 1.865230
Validation band_gap mae = 1.865230
Epoch 11
Validation mae = 1.846233
Validation band_gap mae = 1.846233
Epoch 12
Validation mae = 1.912764
Validation band_gap mae = 1.912764
Epoch 13
Validation mae = 1.911965
Validation band_gap mae = 1.911965
Epoch 14
Validation mae = 1.874591
Validation band_gap mae = 1.874591
Epoch 15
Validation mae = 1.872850
Validation band_gap mae = 1.872850
Epoch 16
Validation mae = 1.851850
Validation band_gap mae = 1.851850
Epoch 17
Validation mae = 1.853651
Validation band_gap mae = 1.853651
Epoch 18
Validation mae = 1.906955
Validation band_gap mae = 1.906955
Epoch 19
Validation mae = 1.856100
Validation band_gap mae = 1.856100
Epoch 20
Validation mae = 1.836403
Validation band_gap mae = 1.836403
Epoch 21
Validation mae = 1.972858
Validation band_gap mae = 1.972858
Epoch 22
Validation mae = 1.956974
Validation band_gap mae = 1.956974
Epoch 23
Validation mae = 1.853799
Validation band_gap mae = 1.853799
Epoch 24
Validation mae = 1.901303
Validation band_gap mae = 1.901303
Epoch 25
Validation mae = 1.923074
Validation band_gap mae = 1.923074
Epoch 26
Validation mae = 1.865442
Validation band_gap mae = 1.865442
Epoch 27
Validation mae = 1.886232
Validation band_gap mae = 1.886232
Epoch 28
Validation mae = 1.870176
Validation band_gap mae = 1.870176
Epoch 29
Validation mae = 1.848535
Validation band_gap mae = 1.848535
Epoch 30
Validation mae = 1.886358
Validation band_gap mae = 1.886358
Epoch 31
Validation mae = 1.869335
Validation band_gap mae = 1.869335
Epoch 32
Validation mae = 1.841934
Validation band_gap mae = 1.841934
Epoch 33
Validation mae = 1.880794
Validation band_gap mae = 1.880794
Epoch 34
Validation mae = 1.867769
Validation band_gap mae = 1.867769
Epoch 35
Validation mae = 1.860918
Validation band_gap mae = 1.860918
Epoch 36
Validation mae = 1.870421
Validation band_gap mae = 1.870421
Epoch 37
Validation mae = 1.876195
Validation band_gap mae = 1.876195
Epoch 38
Validation mae = 1.885165
Validation band_gap mae = 1.885165
Epoch 39
Validation mae = 1.883067
Validation band_gap mae = 1.883067
Epoch 40
Validation mae = 1.889423
Validation band_gap mae = 1.889423
Epoch 41
Validation mae = 1.876911
Validation band_gap mae = 1.876911
Epoch 42
Validation mae = 1.920991
Validation band_gap mae = 1.920991
Epoch 43
Validation mae = 1.864092
Validation band_gap mae = 1.864092
Epoch 44
Validation mae = 1.850468
Validation band_gap mae = 1.850468
Epoch 45
Validation mae = 1.916043
Validation band_gap mae = 1.916043
Epoch 46
Validation mae = 1.865944
Validation band_gap mae = 1.865944
Epoch 47
Validation mae = 1.849684
Validation band_gap mae = 1.849684
Epoch 48
Validation mae = 1.850562
Validation band_gap mae = 1.850562
Epoch 49
Validation mae = 1.885639
Validation band_gap mae = 1.885639
Epoch 50
Validation mae = 1.942876
Validation band_gap mae = 1.942876
Epoch 51
Validation mae = 1.898998
Validation band_gap mae = 1.898998
Epoch 52
Validation mae = 1.866788
Validation band_gap mae = 1.866788
Epoch 53
Validation mae = 1.881382
Validation band_gap mae = 1.881382
Epoch 54
Validation mae = 1.899501
Validation band_gap mae = 1.899501
Epoch 55
Validation mae = 1.863967
Validation band_gap mae = 1.863967
Epoch 56
Validation mae = 1.881692
Validation band_gap mae = 1.881692
Epoch 57
Validation mae = 1.875179
Validation band_gap mae = 1.875179
Epoch 58
Validation mae = 1.913260
Validation band_gap mae = 1.913260
Epoch 59
Validation mae = 1.853755
Validation band_gap mae = 1.853755
Epoch 60
Validation mae = 1.863828
Validation band_gap mae = 1.863828
Epoch 61
Validation mae = 1.922888
Validation band_gap mae = 1.922888
Epoch 62
Validation mae = 1.926052
Validation band_gap mae = 1.926052
Epoch 63
Validation mae = 1.912250
Validation band_gap mae = 1.912250
Epoch 64
Validation mae = 1.921974
Validation band_gap mae = 1.921974
Epoch 65
Validation mae = 1.861242
Validation band_gap mae = 1.861242
Epoch 66
Validation mae = 1.900424
Validation band_gap mae = 1.900424
Epoch 67
Validation mae = 1.868134
Validation band_gap mae = 1.868134
Epoch 68
Validation mae = 1.918208
Validation band_gap mae = 1.918208
Epoch 69
Validation mae = 1.894456
Validation band_gap mae = 1.894456
Epoch 70
Validation mae = 1.897593
Validation band_gap mae = 1.897593
Epoch 71
Validation mae = 1.898228
Validation band_gap mae = 1.898228
Epoch 72
Validation mae = 1.868179
Validation band_gap mae = 1.868179
Epoch 73
Validation mae = 1.886019
Validation band_gap mae = 1.886019
Epoch 74
Validation mae = 1.899708
Validation band_gap mae = 1.899708
Epoch 75
Validation mae = 1.893472
Validation band_gap mae = 1.893472
Epoch 76
Validation mae = 1.860425
Validation band_gap mae = 1.860425
Epoch 77
Validation mae = 1.924655
Validation band_gap mae = 1.924655
Epoch 78
Validation mae = 1.868622
Validation band_gap mae = 1.868622
Epoch 79
Validation mae = 1.905460
Validation band_gap mae = 1.905460
Epoch 80
Validation mae = 1.908392
Validation band_gap mae = 1.908392
Epoch 81
Validation mae = 1.954462
Validation band_gap mae = 1.954462
Epoch 82
Validation mae = 1.931259
Validation band_gap mae = 1.931259
Epoch 83
Validation mae = 1.937136
Validation band_gap mae = 1.937136
Epoch 84
Validation mae = 1.889889
Validation band_gap mae = 1.889889
Epoch 85
Validation mae = 1.888023
Validation band_gap mae = 1.888023
Epoch 86
Validation mae = 1.947749
Validation band_gap mae = 1.947749
Epoch 87
Validation mae = 1.902507
Validation band_gap mae = 1.902507
Epoch 88
Validation mae = 1.896018
Validation band_gap mae = 1.896018
Epoch 89
Validation mae = 1.911486
Validation band_gap mae = 1.911486
Epoch 90
Validation mae = 1.921499
Validation band_gap mae = 1.921499
Epoch 91
Validation mae = 1.891554
Validation band_gap mae = 1.891554
Epoch 92
Validation mae = 1.912447
Validation band_gap mae = 1.912447
Epoch 93
Validation mae = 1.906971
Validation band_gap mae = 1.906971
Epoch 94
Validation mae = 1.876306
Validation band_gap mae = 1.876306
Epoch 95
Validation mae = 1.924550
Validation band_gap mae = 1.924550
Epoch 96
Validation mae = 1.906886
Validation band_gap mae = 1.906886
Epoch 97
Validation mae = 1.904912
Validation band_gap mae = 1.904912
Epoch 98
Validation mae = 1.900823
Validation band_gap mae = 1.900823
Epoch 99
Validation mae = 1.913433
Validation band_gap mae = 1.913433
Model 0 best validation mae = 1.972858 on epoch 21
Moving model to cuda
Model 0 test mae = 0.457374
Model 0 test band_gap mae = 0.457374
Ensemble test mae = 0.457374
Ensemble test band_gap mae = 0.457374
==================== fold 6 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 1.054933
Validation band_gap mae = 1.054933
Epoch 1
Validation mae = 0.635358
Validation band_gap mae = 0.635358
Epoch 2
Validation mae = 0.718118
Validation band_gap mae = 0.718118
Epoch 3
Validation mae = 1.113050
Validation band_gap mae = 1.113050
Epoch 4
Validation mae = 0.869764
Validation band_gap mae = 0.869764
Epoch 5
Validation mae = 0.718288
Validation band_gap mae = 0.718288
Epoch 6
Validation mae = 0.721165
Validation band_gap mae = 0.721165
Epoch 7
Validation mae = 0.749340
Validation band_gap mae = 0.749340
Epoch 8
Validation mae = 0.665355
Validation band_gap mae = 0.665355
Epoch 9
Validation mae = 0.704974
Validation band_gap mae = 0.704974
Epoch 10
Validation mae = 0.929648
Validation band_gap mae = 0.929648
Epoch 11
Validation mae = 0.656381
Validation band_gap mae = 0.656381
Epoch 12
Validation mae = 1.139663
Validation band_gap mae = 1.139663
Epoch 13
Validation mae = 1.116137
Validation band_gap mae = 1.116137
Epoch 14
Validation mae = 1.261741
Validation band_gap mae = 1.261741
Epoch 15
Validation mae = 1.041003
Validation band_gap mae = 1.041003
Epoch 16
Validation mae = 0.877084
Validation band_gap mae = 0.877084
Epoch 17
Validation mae = 0.594341
Validation band_gap mae = 0.594341
Epoch 18
Validation mae = 0.615332
Validation band_gap mae = 0.615332
Epoch 19
Validation mae = 1.284392
Validation band_gap mae = 1.284392
Epoch 20
Validation mae = 0.682260
Validation band_gap mae = 0.682260
Epoch 21
Validation mae = 0.629471
Validation band_gap mae = 0.629471
Epoch 22
Validation mae = 0.665266
Validation band_gap mae = 0.665266
Epoch 23
Validation mae = 0.556166
Validation band_gap mae = 0.556166
Epoch 24
Validation mae = 0.745298
Validation band_gap mae = 0.745298
Epoch 25
Validation mae = 0.837150
Validation band_gap mae = 0.837150
Epoch 26
Validation mae = 0.843702
Validation band_gap mae = 0.843702
Epoch 27
Validation mae = 0.655707
Validation band_gap mae = 0.655707
Epoch 28
Validation mae = 1.132326
Validation band_gap mae = 1.132326
Epoch 29
Validation mae = 0.609729
Validation band_gap mae = 0.609729
Epoch 30
Validation mae = 0.919539
Validation band_gap mae = 0.919539
Epoch 31
Validation mae = 0.764583
Validation band_gap mae = 0.764583
Epoch 32
Validation mae = 0.611730
Validation band_gap mae = 0.611730
Epoch 33
Validation mae = 0.903321
Validation band_gap mae = 0.903321
Epoch 34
Validation mae = 0.646854
Validation band_gap mae = 0.646854
Epoch 35
Validation mae = 0.891387
Validation band_gap mae = 0.891387
Epoch 36
Validation mae = 1.593556
Validation band_gap mae = 1.593556
Epoch 37
Validation mae = 1.286682
Validation band_gap mae = 1.286682
Epoch 38
Validation mae = 0.722082
Validation band_gap mae = 0.722082
Epoch 39
Validation mae = 0.731275
Validation band_gap mae = 0.731275
Epoch 40
Validation mae = 1.029328
Validation band_gap mae = 1.029328
Epoch 41
Validation mae = 0.618802
Validation band_gap mae = 0.618802
Epoch 42
Validation mae = 0.828077
Validation band_gap mae = 0.828077
Epoch 43
Validation mae = 1.213695
Validation band_gap mae = 1.213695
Epoch 44
Validation mae = 0.700604
Validation band_gap mae = 0.700604
Epoch 45
Validation mae = 0.972793
Validation band_gap mae = 0.972793
Epoch 46
Validation mae = 0.985069
Validation band_gap mae = 0.985069
Epoch 47
Validation mae = 0.722633
Validation band_gap mae = 0.722633
Epoch 48
Validation mae = 0.728104
Validation band_gap mae = 0.728104
Epoch 49
Validation mae = 1.032517
Validation band_gap mae = 1.032517
Epoch 50
Validation mae = 0.596215
Validation band_gap mae = 0.596215
Epoch 51
Validation mae = 0.688558
Validation band_gap mae = 0.688558
Epoch 52
Validation mae = 0.685040
Validation band_gap mae = 0.685040
Epoch 53
Validation mae = 0.780589
Validation band_gap mae = 0.780589
Epoch 54
Validation mae = 1.279783
Validation band_gap mae = 1.279783
Epoch 55
Validation mae = 0.908984
Validation band_gap mae = 0.908984
Epoch 56
Validation mae = 1.000808
Validation band_gap mae = 1.000808
Epoch 57
Validation mae = 1.552018
Validation band_gap mae = 1.552018
Epoch 58
Validation mae = 1.405663
Validation band_gap mae = 1.405663
Epoch 59
Validation mae = 0.914960
Validation band_gap mae = 0.914960
Epoch 60
Validation mae = 0.658022
Validation band_gap mae = 0.658022
Epoch 61
Validation mae = 0.634845
Validation band_gap mae = 0.634845
Epoch 62
Validation mae = 0.629714
Validation band_gap mae = 0.629714
Epoch 63
Validation mae = 1.006829
Validation band_gap mae = 1.006829
Epoch 64
Validation mae = 0.654682
Validation band_gap mae = 0.654682
Epoch 65
Validation mae = 0.904882
Validation band_gap mae = 0.904882
Epoch 66
Validation mae = 0.707737
Validation band_gap mae = 0.707737
Epoch 67
Validation mae = 0.641457
Validation band_gap mae = 0.641457
Epoch 68
Validation mae = 0.588199
Validation band_gap mae = 0.588199
Epoch 69
Validation mae = 0.589800
Validation band_gap mae = 0.589800
Epoch 70
Validation mae = 0.581113
Validation band_gap mae = 0.581113
Epoch 71
Validation mae = 0.637295
Validation band_gap mae = 0.637295
Epoch 72
Validation mae = 0.913709
Validation band_gap mae = 0.913709
Epoch 73
Validation mae = 0.933960
Validation band_gap mae = 0.933960
Epoch 74
Validation mae = 0.828435
Validation band_gap mae = 0.828435
Epoch 75
Validation mae = 1.258059
Validation band_gap mae = 1.258059
Epoch 76
Validation mae = 1.437480
Validation band_gap mae = 1.437480
Epoch 77
Validation mae = 1.002217
Validation band_gap mae = 1.002217
Epoch 78
Validation mae = 2.848668
Validation band_gap mae = 2.848668
Epoch 79
Validation mae = 0.918993
Validation band_gap mae = 0.918993
Epoch 80
Validation mae = 0.749962
Validation band_gap mae = 0.749962
Epoch 81
Validation mae = 0.604660
Validation band_gap mae = 0.604660
Epoch 82
Validation mae = 0.658698
Validation band_gap mae = 0.658698
Epoch 83
Validation mae = 0.868343
Validation band_gap mae = 0.868343
Epoch 84
Validation mae = 0.935103
Validation band_gap mae = 0.935103
Epoch 85
Validation mae = 0.581308
Validation band_gap mae = 0.581308
Epoch 86
Validation mae = 0.680798
Validation band_gap mae = 0.680798
Epoch 87
Validation mae = 0.822955
Validation band_gap mae = 0.822955
Epoch 88
Validation mae = 0.695531
Validation band_gap mae = 0.695531
Epoch 89
Validation mae = 0.732370
Validation band_gap mae = 0.732370
Epoch 90
Validation mae = 0.865504
Validation band_gap mae = 0.865504
Epoch 91
Validation mae = 0.737611
Validation band_gap mae = 0.737611
Epoch 92
Validation mae = 1.214891
Validation band_gap mae = 1.214891
Epoch 93
Validation mae = 0.711860
Validation band_gap mae = 0.711860
Epoch 94
Validation mae = 0.861151
Validation band_gap mae = 0.861151
Epoch 95
Validation mae = 1.094160
Validation band_gap mae = 1.094160
Epoch 96
Validation mae = 1.118357
Validation band_gap mae = 1.118357
Epoch 97
Validation mae = 0.967198
Validation band_gap mae = 0.967198
Epoch 98
Validation mae = 0.950779
Validation band_gap mae = 0.950779
Epoch 99
Validation mae = 1.012322
Validation band_gap mae = 1.012322
Model 0 best validation mae = 2.848668 on epoch 78
Moving model to cuda
Model 0 test mae = 1.282286
Model 0 test band_gap mae = 1.282286
Ensemble test mae = 1.282286
Ensemble test band_gap mae = 1.282286
==================== fold 7 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.311078
Validation band_gap mae = 0.311078
Epoch 1
Validation mae = 0.301593
Validation band_gap mae = 0.301593
Epoch 2
Validation mae = 0.422705
Validation band_gap mae = 0.422705
Epoch 3
Validation mae = 0.324929
Validation band_gap mae = 0.324929
Epoch 4
Validation mae = 0.318494
Validation band_gap mae = 0.318494
Epoch 5
Validation mae = 0.626235
Validation band_gap mae = 0.626235
Epoch 6
Validation mae = 0.389022
Validation band_gap mae = 0.389022
Epoch 7
Validation mae = 0.466379
Validation band_gap mae = 0.466379
Epoch 8
Validation mae = 0.299604
Validation band_gap mae = 0.299604
Epoch 9
Validation mae = 0.333930
Validation band_gap mae = 0.333930
Epoch 10
Validation mae = 0.424931
Validation band_gap mae = 0.424931
Epoch 11
Validation mae = 0.425922
Validation band_gap mae = 0.425922
Epoch 12
Validation mae = 0.333069
Validation band_gap mae = 0.333069
Epoch 13
Validation mae = 0.445084
Validation band_gap mae = 0.445084
Epoch 14
Validation mae = 0.313610
Validation band_gap mae = 0.313610
Epoch 15
Validation mae = 0.383233
Validation band_gap mae = 0.383233
Epoch 16
Validation mae = 0.409198
Validation band_gap mae = 0.409198
Epoch 17
Validation mae = 0.335863
Validation band_gap mae = 0.335863
Epoch 18
Validation mae = 0.374730
Validation band_gap mae = 0.374730
Epoch 19
Validation mae = 0.568200
Validation band_gap mae = 0.568200
Epoch 20
Validation mae = 0.488761
Validation band_gap mae = 0.488761
Epoch 21
Validation mae = 0.433584
Validation band_gap mae = 0.433584
Epoch 22
Validation mae = 0.343521
Validation band_gap mae = 0.343521
Epoch 23
Validation mae = 0.500802
Validation band_gap mae = 0.500802
Epoch 24
Validation mae = 0.376737
Validation band_gap mae = 0.376737
Epoch 25
Validation mae = 0.371740
Validation band_gap mae = 0.371740
Epoch 26
Validation mae = 0.330604
Validation band_gap mae = 0.330604
Epoch 27
Validation mae = 0.304702
Validation band_gap mae = 0.304702
Epoch 28
Validation mae = 0.356483
Validation band_gap mae = 0.356483
Epoch 29
Validation mae = 0.326483
Validation band_gap mae = 0.326483
Epoch 30
Validation mae = 0.376769
Validation band_gap mae = 0.376769
Epoch 31
Validation mae = 0.342714
Validation band_gap mae = 0.342714
Epoch 32
Validation mae = 0.293763
Validation band_gap mae = 0.293763
Epoch 33
Validation mae = 0.306697
Validation band_gap mae = 0.306697
Epoch 34
Validation mae = 0.290917
Validation band_gap mae = 0.290917
Epoch 35
Validation mae = 0.299494
Validation band_gap mae = 0.299494
Epoch 36
Validation mae = 0.315248
Validation band_gap mae = 0.315248
Epoch 37
Validation mae = 0.304361
Validation band_gap mae = 0.304361
Epoch 38
Validation mae = 0.362768
Validation band_gap mae = 0.362768
Epoch 39
Validation mae = 0.325734
Validation band_gap mae = 0.325734
Epoch 40
Validation mae = 0.350559
Validation band_gap mae = 0.350559
Epoch 41
Validation mae = 0.316909
Validation band_gap mae = 0.316909
Epoch 42
Validation mae = 0.298435
Validation band_gap mae = 0.298435
Epoch 43
Validation mae = 0.334657
Validation band_gap mae = 0.334657
Epoch 44
Validation mae = 0.410768
Validation band_gap mae = 0.410768
Epoch 45
Validation mae = 0.336978
Validation band_gap mae = 0.336978
Epoch 46
Validation mae = 0.298705
Validation band_gap mae = 0.298705
Epoch 47
Validation mae = 0.290474
Validation band_gap mae = 0.290474
Epoch 48
Validation mae = 0.333614
Validation band_gap mae = 0.333614
Epoch 49
Validation mae = 0.347854
Validation band_gap mae = 0.347854
Epoch 50
Validation mae = 0.323483
Validation band_gap mae = 0.323483
Epoch 51
Validation mae = 0.299680
Validation band_gap mae = 0.299680
Epoch 52
Validation mae = 0.296870
Validation band_gap mae = 0.296870
Epoch 53
Validation mae = 0.298709
Validation band_gap mae = 0.298709
Epoch 54
Validation mae = 0.408318
Validation band_gap mae = 0.408318
Epoch 55
Validation mae = 0.366756
Validation band_gap mae = 0.366756
Epoch 56
Validation mae = 0.375535
Validation band_gap mae = 0.375535
Epoch 57
Validation mae = 0.298042
Validation band_gap mae = 0.298042
Epoch 58
Validation mae = 0.331700
Validation band_gap mae = 0.331700
Epoch 59
Validation mae = 0.336228
Validation band_gap mae = 0.336228
Epoch 60
Validation mae = 0.391458
Validation band_gap mae = 0.391458
Epoch 61
Validation mae = 0.391533
Validation band_gap mae = 0.391533
Epoch 62
Validation mae = 0.352152
Validation band_gap mae = 0.352152
Epoch 63
Validation mae = 0.474830
Validation band_gap mae = 0.474830
Epoch 64
Validation mae = 0.287160
Validation band_gap mae = 0.287160
Epoch 65
Validation mae = 0.330394
Validation band_gap mae = 0.330394
Epoch 66
Validation mae = 0.322432
Validation band_gap mae = 0.322432
Epoch 67
Validation mae = 0.320878
Validation band_gap mae = 0.320878
Epoch 68
Validation mae = 0.292173
Validation band_gap mae = 0.292173
Epoch 69
Validation mae = 0.280620
Validation band_gap mae = 0.280620
Epoch 70
Validation mae = 0.284910
Validation band_gap mae = 0.284910
Epoch 71
Validation mae = 0.238403
Validation band_gap mae = 0.238403
Epoch 72
Validation mae = 0.293828
Validation band_gap mae = 0.293828
Epoch 73
Validation mae = 0.491557
Validation band_gap mae = 0.491557
Epoch 74
Validation mae = 0.355407
Validation band_gap mae = 0.355407
Epoch 75
Validation mae = 0.209971
Validation band_gap mae = 0.209971
Epoch 76
Validation mae = 0.215855
Validation band_gap mae = 0.215855
Epoch 77
Validation mae = 0.223434
Validation band_gap mae = 0.223434
Epoch 78
Validation mae = 0.210280
Validation band_gap mae = 0.210280
Epoch 79
Validation mae = 0.231579
Validation band_gap mae = 0.231579
Epoch 80
Validation mae = 0.207589
Validation band_gap mae = 0.207589
Epoch 81
Validation mae = 0.233045
Validation band_gap mae = 0.233045
Epoch 82
Validation mae = 0.207504
Validation band_gap mae = 0.207504
Epoch 83
Validation mae = 0.254270
Validation band_gap mae = 0.254270
Epoch 84
Validation mae = 0.225213
Validation band_gap mae = 0.225213
Epoch 85
Validation mae = 0.252295
Validation band_gap mae = 0.252295
Epoch 86
Validation mae = 0.223343
Validation band_gap mae = 0.223343
Epoch 87
Validation mae = 0.262190
Validation band_gap mae = 0.262190
Epoch 88
Validation mae = 0.270715
Validation band_gap mae = 0.270715
Epoch 89
Validation mae = 0.292636
Validation band_gap mae = 0.292636
Epoch 90
Validation mae = 0.281183
Validation band_gap mae = 0.281183
Epoch 91
Validation mae = 0.278533
Validation band_gap mae = 0.278533
Epoch 92
Validation mae = 0.232227
Validation band_gap mae = 0.232227
Epoch 93
Validation mae = 0.236578
Validation band_gap mae = 0.236578
Epoch 94
Validation mae = 0.267465
Validation band_gap mae = 0.267465
Epoch 95
Validation mae = 0.259622
Validation band_gap mae = 0.259622
Epoch 96
Validation mae = 0.234988
Validation band_gap mae = 0.234988
Epoch 97
Validation mae = 0.240550
Validation band_gap mae = 0.240550
Epoch 98
Validation mae = 0.225580
Validation band_gap mae = 0.225580
Epoch 99
Validation mae = 0.235468
Validation band_gap mae = 0.235468
Model 0 best validation mae = 0.626235 on epoch 5
Moving model to cuda
Model 0 test mae = 0.561705
Model 0 test band_gap mae = 0.561705
Ensemble test mae = 0.561705
Ensemble test band_gap mae = 0.561705
==================== fold 8 ====================
Total size = 919 | train size = 736 | val size = 91 | test size = 92
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.433904
Validation band_gap mae = 0.433904
Epoch 1
Validation mae = 0.365803
Validation band_gap mae = 0.365803
Epoch 2
Validation mae = 0.403007
Validation band_gap mae = 0.403007
Epoch 3
Validation mae = 0.542581
Validation band_gap mae = 0.542581
Epoch 4
Validation mae = 0.431157
Validation band_gap mae = 0.431157
Epoch 5
Validation mae = 0.372067
Validation band_gap mae = 0.372067
Epoch 6
Validation mae = 0.346509
Validation band_gap mae = 0.346509
Epoch 7
Validation mae = 0.427531
Validation band_gap mae = 0.427531
Epoch 8
Validation mae = 0.404730
Validation band_gap mae = 0.404730
Epoch 9
Validation mae = 0.595071
Validation band_gap mae = 0.595071
Epoch 10
Validation mae = 0.479483
Validation band_gap mae = 0.479483
Epoch 11
Validation mae = 0.389994
Validation band_gap mae = 0.389994
Epoch 12
Validation mae = 0.388733
Validation band_gap mae = 0.388733
Epoch 13
Validation mae = 0.463884
Validation band_gap mae = 0.463884
Epoch 14
Validation mae = 0.379939
Validation band_gap mae = 0.379939
Epoch 15
Validation mae = 0.404617
Validation band_gap mae = 0.404617
Epoch 16
Validation mae = 0.441050
Validation band_gap mae = 0.441050
Epoch 17
Validation mae = 0.382247
Validation band_gap mae = 0.382247
Epoch 18
Validation mae = 0.369450
Validation band_gap mae = 0.369450
Epoch 19
Validation mae = 0.408657
Validation band_gap mae = 0.408657
Epoch 20
Validation mae = 0.373390
Validation band_gap mae = 0.373390
Epoch 21
Validation mae = 0.362666
Validation band_gap mae = 0.362666
Epoch 22
Validation mae = 0.426186
Validation band_gap mae = 0.426186
Epoch 23
Validation mae = 0.374214
Validation band_gap mae = 0.374214
Epoch 24
Validation mae = 0.547049
Validation band_gap mae = 0.547049
Epoch 25
Validation mae = 0.502321
Validation band_gap mae = 0.502321
Epoch 26
Validation mae = 0.385783
Validation band_gap mae = 0.385783
Epoch 27
Validation mae = 0.357546
Validation band_gap mae = 0.357546
Epoch 28
Validation mae = 0.373622
Validation band_gap mae = 0.373622
Epoch 29
Validation mae = 0.367458
Validation band_gap mae = 0.367458
Epoch 30
Validation mae = 0.418246
Validation band_gap mae = 0.418246
Epoch 31
Validation mae = 0.451799
Validation band_gap mae = 0.451799
Epoch 32
Validation mae = 0.422090
Validation band_gap mae = 0.422090
Epoch 33
Validation mae = 0.388606
Validation band_gap mae = 0.388606
Epoch 34
Validation mae = 0.409953
Validation band_gap mae = 0.409953
Epoch 35
Validation mae = 0.424932
Validation band_gap mae = 0.424932
Epoch 36
Validation mae = 0.406403
Validation band_gap mae = 0.406403
Epoch 37
Validation mae = 0.373776
Validation band_gap mae = 0.373776
Epoch 38
Validation mae = 0.411284
Validation band_gap mae = 0.411284
Epoch 39
Validation mae = 0.390806
Validation band_gap mae = 0.390806
Epoch 40
Validation mae = 0.394052
Validation band_gap mae = 0.394052
Epoch 41
Validation mae = 0.355354
Validation band_gap mae = 0.355354
Epoch 42
Validation mae = 0.397893
Validation band_gap mae = 0.397893
Epoch 43
Validation mae = 0.405579
Validation band_gap mae = 0.405579
Epoch 44
Validation mae = 0.383967
Validation band_gap mae = 0.383967
Epoch 45
Validation mae = 0.407911
Validation band_gap mae = 0.407911
Epoch 46
Validation mae = 0.402931
Validation band_gap mae = 0.402931
Epoch 47
Validation mae = 0.478577
Validation band_gap mae = 0.478577
Epoch 48
Validation mae = 0.439357
Validation band_gap mae = 0.439357
Epoch 49
Validation mae = 0.474615
Validation band_gap mae = 0.474615
Epoch 50
Validation mae = 0.403935
Validation band_gap mae = 0.403935
Epoch 51
Validation mae = 0.424315
Validation band_gap mae = 0.424315
Epoch 52
Validation mae = 0.486653
Validation band_gap mae = 0.486653
Epoch 53
Validation mae = 0.427442
Validation band_gap mae = 0.427442
Epoch 54
Validation mae = 0.457220
Validation band_gap mae = 0.457220
Epoch 55
Validation mae = 0.362458
Validation band_gap mae = 0.362458
Epoch 56
Validation mae = 0.539965
Validation band_gap mae = 0.539965
Epoch 57
Validation mae = 0.545492
Validation band_gap mae = 0.545492
Epoch 58
Validation mae = 0.391255
Validation band_gap mae = 0.391255
Epoch 59
Validation mae = 0.367811
Validation band_gap mae = 0.367811
Epoch 60
Validation mae = 0.379181
Validation band_gap mae = 0.379181
Epoch 61
Validation mae = 0.409574
Validation band_gap mae = 0.409574
Epoch 62
Validation mae = 0.389139
Validation band_gap mae = 0.389139
Epoch 63
Validation mae = 0.438492
Validation band_gap mae = 0.438492
Epoch 64
Validation mae = 0.483265
Validation band_gap mae = 0.483265
Epoch 65
Validation mae = 0.417119
Validation band_gap mae = 0.417119
Epoch 66
Validation mae = 0.452708
Validation band_gap mae = 0.452708
Epoch 67
Validation mae = 0.395025
Validation band_gap mae = 0.395025
Epoch 68
Validation mae = 0.361876
Validation band_gap mae = 0.361876
Epoch 69
Validation mae = 0.370758
Validation band_gap mae = 0.370758
Epoch 70
Validation mae = 0.360345
Validation band_gap mae = 0.360345
Epoch 71
Validation mae = 0.389407
Validation band_gap mae = 0.389407
Epoch 72
Validation mae = 0.375157
Validation band_gap mae = 0.375157
Epoch 73
Validation mae = 0.415314
Validation band_gap mae = 0.415314
Epoch 74
Validation mae = 0.411097
Validation band_gap mae = 0.411097
Epoch 75
Validation mae = 0.452325
Validation band_gap mae = 0.452325
Epoch 76
Validation mae = 0.455093
Validation band_gap mae = 0.455093
Epoch 77
Validation mae = 0.550365
Validation band_gap mae = 0.550365
Epoch 78
Validation mae = 0.482654
Validation band_gap mae = 0.482654
Epoch 79
Validation mae = 0.518563
Validation band_gap mae = 0.518563
Epoch 80
Validation mae = 0.481639
Validation band_gap mae = 0.481639
Epoch 81
Validation mae = 0.468585
Validation band_gap mae = 0.468585
Epoch 82
Validation mae = 0.391412
Validation band_gap mae = 0.391412
Epoch 83
Validation mae = 0.465571
Validation band_gap mae = 0.465571
Epoch 84
Validation mae = 0.512112
Validation band_gap mae = 0.512112
Epoch 85
Validation mae = 0.458987
Validation band_gap mae = 0.458987
Epoch 86
Validation mae = 0.502392
Validation band_gap mae = 0.502392
Epoch 87
Validation mae = 0.441305
Validation band_gap mae = 0.441305
Epoch 88
Validation mae = 0.474253
Validation band_gap mae = 0.474253
Epoch 89
Validation mae = 0.449931
Validation band_gap mae = 0.449931
Epoch 90
Validation mae = 0.460795
Validation band_gap mae = 0.460795
Epoch 91
Validation mae = 0.481280
Validation band_gap mae = 0.481280
Epoch 92
Validation mae = 0.395140
Validation band_gap mae = 0.395140
Epoch 93
Validation mae = 0.361187
Validation band_gap mae = 0.361187
Epoch 94
Validation mae = 0.487535
Validation band_gap mae = 0.487535
Epoch 95
Validation mae = 0.388004
Validation band_gap mae = 0.388004
Epoch 96
Validation mae = 0.441211
Validation band_gap mae = 0.441211
Epoch 97
Validation mae = 0.450267
Validation band_gap mae = 0.450267
Epoch 98
Validation mae = 0.396846
Validation band_gap mae = 0.396846
Epoch 99
Validation mae = 0.425905
Validation band_gap mae = 0.425905
Model 0 best validation mae = 0.595071 on epoch 9
Moving model to cuda
Model 0 test mae = 0.402156
Model 0 test band_gap mae = 0.402156
Ensemble test mae = 0.402156
Ensemble test band_gap mae = 0.402156
==================== fold 9 ====================
Total size = 919 | train size = 737 | val size = 91 | test size = 91
Fitting scaler
None
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=46, out_features=512, bias=False)
      (W_i_bond): Linear(in_features=104, out_features=512, bias=False)
      (W_h_atom): Linear(in_features=616, out_features=512, bias=False)
      (W_o): Linear(in_features=1024, out_features=512, bias=True)
      (gru): BatchGRU(
        (gru): GRU(512, 512, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=1536, out_features=512, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=True)
    (1): Linear(in_features=512, out_features=512, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=True)
    (4): Linear(in_features=512, out_features=512, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=True)
    (7): Linear(in_features=512, out_features=512, bias=True)
    (8): ReLU()
    (9): Dropout(p=0.0, inplace=True)
    (10): Linear(in_features=512, out_features=1, bias=True)
  )
)
Number of parameters = 5,644,289
Moving model to cuda
Epoch 0
Validation mae = 0.523941
Validation band_gap mae = 0.523941
Epoch 1
Validation mae = 0.449583
Validation band_gap mae = 0.449583
Epoch 2
Validation mae = 0.422717
Validation band_gap mae = 0.422717
Epoch 3
Validation mae = 0.381276
Validation band_gap mae = 0.381276
Epoch 4
Validation mae = 0.351550
Validation band_gap mae = 0.351550
Epoch 5
Validation mae = 0.424644
Validation band_gap mae = 0.424644
Epoch 6
Validation mae = 0.401017
Validation band_gap mae = 0.401017
Epoch 7
Validation mae = 0.558542
Validation band_gap mae = 0.558542
Epoch 8
Validation mae = 0.529864
Validation band_gap mae = 0.529864
Epoch 9
Validation mae = 0.401781
Validation band_gap mae = 0.401781
Epoch 10
Validation mae = 0.385513
Validation band_gap mae = 0.385513
Epoch 11
Validation mae = 0.389440
Validation band_gap mae = 0.389440
Epoch 12
Validation mae = 0.427690
Validation band_gap mae = 0.427690
Epoch 13
Validation mae = 0.413389
Validation band_gap mae = 0.413389
Epoch 14
Validation mae = 0.357272
Validation band_gap mae = 0.357272
Epoch 15
Validation mae = 0.530144
Validation band_gap mae = 0.530144
Epoch 16
Validation mae = 0.383117
Validation band_gap mae = 0.383117
Epoch 17
Validation mae = 0.350352
Validation band_gap mae = 0.350352
Epoch 18
Validation mae = 0.378688
Validation band_gap mae = 0.378688
Epoch 19
Validation mae = 0.511051
Validation band_gap mae = 0.511051
Epoch 20
Validation mae = 0.336971
Validation band_gap mae = 0.336971
Epoch 21
Validation mae = 0.407965
Validation band_gap mae = 0.407965
Epoch 22
Validation mae = 0.338428
Validation band_gap mae = 0.338428
Epoch 23
Validation mae = 0.463290
Validation band_gap mae = 0.463290
Epoch 24
Validation mae = 0.432425
Validation band_gap mae = 0.432425
Epoch 25
Validation mae = 0.452741
Validation band_gap mae = 0.452741
Epoch 26
Validation mae = 0.349499
Validation band_gap mae = 0.349499
Epoch 27
Validation mae = 0.452793
Validation band_gap mae = 0.452793
Epoch 28
Validation mae = 0.426055
Validation band_gap mae = 0.426055
Epoch 29
Validation mae = 0.557050
Validation band_gap mae = 0.557050
Epoch 30
Validation mae = 0.360376
Validation band_gap mae = 0.360376
Epoch 31
Validation mae = 0.392527
Validation band_gap mae = 0.392527
Epoch 32
Validation mae = 0.352900
Validation band_gap mae = 0.352900
Epoch 33
Validation mae = 0.470496
Validation band_gap mae = 0.470496
Epoch 34
Validation mae = 0.342475
Validation band_gap mae = 0.342475
Epoch 35
Validation mae = 0.361578
Validation band_gap mae = 0.361578
Epoch 36
Validation mae = 0.350235
Validation band_gap mae = 0.350235
Epoch 37
Validation mae = 0.453158
Validation band_gap mae = 0.453158
Epoch 38
Validation mae = 0.477596
Validation band_gap mae = 0.477596
Epoch 39
Validation mae = 0.434623
Validation band_gap mae = 0.434623
Epoch 40
Validation mae = 0.364072
Validation band_gap mae = 0.364072
Epoch 41
Validation mae = 0.430679
Validation band_gap mae = 0.430679
Epoch 42
Validation mae = 0.645559
Validation band_gap mae = 0.645559
Epoch 43
Validation mae = 0.416582
Validation band_gap mae = 0.416582
Epoch 44
Validation mae = 0.372936
Validation band_gap mae = 0.372936
Epoch 45
Validation mae = 0.429552
Validation band_gap mae = 0.429552
Epoch 46
Validation mae = 0.465164
Validation band_gap mae = 0.465164
Epoch 47
Validation mae = 0.591153
Validation band_gap mae = 0.591153
Epoch 48
Validation mae = 0.563324
Validation band_gap mae = 0.563324
Epoch 49
Validation mae = 0.479490
Validation band_gap mae = 0.479490
Epoch 50
Validation mae = 0.437529
Validation band_gap mae = 0.437529
Epoch 51
Validation mae = 0.402104
Validation band_gap mae = 0.402104
Epoch 52
Validation mae = 0.577022
Validation band_gap mae = 0.577022
Epoch 53
Validation mae = 0.458124
Validation band_gap mae = 0.458124
Epoch 54
Validation mae = 0.385730
Validation band_gap mae = 0.385730
Epoch 55
Validation mae = 0.418998
Validation band_gap mae = 0.418998
Epoch 56
Validation mae = 0.418254
Validation band_gap mae = 0.418254
Epoch 57
Validation mae = 0.410422
Validation band_gap mae = 0.410422
Epoch 58
Validation mae = 0.449412
Validation band_gap mae = 0.449412
Epoch 59
Validation mae = 0.446718
Validation band_gap mae = 0.446718
Epoch 60
Validation mae = 0.382980
Validation band_gap mae = 0.382980
Epoch 61
Validation mae = 0.477173
Validation band_gap mae = 0.477173
Epoch 62
Validation mae = 0.445327
Validation band_gap mae = 0.445327
Epoch 63
Validation mae = 0.410382
Validation band_gap mae = 0.410382
Epoch 64
Validation mae = 0.480503
Validation band_gap mae = 0.480503
Epoch 65
Validation mae = 0.403876
Validation band_gap mae = 0.403876
Epoch 66
Validation mae = 0.400121
Validation band_gap mae = 0.400121
Epoch 67
Validation mae = 0.415531
Validation band_gap mae = 0.415531
Epoch 68
Validation mae = 0.434977
Validation band_gap mae = 0.434977
Epoch 69
Validation mae = 0.418631
Validation band_gap mae = 0.418631
Epoch 70
Validation mae = 0.419597
Validation band_gap mae = 0.419597
Epoch 71
Validation mae = 0.481966
Validation band_gap mae = 0.481966
Epoch 72
Validation mae = 0.406894
Validation band_gap mae = 0.406894
Epoch 73
Validation mae = 0.437305
Validation band_gap mae = 0.437305
Epoch 74
Validation mae = 0.421585
Validation band_gap mae = 0.421585
Epoch 75
Validation mae = 0.418248
Validation band_gap mae = 0.418248
Epoch 76
Validation mae = 0.425586
Validation band_gap mae = 0.425586
Epoch 77
Validation mae = 0.422961
Validation band_gap mae = 0.422961
Epoch 78
Validation mae = 0.427372
Validation band_gap mae = 0.427372
Epoch 79
Validation mae = 0.422154
Validation band_gap mae = 0.422154
Epoch 80
Validation mae = 0.445505
Validation band_gap mae = 0.445505
Epoch 81
Validation mae = 0.430522
Validation band_gap mae = 0.430522
Epoch 82
Validation mae = 0.440140
Validation band_gap mae = 0.440140
Epoch 83
Validation mae = 0.436735
Validation band_gap mae = 0.436735
Epoch 84
Validation mae = 0.415052
Validation band_gap mae = 0.415052
Epoch 85
Validation mae = 0.440989
Validation band_gap mae = 0.440989
Epoch 86
Validation mae = 0.422865
Validation band_gap mae = 0.422865
Epoch 87
Validation mae = 0.438836
Validation band_gap mae = 0.438836
Epoch 88
Validation mae = 0.430804
Validation band_gap mae = 0.430804
Epoch 89
Validation mae = 0.451595
Validation band_gap mae = 0.451595
Epoch 90
Validation mae = 0.425440
Validation band_gap mae = 0.425440
Epoch 91
Validation mae = 0.411069
Validation band_gap mae = 0.411069
Epoch 92
Validation mae = 0.449729
Validation band_gap mae = 0.449729
Epoch 93
Validation mae = 0.426022
Validation band_gap mae = 0.426022
Epoch 94
Validation mae = 0.421169
Validation band_gap mae = 0.421169
Epoch 95
Validation mae = 0.429256
Validation band_gap mae = 0.429256
Epoch 96
Validation mae = 0.423855
Validation band_gap mae = 0.423855
Epoch 97
Validation mae = 0.415704
Validation band_gap mae = 0.415704
Epoch 98
Validation mae = 0.422849
Validation band_gap mae = 0.422849
Epoch 99
Validation mae = 0.424933
Validation band_gap mae = 0.424933
Model 0 best validation mae = 0.645559 on epoch 42
Moving model to cuda
Model 0 test mae = 0.215110
Model 0 test band_gap mae = 0.215110
Ensemble test mae = 0.215110
Ensemble test band_gap mae = 0.215110
10-fold cross validation
Seed 1
Fold 0 ==> valid mae = 9.788796 test mae = 9.917665
Fold 0 ==> valid band_gap mae = 9.788796test band_gap mae = 9.917665
Fold 1 ==> valid mae = 4.543805 test mae = 3.864657
Fold 1 ==> valid band_gap mae = 4.543805test band_gap mae = 3.864657
Fold 2 ==> valid mae = 2.318837 test mae = 0.683085
Fold 2 ==> valid band_gap mae = 2.318837test band_gap mae = 0.683085
Fold 3 ==> valid mae = 2.163771 test mae = 0.430437
Fold 3 ==> valid band_gap mae = 2.163771test band_gap mae = 0.430437
Fold 4 ==> valid mae = 2.176274 test mae = 0.792708
Fold 4 ==> valid band_gap mae = 2.176274test band_gap mae = 0.792708
Fold 5 ==> valid mae = 1.972858 test mae = 0.457374
Fold 5 ==> valid band_gap mae = 1.972858test band_gap mae = 0.457374
Fold 6 ==> valid mae = 2.848668 test mae = 1.282286
Fold 6 ==> valid band_gap mae = 2.848668test band_gap mae = 1.282286
Fold 7 ==> valid mae = 0.626235 test mae = 0.561705
Fold 7 ==> valid band_gap mae = 0.626235test band_gap mae = 0.561705
Fold 8 ==> valid mae = 0.595071 test mae = 0.402156
Fold 8 ==> valid band_gap mae = 0.595071test band_gap mae = 0.402156
Fold 9 ==> valid mae = 0.645559 test mae = 0.215110
Fold 9 ==> valid band_gap mae = 0.645559test band_gap mae = 0.215110
Overall valid mae = 2.767988 +/- 2.604119
Overall test mae = 1.860718 +/- 2.869323
Overall test band_gap mae = 1.860718 +/- 2.869323
